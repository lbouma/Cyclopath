------------------------------------------------------------------------
r31108 | landonb | 2014-02-05 17:57:50 -0600 (Wed, 05 Feb 2014) | 13 lines

Fix problems saving and deleting items.
- Flashclient was not interpreting the
  new version from the server correctly.
- Flashclient was expecting version info
  on deleted items, but it's not sent.
  - And Flashclient shouldn't expect GIA
    records, either.
- Fix overzealous assert when deleting
  item while it's being lazy-loaded.
Fix search problems when server response
 is not formatted as expected (i.e., lots
 more null checks in flashclient).

------------------------------------------------------------------------
r31107 | landonb | 2014-02-05 17:53:54 -0600 (Wed, 05 Feb 2014) | 1 line

Add debug/testing comments, and replace short-circuit return.
------------------------------------------------------------------------
r31106 | landonb | 2014-02-05 17:52:05 -0600 (Wed, 05 Feb 2014) | 1 line

Tune error messages to reduce logcheck babble
------------------------------------------------------------------------
r31105 | landonb | 2014-02-05 17:51:27 -0600 (Wed, 05 Feb 2014) | 1 line

Harden byway fcn to verify geometry type (and adapt accordingly; i.e., handle raw, wkt, and svg)
------------------------------------------------------------------------
r31104 | landonb | 2014-02-05 17:50:15 -0600 (Wed, 05 Feb 2014) | 11 lines

Cool new feature: client search-by-stack-id.
- In Flashclient, enter an item's stack ID to
  be spirited to it.
- Makes it easy for developers who are digging
  around the database to easily find items on
  the map.
  - E.g., I saw a logcheck email about a command
    that failed, and the email contained the stack
    ID, so I was able to load Cyclopath and quickly
    find the item on the map.

------------------------------------------------------------------------
r31103 | landonb | 2014-02-05 17:47:01 -0600 (Wed, 05 Feb 2014) | 5 lines

Problem deleting an item from flashclient
 while it was still lazy-loading.
 - Over-zealous assert.
 - Change similar asserts to soft asserts.

------------------------------------------------------------------------
r31102 | landonb | 2014-02-05 17:43:18 -0600 (Wed, 05 Feb 2014) | 1 line

Add Mercurial to Mint16 install
------------------------------------------------------------------------
r31101 | landonb | 2014-02-05 17:42:43 -0600 (Wed, 05 Feb 2014) | 1 line

Fix perms on installed GDAL libraries
------------------------------------------------------------------------
r31100 | landonb | 2014-02-05 17:42:16 -0600 (Wed, 05 Feb 2014) | 1 line

Make dev/prod templates for htdocs files
------------------------------------------------------------------------
r31099 | landonb | 2014-02-05 17:42:02 -0600 (Wed, 05 Feb 2014) | 1 line

Add markdown to downloaded docs (for Bitbucket README.md referece
------------------------------------------------------------------------
r31098 | landonb | 2014-02-05 17:41:11 -0600 (Wed, 05 Feb 2014) | 1 line

Make dev/prod templates for htdocs files
------------------------------------------------------------------------
r31097 | landonb | 2014-02-05 17:40:11 -0600 (Wed, 05 Feb 2014) | 1 line

Make dev/prod templates for htdocs files
------------------------------------------------------------------------
r31096 | landonb | 2014-02-05 17:38:59 -0600 (Wed, 05 Feb 2014) | 1 line

Make dev/prod templates for htdocs files
------------------------------------------------------------------------
r31095 | landonb | 2014-02-05 17:37:29 -0600 (Wed, 05 Feb 2014) | 1 line

Debug comments
------------------------------------------------------------------------
r31094 | landonb | 2014-02-05 16:02:41 -0600 (Wed, 05 Feb 2014) | 1 line

Update svn log mirror.
------------------------------------------------------------------------
r31091 | landonb | 2014-02-04 21:59:53 -0600 (Tue, 04 Feb 2014) | 11 lines

DEVS: cd /ccp/dev/cp/scripts ; ./schema-upgrade.py
==================================================
Fix problem with constraint on geofeature table: We cannot
use subqueries. But for whatever reason, even though our
constraint has a subquery (it calls cp_srid) for whatever
reason I only discovered the problem when trying to run
ogr2ogr (though you can also produce the problem by
SELECT * FROM geometry_columns).
- This schema script drops the old constraint and
  makes a new one with the SRID hard-coded.

------------------------------------------------------------------------
r31090 | landonb | 2014-02-04 21:56:14 -0600 (Tue, 04 Feb 2014) | 12 lines

Update public schema export script:
- Use $INSTANCE rather than hard-coded 'minnesota'.
- Lots of comments about steps remaining to show
  how to import the schema and data and then
  create new instructios and code on import a
  shapefile (so that you actually have a map)
  and also creating users, groups, branches,
  new item policies, etc. (populating the data
  we don't incude in the export that's not
  GIS map data).
- Rather than copy the elevation, just symlink it.

------------------------------------------------------------------------
r31089 | landonb | 2014-02-04 21:43:18 -0600 (Tue, 04 Feb 2014) | 1 line

Move htdocs/misc to /ccp/var/htdocs to accomodate sharing resources among installations in /ccp/dev
------------------------------------------------------------------------
r31088 | landonb | 2014-02-04 21:40:31 -0600 (Tue, 04 Feb 2014) | 3 lines

Update ogr2og2 call: specify port number in
connection string; use what's in pyserver/CONFIG.

------------------------------------------------------------------------
r31087 | landonb | 2014-02-04 21:39:03 -0600 (Tue, 04 Feb 2014) | 1 line

Add comment about apache log line format
------------------------------------------------------------------------
r31080 | landonb | 2014-02-04 18:19:00 -0600 (Tue, 04 Feb 2014) | 1 line

Missing postgres from gdal compile in install script.
------------------------------------------------------------------------
r31079 | landonb | 2014-02-04 18:17:05 -0600 (Tue, 04 Feb 2014) | 1 line

New fcn., wait_bg_tasks, to wait on outstanding tasks (by PID) and also to check their logfiles for errors once all are complete; for use by daily and weekly cron jobs.
------------------------------------------------------------------------
r31078 | landonb | 2014-02-04 18:11:07 -0600 (Tue, 04 Feb 2014) | 1 line

Add eog to mint16 apt-get install; also group packages.
------------------------------------------------------------------------
r31077 | landonb | 2014-02-04 18:07:04 -0600 (Tue, 04 Feb 2014) | 1 line

Make stats png output dir if it doesn't exist.
------------------------------------------------------------------------
r31076 | landonb | 2014-02-04 18:05:42 -0600 (Tue, 04 Feb 2014) | 1 line

Missing target file in path for m4.
------------------------------------------------------------------------
r31075 | landonb | 2014-02-04 18:04:27 -0600 (Tue, 04 Feb 2014) | 1 line

Add robots.txt
------------------------------------------------------------------------
r31073 | landonb | 2014-02-04 16:22:08 -0600 (Tue, 04 Feb 2014) | 1 line

Bug 2826 - Pyserver bails on request containing unicode control characters
------------------------------------------------------------------------
r31072 | landonb | 2014-02-04 16:21:43 -0600 (Tue, 04 Feb 2014) | 1 line

Ccp Export bugfix: Don't reset same_version for Nonwiki items in commit.
------------------------------------------------------------------------
r31071 | landonb | 2014-02-04 15:24:16 -0600 (Tue, 04 Feb 2014) | 1 line

Update install reminder to explain how to configure and use Wireshark.
------------------------------------------------------------------------
r31070 | landonb | 2014-02-04 15:23:58 -0600 (Tue, 04 Feb 2014) | 1 line

Lots of comments about... bugs.
------------------------------------------------------------------------
r31069 | landonb | 2014-02-04 15:21:29 -0600 (Tue, 04 Feb 2014) | 4 lines

- Move GWIS timeout from Conf to Conf_Instance to make it
  easier to change on developer machines (and, e.g., not
  see it popup as a conflict when diffing source).

------------------------------------------------------------------------
r31065 | landonb | 2014-02-03 17:51:33 -0600 (Mon, 03 Feb 2014) | 1 line

Minor mint16 fixes.
------------------------------------------------------------------------
r31059 | landonb | 2014-01-31 19:12:40 -0600 (Fri, 31 Jan 2014) | 1 line

Fix saving new note on new point to not set multiple_allowed to True on attachment type that doesn't specify; the correct answer is: False.
------------------------------------------------------------------------
r31058 | landonb | 2014-01-31 18:59:44 -0600 (Fri, 31 Jan 2014) | 1 line

Don't enable the new-discussion line when the map is dirty. Also, on panel creation, when trying to determine the tooltip, don't die on null because items_selected isn't set.
------------------------------------------------------------------------
r31057 | landonb | 2014-01-31 17:37:44 -0600 (Fri, 31 Jan 2014) | 1 line

Mobile updates
------------------------------------------------------------------------
r31055 | landonb | 2014-01-31 16:14:48 -0600 (Fri, 31 Jan 2014) | 1 line

Flashclient: fix problem after saving new item: when GIA record was received, client needs to try client ID to find existing item, since GIA records are created before item is updated.
------------------------------------------------------------------------
r31054 | landonb | 2014-01-31 16:08:40 -0600 (Fri, 31 Jan 2014) | 1 line

Make static fcn. for finding item of unknown type with a stack ID by searching each of the item type lookups.
------------------------------------------------------------------------
r31053 | landonb | 2014-01-31 16:07:06 -0600 (Fri, 31 Jan 2014) | 1 line

Delete unused fcn. and cleanup some comments.
------------------------------------------------------------------------
r31052 | landonb | 2014-01-31 16:05:13 -0600 (Fri, 31 Jan 2014) | 1 line

Fix problem saving new items: grac_manager was either not assigning dirty, or was assigning it incorrectly, for new items.
------------------------------------------------------------------------
r31051 | landonb | 2014-01-31 16:03:45 -0600 (Fri, 31 Jan 2014) | 1 line

When getting a token takes too long, can now decide to log a debug/info message or a warning -- we don't want emails except for the outliers.
------------------------------------------------------------------------
r31050 | landonb | 2014-01-31 16:02:27 -0600 (Fri, 31 Jan 2014) | 1 line

Added comments and traces in server's gwis request handler to help investigate mobile issues, like GET instead of POST, and missing content bodies.
------------------------------------------------------------------------
r31049 | landonb | 2014-01-31 15:59:58 -0600 (Fri, 31 Jan 2014) | 1 line

MS docs say 'upHierarchy' but it's really 'UpHierarchy'. Or maybe both.
------------------------------------------------------------------------
r31048 | landonb | 2014-01-31 15:39:09 -0600 (Fri, 31 Jan 2014) | 11 lines

- Change assert to raising GWIS_Error: when the route
  finder is locked because it's updating (and not simply
  reloading), we were incorrectly asserting. Instead, tell
  the user to try again soon. (We really need to use two dbs,
  update the second db, and then switch over, so there is
  never any downtime...)
- Also, we output O/D pair to the log file when route
  cannot be found to make it easier to see if it's our fault
  (e.g., duluth to mpls), or if the route is simply not ours
  (e.g., phoenix to las vegas)."

------------------------------------------------------------------------
r31047 | landonb | 2014-01-31 15:37:51 -0600 (Fri, 31 Jan 2014) | 1 line

Change assert to raising GWIS_Error: when the route finder is locked because it's updating (and not simply reloading), we were incorrectly asserting. Instead, tell the user to try again soon. (We really need to use two dbs, update the second db, and then switch over, so there is never any downtime...) Also, we output O/D pair to the log file when route cannot be found to make it easier if it's our fault (e.g., duluth to mpls), or if the route is simply not ours (e.g., phoenix to las vegas).
------------------------------------------------------------------------
r31046 | landonb | 2014-01-31 15:33:00 -0600 (Fri, 31 Jan 2014) | 1 line

Fix path to script in old setupcp/runin dir.
------------------------------------------------------------------------
r31045 | landonb | 2014-01-31 15:32:22 -0600 (Fri, 31 Jan 2014) | 1 line

To time_complain, add some options so devs can define a window on complaint, to help key an eye on things without generating a lot of logcheck email chattery.
------------------------------------------------------------------------
r31044 | landonb | 2014-01-31 15:31:17 -0600 (Fri, 31 Jan 2014) | 1 line

Comment to help devs start debug session.
------------------------------------------------------------------------
r31043 | landonb | 2014-01-31 15:29:40 -0600 (Fri, 31 Jan 2014) | 1 line

Make hard-ref to sed to avoid alias issue.
------------------------------------------------------------------------
r31042 | landonb | 2014-01-31 15:28:50 -0600 (Fri, 31 Jan 2014) | 1 line

Add options to check_prev_cmd_for_error so cron jobs can check for errors just in the tail of a file, and/or do case-insensitive search for magic error string.
------------------------------------------------------------------------
r31041 | landonb | 2014-01-31 15:27:44 -0600 (Fri, 31 Jan 2014) | 6 lines

- Add steps so Wireshark can be run without user being root
  (basically, create wireshark group and add user to it.)
- Also, make Reader not install by default, because of
  license restrictions (cannot distribute as part of
  virtial machine image, which is what we want to do).

------------------------------------------------------------------------
r31040 | landonb | 2014-01-31 15:20:00 -0600 (Fri, 31 Jan 2014) | 1 line

Mint 16 MATE launcher tweaks.
------------------------------------------------------------------------
r31039 | landonb | 2014-01-31 15:18:24 -0600 (Fri, 31 Jan 2014) | 1 line

Drop missing view from old trial.
------------------------------------------------------------------------
r31038 | landonb | 2014-01-31 15:16:34 -0600 (Fri, 31 Jan 2014) | 1 line

Change transitdb_source to transit_db_source to match other usages.
------------------------------------------------------------------------
r31037 | landonb | 2014-01-31 15:14:10 -0600 (Fri, 31 Jan 2014) | 1 line

Troubleshoot apache2sql error: 'psycopg2.DataError: integer out of range'
------------------------------------------------------------------------
r31036 | landonb | 2014-01-31 12:54:50 -0600 (Fri, 31 Jan 2014) | 1 line

Minor Mint 16 install updates to desktop launcher files.
------------------------------------------------------------------------
r31035 | landonb | 2014-01-31 12:49:40 -0600 (Fri, 31 Jan 2014) | 12 lines

To authfail_audit.pl, which analyzes the apache log for
failed login attempts:
 - Remove the two exempt IPs to see if Bug 1562 et al
   still happen; and
 - Add comments about using script better. E.g., from
   the cron job, use `wc` and touch files so we don't
   re-analyze the same apache log events every time
   this script is run. (It should be noted that this
   is the first edit to this script since CcpV1, which
   is probably a record; most scripts have been fiddled
   with since "then".)

------------------------------------------------------------------------
r31027 | landonb | 2014-01-29 17:22:47 -0600 (Wed, 29 Jan 2014) | 1 line

More MATE install code. Should be complete now.
------------------------------------------------------------------------
r31026 | landonb | 2014-01-29 12:10:40 -0600 (Wed, 29 Jan 2014) | 1 line

Mint MATE installer. Find aliased 'sed' issue. Fix logcheck issues with newlines in log messages.
------------------------------------------------------------------------
r31024 | landonb | 2014-01-24 12:44:10 -0600 (Fri, 24 Jan 2014) | 1 line

More Mint 16 fixes.
------------------------------------------------------------------------
r31023 | landonb | 2014-01-23 17:36:25 -0600 (Thu, 23 Jan 2014) | 1 line

Mint 16 install fix
------------------------------------------------------------------------
r31022 | landonb | 2014-01-23 16:34:06 -0600 (Thu, 23 Jan 2014) | 1 line

Update pdf makefile to work with new fchs-wrap
------------------------------------------------------------------------
r31021 | landonb | 2014-01-23 16:26:33 -0600 (Thu, 23 Jan 2014) | 1 line

More Mint 16 installation fixes.
------------------------------------------------------------------------
r31020 | landonb | 2014-01-23 13:15:16 -0600 (Thu, 23 Jan 2014) | 1 line

More fixes (sorry for the multiple checkins, I'm testing installing from an SVN checkout...).
------------------------------------------------------------------------
r31019 | landonb | 2014-01-23 12:55:35 -0600 (Thu, 23 Jan 2014) | 1 line

Mint 16 installer fixes.
------------------------------------------------------------------------
r31018 | landonb | 2014-01-23 12:52:10 -0600 (Thu, 23 Jan 2014) | 1 line

Mint 16 installer fixes.
------------------------------------------------------------------------
r31017 | landonb | 2014-01-23 12:36:57 -0600 (Thu, 23 Jan 2014) | 1 line

Fix conf option when building flashclient using new m4 template-created Conf_Instance.as.
------------------------------------------------------------------------
r31016 | landonb | 2014-01-23 12:30:02 -0600 (Thu, 23 Jan 2014) | 1 line

Stray comma in Mint 16 Conf_Instance.as
------------------------------------------------------------------------
r31015 | landonb | 2014-01-23 12:27:00 -0600 (Thu, 23 Jan 2014) | 1 line

Missing from previous.
------------------------------------------------------------------------
r31014 | landonb | 2014-01-23 12:13:10 -0600 (Thu, 23 Jan 2014) | 1 line

Mint 16 config files and install script: You can now install Cyclopath on and configure fresh mint and cinnamon from one script. Also move runic/ to just scripts/setupcp.
------------------------------------------------------------------------
r31013 | landonb | 2014-01-23 12:02:52 -0600 (Thu, 23 Jan 2014) | 1 line

Update to Linux Mint 16.
------------------------------------------------------------------------
r31001 | landonb | 2013-12-28 14:08:09 -0600 (Sat, 28 Dec 2013) | 1 line

Moving htdocs/exports and htdocs/reports to /ccp/var (Part 2)
------------------------------------------------------------------------
r31000 | landonb | 2013-12-28 14:07:06 -0600 (Sat, 28 Dec 2013) | 1 line

Moving htdocs/exports and htdocs/reports to /ccp/var
------------------------------------------------------------------------
r30997 | landonb | 2013-12-28 13:53:44 -0600 (Sat, 28 Dec 2013) | 1 line

Remove incorrect sql assumption.
------------------------------------------------------------------------
r30994 | landonb | 2013-12-28 13:40:18 -0600 (Sat, 28 Dec 2013) | 11 lines

Flashclient: Convert Makefile and fcsh-wrap to symlinks.
  - The flashclient `make` now defaults to the new versions
    of the files, rather than the old.
    - The big different is how fcsh is backgrounded and how
      Makefile now retries the build until it succeeds.
      - The problem is probably that we're building on new
        versions of Linux using a really old, discontinued
        SDK.
    - You'll typically run: make clean ; killfc ; remake
    - You can also run: make clean ; killfc ; make one ; make ; make ; ...

------------------------------------------------------------------------
r30991 | landonb | 2013-12-28 13:19:09 -0600 (Sat, 28 Dec 2013) | 3 lines

Flashclient routes list paginator regression: was showing
  total record count as page count, not total record count.

------------------------------------------------------------------------
r30987 | landonb | 2013-12-27 21:37:25 -0600 (Fri, 27 Dec 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r30986 | landonb | 2013-12-27 21:29:52 -0600 (Fri, 27 Dec 2013) | 1 line

Update svn log copy.
------------------------------------------------------------------------
r30985 | landonb | 2013-12-27 21:29:20 -0600 (Fri, 27 Dec 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r30984 | landonb | 2013-12-27 21:08:55 -0600 (Fri, 27 Dec 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r30983 | landonb | 2013-12-27 21:01:23 -0600 (Fri, 27 Dec 2013) | 242 lines

DEVS: cd /ccp/dev/cp/scripts ; ./schema-upgrade.py
==================================================
Flashclient Route viewing and editing fixes:
- What was implemented was confusing, nonintuitive,
  and tedious:
  1. Editing a route caused map editing to start, and
     then the user had to use the map save button (on
     the floating tool palette) to save changes to the
     route.
     - It's confusing to the user, maybe, that the
       floating tool palette suddenly appears.
     - That map editing and route editing are committed
       together feels wrong. The map is the geowiki;
       routes are something else, and pinned to a
       specific revision (until re-computed), and don't
       require a changenote. So saving map edits and
       saving route edits should not be triggered by
       the same user action.
  2. The button to indicate that routes are clickable
     is buried on the options page, and it defaults to
     false. But route stops were still hot:
     - When you clicked on the route, no matter what,
       you'd create a new route stop.
     - This would cause a delay in the client.
     - Pyserver would compute two new route segments and
       would burn a new revision.
       - Routes are now revisionless, so you can save a
         new version of a route without burning a map
         revision.
         - In CcpV1, the recent changes list is mostly
           just "auto-computed route segment" revisions,
           which have nothing to do with editing the map.
         - For route history, rather than intertwine with
           the recent map changes list, each route panel
           should just have a list of its changes.
           - (In general, any item panel should list that
              item's edit history.)
- I unwired route editing from the floating tool palette.
  Each route panel now has its own reset/undo/redo/save
  buttons.
  - Among the changes necessary to make this work, I added
    dirty_reason and cmd_mgr_fcn to Text_Field_Editable so
    it can call the correct Command_Manager (and not always
    just G.map.cm, but now it can call a route panel's cmd_mgr).
  - The route panel footer is changed as the user edits a route.
    E.g., for new routes, we suggest to anonymous users that they
    log on to save the route to their library, but if they instead
    edit the route, then the route reset/undo/redo/save buttons
    show up, and the user can edit the route and save it (and
    the user can use the web_link to find the route during a future
    session). We also use nice visual transitions, so the footer
    doesn't just appear in a flash or go away in a jiffy, but it'll
    nicely slide and dissolve into view.
- I moved the routes-clickable option to the bottom of the route
  panel, on the footer (so it's always visible). In CcpV1, it's
  buried on the map display options panel (so most users don't know
  about it, and for those that do, they have to change panels to
  enable or disable the option).
  - I also added a button to indicate if clicking a
    route adds a route stop or just selects the route.
    - In CcpV1, it's annoying because whenever you click the route,
      by default a new route stop is created and two new route
      segments are computed.
  - And now, you can long-press on a route (hold the mouse down
    for a half of a second) and you'll get a route stop and be
    able to drag the route.
  - When you click and drag a route, we no longer auto-
    checkout the new route segments if the user pauses
    long enough with the mouse down. It takes too long
    to get route segments, so the interaction is very
    disruptive (usually, the user has moved the mouse
    again, and then we recompute new-new route segments, and
    then the user experiences an unnecessary "Huh?!" moment).
  - Clicking a route stop did not start dragging it, even though
    we were changing the mouse cursor to the pointy finger hand.
  - After dragging and releasing the mouse, we were clearing
    the straight, dashed lines to the new destination, but
    we weren't clearing the arrows. Now, we leave both the
    dashed line and arrows until the new route segments are
    loaded, and then we clear both of them.
  - New routes by anonymous users were not editable. E.g., anon
    users could not drag their new routes around.
- Fixed route labels.
  - We were showing labels for routes in the route list that
    weren't on the map.
  - We were drawing the label without determining the label
    position so it went to the upper left of the map. Now we
    wait for the route to become hydrated so we can determine
    the label from the route geometry.
  - I moved the Byway label-maker fcn. to Geofeature so
    that Route can also use that fcn., which computes the
    label position in the middle of a line segment and
    determines a rotation for it (albeit the label
    doesn't follow the line geometry, unfortunately).
  - Route labels were not being displayed when they
    collided with byway labels, so I enhanced the
    collision detector to give preference to route labels.
    - Also, route labels now have a colorful background to
      distinguish them from byway labels.
    - Also, now we have to relabel the map whenever a
      route is selected or deselected. The downside is
      there's a little flicker, but more importantly,
      it takes a second to relabel the map (the collision
      detector is O(n^2), I think).
  - The A, B, C, etc. route stop labels were not being drawn,
    or they were being hidden inadvertently.
    - I added a new map canvas layer so that route stop labels
      live on top of other labels, and atop route stops and routes.
  - On get-route failure, or if the user cancels the request, we
    remove the beg_addr and fin_addr (geocoded address) labels from
    the map, rather than leaving them there.
  - The route labels were not being updated after dragging a route.
- Fix double-click on route not to do three things: 1. select
  route, 2. recenter, and 3. zoom in, but just to select the route
  and recenter (zooming in takes a while and is very annoying;
  so now the user is required to be deliberate about zooming the map
  when it appears they're just interacting with a route).
- Fix the route "filter" checkbox in the Route_List_Entry: since
  a route can be in more than one Route_List, when the user unchecks
  the route in one of the lists, we need to uncheck it in the other
  lists, and then we maybe remove the route from the map, so long as
  it's not attached to an active panel, like its route panel, or to
  a discussion panel or a reaction panel. Until now, routes would
  remain on the map even after you closed their panel and unchecked
  their Route_List_Entry checkboxes.
- Fix issues with route Web links (deep links).
  - Permissions were not being calculated correctly in the client,
    so user could not edit the route after getting a Web link.
  - The server nows sends the Session ID group stack ID to the
    client, so that flashclient can accurately update
    access_infer_id based on the group_item_access records.
  - After committing or making a web_link, the server sends back
    each item's group_access records, access_infer_id, and new
    version, so that flashclient can check its math against the
    server's (and ultimately use what the server says, but this
    behavior is beneficial, because it tests the client's access
    control functions).
  - Pyserver was trying to UPDATE a nonexistent group_item_access
    record instead of INSERTing a new one.
  - Flashclient was not telling Pyserver to use the session_id
    when committing changes to an anonymous user's route that
    wasn't fetched with a Web link.
  - Flashclient was incorrectly using http://blah.com/private?
    for anonymous routes, rather than http://blah.com/get?,
    for the Web link URL. (The private? URL causes flashclient
    to require you to log on to load the Web link, which doesn't
    make sense for anonymous routes).
- Fix problem not computing and sending route length to client
  (the client could just as well add up all the route step lengths,
  but pyserver needs to store the value in the database, so doing
  it there).
- Fix Routes Looked At problems.
  - It was showing the library list for anonymous users on boot,
    rather than showing an empty list.
  - For anonymous users, flashclient handles the looked at list,
    rather than trying to checkout a page of a user's viewing
    history from the server.
  - For logged in users, flashclient updates the looked at list
    if the user is on the first page of history results, otherwise
    it doesn't have to do anything (but when the user returns to the
    first page of results, flashclient will ask pyserver for it,
    so the looked at list will be current).
  - Flashclient was wrongly trying to set an item_findability
    view record for anonymous users (pyserver disallows this so
    it would just return an error, but then the alert dialog
    confuses/aggravates the user).
  - I fixed the "Clear All" and "Select All" buttons.
    - Select All is not a good feature. It already takes a number
      of seconds to check out a route, so a button that checks out
      _twenty_ routes at once is ridiculous (the user would wait
      minutes for them to load). So I removed the Select All button.
    - For "Clear All", I changed it into three buttons,
       "Uncheck All" on the left,
      and then one or two of three buttons on the right,
       depending on what routes are selected in the route list:
       "Remove Checked" and "Removed Unchecked", or "Remove All".
      So now the buttons are:
        Uncheck all routes in the list;
        Remove all routes in the list and all user's history (all pages);
        Remove routes that are checked in the list (max. one page); and
        Removed routes that are not checked in the list (max. one page).
      - Remove All applies to all routes in the history, and
        not just to the page of results the user is viewing.
        The Remove All button is only visible when nothing is
        checked in the list.
- Fix problem when closing an active route panel and being returned
  to the second routes tab, the Explore Routes tab, rather than to
  the last panel viewed or to the Get Directions routes tab.
- Fix display flicker in route reaction: before changing
  to the 'input' or 'thank' state, make sure the two
  containers are created and visible and includeInLayout
  (otherwise you'll see them for a split second and then
  they'll disappear).
- Reworded some of the text on the routes panels and fixed the
  "It's lonely in here" label that has the "Get Directions"
  button, used when the routes viewed list is empty. So we hide
  the Route_List and the Uncheck All and Remove * buttons when
  nothing is in the list, and we show the silly message instead.
- Fix the Route Description widget (it's not visible in CcpV1,
  but you can set the value from mobile... so now it's visible
  in flashclient, always).
- Add checkbox for route cue sheet to show/hide landmarks text.
  - Thanks, Fernando!
Other, non-Route related Flashclient changes:
  - Changed single 'Viewing'-'Editing' toggle button to two buttons,
    'View' and 'Edit'. A power user mentioned having trouble
    re-discovering how to edit (spending minutes looking for the
    button). So make it obvious! =)
  - Also fixed the widths of the tab bar buttons to be the same
    width for each two pairs of buttons, 'Road' and 'Aerial', and
    'View' and 'Edit'. This looks more natural.
  - Fixed a problem with toolTips showing on the button bars,
    which is annoying because the toolTip that's displayed is
    just the name of the hidden button. Smells like a Flex anomaly.
- There was a problem creating a new Waypoint -- you'd just see
  the vertex square on the map, but not the waypoint circle.
  - This may have been a regression just in my working code,
    because after seeing the problem, I was later unable to
    reproduce it.
Pyserver:
- Bug in route_step: we need to specify the branch_id when fetching
  byway steps, otherwise you might get rows for more than one branch.
- Bug when fetching GIA records: use distinct on and order by version
  and acl_grouping to get the latest record for the desired revision
  (otherwise, multiple records might be fetched for the same item stack ID).
- Stealth Secret:
   - New items' new group_item_access records were not being created
     (the code was UPDATEing version+1 of the item... which is a no-op,
     since adding the stealth secret doesn't create a new item version).
   - Also fixed save() flow with new dirty reasons to distinguish
     between item changes and grac changes, so we don't bump the
     item version (and write new item records) when we're just
     adding or changing group_item_access records.
- Cleanup of abnormal "import" convention that was applied in
  half the source files that included it, but not the other half:
  Instead of: import lxml.etree as et
         now: from lxml import etree
  - I got tired of typos because half the files used one format,
    and the other half the other. Just use the Python standard.
Skins:
- Fix zoom level label sizes (needs to be at least 9 pixels).

------------------------------------------------------------------------
r30982 | landonb | 2013-12-19 14:14:08 -0600 (Thu, 19 Dec 2013) | 1 line

Scripts: Update old refs to GDAL-1.9.0 to GDAL-1.10.1.
------------------------------------------------------------------------
r30981 | landonb | 2013-12-19 14:13:43 -0600 (Thu, 19 Dec 2013) | 1 line

Add views for item_versioned and route.
------------------------------------------------------------------------
r30980 | landonb | 2013-12-19 14:11:17 -0600 (Thu, 19 Dec 2013) | 1 line

Add item_revisionless dirty reason, for committing routes.
------------------------------------------------------------------------
r30978 | landonb | 2013-12-13 16:05:07 -0600 (Fri, 13 Dec 2013) | 1 line

Fix divide-by-zero fail in prog_logger's delta computation... when time.time() is the same... well, what'd you expect, computers are pretty fast nowadays.
------------------------------------------------------------------------
r30977 | landonb | 2013-12-13 16:02:38 -0600 (Fri, 13 Dec 2013) | 1 line

Fix labeling on routes... kind of, I fixed the skin but the routes in the route list are now labelling themselves, oy.
------------------------------------------------------------------------
r30976 | landonb | 2013-12-13 16:00:43 -0600 (Fri, 13 Dec 2013) | 1 line

Installing proj4 on ika required a hack...
------------------------------------------------------------------------
r30975 | landonb | 2013-12-13 15:59:51 -0600 (Fri, 13 Dec 2013) | 1 line

Update log_jammin from cloc 1.55 to cloc 1.60 (python 2.7 complained)
------------------------------------------------------------------------
r30974 | landonb | 2013-12-13 15:56:06 -0600 (Fri, 13 Dec 2013) | 1 line

Add route_stop convenience view
------------------------------------------------------------------------
r30965 | landonb | 2013-12-08 01:05:33 -0600 (Sun, 08 Dec 2013) | 1 line

Fixes and tweaks to byway rating calulations.
------------------------------------------------------------------------
r30964 | landonb | 2013-12-07 23:41:37 -0600 (Sat, 07 Dec 2013) | 1 line

Tweaks to bikeability rating calculation.
------------------------------------------------------------------------
r30963 | landonb | 2013-12-07 14:27:09 -0600 (Sat, 07 Dec 2013) | 1 line

A little debug help, please.
------------------------------------------------------------------------
r30962 | landonb | 2013-12-07 14:05:58 -0600 (Sat, 07 Dec 2013) | 4 lines

- Change 'Mpls-St. Paul' in map legend to 'Minnesota'.
- Change mediawiki from pointing to magic to cycloplan.
- Update Flashclient Skins.

------------------------------------------------------------------------
r30961 | landonb | 2013-12-07 14:00:35 -0600 (Sat, 07 Dec 2013) | 1 line

Set l_minfeaturesize on bike facils in skin file.
------------------------------------------------------------------------
r30960 | landonb | 2013-12-05 22:21:20 -0600 (Thu, 05 Dec 2013) | 1 line

More fixes to calculating winningest_bike_facility for tilecache cluster cache, and also a new debug switch for testing cluster cache building with specific byway names rather than running blindly for a day with our fingers crossed.
------------------------------------------------------------------------
r30959 | landonb | 2013-12-05 21:42:53 -0600 (Thu, 05 Dec 2013) | 1 line

Drop view _tclust before dropping cluster cache table.
------------------------------------------------------------------------
r30958 | landonb | 2013-12-05 21:32:50 -0600 (Thu, 05 Dec 2013) | 1 line

Update documentation on running tilecache_update on production server, and add option to skip dropping cache tables when just rebuilding one branch and not all branches.
------------------------------------------------------------------------
r30957 | landonb | 2013-12-05 20:16:57 -0600 (Thu, 05 Dec 2013) | 1 line

Fix to tile_cache script (removed unused cluster cache column).
------------------------------------------------------------------------
r30956 | landonb | 2013-12-05 19:49:32 -0600 (Thu, 05 Dec 2013) | 1 line

Run tilecache_seed in 1/3rd the time: group z_levels into just 3 groups, rather than having 9 layers for the 9 z_levels. This means some bridges won't draw perfect on tiles (the underpass and overpass will be drawn on the same layer), but it's better than waiting forever for tiles to be created. And there are very few bridge levels used other than the middle one, "134" (so bridge levels 130-133 get drawn on one layer, then level 134, and then levels 135-8).
------------------------------------------------------------------------
r30955 | landonb | 2013-12-05 19:22:21 -0600 (Thu, 05 Dec 2013) | 1 line

mapserver files missing from previous big checkin
------------------------------------------------------------------------
r30954 | landonb | 2013-12-05 19:21:22 -0600 (Thu, 05 Dec 2013) | 1 line

Update log file
------------------------------------------------------------------------
r30953 | landonb | 2013-12-05 19:16:53 -0600 (Thu, 05 Dec 2013) | 1 line

Add error tracing to routed_p2's tgraph: loading multimodal route finder is failing.
------------------------------------------------------------------------
r30952 | landonb | 2013-12-05 18:58:22 -0600 (Thu, 05 Dec 2013) | 1 line

Fix conflicting gfl_id in previous checkin
------------------------------------------------------------------------
r30951 | landonb | 2013-12-05 18:38:16 -0600 (Thu, 05 Dec 2013) | 24 lines

- Lots and lots of fixes to MapServer tile generation, especially the
  new zoom levels, 5 though 8, and getting them to look nice and show
  bike facilities and bike labels. ([lb] notes that MapServer is a bear
  to work with... it takes a long time to test changes, and it's hard
  to get it to do what you want/expect, and sometimes you must compromise.)
  - Also add lots more columns to tiles_mapserver_zoom to feed values to
    the MapServer config that cannot be set from the SQL checkout values...
    which basically begs the question, why are some MapServer config options
    settable via the SQL checkout but others can only be hardcoded? Because
    of the latter, we might as well just hardcode all the values for the
    thousands of LAYERs and CLASSes we define... what a pain! =)
- Add geofeature layer IDs for railroad and water flowlines... which we don't
  have time to implement this month, anyway, but the IDs are there, at least...
- Updates to byway rating script (which re-calculates generic ratings).
  - Add debug option to run on specific stack ID, to help debug.
  - Bugfix: Add newish BSIR and CBF7 rater usernames to SQL.
- Node cache maker script: add code to better estimate script runtime.
- Flashclient: Use alpha on bike facil icons when aerial enabled.
- Flashclient: Bugfix: Geofeature assert because Region not overriding
  label_parms_compute.
- Fix problem determining winningest_bike_facil for cluster cache (was
  not being set for clusters that actually do have bike_facility set).
- Fix byway rating to return 0 when 'prohibited' or 'closed' tag applied.

------------------------------------------------------------------------
r30932 | landonb | 2013-11-27 18:45:23 -0600 (Wed, 27 Nov 2013) | 1 line

More logging tweaks to MnDOT import.
------------------------------------------------------------------------
r30931 | landonb | 2013-11-27 18:33:32 -0600 (Wed, 27 Nov 2013) | 1 line

Modify logging in MnDOT import.
------------------------------------------------------------------------
r30930 | landonb | 2013-11-27 18:31:15 -0600 (Wed, 27 Nov 2013) | 1 line

Add download of USGS NHD metadata pdf to auto_install.
------------------------------------------------------------------------
r30929 | landonb | 2013-11-27 18:30:15 -0600 (Wed, 27 Nov 2013) | 1 line

Add gfl tables to convenience views script.
------------------------------------------------------------------------
r30928 | landonb | 2013-11-27 15:04:28 -0600 (Wed, 27 Nov 2013) | 1 line

Remove invalid assert from mndot import script
------------------------------------------------------------------------
r30925 | landonb | 2013-11-27 13:29:33 -0600 (Wed, 27 Nov 2013) | 1 line

Convert listen_ports input to int.
------------------------------------------------------------------------
r30924 | landonb | 2013-11-27 13:27:21 -0600 (Wed, 27 Nov 2013) | 1 line

Fix mr_doctl to accept --listen_port arg.
------------------------------------------------------------------------
r30923 | landonb | 2013-11-27 12:55:40 -0600 (Wed, 27 Nov 2013) | 1 line

Add exporting Shapefiles for each county for each branch.
------------------------------------------------------------------------
r30922 | landonb | 2013-11-27 12:13:42 -0600 (Wed, 27 Nov 2013) | 1 line

Fix regex expr. (need more escapes)
------------------------------------------------------------------------
r30921 | landonb | 2013-11-27 11:55:07 -0600 (Wed, 27 Nov 2013) | 31 lines

- MnDOT import: make link_value update an option
  you have to specify.
  - We shouldn't update existing link_values, since I'm not
    very confident the data is accurate.
  - Which is to say, the MnDOT data is accurate: it's from this
    year, and the Cyclopath data (like number of lanes) is from
    2007, unless users have kept it current.
  - But using Hausdorff isn't perfect. For example, consider
    six parallelish roads: two couplets of a freeway, two
    entrance ramps, and two frontage roads on either side.
    Because of where existing Cyclopath lines fall, and
    because there are many parallel roads, and because
    our code doesn't compare geofeature_layer_id to MnDOT's
    route system ID, we'll probably not do a good job matching
    line segments and would probably hose our existing data
    (e.g., write the freeway's number of lanes to the frontage
    road).
- Misc. bug fixes to MnDOT import (I tested updating geom. and
  lvals. in the same run and found a few issues).
  - Missing interpolator in string statement.
  - Was changing valid_until_rid of old lvals but not adding
    the new link_value (for-loop was wrongly <continue>ing).
- Pyserver: Commit and import call staticmethod to hup routed
  and Mr. Do!, and now that Mr. Do! stores its port number in
  key_value_pair, callers have to pass a db now so the port can
  be looked up (I cxpx'd code and left self.qb.db by accident,
  but at least the MetC import committed before the NameError
  happened, ha!).
- Fix problem calling ccp_bash if you previosly `set -e` since
  `readlink` bails (asserts last error, or $?) on non-symlinks.

------------------------------------------------------------------------
r30918 | landonb | 2013-11-26 15:29:32 -0600 (Tue, 26 Nov 2013) | 1 line

Oops, need to cd first so pwd -P works in Ubuntu...
------------------------------------------------------------------------
r30915 | landonb | 2013-11-26 15:22:30 -0600 (Tue, 26 Nov 2013) | 1 line

Oops, use == not eq in [[]] in bash.
------------------------------------------------------------------------
r30912 | landonb | 2013-11-26 15:16:47 -0600 (Tue, 26 Nov 2013) | 1 line

Bad 'comment' in CONFIG confuses parser.
------------------------------------------------------------------------
r30909 | landonb | 2013-11-26 15:10:38 -0600 (Tue, 26 Nov 2013) | 1 line

Fix recent edit to maint.sh
------------------------------------------------------------------------
r30906 | landonb | 2013-11-26 14:54:11 -0600 (Tue, 26 Nov 2013) | 6 lines

- For new deployment method, Mr. Do! init.d scripts
  not specify port number to use.
  - The port number is stored in and retrieved from
    the key_value_pair table.
- Update CONFIG.template and Conf_Instance.as.template.

------------------------------------------------------------------------
r30903 | landonb | 2013-11-26 12:20:04 -0600 (Tue, 26 Nov 2013) | 27 lines

Pyserver:
- Add option to not peek at sequence values, so that
  some operations can run in parallel without each
  needing to lock the 'revision' table.
- Change 'slow fcn.' warnings in item_mgr to only
  print once per script, otherwise you'll get a ton
  of redundant warnings...
- Wrap the caller's callback in item_mgr's bulk-load fcn,
  so if the callback fails, we can print the caller's
  error and a description of the geofeature being
  processed (like, its name and stack ID),
  otherwise the upstream error handler
  just reports the error in item_mgr
  (that the callback failed) which
  is none help at all.
- Remember CBF7 and BSIR ratings in byway_rating.
- Fix some errors in recently changed rating code.
- Fix inaccurate complaints from node_byway about
  intersections' byway counts.
- When finding a node endpoint, instead of getting
  just one random match at an x,y coordinate, we need
  to get all matches and compare against what the caller
  might be expecting: we don't trust the user to specify
  node endpoint IDs via GWIS, but we can at least use what
  they say it is to make an intelligent decision when an
  endpoint is part of two or more intersections.

------------------------------------------------------------------------
r30902 | landonb | 2013-11-26 11:47:06 -0600 (Tue, 26 Nov 2013) | 1 line

Make error message more meaningful.
------------------------------------------------------------------------
r30901 | landonb | 2013-11-26 11:39:50 -0600 (Tue, 26 Nov 2013) | 8 lines

Flashclient regression: New attr_value_get fcn. called via
  Item_Revisioned.consensus returning undefined because fcn.
  missing return (code added earlier this month but not tested
  because MetC branch wasn't tested until now).
Flashclient regression: MetC bike_facil special attr. not
  working because Byway was not resetting the attr pointer
  on branch change.

------------------------------------------------------------------------
r30900 | landonb | 2013-11-26 11:33:09 -0600 (Tue, 26 Nov 2013) | 11 lines

Zero Downtime Cyclopath Upgrades:
  - Update maint.sh to match changes to the deployment process,
    documented (internally) at
      http://wiki.grouplens.org/index.php/Cyclopath/Production_and_Deployment
    - To our community developers (who cannot access the Grouplens wiki):
      I updated the Cyclopath deployment process so we don't have to take
      the site offline during the upgrade. The maint.sh script manages the
      /etc/apache2/sites-available directory and enables/disables Web sites
      automatically for us, and changes some symbolic links we have on the
      server.

------------------------------------------------------------------------
r30899 | landonb | 2013-11-26 11:27:53 -0600 (Tue, 26 Nov 2013) | 7 lines

Node cache maker script (and all scripts) should
  not peek at sequence values any more, so that
  we don't need to lock the 'revision' table
  when doing long tasks that can and should be
  able to run in parallel with our users also
  committing map changes to the database.

------------------------------------------------------------------------
r30898 | landonb | 2013-11-26 11:26:02 -0600 (Tue, 26 Nov 2013) | 1 line

Remove useless byway_mndot table.
------------------------------------------------------------------------
r30897 | landonb | 2013-11-26 11:25:33 -0600 (Tue, 26 Nov 2013) | 1 line

Fixes to byway rating script.
------------------------------------------------------------------------
r30896 | landonb | 2013-11-26 11:25:11 -0600 (Tue, 26 Nov 2013) | 1 line

Numerous fixes to MnDOT/Statewide import script.
------------------------------------------------------------------------
r30895 | landonb | 2013-11-26 11:24:17 -0600 (Tue, 26 Nov 2013) | 3 lines

Add two fake, system users for two additional byway raters:
 one for CBF7 and one for BSIR.

------------------------------------------------------------------------
r30894 | landonb | 2013-11-26 11:22:42 -0600 (Tue, 26 Nov 2013) | 13 lines

Bugfixes to work item: import (which hasn't been tested in a while,
  and there have been many changes to pyserver since last tested):
  - Typos in new code that hups routed.
  - The code that accommodates truncated names (e.g., MetC Shapefile
    has a 44-char name field, so some Cyclopath names got blasted)
    is now fixed and applies just to MetC shp specifically (though
    we should probably add code to detect name field length for any
    Shapefile and always check for truncated names, since this problem
    probably isn't MetC-specific).
  - Coalesce some immediate warnings into stats that'll be printed at
    end of import, so it's easier to process all of the warnings (since
    they're grouped by type, and not just interleaved with one another).

------------------------------------------------------------------------
r30893 | landonb | 2013-11-26 11:20:25 -0600 (Tue, 26 Nov 2013) | 1 line

Update link_value convenience views.
------------------------------------------------------------------------
r30892 | landonb | 2013-11-26 11:13:17 -0600 (Tue, 26 Nov 2013) | 1 line

Update cut-n-paste commands and add execution times for Statewide dataset.
------------------------------------------------------------------------
r30891 | landonb | 2013-11-26 11:12:30 -0600 (Tue, 26 Nov 2013) | 1 line

Add comments re: fixes to MetC import related to specific stack IDs.
------------------------------------------------------------------------
r30890 | landonb | 2013-11-26 11:11:43 -0600 (Tue, 26 Nov 2013) | 1 line

Bikeways skinfile: Hide some features at new Statewide zoom levels.
------------------------------------------------------------------------
r30889 | landonb | 2013-11-26 11:10:57 -0600 (Tue, 26 Nov 2013) | 1 line

Cleanup comments.
------------------------------------------------------------------------
r30888 | landonb | 2013-11-26 11:10:40 -0600 (Tue, 26 Nov 2013) | 1 line

Commands to run on production server for next release.
------------------------------------------------------------------------
r30887 | landonb | 2013-11-26 10:49:27 -0600 (Tue, 26 Nov 2013) | 1 line

Add doc: Bicycle safety index rating
------------------------------------------------------------------------
r30885 | landonb | 2013-11-21 10:04:12 -0600 (Thu, 21 Nov 2013) | 1 line

Tweaks to MnDOT import.
------------------------------------------------------------------------
r30884 | landonb | 2013-11-21 09:41:18 -0600 (Thu, 21 Nov 2013) | 18 lines

- Pyserver: Add Bicycle Safety Rating calculation to
  generic rating calculator, and guess speed limit
  for existing Chicago Bike Federation Algorithm No. 9,
  since for Statewide we don't have speed limit data
  and the naive heuristic is pretty pathetic.
- Reduce zoom even further, now 5 to 19 (was 9 to 19,
  then 6 to 19, but need 5 to fit whole State in my
  laptop viewport).
- In Flashclient, use separate and longer GWIS timeout
  for route requests: GWIS timeout was 90 seconds, but
  requesting a route across the State, e.g., from
  Saint Vincent to Brownsville, takes a few minutes.
- MnDOT import script now imports attributes (and makes
  tag- and attribute-link_values).
- Some other fixes to the MnDOT import script, and more
  checks against data to issue complaints about suspect
  calculated values.

------------------------------------------------------------------------
r30883 | landonb | 2013-11-19 13:49:39 -0600 (Tue, 19 Nov 2013) | 76 lines

DEVS: Run this. (You can also find these cmd snippets
                 at the top of the scripts themselves.)

# Re-create skins.
cd /ccp/dev/cp/mapserver
./flashclient_classes.py

# Update mapserver_zoom tables: add zooms 6, 7, and 8.
cd /ccp/dev/cp/mapserver
./tilecache_update.py --database {ccpdb} --db-create-public-zooms

# Remake the Really Big /ccp/var/tilecache-cache/cp/wms_instance.map.
cd $cp/mapserver
./make_mapfile.py

m4 wms-minnesota.m4 > wms_instance.map
/bin/mv -f wms_instance.map /ccp/var/tilecache-cache/cp/
/bin/rm -f byways_and_labels.map
#
/bin/rm -rf /ccp/var/tilecache-cache/cp/fonts
/bin/cp -rf fonts/ /ccp/var/tilecache-cache/cp
/bin/cp -f fonts.list /ccp/var/tilecache-cache/cp
#
sudo chown -R $httpd_user /ccp/var/tilecache-cache/cp/
sudo chgrp -R $httpd_user /ccp/var/tilecache-cache/cp/
sudo chmod 2775 /ccp/var/tilecache-cache/cp/
sudo chmod 2775 /ccp/var/tilecache-cache/cp/fonts/
sudo chmod 664 /ccp/var/tilecache-cache/cp/fonts.list
sudo chmod 664 /ccp/var/tilecache-cache/cp/wms_instance.map
sudo chmod 664 /ccp/var/tilecache-cache/cp/fonts/*

# Remake the More Manageable /ccp/var/tilecache-cache/cp/tilecache.cfg.
cd $cp/mapserver
./gen_tilecache_cfg.py
#
/bin/mv -f tilecache.cfg /ccp/var/tilecache-cache/cp/
sudo chown -R $httpd_user /ccp/var/tilecache-cache/cp/
sudo chgrp -R $httpd_user /ccp/var/tilecache-cache/cp/
sudo chmod 664 /ccp/var/tilecache-cache/cp/tilecache.cfg

==========

Flashclient: Fix problem using remote Cyclopath tiles, i.e.,
when debugging on a dev machine but using tiles from a remote
server. The problem was that the remote URL was being prefixed
to the aerial URL, so aerial tiles weren't loading.

Change lowest Ccp zoom from 9 to 6: Greater MN, holmeses!
- Changed Conf.as, conf.py, and resolutions= in tilecache.cfg.

In tilecache.cfg, increase bbox= to match meta tile size,
otherwise new zoom level 7 won't render.

Fix problem in wms_instance.map: its MINSCALEDENOM and
MAXSCALEDENOM need to be looser to accommodate errors
in calculating the value (zoom 7 wouldn't render with
the old calculation; now we +/- 25% the calculated
scale denominator value to the min and max).

tilecache_update should check tile_x/ymin/max is not None,
rather than not True/False, otherwise tiles that start at
0,0 will not be rendered.

MnDOT import script adds county names to revision changenote.

Big change to pyserver: Rather than locking tables using
'EXCLUSIVE' mode, use 'SHARE ROW EXCLUSIVE' mode. This is
almost just as strict, but INSERTs with FOREIGN KEY
references won't be blocked, and since this is a Wiki, we
never DELETE rows, so we should never need to be 'EXCLUSIVE'.

Squelch a bevy of verbosey pyserver trace statements.

Add missing RESET STATEMENT_TIMEOUT/SET STATEMENT_TIMEOUT TO 0
to db_glue after row lock failure on nonexistant row.

------------------------------------------------------------------------
r30882 | landonb | 2013-11-19 13:15:41 -0600 (Tue, 19 Nov 2013) | 1 line

Add Zooms 6, 7, 8 to skins.
------------------------------------------------------------------------
r30881 | landonb | 2013-11-18 17:08:24 -0600 (Mon, 18 Nov 2013) | 16 lines

- Add --county option to tilecache_update to offer another
  way to restrict updating Cyclopath cache or tiles by bbox.
- Update tilecache_update from PostGIS 1.x to 2.x (GIST
  index no longer uses GIST_GEOMETRY_OPS).
- Apply bbox retriction in tilecache_update to Cyclopath
  cache update (until now, it only applied when making tiles).
- Consolidate debug fcns. that print elapsed time:
  new utility fcn. pretty-prints as secs., mins.,
  hours, day, months, or years, depending on magnitude.
- Fix filtering by bbox when looking for cycle_route attrs.
  (for tilecache_update).
- New mndot_helper.py to interface with new (temp?) mndot tables.
- Update progress logger to estimate script run times and print
  percentage complete and remaining time.
- Whitespace cleanup (trailing spaces)...

------------------------------------------------------------------------
r30880 | landonb | 2013-11-17 12:54:17 -0600 (Sun, 17 Nov 2013) | 13 lines

Lots more MnDOT Shapefile import fixes and implementation.
- Have successfully imported 'Lake' county.
- Still need script to convert mndot_* table attributes
  into byway link_values... so far we're just creating
  new byways and node endpoints, which is pretty cool,
  but we'll need to create new link_values next (which
  can be another script; this MnDOT byway import script
  processes two line segments per second, and with almost
  a half million line segments, it'll take almost three
  days to run... unless we can multi-thread the process
  by running the script in 87 different terminal windows
  simultaneously (once for each county in MN)...).

------------------------------------------------------------------------
r30879 | landonb | 2013-11-16 23:27:16 -0600 (Sat, 16 Nov 2013) | 19 lines

DEVS: Rerun city script, which now imports geometry and also county data,
      and schema-upgrade and constraints... or just get a fresh server db.

   cd $cp/scripts/setupcp/runic/greatermn
   ./statewide_munis_lookup.py

   cd $cp/scripts
   ./schema-upgrade.py

   cd $cp/scripts/setupcp/runic
   ./ccpv2-add_constraints.sql

   psql -U cycling {ccpdb} < /ccp/dev/cp/scripts/dev/convenience_views.sql
==========
- Add average ops per sec to log progger.
- Add counties, and city and county geoms, to municpal import script.
- Lot more implementation to MnDOT import: byways and nodes seem bueno,
  but still need to deal with attrs...

------------------------------------------------------------------------
r30878 | landonb | 2013-11-15 14:33:21 -0600 (Fri, 15 Nov 2013) | 1 line

Fixes to mndot import script.
------------------------------------------------------------------------
r30877 | landonb | 2013-11-15 14:19:28 -0600 (Fri, 15 Nov 2013) | 19 lines

DEVS:
 psql -U cycling ccpv3_demo < /ccp/dev/cp/scripts/dev/convenience_views.sql
==========
- Problem in db_glue when closing curs multiple times
  (the code 'del's the attr, so use try/except AttributeError).
- In Diff mode, the TabButtonBar width was being assigned a
  width of 0 sometimes, which caused the button names (which
  are just revision numbers) to be truncated, e.g., "12345"
  became "12...".
- Implement Diff mode for bike facility widget: show and paint
  a second bike facility canvas.
- New Shapefile_Wrapper class contains common Shapefile routines.
- Fix to Item_Revisioned.consensus.
- Don't show Editing tooltip in Diff or Historic mode.
- Add byway_mndot table for mndot import... so that it's quicker
  and we can worry about link_values later.
- Start of the MnDOT import script: load Shapefiles into temp
  tables and start parsing data... more to come...

------------------------------------------------------------------------
r30874 | landonb | 2013-11-12 19:49:52 -0600 (Tue, 12 Nov 2013) | 96 lines

Merge Bug 2788 branch from Mikhil:
- On commit, if just adding a new link_value, need to
  load item_mgr's attc cache (otherwise the link's lhs,
  or attr, is not found).
- Pyserver bugfix: self.revision, not self.rev.
- Fix revision.Diff (hooray!).
- Lots and lots of little fixes to Diff Mode.
Some more changes by Landon:
- Rather than converting query_filter stack ID lookup stack IDs
  to and from the hack ID when using the lookup, override the
  Array class with a new array type, Stack_Id_Array, that unhacks
  the ID before storing it in the array.
- Reimplemented the new Item_Revisioned.consensus fcn: when in
  diff mode, you can only select one item at a time in flashclient,
  so there's no need to iterate through items_selected and act like
  we don't know what's in it. If we're in diff mode, there are just
  the two counterpart items.
  - I also changed a bunch of other Objutil.consensus calls
    Item_Revisioned.consensus calls, for places where the diff
    text was not being computed.
- Add on_empty param to Objutil.consensus.
- Fix problem displaying two or more stack IDs in details panel and
  panel becoming too wide (use ellipses for second+ items).

MERGE from Mikhil: Diff Mode
------------------------------------------------------------------------
r30295 | masli | 2013-05-29 18:19:47 -0500 (Wed, 29 May 2013) | 1 line

Fixed diffing colours in the tagging widget.
------------------------------------------------------------------------
r30292 | masli | 2013-05-29 16:49:47 -0500 (Wed, 29 May 2013) | 1 line

Diff colouring in the place widget
------------------------------------------------------------------------
r30290 | masli | 2013-05-29 16:14:40 -0500 (Wed, 29 May 2013) | 1 line

Fixed an issue with colouring of diffing annotations.
------------------------------------------------------------------------
r30289 | masli | 2013-05-29 14:01:59 -0500 (Wed, 29 May 2013) | 1 line

Fixed a bug, now diffing link-values are displayed in the flashclient, albeit with wrong colours...
------------------------------------------------------------------------
r30287 | masli | 2013-05-28 19:37:38 -0500 (Tue, 28 May 2013) | 1 line

Possible fix for missing diff_group in link-values. Not fully tested because of weirdness with caching (I think...)
------------------------------------------------------------------------
r30273 | masli | 2013-05-23 19:24:06 -0500 (Thu, 23 May 2013) | 1 line

Re-writing Attribute.consensus to use Item_Revisioned.consensus and deal with diffing link_values appropriately.
------------------------------------------------------------------------
r30272 | masli | 2013-05-23 17:22:35 -0500 (Thu, 23 May 2013) | 1 line

Wrote a wrapper for Objutil.consensus called Item_Revisioned.consensus that respects diffing objects and does the consensus operation on their fields accordingly, returns old -> new for diffing objects.
------------------------------------------------------------------------
r30271 | masli | 2013-05-23 14:59:48 -0500 (Thu, 23 May 2013) | 1 line

Merge from trunk
------------------------------------------------------------------------
r30250 | masli | 2013-05-16 18:24:23 -0500 (Thu, 16 May 2013) | 1 line

Fixed an issue where current revision's geosummary wasn't being persisted while viewing historic or diff revision.
------------------------------------------------------------------------
r30247 | masli | 2013-05-16 17:40:30 -0500 (Thu, 16 May 2013) | 1 line

Fixed item selection issues with old/new versions in diff mode.
------------------------------------------------------------------------
r30246 | masli | 2013-05-16 17:09:06 -0500 (Thu, 16 May 2013) | 1 line

Fixed link_value fetching w.r.t. diffed items, base_ids and hacked stack_ids.
------------------------------------------------------------------------
r30244 | masli | 2013-05-16 15:28:13 -0500 (Thu, 16 May 2013) | 1 line

Fixed a bug with effectively_active_panel and selecting geofeatures with counterparts while viewing diff view.
------------------------------------------------------------------------
r30230 | masli | 2013-05-15 19:29:53 -0500 (Wed, 15 May 2013) | 1 line

Fixed several bugs with interpreting server-returned results and displaying diff-ed items on the map. Detail panel hasn't been touched yet.
------------------------------------------------------------------------
r30199 | masli | 2013-05-14 18:24:32 -0500 (Tue, 14 May 2013) | 1 line

Fixing server-side and client-side communication issues w.r.t. diff mode.
------------------------------------------------------------------------
r30193 | masli | 2013-05-13 19:34:03 -0500 (Mon, 13 May 2013) | 1 line

More fixes, not all tested.
------------------------------------------------------------------------
r30192 | masli | 2013-05-13 19:07:51 -0500 (Mon, 13 May 2013) | 1 line

Resolved some issues on the server side w.r.t. sending diff contents to the client.
------------------------------------------------------------------------
r30191 | masli | 2013-05-13 15:14:48 -0500 (Mon, 13 May 2013) | 1 line

Creating new branch to fix diff mode.

END: MERGE from Mikhil: Diff Mode

------------------------------------------------------------------------
r30872 | landonb | 2013-11-11 15:01:12 -0600 (Mon, 11 Nov 2013) | 1 line

Zero-downtime Cyclopath software upgrade support.
------------------------------------------------------------------------
r30870 | landonb | 2013-11-11 10:52:31 -0600 (Mon, 11 Nov 2013) | 1 line

Move CcpV1->V2 upgrade scripts to archival subdir.
------------------------------------------------------------------------
r30869 | landonb | 2013-11-11 00:52:49 -0600 (Mon, 11 Nov 2013) | 60 lines

Flashclient
- Three Big Ones:
  1. Selection Resolver fixed
  2. Find Route button now always visible
     (users no longer have to scroll to find it)
  3. Implemented persistable map settings
  - Fixed Selection Resolver: we were using G.map_canvas to
    find all items under the cursor, but it only returns one
    item; we have to query the stage instead.
    - Also fixed a bug from CcpV1, where selection resolver
      only orders by z_level, but within each z_level, it
      doesn't order by sprite order. So, if you clicked an
      intersection and the selection resolver automatically
      chose a byway, it wouldn't necessarily choose the byway
      whose sprite is on top.
    - Added new feature: historic behavior is not to use
      selection resolver ever if items are only byways, so,
      e.g., you can never select a byway from a bunch of
      overlapping byways, but flashclient just grabs one
      randomly from the top-most z_level (but not necessarily
      the top-most sprite).
      - I added a settings checkbox to say to always pop
        up the selection resolver whenever two or more items
        are under the mouse cursor.
      - I added a feature where you "long press", or hold
        down the mouse for about one second, on an intersection
        or overlapping items and we pop up the selection resolver.
        - (As an aside, I added a feature where long-pressing
           on "nothing" clears the active selection, to complement
           the existing clicking-on-nothing-clears-selection
           settings checkbox.)
  - Fixed "Find Route" button so it's never hidden, which forces
    user to scroll to find it. The problem is that new users won't
    equate the scroll bar with finding the button to find their route.
    It also looks sloppy -- this is a very important button!
    - The solution is another one of those tricky height-measuring
      dances, but I used a new trick: create the component with
      all scroll bars off, then measure the real height of the
      scroll target, and then set its scroll policy to 'auto'.
      This way, whenever the user resizes the window, you'll
      know the real height of the component, which you can compare
      against the actual height of the parent, and then you can choose
      if the find route button is inline, or if it's a sticky footer.
      If inline, the button is below all if the find route options,
      and it is guaranteed to be visible; if the button is a sticky
      footer, the find route options have a scroll bar, but
      the find route button is always visible on a footer at the
      bottom of the panel.
  - Change search results component that says "Results for blah blah"
    from Label to Text and switched to using htmlText so that the
    component wraps, rather than causing the side panel to put on
    horizontal gain (it grows wider and gets clipped by the right
    side of the side panel).
  - New class and fcns. to remember all of the options on the
    map settings panel (I'm surpirsed these haven't been persistable
    before). Users can also reset to default values.
Pyserver
- Geocoder: When doing a radius search for node_endpoint,
  don't go past 10K, otherwise query takes too long.

------------------------------------------------------------------------
r30867 | landonb | 2013-11-09 22:44:18 -0600 (Sat, 09 Nov 2013) | 1 line

Was using CCP_INSTANCE instead of INSTANCE\nwhen checking for flashclient errors in database.
------------------------------------------------------------------------
r30865 | landonb | 2013-11-09 22:34:56 -0600 (Sat, 09 Nov 2013) | 1 line

When calculating CCP_INSTANCE, resolve symlinks.
------------------------------------------------------------------------
r30863 | landonb | 2013-11-09 14:39:06 -0600 (Sat, 09 Nov 2013) | 1 line

Bad assert in geocode.
------------------------------------------------------------------------
r30862 | landonb | 2013-11-09 14:13:10 -0600 (Sat, 09 Nov 2013) | 4 lines

- Publish Shapefile script fixes:
  - Was not deleting old files from htdocs/reports/daily
  - Was not using correct path for quarterly export

------------------------------------------------------------------------
r30861 | landonb | 2013-11-09 13:46:26 -0600 (Sat, 09 Nov 2013) | 1 line

Add comments
------------------------------------------------------------------------
r30860 | landonb | 2013-11-09 13:45:49 -0600 (Sat, 09 Nov 2013) | 3 lines

- Remove cyclopath-feedback email from CONFIG template (obsolete addr)
- Clean up some comments in other files

------------------------------------------------------------------------
r30854 | landonb | 2013-11-08 20:46:45 -0600 (Fri, 08 Nov 2013) | 66 lines

DEVs: Earlier new item policy script instructions were wrong.
      Run these instead:

   ./new_item_policy_init.py \
     -U landonb --no-password \
     -b 0 \
     --profile='standard' \
     -m "Create new item policies for basemap."

  ./new_item_policy_init.py \
     -U landonb --no-password \
     -b "Metc Bikeways 2012" \
     --profile='standard' \
     -m "Create new item policies for branch."

Same with the constraints SQL command:

  cd /ccp/dev/cp/scripts/setupcp/runic
  psql -U cycling ccpv3_demo < ccpv2-add_constraints.sql

================================================================

- Lots of fixes to the events emailer.
  - Moved the email fcns. in misc.py to a new class, emailer.py.
  - Combined all the calls that make emails into a set of classes,
    item.util.watcher_*.py, to make it easy to manage all
    the different types of emails we send (currently: 6
    alert event types, and 1 spam script, makes 7 different
    types of callers that all gait through one final sendmail
    wrapper (and also an experiment script, for landmarks, makes 8)).
    - Reimplemented all of the CcpV1 email messages, which have been
      broken in CcpV2 for a long, long time...
  - See also the cron job which kicks off the event emailer:
    scripts/daily/watchers_emailer.py
    - The production server will call this every minute.
  - In CcpV1, not all sendmail calls cause pyserver to check
    CONFIG's mail_ok_addrs.
    - Developers might accidentally email real users.
    - The code now always checks the email exactly before sendmail.
    - I also changed the meaning of the 'mail_ok_addrs' value: if it
      is empty, it used to mean that all users are okay to email.
      - This seems dangerous: what if a DEV deletes it by accident,
        or what if a new DEV doesn't configure their new Cyclopath
        site correctly in the first place.
      - Now, "mail_ok_addrs: ALL_OKAY" is how you specify
        that all emails are okay to mail.
  - Fix emailer script: instead of UPDATEing key_value_pair,
    DELETE and INSERT.
- Fix db_load.sh to grant permissions on the new PostGIS 2.x topology
  schema and tables, otherwise some PostGIS calls used by pyserver fail.
- Remove newlines from a pyserver log statement -- it was causing logcheck
  to report on each line.
- Remove traces of /item/reminder_email attribute, which doesn't make
  sense to implement. Item reminders are a one-off, special type of
  alert, so they have a custom command. They still use the item_event_alert
  table, but there's no reason to gait them through commit.
  - See GWIS_Item_Reminder_Set.as and command_/item_reminder_set.py,
    which are updated versions of CcpV1's route reaction command.
- Fix to problem saving new link_value when not also saving a new revision:
  don't go the acl_grouping route if the item is new, otherwise
  group_item_access rows don't get written on save.
- Update db_glue to track open cursors, to make it easier to troubleshoot
  trying to commit when another cursor is still open.
  - Also fix a problem with close() not calling curs_close (it was calling
    curs.close).

------------------------------------------------------------------------
r30853 | landonb | 2013-11-04 14:58:04 -0600 (Mon, 04 Nov 2013) | 1 line

Fix for fix for search_center_sql.
------------------------------------------------------------------------
r30852 | landonb | 2013-11-04 14:52:50 -0600 (Mon, 04 Nov 2013) | 1 line

Wrong param names in search_center_sql calls.
------------------------------------------------------------------------
r30851 | landonb | 2013-11-04 14:27:29 -0600 (Mon, 04 Nov 2013) | 1 line

Fix vacuum script to use CONFIG's db name.
------------------------------------------------------------------------
r30850 | landonb | 2013-11-04 14:25:30 -0600 (Mon, 04 Nov 2013) | 1 line

Fix vacuum script to use CONFIG's db name.
------------------------------------------------------------------------
r30848 | landonb | 2013-11-04 13:48:24 -0600 (Mon, 04 Nov 2013) | 1 line

Convert tabs to spaces in third-party code just edited for Py2.6.
------------------------------------------------------------------------
r30847 | landonb | 2013-11-04 13:45:32 -0600 (Mon, 04 Nov 2013) | 9 lines

- DEVs: In an earlier changelog, I referenced the wrong script to run.
  - This is wrong: ./pyzipcode_setup.py (doesn't exist).
  - This is the correct script:
     ./pyzipcode-setup.sh

- Also, newish addressconf module should use Python 2.6-compatible
  inverse dictionary mapping, since this is Py2.7+ syntax:
    {v:k for k,v in some_list.iteritems()}

------------------------------------------------------------------------
r30846 | landonb | 2013-11-04 13:21:04 -0600 (Mon, 04 Nov 2013) | 3 lines

Pyserver: config parser getlist should return empty list when
 no values specified, rather than None

------------------------------------------------------------------------
r30845 | landonb | 2013-11-04 13:15:20 -0600 (Mon, 04 Nov 2013) | 3 lines

ccpv2-add_constraints.sql: GIST_GEOMETRY_OPS is not necessary
 in PostGIS 2.x.

------------------------------------------------------------------------
r30844 | landonb | 2013-11-04 12:19:25 -0600 (Mon, 04 Nov 2013) | 39 lines

DEVS: pyserver/CONFIG.template is updated, but you don't
      have to update it unless you want more search results
      (like those from neighboring states).

Flashclient:
- A GWIS_Commit was missing callback_payload.
- a debug trace fix: convert value to int() before .toString(16).
Scripts:
- auto_install: installing new libxml2 requires sudo? weird.
- schema-upgrade: Ignore new 'topology' schema that PostGIS 2.x adds.
Pyserver:
- commit.py: remove obsolete comments
- when geocoding route endpoints, also search region names
  - also update to new search module interface introduced in the
    last checkin (routed geocode was still using old interface).
- fix waypoint's search_center_sql, which was working when
  given a table name but not a geometry.
- add 'confidence' and 'match_code' values to the address
  object, since the external geocoder returns these, and
  it'll help us decide if a geocoded route endpoint is
  good enough that we don't have to search the internal
  Cyclopath database.
  - also grab the state value so we can show results in
    neighboring states (currently, we exclude whatever's
    outside the branch bbox, but we shouldn't act like
    we can't find anything in bordering states; we just
    need to tell the user when results are off the map).
  - also calculate center for external geocode results,
    so search can use it for ordering
    - specifically, an external geocode result is not
      always the first search result that flashclient
      displays. Rather, it's the first if we're confident
      about the result, otherwise it's placed somewhere
      else in the list of results, based on our confidence
      and its distance from the center).
  - fix problem trying to add node endpoints for waypoints
    (just catch AttributeError and do nothing).
- update config parser getlist to accept default value.

------------------------------------------------------------------------
r30832 | landonb | 2013-11-01 18:57:26 -0500 (Fri, 01 Nov 2013) | 354 lines

=============
PREFACE: [lb] apologizes for the massive checkin; if you've just
run `svn log [some_file]` (and not `svn log` on the whole project),
you might find this message and realize that tracing individual
file changes in CcpV2 is not going to be very fruitful. You're much
better off checking out different revisions and then diffing
those different files, rather than trying to find the answer
in this here very verbose changelog.

(Okay, maybe I don't apologize; sometimes madness means you do
seventy differntly things simultaneously until everything comes
together in one brilliant oneness).

=============
DEVS: Run these commands to upgrade your database (or skip this
      commands and just load a new production dump):

# Start with an alias to your working directory so you can copy
# and paste the following commands.

cp=/dev/ccp/cp

# Create a table of city, state, zipcodes, so users can, e.g., just
# search "55401" and we'll find the "minneapolis" region. The file
# that this script creates is needed by schema-upgrade.py.

cd $cp/scripts/dev
./pyzipcode_setup.py

# Run the new schema upgrade scripts, which add convenience views
# for all item tables, populate the new zipcodes table, and fix
# some problems with the item_event_alert table.

cd $cp/scripts
./schema-upgrade.py

# Add lists of city names, state names, and associated abbreviations
# (like "mpls" for "minneapolis", and "stp" for "saint paul"), and
# print out statistics of commonly-used words that are used as stop
# words by the new CcpV2 search feat.

cd $cp/scripts/setupcp/runic/greatermn
./statewide_munis_lookup.py

# Repopulate the policy table, to add the new link-post-revision policy.

cd $cp/scripts/setupcp/runic
./new_item_policy_init.py

# Build a lookup of city names.

$cp/scripts/setupcp/runic/greatermn/statewide_munis_lookup.py

# Remake all database indices, including some new ones for item alerts.

cd $cp/scripts/setupcp/runic
./ccpv2-add_constraints.sql

# OR: In lieu of all of the above commands, wait a few days until
#     the production server is updated and then you can just db_load
#     a new dump.

=============
DEVS: Upgrade to PostGIS 2.0... with caveats.

You shouldn't need to upgrade PostGIS, but you can, if you want...

You can install most of the software yourself. Copy and paste
commands from the updated gis_compile script, starting with GEOS
and finishing with the make of PostGIS.

 scripts/setup/runic/auto_install/gis_compile.sh

but after making PostGIS, someone with sudo will have to
update /etc/ld.so.conf, install PostGIS, and remake MapServer.

And then you'll have to pg_dump and db_load your database using
a new pg_dump format and using the updated db_load script.

  # PostGIS 2.0 doesn't use -E UTF8 but uses a custom dump
  # format, so this pg_dump command may be different from
  # what is familiar to you.

  pg_dump -U cycling \
     -Fc -b -v -f "/ccp/var/dbdumps/ccpv3_demo.pgis20" \
     ccpv3_demo

  # Just in case we screw something up... backup.

  psql -U postgres -d postgres \
    -c "ALTER DATABASE ccpv3_demo RENAME TO ccpv3_demo_pgis15"

  # The updated db_load script does something new for PostGIS 2.x:
  # it creates a new database first, runs a bunch of postgis
  # sql scripts, and then it imports the dump file. In PostGIS
  # 1.x, we only had to call one postgis shell script to handle
  # the import, but in 2.x there's a lot more upfront work to do
  # (which, to the project's credit, allows us more control
  # over what postgis features we choose to load... so maybe
  # now it's possible to make a "leaner" postgis database...
  # not that we care about that, though, since we run on meaty
  # desktops and servers, usually, and not on embedded devices).

  cd /ccp/dev/cp/scripts
  ./db_load.sh /ccp/var/dbdumps/ccpv3_demo.pgis20 ccpv3_demo

=============
CHANGES IN THIS REVISION (it's been a while since the last checkin!):
- Well, it's only been two weeks and a few days change since the 
  last checkin, but it'll sting like thousands of lines of changes...
  and, ideally, I'd break this into twenty separate checkins, but
  there's no time, man! We gotta go Statewide or bust! So, sorry,
  but there are 178 files touched and the svn diff is 23,537 lines long....

Cyclopath Search is Working- And it's Brilliant!
- Lots of enhancements to CcpV1 search, and a ton of bugfixes
  to the earlier CcpV2 implementation attempt (from, like, a year
  or two ago... Long Live CcpV2!).
  - Let's start with the regression bugs:
    - Only one search result was being returned by pyserver.
    - In flashclient, the search query edit box was being
      cleared when the search responce was received (because
      pyserver was not returning the clean query string).
    - When using the search filters, the pageinator total
      record count was not being updated.
  - And then there were bugs from CcpV1:
    - The popup window associated with each search result in
      the list would come up immediately as you moused over,
      but if you were just mousing over to the scroll bar, all
      of a sudden, the scroll bar is obscured. Also, the popup
      doesn't realiably hide itself- it remains on the screen
      if you mouse over to the map. I added more event handlers
      on mouse over and on mouse out and I added a timer to
      delay the popping up and clossing down of the menu.
    - Searching for, e.g., "worthington, minnesota" failed
      because of missing bing entity type, 'PopulatedPlace'.
      Usually, at least in CcpV1, we'd find a matching
      Cyclopath region, but that's dependent on having a
      rich dataset, and for Statewide Cyclopath, I don't
      want to assume that we'll know the answer to every query.
  - If we find an externally geocode result, and if it's an
    address, we can assume that this is exactly what the user wants,
    so we can use this as the center to which to compare all results
    when we're ranking results, rather than using the center of the
    user's viewport. (This is because if the user is searching for an
    address, we can assume they're looking for one specific location,
    whereas if the user is searching for a restaurant, for example,
    we'd want to show all possible results in the user's viewport.)
  - The CcpV2 search fcn. parses the address using lots of
    cool tricks: It uses lookup tables of city and state
    names and zipcodes, and it smartly parses the address
    from the last word to the first word, trying to find,
    progressively from the end of the query string, a zipcode,
    then a state, then a city, and finally the street name.
    - You can now search without specifying the state name,
      and you can also use abbreviations, and you don't always
      need commas. E.g.s:
      - '538 rice st st paul'
      - 'W 50th St and Dupont Ave S Mpls'
      - CcpV2 now decodes the zip code so we can search
        internally and find city regions. E.g., searching
        '55401' will find the Minneapolis region (and even
        rank it nice and high).
    - I fixed how results are ranked so that more meaningful
      results are listed first. I use a mix of values, including:
      - the result of the postgres full text search function,
        ts_rank_cd;
      - for addresses, we can also look for exact names of things,
        e.g., if I search "123 Main St N Mpls", then we can consider
        that something named "Main St N" is probably pretty important;
      - and we still use the item type, like in CcpV1, so that we rank
        regions highest, then byways, and then waypoints;
      - but now we also rank externally geocoded results by their Entity
        Type, and we no longer exclude any externally geocoded results,
        since then we tend to return 0 results for seemingly perfectly
        acceptable queries (Entity Type is specified by the external
        geocoder, and in CcpV1 we exclude all but less than 10% of the
        resulting Entity Types).
  - I fixed the Cyclopath geocoder (used by flashclient when doing a
    route request) to short-circuit return when the external geocoder
    (currently, Bing Maps) finds a confident result (something we believe
    is really what the user wants). This means the geocoder says the
    result is an address, intersection, city, or county, but not any
    other Entity Type.
    - This saves time and we won't annoy the user by returning more than
      one result, which causes flashclient to bug the user and ask them
      to choose one of the results as the route destination.
    - Also, before checking with the external geocoder, we
      search first for an exact Cyclopath name match: if
      the user is routing from, e.g., "gateway fountain",
      we have a point for that. (And we don't have to do any more
      processing, e.g., we don't have to contact the external geocoder.)
  - In CcpV1, the search feature uses Postgres's IN operator.
      e.g., ' '.join(["AND (position(lower(%%s) IN lower(name)))"]
                     * len(self.query_include))
      which means there's one conditional for each search term -- like,
      AND () AND () AND () AND () -- but this is complicated and tedious.
      In CcpV1, the more terms that a user adds, the more restrictive is
      the search! So we're less likely to find items as the search query
      gets more complicated (or, has more words).
    - In CcpV2, we use postgres's "full text search", and we OR terms,
      rather than ANDing them.
    - This means that we find more results for longer queries -- so, rather
      than finding no results, we find more results, but we're also more
      careful to sort results accordingly, so that more relevant results
      are ordered higher.
    - To reduce meaningless hits, I made stop word lookups for each item
      type, e.g., 'ave' is a stop word for byways because so many roads
      have the word 'ave' in their name.
      - The stop words were compiled by counting how often
        certain words are used in item names, or annotation
        comments, etc., and then putting the words that are
        used hundreds of times or more into the stop list.
        - I only searched common street types, like 'ave', 'blvd',
          etc., but a more complete approach would be to make a
          dictionary of all words in all names and then to count
          uses of each of these words... which sounds really
          tedious, but also kind of fun.
  - I created a test script that exercises most of the code paths through
    the new search code. It's in a new directory, scripts/dev/testing/.
    We haven't historically done a good job of testing, so I think search_map_test.sh
    might show how a good test infrastructure might be implemented: by making a
    script that calls ccp.py a lot, and then diff'ing known output from earlier
    runs of the script against nightly runs of the script.

Flashclient Updates
- Relayer map vertices so they are drawn on top of labels,
  otherwise some vertices are obscured by labels and cannot
  be seen (this is especially apparent when splitting byways).
- Fix null ref in trace statement (fortunately, this only affected
  debug builds; i.e., not production code, which doesn't trace).
- Reword the Cyclopath-updated-so-please-reload-flashclient
  msg. to be conciser (it was rather wordy and apologetic).
- After commit, be sure to cleanup deleted byways' old nodes.

Pyserver Fixes
- Problems on import and commit:
  - Again with splitting byways! There was a problem with
    duplicate link_values being created.
    - There was also a problem with the link_value in the
      parent branch having its valid_until_rid being set
      (it should stay at rid_inf because we're not editing
      the parent branch), and with having the parent item
      being marked deleted (rather than the parent item
      being copied to the branch, and then the branch
      item being marked deleted).
  - When making endpoint nodes, we have to normalize the
    elevation to the proper precision (i.e., we can't
    use the whole float, but need to chop it off to
    a decimeter or so).
  - On item delete, the node tables were not being
    maintained properly. Rows weren't being deleted
    from node_byway, so the node_endpoint.reference_n
    wasn't being calculated right.
- Hide some of the more useless MetC branch attributes
  from the flashclient item details panel (like ALT_NAMES,
  LINE_SIDE, etc.).
- Add views for most of the item type tables, so that name
  is joined from item_versioned, access level is grabbed
  from gia table, etc. The new views' names all start with
  an underscore followed by the two-letter item abbreviation.
  E.g., "select * from _by where stk_id = 1234567"
  This is especially useful for debugging links:
    "select * from _lv_an where rhs_stk_id = 1234567"
- load_feats_and_attcs should copy qb.filters instead of
  using a new one, otherwise, e.g., searching using bulk
  stack IDs won't work in some circumstances, because
  it'll have cleared those IDs from the search.
- After import, do like commit.py: tickle Mr. Do! and
  send an interrupt to the route daemon.
- Add the modules from the services/ directory to pyserver_glue,
  so that other scripts that interact with Shapefiles can reuse
  some of the useful code therein (which right now is just some
  debug tracing fcns. that print out stats and info. about a
  specific Shapefile, like attribute definitions, etc.).
- Fix bug trying to submit Revision Feedback: there is no
  default match in the new item policy table for a link_value
  between an attachment and an attribute.
- Fix a problem calculating route reaction likes and dislikes.
- Add __eq__ and __ne__ fcns. to item_base so we can compare
  node_endpoints (well, any item type, but it's needed for
  node_endpoints).
- grac_record was not initializing acl_grouping in the version
  finalize fcn.
...
- Ug, I hid the route reaction panel, because we disabled
  that experiment last December... so this whole time the
  panel has been visible and you can read old route reactions,
  but you cannot make any new reactions! (We are a solly lot!)

Statewide Changes
- Add two bike facilities for greatermn project (our client
  asked for it): 'U.S. Bike Route' and 'State Bikeway'.
  (Though we still need to figure out ornamentation, like color).

Changes to scripts/ Scripts
- When running schema-upgrade from command line, don't vacuum
  after every script, but ask user if they want to vacuum after
  all scripts have run (vacuuming is rarely necessary between
  scripts, and it takes a number of minutes).
  - Also fix another bug in schema-upgrade: it was failing for
    me because I have the so-called "lite" database, with just
    the minnesota schema, and missing colorado, but the latter
    schema is listed in the upgrade_event table, which schema-
    upgrade parses.
- In the auto_install scripts, I removed all the /export/scratch/
  prefixes since /ccp/ should always exist, and /ccp/var on the
  production server is mapped to another hard drive,
  /export/scratch2. Basically, /export/scratch is too hard of
  a path, should let's stick with something a little mo' symbolic.

Item Watching
- New item watching cron job -- it will run every minute and
  will email users about revision, thread/post, and item activity.
  - Reworked the spam module to share its email fcn. (the one
    that sends multipart emails and not just plain old text)
    with the cron job, so now there's a common fcn. to call
    to send an email. No more copy-n-pasted email code all over
    the place.
  - On commit, rather than emailing users immediately, the
    proper item alerts are created and stored in the new
    item_event_alert table. (Really, I didn't like that
    one user's HTTP request was hanging while pyserver
    was emailing other users: we can complete the waiting
    users's HTTP request and *then* email other users.)
- More updates to item_event_alert table to support new
  cron job for emailing users.
  - Also add option for users to choose to watch their
    saved revisions: in CcpV1, we automatically emailed
    any user whose revision was reverted or commented upon,
    but now we can let the user choose if they care for
    this correspondence.
- When sending item watcher emails, we now add an opt-out
  link, like the new opt-out command for user emails:
  item watcher emails include a link to a similar command,
  user_nowatchers, that'll disable all of a user's item
  watchers -- so users can disable all of their watchers
  using a link from an item watcher email.

Upgrade to PostGIS 2.0.4!!
- Unfortunately, we cannot upgrade to PostGIS 2.1 until we
  upgrade from Postgres 8.4 to at least 9.1, but...
- But... PostGIS 2.0 is a big step!
- PostGIS 1.5 was working well, but 2.0 has lots of improvements,
  including to projections, and in the updated search feature; we
  now geocode external lon,lat results, so, hey, that's working
  for us.
- We're also ready to jump to Postgres 9.1/2/3 whenever, and
  we work with all of the latest versions of GEOS, GDAL, Proj.4,
  etc. (I updated and tested the gis_compile auto_install script,
  and we're good to go with all of the latest GIS libraries that
  we use and love so much.)


------------------------------------------------------------------------
r30806 | landonb | 2013-10-15 00:28:30 -0500 (Tue, 15 Oct 2013) | 19 lines

DEVS: There's a new schema script.
  cd /ccp/dev/cp/scripts
  ./schema-upgrade.py {your_db_name}

Also run ccpv2-add_constraints.sql:
  cd /ccp/dev/cp/scripts/setup/runic
  psql -U cycling {your_db_name} < ccpv2-add_constraints.sql

- Fix issues with item-read-events.
  - Update tables, and fix flashclient and pyserver.
- Fix flashclient so user can reset email_bouncing from therein.
- Fix search:
  - Grouping byways by connectivity was broken and only
    returning one set of connected results (loop var wasn't
    being reset).
  - A ton of other problems...
- A few other misc. pyserver bugs with certain qb.filters not
  working.

------------------------------------------------------------------------
r30802 | landonb | 2013-10-09 17:00:38 -0500 (Wed, 09 Oct 2013) | 88 lines

DEVS: There's a new schema script.
  cd /ccp/dev/cp/scripts
  ./schema-upgrade.py {your_db_name}

- Flashclient: Problem when using split tool while
  byway is still lazy-loading. The tool would send
  GWIS supplemental requests, but some were duplicates
  that were being ignored. So update_supplemental now
  returns an indication if the request was actually
  queued.
  - The widget was waiting forever for GWIS requests
    that were never sent.
- Flashclient regression: Item ratings were not
  being sent- the code was using an uninitialized variable
  in GWIS_Commit: the var had been renamed but old the
  declaration hadn't been deleted and there was still a
  reference, so, kind of like a typo and kind of like a
  copy-n-paste (or copy-n-delete) mistake.
- Flashclient regression: Rating and Watching _new_ (fresh)
  items should be added to the working copy and committed
  when the map is saved. There were unintentionally being
  sent immediately for new, unsaved items (since rating
  and watching was made into an out-of-band commit). Now,
  rating and watching existing items is still an immediate
  GWIS commit, but rating and watching new items is queued
  to the map save data.
- Flashclient: When the Name widget was in editing mode,
  it was causing the Stack ID not to be shown in the header.
- Pyserver: Fix problem computing access_infer_id. 1., So
  that split-into link_values, which are fetched userlessly,
  are assigned the proper bitmask. And, 2., To remove
  ambiguity about whom usr_editor and usr_arbiter apply,
  since they're calculated in the context of the user who
  is saving; i.e., the usr_* bit values don't make sense
  for 'permissive'-style item, which allow more than one
  user to be arbiter, and for 'restricted'-style items,
  which users other than the arbiter can edit. E.g., when
  a non-arbiter user would save, the access_infer_id would
  be mis-calculated (by removing the usr_arbiter bit),
  because the user saving has editor access but not
  arbiter access.
- Pyserver: I noticed that the same thread is used by
  overlapping apache requests, so it was not possible
  to trace the same apache requests in the log file.
  So in gwis_mod_python, which is the entry point for
  apache requests, I pass the apache request object to
  the logging facility so it can include the unique
  connection ID. Now, it's possible to trace the same
  request in the log file and to differentiate unique
  connections' log messages from other, overlapping
  requests' messages.
- Pyserver: Big Problems with locks:
  - We need a longer timeout, especially for developer
    machines. I added a timeout to conf that's similar
    to flashclient's client timeout: that is, we want
    the gwis request to timeout before the client, so
    at least the server can send back an error before
    the client timesout.
  - When a SQL table or row lock timedout, we were missing
    the error, 1., because db_glue was intercepting the
    exception and throwing a different error (for another
    reason), and 2., because some of the try/except blocks
    were ordered wrong, and a base class exception was
    catching the exception before the derived class
    handler.
    - Now, callers tell the sql() fcn. to raise the
      original exception; and the caller reordered its
      except blocks so the derived class comes first.
- MetC Shapefile: It truncates names to 44 chars (the
  width of the field) so check for this and restore the
  original byway's name if so.
- To revision table, add a new column which indicates how
  long the 'revision' table lock was held to complete the
  revision. This helps give context to the revision and
  may help fix problems with slow commits and imports.
- Pyserver: Problem with duplicate split-into link_values.
  When splitting a byway, byway was making new link_values,
  and then commit was making new ones based on the GML.
  - I added code in commit to just overwrite the newly
    created link_value record when processing GML link_values
    for newly split byways' link_values.
  - I also added code to link_value to check for duplicate
    link_values (same lhs_stack_id and same rhs_stack_id)
    when the lhs item is not an attribute that indicates
    multiple_allowed.
- A bunch of fixes to the import script, which was broken by
  recent changes to splitting byways and making link_values.

------------------------------------------------------------------------
r30788 | landonb | 2013-10-01 14:13:33 -0500 (Tue, 01 Oct 2013) | 1 line

Update to previous.
------------------------------------------------------------------------
r30787 | landonb | 2013-10-01 13:59:51 -0500 (Tue, 01 Oct 2013) | 1 line

New cron script to check log_event_joined for flashclient errors and to email them to cyclopath-errs.
------------------------------------------------------------------------
r30785 | landonb | 2013-10-01 13:26:23 -0500 (Tue, 01 Oct 2013) | 4 lines

Update logrotate scripts to remove logcheck offset file
so we don't get that annoying tampering warning email
because the logfile size changed.

------------------------------------------------------------------------
r30782 | landonb | 2013-09-30 17:13:38 -0500 (Mon, 30 Sep 2013) | 33 lines

DEVS: There's a new schema script.
  cd /ccp/dev/cp/scripts
  ./schema-upgrade.py {your_db_name}

Bugfixes:
- Regression: Splitting byway and making new intersection
  is broken. The node_endpoint class needs to set acl_grouping
  to 1, and the byway class was not assigning new split-from
  link_values' client stack IDs correctly.
- Change flashclient name header to default to an edit box when
  the user is in edit mode, rather than user having to double-
  click on the name.
- For private routes with a Web link, the deep-link URL should
  require the user to log in, so I added a new deep-link,
  'private', that asks users to log on before fetching the
  deep-linked item.
  - Before this, making a Web link on a private route didn't
    work if the user used the link after logging off.
- Add user_ column, unsubscribe_proof, which is an UUID we can
  use with the new user_unsubscribe command so users can opt-out
  of emails without having to email us and us having to manually
  update the database.
  - I added an htmlfile_out attribute to the request object,
  since the new GWIS command needs to return HTML, rather than
  XML.
  - See: http://bugs.cyclopath.org/show_bug.cgi?id=2098
- Fixed problems trying to lock database rows and using NOWAIT:
  When the server is busy, it seems to not ever be able to lock
  rows.
  - We now use SET STATEMENT_TIMEOUT to set a timeout of a few
  seconds. The default is to wait forever, but we want to not
  wait longer than the HTTP timeout.

------------------------------------------------------------------------
r30777 | landonb | 2013-09-27 12:31:53 -0500 (Fri, 27 Sep 2013) | 1 line

Bugfix to emails_for_spam
------------------------------------------------------------------------
r30776 | landonb | 2013-09-27 12:18:44 -0500 (Fri, 27 Sep 2013) | 1 line

Landmarks email script should commit.
------------------------------------------------------------------------
r30775 | landonb | 2013-09-27 11:25:39 -0500 (Fri, 27 Sep 2013) | 1 line

Typo in user_email. Also, update emails_for spam to accept user IDs.
------------------------------------------------------------------------
r30771 | landonb | 2013-09-26 10:50:35 -0500 (Thu, 26 Sep 2013) | 1 line

Landmarks update.
------------------------------------------------------------------------
r30768 | landonb | 2013-09-25 15:52:45 -0500 (Wed, 25 Sep 2013) | 1 line

search_by_stack_id should reset qb.filters changes.
------------------------------------------------------------------------
r30765 | landonb | 2013-09-25 14:25:50 -0500 (Wed, 25 Sep 2013) | 1 line

Typo in previous; just affect mon.itor.us response.
------------------------------------------------------------------------
r30764 | landonb | 2013-09-25 12:48:55 -0500 (Wed, 25 Sep 2013) | 2 lines

- Change log messages in transaction_lock_row_logic.

------------------------------------------------------------------------
r30763 | landonb | 2013-09-25 11:53:57 -0500 (Wed, 25 Sep 2013) | 3 lines

- Tweak log messages. Coincides with changes
  to logcheck to make known issues silent.

------------------------------------------------------------------------
r30761 | landonb | 2013-09-25 01:07:11 -0500 (Wed, 25 Sep 2013) | 11 lines

- Regression: If pyserver uses a client's unknown token,
  it sets integrity_errs_okay so db_glue doesn't
  assert. (This is a symptom of another, unknown bug:
  for some reason, pyserver is getting a token from
  the client that is not set in user__token.)
  - It shold also indicate that the token is valid,
    since it was just inserted into user__token.
- Also wrapped other sql() calls that catch IntegrityError
  by temporarily setting integrity_errs_okay, so db_glue
  doesn't assert.

------------------------------------------------------------------------
r30760 | landonb | 2013-09-24 21:29:29 -0500 (Tue, 24 Sep 2013) | 1 line

Token retries need integrity_errs_okay.
------------------------------------------------------------------------
r30758 | landonb | 2013-09-24 21:01:27 -0500 (Tue, 24 Sep 2013) | 1 line

Don't set locked_tables if rows-to-lock not found.
------------------------------------------------------------------------
r30757 | landonb | 2013-09-24 20:51:07 -0500 (Tue, 24 Sep 2013) | 15 lines

Argh, when I fixed the user__token problem I broke mobile!
  - At least I think so: it looks like mobile is sending
    its own token. In contrast, flashclient doesn't generate
    tokens but requests them from the server. This ensures
    that tokens are unique, and it helps prevent against
    spoofing users, since, in CcpV1, a user's token never
    changes... like, not even when they log out, which
    makes the token more vulnerable than a session-based
    token.
Regression: routed crashing when revision changes and
  service tries to load updated (changed) byways: it
  should not set the qb's username to None, since
  Item_Manager was recently recoded to better handle
  update fetches.

------------------------------------------------------------------------
r30754 | landonb | 2013-09-24 16:23:49 -0500 (Tue, 24 Sep 2013) | 6 lines

Regression: routed crashing when revision changes and
  service tries to load updated (changed) byways: it
  should not set the qb's username to None, since
  Item_Manager was recently recoded to better handle
  update fetches.

------------------------------------------------------------------------
r30753 | landonb | 2013-09-24 16:04:29 -0500 (Tue, 24 Sep 2013) | 8 lines

- Make some GWIS_Warning and GWIS_Error exceptions
  log to info, rather than to warning or error:
  the warning or error is for the client and
  doesn't always mean we need to pay attention
  (e.g., when the user enters an incorrect password).
- Add addition log messages to some errors that
  we're still investigating.

------------------------------------------------------------------------
r30750 | landonb | 2013-09-24 14:20:08 -0500 (Tue, 24 Sep 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r30749 | landonb | 2013-09-24 14:09:31 -0500 (Tue, 24 Sep 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r30748 | landonb | 2013-09-24 13:55:16 -0500 (Tue, 24 Sep 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r30747 | landonb | 2013-09-24 13:20:27 -0500 (Tue, 24 Sep 2013) | 17 lines

- Redo locking user__token row: I'm seeing lots of warnings
  in the log files.
  - Add better trace messages.
  - No longer use transaction_retryable. Instead, row-lock
    fcn. will handle retrying the lock (and closing the
    curson, sleeping, and getting a new cursor between
    tries).
- Missing fcn. argument when handling too many failed
  login attempts.
- Fix bouncing warning: pyserver command class was
  referencing self.doc too early, so I moved some
  code from decode_request to prepare_metaresp.
- Fix race condition where rid_max is not received
  by the client before it tries to checkout items
  for a freshly loading branch.
- apache2sql fix for weirdly formatted time_consumed.

------------------------------------------------------------------------
r30743 | landonb | 2013-09-23 15:37:32 -0500 (Mon, 23 Sep 2013) | 1 line

Error handling bugfix
------------------------------------------------------------------------
r30742 | landonb | 2013-09-23 15:35:51 -0500 (Mon, 23 Sep 2013) | 1 line

Add scripts for logrotate to fix problem archiving logs while apache is reloading.
------------------------------------------------------------------------
r30739 | landonb | 2013-09-23 10:57:14 -0500 (Mon, 23 Sep 2013) | 1 line

Landmarks bugfix from Fernando.
------------------------------------------------------------------------
r30736 | landonb | 2013-09-21 15:25:28 -0500 (Sat, 21 Sep 2013) | 53 lines

- Route editing fixes.
  - Wasn't splicing the new sub-segment correctly.
  - Wasn't updating the directions and route details
    tabs.
  - Wasn't recalculating the route length.
  - Route_List has same Flex scrolling problem as
    Text, so I added one more row to the list than
    their are number of route_stops, so the scrolling
    problem doesn't happen (as opposed to overriding
    the DataGrid object, which seems like a waste of
    time and possibly a fruitless effort).
  - Dragging the route was broken: clicking on the route
    (on the temporary route_stop that tracks the cursor
    as a user mouses over a route line) to create a new
    route stop and drag it to another intersection was
    broken. There were a handful of issues.
    - Same with using the New Destination button in the
      panel, which then lets you click on the map. The
      tool was broken.
- Getting GPX on anon. route was not working because
  session ID was not being used.
- Fix item alerts panel: was not showing fetched alerts
  (a regression error: untested new code from a fix to
   an earlier bug...).
- Fix Route History's Clear All (discrepancies between
  client and server GWIS protocol implementation).
- Fix two "warning: unable to bind to property" properties,
  (just add [Bindable], dummie! oh, and the matching 'set'
  function =).
- Fix route stop naming problem: android still uses 'step'
  and 'waypoint', but gwis v3 was using 'rstep' and 'rstop';
  I just reverted to the wfs v1 convention (CcpV1).
- Fix bug saving routes: new route stops were not being
  saved in the database.
- Fix MediaWiki new user plugin:
  - http://bugs.cyclopath.org/show_bug.cgi?id=2824
  - MediaWiki converts spaces in usernames to underscores.
  - We've never handled this case, nor has any user ever
    complained.
  - I wrote a custom new user plugin to explain how to
    formulate a username, and that spaces will become
    underscores.
  - I fixed the auth plugin to convert spaces to
    underscores before interacting with the cyclopath
    database.
- On logout, the branchChange event was not being signalled.
  - I figured this out trying to suppress the Manage Map
    menu item in the Map Legend.
- Finish wiring and fix a bunch of the Map Settings options:
  - Show bike facilities.
  - Highlight items with notes or discussions.
  - Shade roads by their rating.

------------------------------------------------------------------------
r30728 | landonb | 2013-09-20 13:17:47 -0500 (Fri, 20 Sep 2013) | 1 line

Fix asgpx issue and add better logging for other error.
------------------------------------------------------------------------
r30727 | landonb | 2013-09-20 12:43:28 -0500 (Fri, 20 Sep 2013) | 1 line

Landmarks trial fix for previously incomplete trials (from Fernando).
------------------------------------------------------------------------
r30721 | landonb | 2013-09-19 10:35:35 -0500 (Thu, 19 Sep 2013) | 35 lines

- Implement Access_Infer.sessid_arbiter so we don't set
  Access_Infer.others_arbiter instead. This helps anon
  users request routes, log in, and then save the routes.
- Also fix the footer text about saving to handle the
  different states better (and print more relevant text).
- Check for DisabledListItemRenderer null object reference
  and print stack trace -- I saw this earlier but wasn't
  able to reproduce it.
- MediaWiki CycloAuth.php fixes:
  - We don't have a test mediawiki server, so it's hard
    to test except just going live and testing...
  - Checking for underscore as the first character
    needs to be doubly-escaped, since PHP escapes
    the slash, and then postgres escapes it.
  - Now setting search_path, because cp_user_new
    needs it. So now I've hard-coded 'minnesota'.
- Fix creating stealth secret (deep link) for anon
  user routes.
- Also fix problem saving new group_item_access rows:
  the session_id was not being recorded in the new rows.
- Catch IOError in setup_areq: in self.areq.read(),
  it looks like the client has disconnected.
- Fix email script reference to emailx (it's now user_mail).
- Fix route editing: add CcpV1's nosave (dont_save) to
  tell route finder not to save route request (when getting
  sub-segment routes).
  - Also don't add sub-segments to Geofeature.all or map.
  - Change Route's Route_Stops from Sprites to Item_Sprites,
    so when they're clicked, we know to which Route they
    belong.
- Fix refreshing anon-fetched routes after logging in:
  do similar to stealth_create and use commit to update
  GIA records (route_get was just doing SQL directly,
  but that's not good enough).

------------------------------------------------------------------------
r30720 | landonb | 2013-09-18 17:42:29 -0500 (Wed, 18 Sep 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r30719 | landonb | 2013-09-18 17:37:03 -0500 (Wed, 18 Sep 2013) | 24 lines

- Implement Access_Infer.sessid_arbiter so we don't set
  Access_Infer.others_arbiter instead. This helps anon
  users request routes, log in, and then save the routes.
- Also fix the footer text about saving to handle the
  different states better (and print more relevant text).
- Check for DisabledListItemRenderer null object reference
  and print stack trace -- I saw this earlier but wasn't
  able to reproduce it.
- MediaWiki CycloAuth.php fixes:
  - We don't have a test mediawiki server, so it's hard
    to test except just going live and testing...
  - Checking for underscore as the first character
    needs to be doubly-escaped, since PHP escapes
    the slash, and then postgres escapes it.
  - Now setting search_path, because cp_user_new
    needs it. So now I've hard-coded 'minnesota'.
- Fix creating stealth secret (deep link) for anon
  user routes.
- Also fix problem saving new group_item_access rows:
  the session_id was not being recorded in the new rows.
- Catch IOError in setup_areq: in self.areq.read(),
  it looks like the client has disconnected.
- Fix email script reference to emailx (it's now user_mail).

------------------------------------------------------------------------
r30711 | landonb | 2013-09-18 10:12:13 -0500 (Wed, 18 Sep 2013) | 1 line

Bug in landmarks trial: SELECT MAX() returns one row with the NULL value if there are no matches; the code was assuming it would return no rows.
------------------------------------------------------------------------
r30703 | landonb | 2013-09-16 23:24:46 -0500 (Mon, 16 Sep 2013) | 1 line

Fix indents
------------------------------------------------------------------------
r30699 | landonb | 2013-09-16 19:03:52 -0500 (Mon, 16 Sep 2013) | 1 line

Add htdocs/ reports and exports folders.
------------------------------------------------------------------------
r30698 | landonb | 2013-09-16 18:55:50 -0500 (Mon, 16 Sep 2013) | 13 lines

- Add App_Mode_Dull for editing routes -- we'll show the Editing
  Tools so that the user can save the map, but we won't let users
  drag byway vertices.
- Show Welcome message ("to new CcpV2!") and link to known issues
  in a banner above the map.
- Change "View-only" to "Viewing", so it parallels "Editing".
  We can also now show "Routing" when user is just editing routes.
- More fixes to saving routes, changing visibility and permissions,
  and deleting routes.
- Fix to refreshing GIA records after changing permissions.
  - Problems in user interface, and the GWIS_Grac_Get handler
    wasn't updating item.groups_access correctly.

------------------------------------------------------------------------
r30695 | landonb | 2013-09-16 17:30:36 -0500 (Mon, 16 Sep 2013) | 29 lines

- Glaring type (missing opening paranthesis) in import_items_ccp,
  called via daily cron when exporting branches.
- Fixes to committing permissions changes for restricted item types,
  e.g., saving changes to route permissions.
  - In pyserver commit, when we fetch items that are not being
    edited but are instead having permissions changed, or are being
    rated, etc., we should peek in the group_item_access table to
    figure out the item_type, so that we hydrate a proper item, e.g.,
    a route.One, instead of the parent class, item_user_access.One.
    - If we don't do this, for permissions changes, the item_type_id
      column will be recorded incorrectly.
  - Fix a problem in grac_manager asserting when called by commit
    when incrementing acl_grouping, i.e., changing an item's permissions
    without creating a new revision. The grac_mgr now has an
    "allow_existing" option, since the item will have an incremented
    acl_grouping, but its version will be the same.
  - Also fix commit to call item_mgr.start_new_revision rather than
    trying to sneakily do it itself.
- Fix route.One to allow 'source' to be specified by flashclient
  via GML.
- Fix problem deleting route -- route_steps were not being assigned
  byway_id.
- Fix group_item_access.One.sql_context_user, which is not used but
  can be called via ./ccp.py -r -t group_item_access -x user -I {stk_id}
- Don't call save_core when just incrementing acl_grouping, but do
  call save_related_maybe.
- Add dirty_reason_infr to indicate when item_stack.access_infer needs
  to be updated.

------------------------------------------------------------------------
r30694 | landonb | 2013-09-16 16:58:40 -0500 (Mon, 16 Sep 2013) | 1 line

Point analytics to new server.
------------------------------------------------------------------------
r30693 | landonb | 2013-09-16 16:56:48 -0500 (Mon, 16 Sep 2013) | 1 line

Notes about the Statewide dataset.
------------------------------------------------------------------------
r30691 | landonb | 2013-09-11 17:06:33 -0500 (Wed, 11 Sep 2013) | 6 lines

I broke the p2 route finder (multimodal) when I fixed
a problem with node_cache_maker: the later needs byway
elevation data, but not the latter. Rather than rely
on item_mgr's 'heavyweight' attribute, I added a new
qb.filters setting, exclude_byway_elevations.

------------------------------------------------------------------------
r30690 | landonb | 2013-09-11 16:26:34 -0500 (Wed, 11 Sep 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r30689 | landonb | 2013-09-11 16:14:10 -0500 (Wed, 11 Sep 2013) | 1 line

Cloning the qb should copy qb.session_id because filters.gia_use_sessid was copied (or, we shouldn't copy either...).
------------------------------------------------------------------------
r30688 | landonb | 2013-09-11 15:14:06 -0500 (Wed, 11 Sep 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r30686 | landonb | 2013-09-11 15:06:57 -0500 (Wed, 11 Sep 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r30685 | landonb | 2013-09-11 15:03:17 -0500 (Wed, 11 Sep 2013) | 24 lines

Flashclient:
- Two GWIS_Item_Findability_Get commands could not be sent
  simultaneously: we need to override allow_overlapped_requests
  to return true.
  - Same for GWIS_Item_Findability_Put, and always define its
    own equals() function.
  - Also GWIS_Landmark_Trial_Get: override both
    allow_overlapped_requests and equals.
  - And a half dozen other GWIS classes.
- Continuing implementation of Tab_Item_Sharing_Restricted.

MERGE from Fernando: Landmarks Experiment

------------------------------------------------------------------------
r30675 | torre | 2013-09-11 13:03:09 -0500 (Wed, 11 Sep 2013) | 1 line

landmarks for new routes
------------------------------------------------------------------------
r30674 | torre | 2013-09-11 12:44:47 -0500 (Wed, 11 Sep 2013) | 1 line

merge with trunk and fix landmark issue for existing routes

END MERGE from Fernando

------------------------------------------------------------------------
r30679 | landonb | 2013-09-11 13:42:49 -0500 (Wed, 11 Sep 2013) | 1 line

Fix MAGIC_NUMBER by using socket.gethostname(), drr.
------------------------------------------------------------------------
r30678 | landonb | 2013-09-11 13:35:26 -0500 (Wed, 11 Sep 2013) | 1 line

Fix MAGIC_NUMBER in email-generating script to reference new production server.
------------------------------------------------------------------------
r30677 | landonb | 2013-09-11 13:33:55 -0500 (Wed, 11 Sep 2013) | 1 line

Mapfile fix: bike facility CLASS was using all STYLEs (misplaced array reset).
------------------------------------------------------------------------
r30671 | landonb | 2013-09-11 09:33:52 -0500 (Wed, 11 Sep 2013) | 1 line

Missing htdocs/misc graphics from CcpV1.
------------------------------------------------------------------------
r30669 | landonb | 2013-09-10 15:19:18 -0500 (Tue, 10 Sep 2013) | 12 lines

Flashclient:
- Don't get item_findability if route is unlibraried.
- Fix Route_Get_Base callback caller (missing param).
- Fix log in after anonymous route request (many errors).
  - Pyserver now updates GIA and item_stack records when
    a user requests a route with the session ID.
- Flashclient needs to be explicit when getting routes
  using the session ID (i.e., when an anoymous user
  requests a route and then logs in).
- Have pyserver send route.date_created so flashclient
  can display it.

------------------------------------------------------------------------
r30668 | landonb | 2013-09-10 14:56:47 -0500 (Tue, 10 Sep 2013) | 1 line

Fixing problem I created a few days ago when I fixed make_new_branch to not fetch node_endpoints: we still need to fetch byway ratings, even when not qb.item_mgr.heavyweight, so the flashclient shows the correct ratings.
------------------------------------------------------------------------
r30667 | landonb | 2013-09-10 14:41:00 -0500 (Tue, 10 Sep 2013) | 1 line

A few fixes to the landmarks cron job and email script.
------------------------------------------------------------------------
r30663 | landonb | 2013-09-09 16:21:40 -0500 (Mon, 09 Sep 2013) | 17 lines

MERGE from Fernando: Landmarks Experiment

------------------------------------------------------------------------
r30657 | torre | 2013-09-09 11:42:39 -0500 (Mon, 09 Sep 2013) | 1 line

grab a few more landmark needs
------------------------------------------------------------------------
r30656 | torre | 2013-09-09 11:41:28 -0500 (Mon, 09 Sep 2013) | 1 line

grab a few more landmark needs
------------------------------------------------------------------------
r30654 | torre | 2013-09-09 11:23:26 -0500 (Mon, 09 Sep 2013) | 1 line

merge with trunk

END MERGE from Fernando

------------------------------------------------------------------------
r30658 | landonb | 2013-09-09 14:55:09 -0500 (Mon, 09 Sep 2013) | 20 lines

- Flashclient: In Geofeature.set_selected, check if
  effectively_next_panel is null before using ([lb]
  hit a null-pointer exception when getting a route,
  but I wasn't been able to reproduce it... so I just
  added the null check... so it shouldn't crash, but
  maybe something won't happen the way it should).
- Flashclient: Remove Widget_Bike_Facility's
  item event listeners in on_remove_event, lest the
  callbacks fire and there's no widget anymore.
- Flashclient: More Route_Save_Footer implementation:
  - Don't show 'Save' button if user is anonymous.
  - Hide the foot widget after the user saves.
  - Still a little more work to do...
- Flashclient: Per Loren, make the 'Editing' button
  say 'View-only' when not in editing mode (rather
  than always saying Editing).
- MapServer: Fix map file: For bike facilities, if
  you want multiple styles applied, don't use multiple
  CLASS entries but use multiple STYLE entries instead.

------------------------------------------------------------------------
r30655 | landonb | 2013-09-09 11:30:13 -0500 (Mon, 09 Sep 2013) | 10 lines

Pyserver fix: If you're missing a value in CONFIG, conf.py can
  use a default value, except this was broken if the section was
  also missing. Adding catch NoSectionError to RawConfigParser2
  fixes the problem.

------------------------------------------------------------------------
r30653 | torre | 2013-09-09 09:19:56 -0500 (Mon, 09 Sep 2013) | 1 line

very dumb error

------------------------------------------------------------------------
r30652 | landonb | 2013-09-09 00:40:39 -0500 (Mon, 09 Sep 2013) | 105 lines

MERGE from Fernando: Landmarks Experiment
- Circa br/torre_landmarks_30517@30647 / 2013-09-07 15:13:11
- Plus [lb] added a cron job bash shell wrapper around
  landmarks_experiment_email.py so it runs just once at a time
  (using the Very Populate flock_dir to gait script instances).

------------------------------------------------------------------------
r30647 | torre | 2013-09-07 15:13:11 -0500 (Sat, 07 Sep 2013) | 1 line

small fixes
------------------------------------------------------------------------
r30646 | torre | 2013-09-06 11:30:58 -0500 (Fri, 06 Sep 2013) | 1 line

add two landmark experiment logs
------------------------------------------------------------------------
r30645 | torre | 2013-09-06 11:06:16 -0500 (Fri, 06 Sep 2013) | 1 line

deeplink now works!
------------------------------------------------------------------------
r30644 | torre | 2013-09-06 10:56:34 -0500 (Fri, 06 Sep 2013) | 1 line

merge with trunk
------------------------------------------------------------------------
r30640 | torre | 2013-09-05 16:23:26 -0500 (Thu, 05 Sep 2013) | 1 line

merge with trunk
------------------------------------------------------------------------
r30636 | torre | 2013-09-05 13:41:30 -0500 (Thu, 05 Sep 2013) | 1 line

merge with trunk
------------------------------------------------------------------------
r30631 | torre | 2013-09-03 12:42:08 -0500 (Tue, 03 Sep 2013) | 1 line

landmarks experiment gwis commands
------------------------------------------------------------------------
r30630 | torre | 2013-09-03 12:25:25 -0500 (Tue, 03 Sep 2013) | 1 line

script for adding landmark experiment tables and script for sending landmarks experiment reminders
------------------------------------------------------------------------
r30629 | torre | 2013-09-03 09:19:51 -0500 (Tue, 03 Sep 2013) | 1 line

show landmark prompts in Flash, show landmarks in cue sheet, and click on cue sheet to go to each step on the map
------------------------------------------------------------------------
r30626 | torre | 2013-08-30 14:07:53 -0500 (Fri, 30 Aug 2013) | 1 line

merge with trunk
------------------------------------------------------------------------
r30625 | torre | 2013-08-30 14:07:06 -0500 (Fri, 30 Aug 2013) | 1 line

merge with trunk
------------------------------------------------------------------------
r30621 | torre | 2013-08-30 10:16:01 -0500 (Fri, 30 Aug 2013) | 1 line

committing some of the stuff temporarily so that I can merge again with trunk
------------------------------------------------------------------------
r30620 | torre | 2013-08-30 10:10:10 -0500 (Fri, 30 Aug 2013) | 1 line

small changes
------------------------------------------------------------------------
r30618 | torre | 2013-08-26 21:58:38 -0500 (Mon, 26 Aug 2013) | 1 line

fixes to conflation algorithm
------------------------------------------------------------------------
r30608 | torre | 2013-08-21 13:05:04 -0500 (Wed, 21 Aug 2013) | 1 line

merge with trunk
------------------------------------------------------------------------
r30607 | torre | 2013-08-21 13:02:49 -0500 (Wed, 21 Aug 2013) | 1 line

track fix
------------------------------------------------------------------------
r30535 | torre | 2013-08-04 15:11:38 -0500 (Sun, 04 Aug 2013) | 1 line

merge with trunk
------------------------------------------------------------------------
r30534 | torre | 2013-08-04 15:09:58 -0500 (Sun, 04 Aug 2013) | 1 line

test
------------------------------------------------------------------------
r30523 | landonb | 2013-07-30 18:04:13 -0500 (Tue, 30 Jul 2013) | 1 line

Restore branch
------------------------------------------------------------------------
r30385 | torre | 2013-06-24 14:21:40 -0500 (Mon, 24 Jun 2013) | 1 line

conflation fix
------------------------------------------------------------------------
r30377 | torre | 2013-06-22 15:30:54 -0500 (Sat, 22 Jun 2013) | 1 line

conflation algorithm can now add just intersections when a new block is not needed
------------------------------------------------------------------------
r30338 | torre | 2013-06-11 13:40:03 -0500 (Tue, 11 Jun 2013) | 1 line

not sure why this was added
------------------------------------------------------------------------
r30337 | torre | 2013-06-11 13:37:50 -0500 (Tue, 11 Jun 2013) | 1 line

branch for landmarks project
------------------------------------------------------------------------
r30336 | torre | 2013-06-11 13:37:27 -0500 (Tue, 11 Jun 2013) | 2 lines

branch for landmarks project

END MERGE from Fernando

------------------------------------------------------------------------
r30651 | landonb | 2013-09-08 14:08:33 -0500 (Sun, 08 Sep 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r30650 | landonb | 2013-09-08 14:07:23 -0500 (Sun, 08 Sep 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r30648 | landonb | 2013-09-08 13:29:45 -0500 (Sun, 08 Sep 2013) | 24 lines

DEVS:
 UPDATE group_ SET access_scope_id = cp_access_scope_id('public')
 WHERE access_scope_id = cp_access_scope_id('shared')
       AND name = 'Stealth-Secret Group';

- Change Stealth Secret Group from shared to public, so flashclient
  can determine the stealth secret group stack ID, which it uses to
  determine a route's permissions and visibilities.
  - Also modified pyserver to send the steatch secret group id with
    a user's group_membership records, and modified flashclient to
    consume the group id.
- In mapserver/tilecache_update.py, two bugs:
  - Incorrent indent (typo) causes --bbox option to fail.
  - When making the segment cache, we need to load byways
    with heavyweight=True so we get ratings, tags, and attrs.
- Pyserver: search_by_stack_id should use qb.filters.only_stack_ids
  instead of directly injecting SQL, otherwise qb.filters.get_id_count
  doesn't work.
- Exchange MAGIC_NUMBERs in pyserver with correct values from
  Library_Squelch class (pyserver was creating item_findability
  records with the wrong enum value, which is why using a class
  reference rather than hard-coding numbers in code is the way to go).
- Many miscellaneous bugfixes to route saving and sharing widgets.

------------------------------------------------------------------------
r30643 | landonb | 2013-09-06 00:31:23 -0500 (Fri, 06 Sep 2013) | 1 line

Regression fix: opening a thread, remove assert before items_add.
------------------------------------------------------------------------
r30642 | landonb | 2013-09-05 23:29:34 -0500 (Thu, 05 Sep 2013) | 21 lines

- Fixed Deep_Link.LOGGED_IN: with a deep link that requires authentication,
  the deep link was executing right before the Update_User started, so the
  GWIS request for the route sent by the deep link was being discarded as
  soon as flashclient started reloading the map for the logged-in user.
  - I deferred reacting to LOGGED_IN until updatedItems is dispatched.
- Lots of fixes (well, three in pyserver, and one or two in flashclient) to
  item_findability_put. The code was pretty green and not tested well,
  because other problems had to be solved before said code could be tested.
  I haven't tested changing library visibilty, but the history_add action
  seems to be working now.
- Route.set_selected had an error: it was testing this.selected
  after calling super.set_selected, so this.selected was changed.
  This caused problems selecting routes when switching to
  their details panel, e.g., when deep linking to a route or
  double-clicking one in a route list, the route would not
  get selected on the map.
- In flashclient, out-of-band requests no longer start the throbberer.
  E.g., when switching to a route panel, the user triggers a
  findability-put command, but we shouldn't annoy/confuse (annoy-confuse?)
  the user with the "Working..." throbberer.

------------------------------------------------------------------------
r30641 | landonb | 2013-09-05 16:28:57 -0500 (Thu, 05 Sep 2013) | 3 lines

On anonymous-user find-new-route, flashclient was popping up a
GWIS error, because we were sending GWIS_Item_Findability_Get.

------------------------------------------------------------------------
r30639 | landonb | 2013-09-05 16:19:05 -0500 (Thu, 05 Sep 2013) | 5 lines

Pyserver Regression (I broke the route finder):
- In the second to last revision, I added some asserts to
  check for places assuming stack_id is not None when checking
  stack_id < 0, but I got one case wrong.

------------------------------------------------------------------------
r30638 | landonb | 2013-09-05 16:06:09 -0500 (Thu, 05 Sep 2013) | 1 line

Fix to previous.
------------------------------------------------------------------------
r30637 | landonb | 2013-09-05 16:02:58 -0500 (Thu, 05 Sep 2013) | 13 lines

Flashclient:
- Typo in route_select (or, more accurately, a cut-n-paste
  error) was causing route_select to have route_lookat called
  on ensure_hydrated callback. Meaning, if the route wasn't
  loaded, it would be lazy-loaded first, but the wrong callback
  was being called: lookat instead of select.
- Byway was not clearing one-way arrows when deselected.
Pyserver:
- Error looking up existing tags by name: was just using
  item_versioned table without bothering to join on the tag table.
  - This was causing a problem adding tags whose name is
    the name of other, non-tag items in the system, like 'test'.

------------------------------------------------------------------------
r30635 | landonb | 2013-09-05 13:07:25 -0500 (Thu, 05 Sep 2013) | 79 lines

Flashclient:
- Some GWIS callbacks were processing resp_items without
  checking to see if the items already exist.
  - E.g., when deep-linking to a route, we've already
    loaded the route list, and then we request the deep-
    linked route, but the deep-link callback uses the
    newly created item from the GWIS response. Instead,
    it should check Geofeature.all and use the existing
    item (after calling route.init(G.item_mgr) to update
    the existing item, since we're getting route steps,
    route stops, and lazy-loading item_values).
  - Deep Link is fixed to always check the item's class's
    item lookup for the resident item.
- Deep Link also fixed to activate route panel.
  - The route was being selected, but solo=false, so the
    route was just attaching itself to the route-list panel,
    rather than opening a route details panel.
- I did a Big No-No: I used ||= to try to run a function
  that I always want to run, but stupidly overlooked the
  fact that ||= only runs the right-hand side if the left-
  hand side is false. Specifically, I set a Boolean first
  to the Boolean output of a function, and then I wanted
  to run a second function and OR the results together.
  But I need to use an intermediate variable, since ||=
  is So Smart.
  - This fixes the problem with pan_and_zoom_to where
    the map pans but does not zoom (since zooming was
    the second operation that ||= skipped).
- When adding or deleting tags, the tag widget list was
  not updating.
  - I had recently modified the tag widget list to update
    only when necessary, otherwise there's this annoying
    screen flicker.
    - But I guess I was too restrictive, or didn't code
      for all circumstances... so hopefully this is the
      last regression caused by trying to get rid of the
      annoying screen flicker.
- Bugfix for anonymous route request, which was complaining
  "requires loggin in": We shouldn't request the findability
  of an unsaved route, since it has no findability record.
- Funny Flex Behaviour (I.E., Flex Bug Fixed):
  If you use the mouse wheel over a Text element with
  a scrolling Container, you'll scroll both the container
  and one line of the Text -- meaning, the first line
  of the Text field disappears! This is super funny.
  I found a blog post with a simple class that overrides
  Flex's Text class that fixes this... silly issue.
- Statewide updates:
  - I added all (of the overly loquacious) help text for
    the bike facilities (which you'll find in the map
    legend).
  - I renamed the bike facility classes and some of the
    lookup keys to reflect the changes what we decided
    at the MnDOT meeting a few weeks back.
  - I moved the checkbox-taggers to below the bike
    facilities and cautions dropdowns, removed the
    'unpaved' option, and added a few more. Now it's
    four checkboxes: Busy, Closed, Planned, Rumbles.
    - FIXME: The checkbox-taggers are not implemented;
      toggling the checkbox will eventually add or
      remove the corresponding tag.
Pyserver:
- A few problems when saving newly created or deleted
  link_values.
  - link_value.py missing one fcn. override, and also
    missing the last parm of another fcn. override.
- Bugfix: When making new items, checking stack_id < 0
  must also check stack_id is not None.
- Change SQLs' "AS foo" to a unique name for each call,
  to make debugging easier.
- Bugfix: Typo on SQL when fetching item_findability.
Wire the new bike facility skin styles into the mapserver mapfile.
 - Incorporates color and style changes decided at the recent
   MnDOT meeting.
 - This is obviously untested, 'natch, since the upgrade scripts
   are currently running on the production server and I'm scrambling
   to get all this awesome code out... so I expect to be checking
   in bugfixes to the mapfile once the check_cache_now.sh runs.

------------------------------------------------------------------------
r30624 | landonb | 2013-08-30 13:42:48 -0500 (Fri, 30 Aug 2013) | 1 line

Fix to track length calculation.
------------------------------------------------------------------------
r30623 | landonb | 2013-08-30 13:16:11 -0500 (Fri, 30 Aug 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r30622 | landonb | 2013-08-30 13:06:02 -0500 (Fri, 30 Aug 2013) | 115 lines

===========================
DEVS: Update your database:

 UPDATE item_findability SET library_squelch = library_squelch + 1;
===========================

- Lots of bugfixes to route_list and route_list_entry.
  - The route_list in the route library and the user's
    recent routes list was very much broken.
  - In CcpV1, each Route_List_Entry has a checkbox,
    a 'lookat' button, and a 'more' button. Toggling
    the checkbox shows or hides a route path on the map;
    using the 'lookat' button zooms and pans to the route,
    and the 'more' button changes the sole CcpV1 item details
    panel to the chosen route.
  - What's new in this revision:
    - The Panel_Routes_Box's Detail_Panel_Base (which owns the
      route library and the user's last viewed list) did not
      specify a shows_type, so Routes could not be attached
      to its selection set.
    - Clicking on a Route_List_Entry hydrates the route (loads
      its route_steps, route_stops, and link_values), zooms and
      pans to the route, and shows the route on the map.
      - In CcpV1, a random route visualization is chosen unless
        the user is logged in and their last-used-route-viz cookie
        is set.
        - Using a random visualization for anonymous users is
          confusing, since the user has to discover what the
          different colors mean. It makes more sense to just
          default to the boring, solid color visualization.
        - In CcpV2, we default to the 'normal', boring route
          visualization.
        - Since CcpV2 supports multiple panels, the user can open
          multiple routes simultaneously and choose different
          visualizations for each route, using the dropdown
          visualization widget on each route's panel.
          - On the map, the user will see unique visualizations for
            each route.
    - The 'lookat' button triggers a zoom and pan. I already had CcpV2
      working to ignore non-zoom zooms (i.e., if zoom-to and zoom-from are
      equal), but I guess I didn't do the same for pan. So clicking the
      'lookat' button was triggering a GWIS request and the 'Working...'
      throbberer was showing its face. So I fixed pan such that the map
      does a no-op if the pan's x and y deltas are both 0.
    - Added a double-click handler on Route_List_Entry that opens the route
      panel and selects the route.
      - Both click handlers now ignore clicks on the other widgets using a
        lookup of the widgets to ignore (i.e., the 'lookat' button, the
        show-on-map checkbox, etc.). Previously, the single click handler
        simply ignored the click if it was on a Button. Now we can ignore
        the 'locked' icon, the checkbox, and whatever other children we want.
      - I set the locked icon to not includeInLayout if it's not visible,
        which causes the origin-destination text to left-justify, which
        looks sooo much better.
    - Mouse-over and mouse-out are now utilized to highlight the route, which
      gives the one route that you're hovering over in the list to have a
      border around it on the map, making it distinguishable from the other
      routes.
      - You can also mouse-over routes when looking at another route's
        details panel, and the route under the mouse will be highlighted,
        and its route_stops drawn.
  - On the route details panel, unless you were in editing mode, the route
    visualization dropdown had no effect. This was also affecting the new
    mouse-over behavior in the route library.
    - For whatever reason, Route.as was only drawing the visualization if
      the client was in editing mode.
    - In CcpV1, there's one route visualization for all routes (whatever was
      last selected in the route details panel). Now, each route remembers its
      own route visualization, which is used to draw the route, regardless of
      editing mode.
    - (But we don't draw the draggable route stuff unless in editing mode...
       which we may have to rethink, since editing and saving routes is not
       what we mean by edit mode: routes are editable and saveable regardless
       of whether or not the user hits the 'Editing' button.)
  - Compilation was often failing because of spaghetti
    code in route_list_entry that referenced a long chain
    of objects, e.g., G.app.blah.blah.blah, I mean,
    G.app.routes_panel.routes_library.search_routes; I replaced
    this mechanism with an event that route_list dispatches,
    and on which the owning parent panel listens, and now compilation
    doesn't sometimes mysteriously fail on this code.
  - Fixed problem with route_stop labels being drawn beneath the route
    stop circle.
- After a great meeting with the client, I'm starting to implement
  some changes to the Bike Facility and Cautions widgets, and related
  widgets that the traffic planners will use.
  - I started adding help hints to each bike facility in the help panel
    in the map legend. We need it to be easy for editors to decide or
    to determine what bike facility to apply to road segments.
- Silly error: overriders of set_selected were not passing the
  third param, solo, to the super!
- Item_Versioned.rev_is_working now checks if Follow, so that
  Current is allowed, and not just Working, since even when
  editing, individual items generally use the Current rev.
- When changing a panel's items_selected, don't deselect items
  unless the panel is the active panel, otherwise the items are
  considered selected by the panel that's about to become the
  active panel.
  - Same goes for panel_selection_clear.
- The annotation widget autocomplete box was not populating and
  showing properly.
- Fix problem changing to historic or diff mode: disable the Editing
  button (otherwise, flashclient asserts if you click Editing
  while in historic mode).
  - Also cleanup History_Manager so it doesn't do anything more
    than just manage the hazy map border and the revision label.
- Fixes to getting new routes:
  - Enum-ified the library_squelch constants, so we can remove
    magic numbers from the code.
  - Fixed GWIS_Route_Get_New to lazy-load the route once it's fetched.
    - I fixed lazy-loading to wait on the item_stack and item_findability
      data first before firing the linksLoaded events, otherwise the route
      panel doesn't know enough about the route to decide to draw the
      save-route widgets.

------------------------------------------------------------------------
r30613 | landonb | 2013-08-21 16:45:17 -0500 (Wed, 21 Aug 2013) | 1 line

Wrap user_token_verify in transaction_retryable (I saw problems not being able to lock rows and not retrying immediately).
------------------------------------------------------------------------
r30612 | landonb | 2013-08-21 15:36:19 -0500 (Wed, 21 Aug 2013) | 1 line

Error handling error in route.py's steps_between.
------------------------------------------------------------------------
r30609 | landonb | 2013-08-21 14:10:27 -0500 (Wed, 21 Aug 2013) | 8 lines

Flashclient: Bugfix after non-revision changing commit
- E.g., setting item watcher.
Flashclient: Bugfix when setting items_selected, when
  it was initially null.
Flashclient: 'Create new attribute' was not being
  hidden for non-branch arbiters/owners.
Pyserver: Fix GPX XML (specifically, the namespaces).

------------------------------------------------------------------------
r30601 | landonb | 2013-08-21 00:37:14 -0500 (Wed, 21 Aug 2013) | 1 line

Tweak Makefile-new to better work with fcsh-wrap-new and Bash remake command.
------------------------------------------------------------------------
r30600 | landonb | 2013-08-20 21:39:17 -0500 (Tue, 20 Aug 2013) | 11 lines

 - Flashclient : After creating byway,
        bugfix   dragging vertex atop another line,
                 and making an intersection,
                 if you drag the other endpoint vertex,
                 null pointer referenced because the
                 node intersection detector isn't updated
                 until after items are deselected... so
                 check that byways returned by the node
                 detector are actually selected and are
                 actually valid node endpoints.

------------------------------------------------------------------------
r30598 | landonb | 2013-08-20 20:17:58 -0500 (Tue, 20 Aug 2013) | 7 lines

- Elaborate error message about finding routes with
  no route steps.
- Change error messages to info/debug messages for
  innocuous concurrent-update/retry-needed messages.
- Move all item_cache dictionaries to item_manager.
- Don't crash on db.close() if conn never existed.

------------------------------------------------------------------------
r30583 | landonb | 2013-08-19 15:32:55 -0500 (Mon, 19 Aug 2013) | 1 line

Bugfix to previous
------------------------------------------------------------------------
r30575 | landonb | 2013-08-16 11:25:22 -0500 (Fri, 16 Aug 2013) | 59 lines

- Bugfix (ug: _Major_ Bugfix): Wrong Client IDs issued during
  commit (or, rather, the same client ID being used for
  disparate items being saved).
  - pyserver's qb.item_mgr was starting with client ID
    -1, which is fine, except it wasn't being changed
    after loading items from the client. Since flashclient
    also sends client IDs, after pyserver's commit hydrates
    items from GML, it needs to reset item_mgr.next_client_id
    accordingly (i.e., to one less than the lowest client ID
    referenced in the GML).
- Branchy Bugfix: Unknown node_endpoint data being joined.
  - When fetching byways, we need to filter on the revision
    IDs (valid_start_rid and valid_until_rid) and the
    branch_id. The old code was loosely joining using just the
    stack ID of the nodes, so it was picking up node_endpoints
    of all versions and from all branches (albeit, sharing the
    same stack_id, but whatever, you don't know what record you
    get after the "select distinct" is applied).
- Branchy Bugfix: Incorrect byway_rating sent for branchy byways.
  - Ug, another tedious solution: We have to make rows in
    byway_rating in each branch for every byway in the parent
    branches.
    - See the new upgrade script, byway_ratings_populate.py.
  - This is similar to the node_endpoint problem: even though
    our branches are technically "stacked" branches -- meaning,
    we don't have to duplicate data in the branch that hasn't
    been modified, i.e., when you make a new branch, you don't
    clone a single byway -- we still have to make rows for
    every node_endpoint and every byway_rating...
- New flashclient widget for node endpoints.
  - Eventually, users will be able to edit node endpoints:
    - To change a node's elevation;
    - To look for and fix connectivity issues by examining
      dangles, and either marking the dangle "okay" (meaning,
      the dangle represents a dead-end in the network), or by
      fixing the dangle and connecting the node to the network.
    - But for now, the new widget is to help developers debug:
      - I've been using the widget to get at the node endpoint
        stack IDs, so I can poke around in the database and
        verify that data is being saved correctly... which is
        how I discovered some of the aforementioned bugs.
- In pyserver, generic_rating was being declared int, but it's real.
- Bugfix: flashclient was creating new stack_ids for every drag
          event. This was supposedly recently fixed... so maybe
          this is a regression.
  - move_do was not correctly resolving the vertex index when
    calling node_endpoint_update.
- Change lowest rating label from "impassable" to "avoid"...
  Let's think about this more, but impassable isn't a rating or
  sentiment, it's a fact; telling the system to avoid a segment
  makes more sense, I think.
- Add union() operator to Set_UUID.
- Bugfix/annoyance: when switching branches, flashclient was
  always warning you that there were unsaved changes, even when
  not.
- In pyserver, fixed some problems related to re-hydrating an
  item's link_values. Specifically, the new_item_cache was not
  being cleaned up when an item's link_values were overwritten.

------------------------------------------------------------------------
r30568 | landonb | 2013-08-14 12:03:11 -0500 (Wed, 14 Aug 2013) | 53 lines

- Bugix to newish schema upgrade scripts (it's been
  a while since the scripts have been run, since
  runic was offline for much of the summer...).
- Tweak gwis_error to not include None in the
  hint dictionary set (mostly cosmetic).
- Bugfix: Create a new byway, then split it and
  save it; pyserver does not expect a client ID as
  split_from_stack_id.
  - I fixed flashclient to not send client IDs as
    split-from IDs, and I fixed pyserver to not assert
    but to make a new gwis_error instead.
  - Bugfix: Fixed scope of return variable in commit's
    process_item_hydrated -- it was discovered by the
    previous error caused by client split_from_stack_id.
    The return value was being declared in if block, so
    the else path resulted in no defined return value...
- Bugfix: In flashclient, if you create a new byway,
  save it, then select it, flashclient would lazy-load
  the byway at the previous revision (i.e., one revision
  before the new revision at which the new byway was
  saved).
  - I changed the assert in access_style_results_load
    to log warnings and bail instead, if the server does
    not return an item_stack record.
  - When the Commit Command response is being processed,
    flashclient now bumps its rev_working to the latest
    revision.
    - If the difference in revisions is more than 1, it
      means there were other changes than just the user's
      commit. Since flashclient doesn't implement an Update
      revision, like pyserver, and using a Diff checkout
      to update flashclient's working checkout sounds like
      an unwired nightmare, I opted to force a full discard-
      and-reload if jumping more than just one revision.
- When making a new Command in flashclient, if the
  command detects a problem trying to initialize, it
  can mark itself pre-canceled, such that the caller
  can still try to execute the command and we'll just
  bark at the user.
  - I had a problem with Style Change being unset but
    being marked dirty, and Commit trying to add its
    XML subdoc. I fixed the Style Change problem (see
    next bugfix), but also made Commit more robust, so
    that now errors can be handled in the constructor.
- Bugfix: Differentiate between types of item cloning.
  - The same clone fcn. is being used to
    a) update items already in memory with the latest
       GML (XML) from the server; and
    b) make a new item by copying an existing item.
  - In the latter case, b), we shouldn't copy
    access_level_id, otherwise the grac_manager doesn't
    bother calculating and setting access_scope_id.

------------------------------------------------------------------------
r30563 | landonb | 2013-08-13 14:51:15 -0500 (Tue, 13 Aug 2013) | 27 lines

More Flashclient map editing bugfixes:
- When deleting geofeatures and attachments, do
  not also delete link_values (or make sure you
  re-add them when said items are un-deleted).
  - I went with the don't-delete option, to make
    it easy to fix, e.g., byway split undo: if
    you undo the split, the link_values were not
    re-added, so the undone byway was actually
    missing all of its link_values.
- If not loose_selection_set and reusing a details
  panel, make sure to de-select whatever items are
  not part of the new selection set before overwriting
  a panel's items_selected/feats_selected.
  - Otherwise, e.g., if you make an intersection, which
    selects two roads, and then split one of the roads,
    the non-split road remains selected on the map even
    though the item is no longer part of the details panel
    selection.
- Bug in Attribute.consensus: wasn't using on_empty when
  calling Attribute.consensus_one for second and subsequent
  items (so the consensus was sometimes null when multiple
  items were selected).
- Another fix to the advanced tool palette.
Pyserver bugfixes:
- Typo in commit.py when processing split byways.
- Send new max_rid in commit response.

------------------------------------------------------------------------
r30562 | landonb | 2013-08-12 14:42:31 -0500 (Mon, 12 Aug 2013) | 30 lines

- Fix regression: create a point, then create a byway,
  and the byway is added to the point panel.
- Fix CcpV1 editing tools behavioral problems:
  - When you open the dropdown, if you click on the map,
    the dropdown should close but the tool should not
    execute. E.g., if you have the create new point tool
    active and open the advanced tool dropdown, if you then
    click on the map, only the dropdown should close; a new
    point should not be created.
    - The same logic also applies if you open the dropdown
      and then click on Undo, Redo, Save Map, or Discard
      Changes.
  - The keyboard shortcuts for selecting tools was broken
    if the tool palette had focus. (Rather than letting the
    owning Combo_Box_V2 process the keypress, we need to have
    the map process the keypress.)
  - If you click on the already-selected tool in the advanced
    dropdown, that tool was not being activated, e.g., if you
    had the pan tool active and choose whatever was selected
    in the dropdown, the active tool was not changed to the
    chosen advanced tool.
  - While you could use the Tab key to find the dropdown, and
    you could use the up and down arrows to change the selected
    item in the list of advanced tools, there was no way to
    activate the selected tool. Now you can press space to
    activate the tool, just like you can do if you tab to
    the pan-select or new-point tool.
- Fix error in Combo_Box_V2: internal_dropdown_factory.properties
  were being inadvertently overwritten.

------------------------------------------------------------------------
r30557 | landonb | 2013-08-09 13:26:48 -0500 (Fri, 09 Aug 2013) | 45 lines

- Bug 2806: Flashclient: Purple highlight disappears
                         when dragging vertex
  Thanks for the bugfix, Stephanie!
    http://bugs.cyclopath.org/show_bug.cgi?id=2806
- I also fixed Byway_Vertex_Move not to select all
  byways being edited. E.g., if you have one byway
  selected and then drag an intersection, the tool
  should not select all the other byways attached
  to that intersection.
- New Region Tool was crashing; it's on_mouse_down now
  reads pretty much like the new point tool's, and some-
  what like the new byway tool's.
  - Also fixed CcpV1 Bug 1736, which indicates that the
    new region tool does not work like the new point
    and new byway tool because new regions cannot
    be dragged. Now new regions can be dragged while
    the mouse is held down.
    http://bugs.cyclopath.org/show_bug.cgi?id=1736
- Branch panel was asserting when showing because
  of over-assertive behaviour in Branch.set_selected.
- On branch change, with unsaved changes, user was
  not being asked to save (and dirty items were
  correctly triggering an assert in item_discard).
- Silly error swiching modes with no tags selected,
  and Widget_Tag_List.repopulate failing.
- For the custom attr widgets, Bike Facility and Bike
  Caution, if the default value is not set and editing
  mode is not enabled, the widget is now hidden.
- Fix Attribute-Link_Value edit control (the one
  on the attribute list with the edit text box,
  e.g., Bicycle Route Name).
  - The text field was incorrectly wired to the
    set of selected geofeatures, but we really
    need a set of link_values (and we make new
    link_values as needed).
  - The Text_Field_Editable class needs to supply
    the command object with the old text and a handle
    to itself so that undo/redo work right (so that,
    e.g., on undo and redo, the text in the edit
    field changes).
- Add a new topic to the map legend: editing hints.
  - Even I didn't remember how to test Vertex_Delete
    (hint: select a vertex with your mouse and then
     use the backspace or delete key on your keyboard).

------------------------------------------------------------------------
r30552 | landonb | 2013-08-08 02:21:41 -0500 (Thu, 08 Aug 2013) | 94 lines


DEVS: I edited a schema script; you can wait for the next db,
      or you can run, e.g.:
  psql -U cycling ccpv3_demo < scripts/schema/209-geofeat_lyr_majortrail.sql

Flashclient details panel flicker problem:
  - For a number of the widgets, I added listeners on
  selectedsetChanged so that widgets don't have to
  blindly reset themselves whenever repopulate is
  called.
  - This fixes a problem, e.g., when you edit an
  item on the details panel, _all_ widgets temporarily
  disappear and then reappear. This is very annoying
  if you're editing one of the attribute steppers,
  because it disappears, the vertical scroll bar
  disappears, and then everything is redrawn.
Map editing fixes:
- Fix Flashclient undo/redo problem maintaining dirty
  flags. Command_Base was only remembering one dirty flag,
  but it should remember all flags for each item (I saw a
  problem with Dirty_Reason.item_schg being forgotten).
- Deprecate group_item_access.item_layer, which is
  not used by any features (the value is not maintained
  by group_item_access so I removed it from the table).
Add new tag problems:
- If you undo the new tag, you cannot re-add the same
  tag, because the item.tagged lookup still contained
  the tag.
  - The solution was more general: I fixed a problem
    when deleting link_values, so that an item's tagged
    and attrs get updated.
- When you add a new tag, the tag was not being added
  to the autocomplete list. So, e.g., if I wanted to
  add the tag to another geofeature I selected, I'd
  have to re-type it since it wouldn't show up in the
  list.
- On undo, then redo, was not un-deleting the
  attachment, so the tag was not getting applied
  (since the link_value couldn't find the attachment).
Flashclient issues logging on and off:
- When you log on, there were errors due to trying
  to preserve edited items (on log on, you can
  keep your edits without having to save; on log
  out, you have to save or discard before logging
  off).
- Also when you log on, all item panels were being
  closed and then the recent changes was being
  activated.
  - I changed it so that the find route panel is
    activated instead, which feels a lot more
    natural (it's the first panel you see when
    you log on, duh).
  - I also did something neat: if you have an item
    or items selected with you log on, those item(s)
    are re-selected, which creates, populates, and
    activates the item's panel.
    - This actually only works for selected geofeatures
      in the viewport; we could open a Bug nnnn for when
      items are not loaded automatically (so, on log on,
      we checkout stack IDs of the items that were selected,
      since, e.g., notes are only loaded when a geofeature
      to which they're attached is selected), and we could
      also maybe preserve other item tabs that were open.
      But that seems like a lot of work for very little
      benefit...
Pyserver and script fixes:
- Pyserver bug: not setting access_style_id correctly.
  - When an anoymous user saved a pub_choice item or a
    logged on user saved a usr_choice item, pyserver
    was not changing access_style_id from *_choice to
    *_editor... so the wrong access_style_id value was
    saved in item_stack. (The problem manifested itself
    in flashclient, as I noticed I could not delete
    new items that I had created, but I could edit
    them!)
- Pyserver bug: when deleting an item, if item was
  already deleted or cannot be found, don't keep
  running the delete fcn. I made commit.py's
  process_item_hydrated return a success bool so
  mark_deleted can short circuit.
  - I also fixed the ordering of deleting the geofeature
    and its link_values -- you cannot delete the geofeature
    until after you delete the links, otherwise the links
    are confused because the geofeature is already deleted.
- Update emails_for_spam.py to ref. correct ccpdev location.
- Update emails_for_spam.py to look for and to cull duplicate
  user IDs (so we don't email the same person multiple times!).
- Fix minimum value of /byway/shoulder_width, which should be
  0, not -1 (unless -1 was suppose to mean something special...).
- Set custom-control bit for un-implemented attrs so they don't
  show up in the byway attributes list (/byway/cycle_route and
  /byway/no_access).
- Add 'Alley' byway layer type.

------------------------------------------------------------------------
r30547 | landonb | 2013-08-06 12:02:21 -0500 (Tue, 06 Aug 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r30546 | landonb | 2013-08-06 11:30:45 -0500 (Tue, 06 Aug 2013) | 20 lines

- Fix Flashclient undo/redo problem maintaining dirty
  flags. Command_Base was only remembering one dirty flag,
  but it should remember all flags for each item (I saw a
  problem with Dirty_Reason.item_schg being forgotten).
- Deprecate group_item_access.item_layer, which is
  not used by any features (the value is not maintained
  by group_item_access so I removed it from the table).
- Pyserver bug: commit was not getting the split-from
  link_values for the second and subsequent split-intos
  being processed (so all but one split-from was getting
  the right link_values cloned).
- Pyserver bug: delete was not loading all of an item's
  link_values correctly (since all link_values also have
  to be deleted).
  - One problem was link_value extra where clause was
    always checking group stack IDs, but we want a
    userless fetch, i.e., all link_values, regardless
    of permissions.
- Update emails_for_spam.py to ref. correct ccpdev location.

------------------------------------------------------------------------
r30537 | landonb | 2013-08-05 10:37:42 -0500 (Mon, 05 Aug 2013) | 1 line

Thanks, Fernando: found two iteritems() in commit that should be itervalues() (called when deleting items).
------------------------------------------------------------------------
r30533 | landonb | 2013-08-02 23:37:51 -0500 (Fri, 02 Aug 2013) | 51 lines

More flashclient map editing bug fixes:
- The mouse listeners for new byways were not being added
  correctly (so, e.g., mouse-over did not trigger connectivity
  highlights). I moved the addEventListener from the Geofeature's
  constructor to the init_add fcn., so that an item can be removed
  from the map but also re-added later (which is how commands' undoes
  and redoes work).
- Each item's 'set deleted' used to remove the item
  from the class's .all lookup, but that's no longer
  the case: the item_cleanup fcn. (called via item_discard)
  should handle the .all lookup (like how init_add handles
  adding items to the lookup); set deleted is only about
  the map's deletedset, and isn't about the item lookups.
- On init_add, check if item was previously added.
- During do/undo command stack walking, some commands
  were leaving byway vertices selected on the map,
  sometimes without even a byway to go along with 
  the vertices. Turns out the Geofeature fcn. to
  enable vertices was blindly overwriting the existing
  vertices collection, so we were orphaning vertices on
  the map.
  - I also hardened vertex_init to call vertex_unit if
    it is about to overwrite an existing vertex (though
    this step is redundant if vertices_activate does its
    job).
- Make sure new ('invalid') Geofeatures (whose stack_ids
  are 0) get discarded from the map prior to being assigned
  client stack_ids, otherwise their goo is leftover in the
  item class lookups and confusion ensues.
- Fix yet another problem making new itersection: after
  undo or redo, not all the byways that should be selected
  were selected, and there were remnants of deleted byways,
  or byways were drawn without their wide roadway sprites
  but instead just the thin blue centerlines.
- For Vertex_Move command, I had previously modified it
  to maintain a loose selection set, but on undo and redo,
  the selection set should be strictly the byway that was
  moved (otherwise it seems silly to keep other byways
  selected, because it's not obvious what undo/redo did)
  so I modified Command_Base.activate_appropriate_panel
  to accept a Boolean, loose_selection_set, to override the
  class's value (so the class's loose_selection_set value
  really applies for the first do_, but it can be
  overridden for undo and redo).
- The Detail_Panel_Base class now does a better job cleaning
  up a closed panel: it actively clears its selection set
  (so that the items can nullify their pointers to the panel),
  it resets Panel_Manager's panel_stack_prev_eap if it points
  to the panel being removed from the ViewStack, and it also
  resets effectively_active_panel if it was that, as well.

------------------------------------------------------------------------
r30532 | landonb | 2013-08-02 16:59:31 -0500 (Fri, 02 Aug 2013) | 1 line

Bug saving new track: using incorrect bitmasks when validating 'schg' value.
------------------------------------------------------------------------
r30531 | landonb | 2013-08-02 15:00:59 -0500 (Fri, 02 Aug 2013) | 1 line

Typo in item_user_access.py: use self.valid, not item.valid.
------------------------------------------------------------------------
r30529 | landonb | 2013-08-02 10:04:07 -0500 (Fri, 02 Aug 2013) | 25 lines

Flashclient map editing bugs fixed:
- On new byway, original position of byway contained phantom
  highlight. E.g., just pressing the Ctrl key all alone, regardless
  of where the mouse is, would cause a green highlight to mystically
  appear wherever the new byway had first been laid. This is because
  prepare_item was being called and changed the item's stack
  ID from 0 to a valid client ID, and so the last highlight
  gets left in the highlight set.
- Assert on panel closing when ripe panel found for solo item;
  I fixed the fcn. to handle panels being closed and to salvage
  them if possible (if the selection set is comparable, otherwise
  we use a new panel).
- False loop inconsistency because new byway, when vertex is
  dragged, has same node IDs for both endpoints.
- Fix problem not resuing geofeature panel appropriately when
  old geofeature panel being closed has zero items in it.
- On Vertex move, recycle client stack IDs. This makes debugging
  easier, otherwise the vertex client stack ID keeps changing
  with every on_drag.
- On new intersection, if a T-intersection and a small byway was
  created and then deleted, we were accidentally still selecting
  the deleted byway (so, e.g., the details panel would indicate
  four items selected rather than three, and there'd be a phantom
  vertex on the map).

------------------------------------------------------------------------
r30527 | landonb | 2013-08-01 12:17:03 -0500 (Thu, 01 Aug 2013) | 18 lines

Change Item_Versioned's "function set selected"
  to "function set_selected" so we can pass additional
  parameters.
  - The fcn. needs to know if, on deselect, an item should
    just be removed from the map or also from the panel
    selection set. And on select, the pan-select tool can
    tell the object if it should use a new panel or try to
    add itself to the current panel (historically, this code
    was confusing, because Geofeature had to infer this info.).
  - I also added a selection_panel reference from Geofeature
    to the panel associated with its map selection. A Geofeature
    can belong to more than one panel's selection set, but there's
    only ever one panel that it belongs to that represents its
    selection on the map.
Fix incorrect pyserver assert when link_values not found for an item
  being heavyweight loaded (i.e., when user selects item on map
  and flashclient lazy-loads the fully hydrated item).

------------------------------------------------------------------------
r30525 | landonb | 2013-07-31 11:17:43 -0500 (Wed, 31 Jul 2013) | 1 line

On items_deselect_add, force_reset should also clear panel_close_pending.
------------------------------------------------------------------------
r30524 | landonb | 2013-07-31 11:01:48 -0500 (Wed, 31 Jul 2013) | 22 lines

* Mild overhaul of Geofeature's set selected,
  to help figure out correct panel for do/undo/redo
  commands.
  - See also Geofeature.panel_get_for_geofeatures,
    which replaces get_panel_for_single_item.
    The idea is that we want to find a panel for
    one or more geofeatures that are being edited,
    or create a new panel if an existing one cannot
    be found. For existing panels, we may or may not
    care if a panel's selection set exactly matches
    the set of geofeatures being edited, or if the
    selection set can just be a superset of the edited
    set. The latter matters, e.g., when you're dragging
    one vertex of a byway but there are additional byways
    selected. The former matters -- the desired panel should
    have exactly those geofeatures selected -- for, e.g.,
    link_value editing commands (like change attribute, or
    add/remove tag, etc.).
  - I similarly fixed Command_Base.activate_appropriate_panel,
    so it's much smarter about finding or making panels for
    commands.

------------------------------------------------------------------------
r30519 | landonb | 2013-07-30 13:13:47 -0500 (Tue, 30 Jul 2013) | 1 line

Conflation work item bug fixes from br/torre_landmarks.
------------------------------------------------------------------------
r30517 | landonb | 2013-07-30 11:15:50 -0500 (Tue, 30 Jul 2013) | 28 lines

* Fix Byway_Merge so it activates appropriate panel on do/undo.
* Fix Byway_Merge so it calls items_add with unique Array, since
  items_add removes elements... (also did the same for Byway_Split).
* Fix problem with second details panel appearing for same item type
  (get rid of Command_Base.cmd_item_panel, which no longer works
   well because we can reuse panels now, unless we maintained the
   pointer from the command object to the panel, but it's easier
   to remove the pointer and just use edit_items to find a suitable
   panel for the command).
* Remove item.dpanel (just use Geofeature.get_panel_for_single_item
  or Attachment.attachment_panel)
* Detail_Panel_Base.items_deselect_all now accepts an item as a
  parameter and won't deselect that item. This fixes a problem
  clicking a vertex of a byway and dragging it (since the vertex
  is selected before the panel is cleared, and it seems easier
  to not de-select an item rather than to remember which vertex
  to re-select later; savvy?).
* No need for a command to change panels if all the items in a
  command are already selected (the "aha!" for this bug is that
  there might be additional items also selected, but we don't
  want to disrupt what the user has selected, e.g., consider
  having two byways selected and wanting to drag a vertex of
  one of the byways, and how annoying it would be if we changed
  the active panel selection to just the byway whose vertex is
  being dragged; if I was a user, I'd be annoyed that the other
  byway was needlessly deselected, and that I had to actively
  reselect it ("how dare you waste my precious mouse clicks!")).

------------------------------------------------------------------------
r30514 | landonb | 2013-07-29 13:43:22 -0500 (Mon, 29 Jul 2013) | 4 lines

When changing app mode, redraw selected geofeatures
  (e.g., so selected byway vertices are drawn/undrawn).
Fix to Byway merge: was not merging byways in correct order.

------------------------------------------------------------------------
r30513 | landonb | 2013-07-29 12:16:35 -0500 (Mon, 29 Jul 2013) | 11 lines

Regression: stranded_link_values is Set_UUID, so must
  use, e.g., this.stranded_link_values.is_member(this)
  rather than, (this in this.stranded_link_values).
  - This fixes problem to copying link_values when 
    splitting byways.
Switch to pan tool after using split-byway or add vertex.
When reclaiming geofeature panel, be sure to empty its
  feats_selected (otherwise, e.g., the delete split-from
  byway is still part of the selection set (and though
  you can't see it, the panel counts it)).

------------------------------------------------------------------------
r30512 | landonb | 2013-07-29 09:01:53 -0500 (Mon, 29 Jul 2013) | 11 lines

* Fixes to make-intersection and byway split cmds.
  - Now all new byways are selected after do_(),
    instead of just the last byway's, and undo
    works.
* Better panel management infrastructure for
  doing and undoing commands (new Command_Base fcns.
  activate_panel_do_ and activate_panel_undo).
* When two or more items are selected, single-clicking
  a selected item should select just that item, rather
  than doing nothing.

------------------------------------------------------------------------
r30510 | landonb | 2013-07-26 16:07:36 -0500 (Fri, 26 Jul 2013) | 1 line

Convert Conf_Instance opt. back to Conf. (so DEVs don't have to edit Conf_Instance.as).
------------------------------------------------------------------------
r30509 | landonb | 2013-07-26 16:00:00 -0500 (Fri, 26 Jul 2013) | 1 line

Convert Conf_Instance opt. back to Conf. (so DEVs don't have to edit Conf_Instance.as).
------------------------------------------------------------------------
r30508 | landonb | 2013-07-26 15:57:48 -0500 (Fri, 26 Jul 2013) | 1 line

Server-side fixes for previous. Minor fixes to commit for processing split items.
------------------------------------------------------------------------
r30507 | landonb | 2013-07-26 15:54:05 -0500 (Fri, 26 Jul 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r30506 | landonb | 2013-07-26 15:50:27 -0500 (Fri, 26 Jul 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r30505 | landonb | 2013-07-26 15:46:46 -0500 (Fri, 26 Jul 2013) | 26 lines

* Bug 2808 - Flashclient: Regression: Cannot drag new point
* Change assertions to soft assertions in item classes'
  init_update() when items don't exist.
* When clicking on the map, a Terrain does not count as an
  item, since it has no panel (yet).
* attachment_mode_stop should not always reset the active
  tool, i.e., when creating a new point on the map.
* New doubly-linked list of panels that the user has visited,
  i.e., each panel has a pointer to the last and next panels.
  The pointers are maintained as the user switches panels,
  closes panels, selects items on the map, performs commands,
  uses undo/redo, etc.
* Restrict number of detail panels to one per item type.
* Clicking on the map no longer deselects selected items,
  since that behavior is confusing and possible responses
  to that action are imperfect (e.g., do you close the
  panel, since you've deselected all items, or do you
  switch to the find-route panel? both seem awkward, but
  you can't just empty the details panel, so it makes
  sense to not respond to "mouse clicks on nothing".
* Fix problems removing empty item detail panels
  (they were sometimes being re-activated, albeit with
  an empty selection set).
* Miscellaneous fixes to split byway, make intersection,
  and other commands, but I still have more testing...

------------------------------------------------------------------------
r30503 | landonb | 2013-07-26 12:37:20 -0500 (Fri, 26 Jul 2013) | 4 lines

Bug 2807 - Flashclient: Set.as primitive class should use UUID keys
DEVS: This revision is most likely broken;
      this is the first of a multi-part checkin.

------------------------------------------------------------------------
r30475 | landonb | 2013-07-17 16:01:41 -0500 (Wed, 17 Jul 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r30474 | landonb | 2013-07-17 15:16:49 -0500 (Wed, 17 Jul 2013) | 72 lines

Bug 2804: Map Editing and Item Saving: Many Bugs
* Flashclient split byway
  - Split a byway, then join the split segments, then save.
  - pyserver has multiple bugs.
  - flashclient has multiple bugs.
    - on commit response, process "deleted freshies",
      i.e., in the bug example, the two split segments
      are fresh (new) byways that were marked deleted
      when they were joined, so they weren't sent to
      pyserver on commit. But when the commit is complete,
      we have to cleanup these items and delete their
      commands.
    - When splitting, recycle the active panel if it's
      for the byway being split (which is also being
      deleted).
      - This was a bit tricky, so I hope the Geofeature
        set selected function isn't too broken. :/
* Flashclient join byways:
  - In CcpV1, you merged byways into an existing byway,
    and it worked by taking one of the byways being
    joined, merging the others into it one by one,
    and then deleting all the other byways except for
    the one merged into.
    But this is prone to error, and it's not conceptually
    representative of what's happening, i.e., existing
    line segments are all being deleted and being replaced
    by a new line segment (rather than one of the line
    segments being arbitrarily chosed to "grow" into
    the new shape).
    So Byway.merge is replaced by Byway.join_byways
    which takes an array of byways and returns a new
    byway.
    - The new command also merges all of the joinees'
      link_values. The link_values are merged in the
      order that the byways were selected, so if two
      byways have the same link_value but with different
      values, only the byway that was selected earlier
      by the user has its link_value copied to the
      new byway. (See: Detail_Panel_Base.feats_ordered)
* Flashclient Misc:
  - Close detail panel if it no longer has items_selected.
* Pyserver:
  - Item_Manager wasn't loading link_value groups_access
    when asked to load heavyweight byways.
  - Pyserver wasn't handling the deleted split-from from
    the client (it was returning a GWIS error, but the
    client should be okay to send the byway being deleted).
  - The commit command now processes deleted items
    separately.
    - It wasn't making a new version of the item to mark
      deleted!
      - So now we make new versions of the item and all
        of its link_values and then UPDATE all the new
        rows and mark them all deleted.
        - It's tedious, I believe you! We're talking
          group_item_access records for the item and
          all of its link_values, too. So it's a lot
          of recursive code, and it's a lot of work
          to manually inspect the database to make
          sure the code is working well.
Pyserver Miscellaneous:
* From CcpV1, Bug 2803: Make transaction_retryable backoff
  - When retrying a concurrent transaction, pyserver
    now just tries at most three times (not five)
    and sleeps around 1/20th second between tries.
* In finalize_last_version_at_revision, only update records
  with valid_until_rid == conf.rid_inf, since you can change
  group_item_access records without changing an item version,
  i.e., multiple group_item_access records use the same item_id
  but have different valid_until_rids (and UPDATE was failing
  because it was causing a constraint failure).

------------------------------------------------------------------------
r30460 | landonb | 2013-07-10 12:55:36 -0500 (Wed, 10 Jul 2013) | 1 line

Don't restart apache from scripts/maint.sh, just reload it.
------------------------------------------------------------------------
r30435 | landonb | 2013-07-09 14:48:34 -0500 (Tue, 09 Jul 2013) | 11 lines

- Bug 2796 - Production failure: pyserver dies: OperationalError:
             FATAL: connection limit exceeded for non-superusers
  - Use PgBouncer for database connection pooling.
  - DEVS: Install PgBouncer to use PgBouncer.
           See scripts/setupcp/runic/auto_install/etc_overlay.sh
  (from CcpV1; I've never seen it happen in CcpV2 -- but we
   should definitely be using a database connection pool, i.e.,
   we need PgBouncer, anyway).
- Bug 2797 - Pyserver: Missing payload triggers AttributeError
  (from CcpV1; I've never seen it happen in CcpV2).

------------------------------------------------------------------------
r30416 | landonb | 2013-07-03 01:13:37 -0500 (Wed, 03 Jul 2013) | 7 lines

More editing fixes:
- Byway splitting, on the byway line segment and not on an existing vertex.
- Byway splitting, on an existing vertex.
- Create intersection, on existing and overlapping byways.
- Create new region and drag it around before releasing mouse.
- Add new vertex to region and drag it.

------------------------------------------------------------------------
r30415 | landonb | 2013-07-02 23:03:44 -0500 (Tue, 02 Jul 2013) | 1 line

De-m4_TALKY-fy R_Tree.as
------------------------------------------------------------------------
r30414 | landonb | 2013-07-02 22:55:38 -0500 (Tue, 02 Jul 2013) | 24 lines

Lots of editing fixes:
- Connect endpoint to middle of existing block
  and make an intersection
  - I.e., Byway Split, followed by New Intersection
  - The code lazy-loads the block being split because
    it might not have been selected by the user yet,
    and we need its link_values to make the split.
    - BUG nnnn: TEST: Pull the network cable and
      then test the command. I'm wondering how well
      we handle a failed lazy-load...
- Vertex Add works again.
Though not everything is refined:
- After Vertex Add, that tool remains selected, so
  user has to select select/pan tool to move vertex
  (but maybe that's working-as-designed? I think it
  might do this in CcpV1 but I'd think it's backwards).
- BUG nnnn/regression: I think I broke the Create
  Region tool (though Create Byway and Create Point work).
- BUG nnnn/regression: The Split Byway tool acts
  just like the Add Vertex tool and doesn't actually
  split the byways.
  - Which is funny since the Byway Split/New Intersection
    two-in-one-command works.

------------------------------------------------------------------------
r30413 | landonb | 2013-07-02 21:04:52 -0500 (Tue, 02 Jul 2013) | 1 line

Fix to pdf-printer (missing imports from previous checkin).
------------------------------------------------------------------------
r30412 | landonb | 2013-07-02 20:59:04 -0500 (Tue, 02 Jul 2013) | 8 lines

Fixes to item editing:
- G.map.cm.do_ now lazy-loads items that are not hydrated.
- There are still more editing bugs but I'm making progress...
Miscellaneous:
- Fix get hydrated: it should test invalid instead of fresh.
- Fix get links_lazy_loaded: fresh geofeatures now say true.
- G.map.cm.do_ is now a :void fcn.

------------------------------------------------------------------------
r30411 | landonb | 2013-07-02 20:36:06 -0500 (Tue, 02 Jul 2013) | 31 lines

Bug 2795: Flashclient: 'make' often fails
- The first time I run 'make', it usually fails, and
    I have to run it once or twice more.
  Sometimes after editing source code files, running
    'make' will fail so many times in a row that I give
    up, kill fcsh, make clean, and try again (where 'so
    many times' is at most six retries before I give up).
  I wondered if maybe this was because each of our source
    code modules import packages rather than specific modules,
  e.g.,

   import utils.misc.*;

  instead of

   import utils.misc.Logging;

  The problem is that a change to any module in a package
    causes any file that imports the package to be recompiled.
    So, e.g., editing utils.misc.Set causes any module that
    imports utils.misc.* to need a recompile.
  And oftentimes, this leads to circular references or
    something just as bad, and 'make' fails.
  Also, editing one file sometimes causes scores of other files
    to be rebuilt. I noticed after fixing this bug that many
    modules, when edited, no longer cause a ton of other modules
    to be recompiled.
  Ug! This took six hours and over 1200 'import ...' statements
  were edited. But compilation is remarkably and rather markedly
  faster!! Hooray!

------------------------------------------------------------------------
r30393 | landonb | 2013-06-27 13:58:45 -0500 (Thu, 27 Jun 2013) | 145 lines

Big Changes:
- Finally using the latest, greatest and *last* Flex 3
  SDK, 3.6a. Except for a one-line change in fcsh-wrap
  (which checks which SDK we're using and complains if
  it differs from expected), everything seems to work
  peachy.

Auto_install:
- Install 3.6a Flex SDK instead of 3.4a.
- Some scripts now work on Fedora in addition to Ubuntu;
  e.g., gis_compile.sh.
  - Also, bash_base updated to work on Fedora
    - E.g., need to use ifconfig instead of host, and even
    then, sed works differently for me on the two distros.
    I have to escape regex control chars in one distro
    but not for t'other... though I'm sure there's a way
    to fix this: e.g.,
          sed "s/.*inet addr:([.0-9]+).*/\1/"
      vs. sed "s/.*inet addr:\([.0-9]\+\).*/\1/"
- You can install offline/locally by not specifying the 
  host machine and target user, e.g.,
    ./ccp_install.sh - -

Skins file:
- Fix computing key_rank (we need to reset it between each
  set of pen definitions, so key_rank starts appropriately
  at 0 for each distinct pen set).
- Move the "cautionary" bike facilities into their own
  pen set, so we can remove these non-facilities from
  the facility dropdown (and now you can say that a
  road has both a facility and a caution).
- Sort pen keys by rank rather than alphabetically so that
  the GUI client shows options in the same order as they're
  defined by the DEVs in the skin file.

Add "Bicycle Caution" attribute.
- E.g., Difficult Connection, Use Extra Caution,
        and Limited Visibility.

Fix problem centering map on boot with corrupt flash cookies
  (somehow my x,y cookies were corrupted and on boot the map
  wouldn't load properly).
- Rather than just using the x,y cookies, we verify their
  values first and reset them if they're inappropriate.

Fix the zoombar.
- Make the raster level ticks more noticeable (even I can
  barely tell the difference between raster and tile ticks
  in CcpV1, so I added a little green highlight to the raster
  ticks to mean that those zoom levels are interactive; I
  also added a crude toolTip).
- Tweak the map widget glow so that the zoombar and scale
  widget are more readable -- the contrast in CcpV1 is so
  subtle that the zoombar tick marks and the scalebar tend
  to blend into the map. I added a tiny extra glow with a
  little alpha, so there's the original opaque white glow
  and then an extra pixel or two of 0.6 alpha white.

I started to replace package-level imports with just
  module imports.
- This reduces rebuild time, since a package-level import
  means a module is considered dirty and recompiled whenever
  any module in the imported package is changed.
  - E.g., the difference between
           import utils.misc.*;
          and
           import utils.misc.Logging;
    is that, for the former, whenever any file in utils/misc/
    is edited, any module including that package has to recompiled,
    whereas if a module only included the modules it actually
    used, then it's only recompiled when just those modules are
    touched and not whenever any module in the package is touched.
- FIXME: Continue reworking the imports to get rid of .* imports.
  - [lb] thinks this might be causing the problem where 'make'
    always fails the first time and I have to run it a second
    or third time to get all of flashclient to compile (which
    is stupidly tedious and frustrating).

New "alert box"ish components for the new site.
- One system-wide alert sits below the Cyclopath header (search
  bar, Cycloplan logo, et al), and the other alert sits below
  the map toolbar
  - The system-wide alert can show messages from the system, e.g.,
    when we want to take the system offline for maintenance, we
    can send a message to clients first to give users a warning
    that the site is going offline soon (currently, we send a
    Tweet, but really we need to do in-application alerting).
  - The map-wide alert is used to indicate when Cyclopath is in
    read-only node.
  - Both alerts can be dismissed by the user and will fade away
    and disappear.

Implement the Bike Facility Key for the Map Legend.
- Sorry, Stephanie, it was easy to do and we need to get all
  view-mode features complete.

Editing fixes:
- Undo was failing to undo new item create when trying to
  return to a panel that had since been closed.
  - I had to teach undo to differentiate between commands
    that create new items (and thus new panels) and those
    that edit existing items, because for existing items,
    we can always resurrect the item panel if it was closed,
    but when undoing an operation that created a new item
    which created a new panel, it's ambiguous as to which
    panel to show after the undo (since it would be silly
    to show the item panel for an item that doesn't exist).
- Add 'dangle' concept: A byway knows one of its end vertices
  is a dangle if there are no other byways in the adjacency
  lookup.
  - For dangle vertices, we color the square vertex red to
    indicate that it doesn't connect to the network.
- I recently added double-click to vertices to toggle sticky
  connectivity. Now, I change the vertex color depending on
  the setting -- one color to indicate that if the user drags
  the vertex, s/he will break the intersection, and another
  color to indicate that if the user drags the vertex, then
  the whole intersection moves with it.

Little stuff:
- Cleanup the Map Legend panels (common header formatting;
  put content in boxes with one pixel borders).
- Add a little highlight to the map legend key.
- Make the mouse cursor a finger-pointing-hand cursor when
  over the Map Legend button so users know to click it
  to expand/contract the map key (I saw an agency user
  struggle to figure out how to dismiss the map key).
- Add the "controlled access" visualization to the map
  key (e.g., roads with a one pixel red line down the
  center are roads that do not allow bicycle traffic).
- Add a little hint to the bikeability ratings key to
  help people understand the "yours" vs. "ours" distinction.
- To Item Type widget, for Byways, I added two checkboxes
  that will eventually (ahem, FIXME) be implemented and wired
  to the two tags, "Busy" and "Unpaved", since these two
  attributes and very important to planners and cyclists
  (and there's no reason, as a Geowiki, to not enforce at
  least a little standardization of tags, i.e., our users
  already use either "bikelane" or "bike lane" but really
  we should just say, hey, it's called "bikelane" and then
  convert all "bike lane"s to "bikelane".
- Floating tool palette needs to intercept mouse down to
  call stopPropagation so global catcher doesn't clear
  focus.

------------------------------------------------------------------------
r30382 | landonb | 2013-06-24 13:21:58 -0500 (Mon, 24 Jun 2013) | 1 line

Typo in pyserver on save: access_style_id, not just access_style.
------------------------------------------------------------------------
r30381 | landonb | 2013-06-24 12:11:24 -0500 (Mon, 24 Jun 2013) | 1 line

Regression: Fetching saved route. Too many args in string interpolation.
------------------------------------------------------------------------
r30380 | landonb | 2013-06-24 11:57:16 -0500 (Mon, 24 Jun 2013) | 1 line

Make sure make always runs with bash.
------------------------------------------------------------------------
r30379 | landonb | 2013-06-24 11:52:09 -0500 (Mon, 24 Jun 2013) | 6 lines

Regression: Find route in client because of recent
 fixes to clone_ and clone_id.

Fixed: Testing gwis via wget failing without session
 ID because wrong uuid fcn. being called.

------------------------------------------------------------------------
r30365 | landonb | 2013-06-14 23:58:08 -0500 (Fri, 14 Jun 2013) | 1 line

Fix for routed p2 (multimodal route planner); the interface differed from p1, and caller was calling solve() and not solve(qb).
------------------------------------------------------------------------
r30364 | landonb | 2013-06-14 20:55:19 -0500 (Fri, 14 Jun 2013) | 1 line

commit should not care about wiki_item_count if no changenote, in case it is a work_item (nonwiki_item) commit.
------------------------------------------------------------------------
r30363 | landonb | 2013-06-14 20:54:54 -0500 (Fri, 14 Jun 2013) | 1 line

Typo in item_manager
------------------------------------------------------------------------
r30360 | landonb | 2013-06-14 14:06:13 -0500 (Fri, 14 Jun 2013) | 1 line

Fix node_endpoint to not use item_stack.
------------------------------------------------------------------------
r30359 | landonb | 2013-06-14 12:48:02 -0500 (Fri, 14 Jun 2013) | 1 line

Regression: gml_consume should make Array()s that constructor no longer does.
------------------------------------------------------------------------
r30358 | landonb | 2013-06-14 10:47:46 -0500 (Fri, 14 Jun 2013) | 1 line

Typos in bikeways_skin.py.
------------------------------------------------------------------------
r30357 | landonb | 2013-06-14 10:44:59 -0500 (Fri, 14 Jun 2013) | 1 line

Typo in apache2sql.
------------------------------------------------------------------------
r30355 | landonb | 2013-06-13 22:46:44 -0500 (Thu, 13 Jun 2013) | 1 line

The permissions_free classes should not make item_stack records.
------------------------------------------------------------------------
r30350 | landonb | 2013-06-13 12:50:58 -0500 (Thu, 13 Jun 2013) | 1 line

Selected item(s) name(s) were not appearing unless Conf_Instance debug_items_show_stack_ids was true, which it is not by default. Funny: we were listening for resize events on the debug stack ID label widget, instead of the name label widget.
------------------------------------------------------------------------
r30349 | landonb | 2013-06-13 12:23:10 -0500 (Thu, 13 Jun 2013) | 1 line

Fix widgets overlapping: includeInLayout not auto-changing.
------------------------------------------------------------------------
r30348 | landonb | 2013-06-13 12:16:07 -0500 (Thu, 13 Jun 2013) | 1 line

Map key was not showing for logged out users on boot.
------------------------------------------------------------------------
r30347 | landonb | 2013-06-13 11:48:13 -0500 (Thu, 13 Jun 2013) | 1 line

Make CONFIG.commit_to_testing optional.
------------------------------------------------------------------------
r30343 | landonb | 2013-06-13 11:27:43 -0500 (Thu, 13 Jun 2013) | 1 line

Need to check !== undefined, not just != undefined, so null doesn't match.
------------------------------------------------------------------------
r30341 | landonb | 2013-06-12 17:32:22 -0500 (Wed, 12 Jun 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r30339 | landonb | 2013-06-12 17:24:56 -0500 (Wed, 12 Jun 2013) | 81 lines

ha-Ha! This is the *coolest* little nugget since sliced nuggets!

- Double-click a Vertex to toggle Sticky Intersections!

But, Wait, There's More!

- I fixed the Big Annoyance with Irresponsive Dragging.

(Yeah, der, I know, 'irresponsive' isn't a word, but dragging
wasn't unresponsive, it was just stupidly-slow-responsive.)

And a bunch more *semi-cool* nuggetlings of bug fixes
related to messing around with map items.

- There were unnecessary GWIS_Checkout requests happening,
  e.g., after dragging a Vertex and releasing the mouse,
  even though the Viewport had not changed, flashclient
  was sending a checkout request. This was because the
  same fcn. that handles panning the map was also the
  base class fcn. for moving vertices, and it wasn't
  differentiating between the two types of drags.

- I removed the Vertex mouse listeners and implemented
  their mouse handling the same as for Geofeatures. We
  let the map canvas mouse listener handle mouse down,
  mouse move, and mouse up, so that it can also manage
  the double click detector. Making this change -- so
  the Vertex's drag is called deliberately by the map
  canvas mouse handler -- markedly improves user inter-
  action with item vertices.

- Dragging vertices around the map was very unresponsive
  and "jerky". I added a timer to the mouse move handler,
  so that we don't make a new vertex-move command for
  every mouse move. The problem is that, while a user
  is mousing down and dragging a vertex, flashclient
  gets mouse move events every application frame.
  But the vertex-move command is costly --
  as are most undoable/redoable item commands --
  because it creates a new item, checks the new item
  policy, and adds the new item to the map, all of
  which are somewhat time consuming operations.

- Bike Facility tweaks: Replace Extra_Caution_2 with
  Poor_Visibility and also fidget with skin file
  and line definitions to redo a couple of the
  facilities' icons (e.g., poor visibility is now a
  solid green line surrounded with two red, dashed
  gutter lines).

- Awesome new facilities for outstate:
  - Highway High Volume, Highway Low Volume,
    Shoulder High Volume, and Unpaved Rural Road.

- Misc:
  - Renamed R_Tree.draw to R_Tree.draw_tree to help
    us distinguish from the other draw commands, e.g.,
    Geofeature.draw().
  - Fix bug zooming in and out when in edit mode:
    the historic mode fcn. was being called and was
    setting G.app.mode = G.view_mode. Bah.
  - Fixed bug not rebuilding network connectivity.
    The items_add fcn. pops completed items off the
    collection, so we need to array_copy byways so
    we know which ones' networks connections to fix.
  - Moved Route.is_hydrated to base class; renamed
    hydrated; Geofeature is not hydrated until its
    Item_Stack and Link_Values are received, right.
  - Got rid if clone_'s skip_ids and changed init()
    to behave differently -- on init_add, we just
    gml_consume, but on init_update, instead of
    calling clone (which clobbers values the user
    may have edited) we call a new fcn., clone_update,
    which only sets those values that may have been
    lazy loading, e.g., Item_Stack.
  - Fix Attribute.consensus. It cannot just get link
    values for the collection of items but must
    iterate over the items one by one.
  - When you create a new item (e.g., Byway), create
    and open its item details panel.

------------------------------------------------------------------------
r30321 | landonb | 2013-06-07 20:02:11 -0500 (Fri, 07 Jun 2013) | 128 lines

== DEVS: Database Update: ==

INSERT INTO item_type (id, type_name) VALUES (54, 'link_post');
INSERT INTO item_type (id, type_name) VALUES (55, 'link_attribute');

There's also a new attribute, '/item/reminder_email', you'll need
if you want the item alert widget to work. You could make this in
flashclient and then update value_internal_name='/item/reminder_email'
using psql or ccp.py, but it's probably easier to not care, since
the widget won't crash and you'll get the new attribute the next
time your reload your dev database.

Also, this is a big checkin, so this revision will likely break.
I'm not checking in my complete working folder, but used Meld
(visual diff) to merge most of my changes, so I'll have to
checkout this new revision and fix regression bugs...

== The bugs: ==

There were a lot of bugs in discussions and with the new
item attachment widget.
- I fixed a few bugs saving and checking out posts,
  and linking geofeatures to posts.
  - Also, annoying regression: when you attach places
    to a post, the post button gets pushed underneath
    the side panel but the vertical scroll bar doesn't
    change, so you can't post your places!
  - Unfortunately, this took a little time to figure
    out -- we have to override the Flex Data_Grid and
    then figure out and hack the height at the
    appropriate time.
- Multiple bugs because of leftover static variables
  from CcpV1 -- [mm] updated Discussions with the new
  selection widget (which is very cool), but neither
  of us tested discussions very well. I found a number
  of problems, mostly related to Item_Manager's
  active_thread and active_post, and also Post's
  first and reply. The active_thread and active_post
  are silly, because we can get that info from
  effectively_active_panel, and also because the values
  were not maintained well and could get out of sync
  (so that, e.g., you could save a post to the wrong
  thread). As for Post.first and Post.reply, don't get
  me started. These are pulvarized. Using application-
  level static class objects for an item panel's item
  reference? Yikes. Now the panels and the items in
  question figure this out without using a scary shared
  static.
  - Got rid of weird Post.reset() fcn.
- Threads and Post and Link_Posts are now added to the
  item lookups, e.g., Attachment.all, by way of
  G.map.items_add.

Lots of Great Fixes a Long Time Coming:
- Byway Rating
  - I made this an immediate command -- in CcpV1, ratings
    were part of the undo/redoable command stack and had
    to be saved with the rest of the map. Now, changing
    the widget value in flashclient causes an immediate
    GWIS command.
  - I fixed issues on pyserver -- I had implemented the
    CcpV2 code for ratings earlier in commit, but it was
    not fully tested. At this point, I think ratings is
    all done: on commit, if a byway is edited, or if a
    byway's tags or attribute link_values are edited, or
    if a byway is rated, the system recalculates the
    generic rating. After the commit, the command hups
    the route finder, and routed always checks for new
    ratings when it's hupped.
- Item Watching (Item Alerts)
  - This is a very simple but very elegant custom control.
    - It's like the one-way control, which is a label
      showing the current setting and then a small
      button for cycling through the different settings.
  - Because the user cannot see all of the watching options
    at one time (they have to click the 'Change' button to
    cycle through them all), there's a delay of some number
    of seconds between the time the setting is changed and
    when flashclient sends the GWIS command.
    - But not that we also send the command early if the
      side panel changes, or if the user saves the map.
- NOTE: Watching is still not completely implemented;
        the email cron job script is the last piece of
        the puzzle.... I rewrote it to CcpV2 a while
        ago, but item watchers are now private link
        values, so it needs to be updated again.
- Deeplink generation.
  - See the new network cmd, GWIS_Stealth_Create.
  - In CcpV1, when a user "shares" a route (adds it
    to their library; see the command, ShareRoute),
    pyserver generates a deeplink for the route. In CcpV2,
    users can generate deeplinks to any publicly editable
    item, and also to any item they can arbit.
    - So in CcpV2, the stealth secret a) is not generated
    automatically, and b) can be created on any item type,
    not just routes.

- Fix Item Delete in flashclient.
  - The Map Mode implementation was throwing an assert that
    led me to find out that removing an item from the map
    when deleted was also wrongly removing the item from
    the deletedset.
  - The UI interaction is still unrefined, but the
    operation seems to work (e.g., when you delete an item
    from the map, we still don't cleanup its panel, but at
    least the item is removed from the panel, so the panel
    shows, "nothing selected").

Cleaned up Item_Manager.
- Move G.map.dirtyset to G.item_mgr.dirtyset so it's
  with its companion collection, G.item_mgr.deletedset.
- Got rid of kludgy variables like 'active_post' and
  either moved them to the panel classes or recoded
  their usage -- a lot of uses was from widgets who
  were descendents of the details panel in question,
  so they can just, e.g., call this.parentDocument.

Add caller payload to GWIS_Base (caller_data).
- I'm suprised we haven't found a need for this before.

Add restrict_dirty to GWIS_Commit.
- So we can commit just a subset of what's dirty, i.e.,
  for saving ratings or for saving watchers independently
  of saving dirty map items.

Random fixes to undo/redo and item saving.
- I'm still debugging undo/redo/save... next time! =)

------------------------------------------------------------------------
r30301 | landonb | 2013-05-30 13:25:01 -0500 (Thu, 30 May 2013) | 4 lines

It would help if I tested better. Fix to previous:
If not logged on, new bless_new on Link_Value fails
  for the private item watcher's New Item Policy.

------------------------------------------------------------------------
r30300 | landonb | 2013-05-30 11:47:58 -0500 (Thu, 30 May 2013) | 66 lines

Flashclient:
- On item details panel, instead of not showing anything in
the name header when multiple items with different names
are selected, show, "Various Names" in italics.
- Fix Attribute.consensus with _two_ defaults: one for
when multiple items share the attribute but not the same
value, and another for when no items are selected.
- Fix Attribute panel name widget, which was not having
its width set, so the label was hidden.
- For view mode, show bike facility as an uneditable
label, of sorts (it's a Canvas we just paint on, but
we show that instead of the combo box).
- Hide the tag widget 'X' button in view mode.
- Hide the 'Show Road type'/'Hide Road type' widget
because we have view and edit mode now.
- Restore the inline hints for the attribute list
on the item details panel.
- There was a crash (bad assert) when making a new
route feedback post.
- For whatever reason, Route_Stop_Entry was referencing
this.parent_proxy.parent instead of just this.parentDocument,
and it finally failed on a null reference. I think I changed
a this.parent.parent from CcpV1 to this.parent_proxy.parent
to side-step a Flex warning, but the real issue was not just
using this.parentDocument to boot! =)_
- Fix the hard reference in List_Disableable to a worldly
view component. That class is a utility class, but it was
created before I knew better about how item renderers could
get at their parents... and in this case, List_Disableable
had to get at its parent, Combo_Box_V2 (which isn't always
the parent) to get at the combo's parent, Floating_Tool_Palette
(and obviously the latterest is never always the parent of
Combo_Box_V2, so you can see why the hard-coded hack was
tolerated for so long).
- Fix New_Item_Policy's matches_target to work on dummy
Link_Value when testing user's permissions (since a dummy
Link_Value won't have its attc or feat members set).
- New Combo_Box_V2 option to show special button, i.e.,
something other than what's in the dropdown is used as the
combo button. We use this for the "Varies" situation.
- Rename some buttons, like Save Changes and Discard Changes
to Save Map and Start Over, so that that save button can be
distinguished from other save buttons. Also, Start Over is
more meaningful, maybe -- what does Discard mean, I mean, I
don't see a trash can anywhere.
 - Start Over implies that the user can do things that don't
 matter, so hopefully users will be less intimidated by our
 map. "Oops, I just edited, but nevermind, I can "Start Over"!"
- Disable Route Feedback Ask Me Later widget: it lets anyone
enter any email address to be emailed... but seems like a big
gaping security hole. We should use the logged in user's
registered account email -- which probably means we don't
let anonymous users ask to be asked later (though we could
give them a deeplink to the route for them to keep for later).

db_glue was logging an error on an _anticipated_ integrity
error, which was causing a script to get flagged as
failing. now it logs a debug trace instead. (see:
integrity_errs_okay).

Regression (well, missed code from an earlier merge):
- Was missing override fcn:
   Panel_Item_Thread.attachment_highlights_update
  Sorry, Mikhil! I guess no one's used the thread
  panel recently, though...

------------------------------------------------------------------------
r30297 | landonb | 2013-05-29 18:54:53 -0500 (Wed, 29 May 2013) | 1 line

Fix to previous: skin attr pens that specify key_rank must come after those that do not.
------------------------------------------------------------------------
r30296 | landonb | 2013-05-29 18:37:06 -0500 (Wed, 29 May 2013) | 44 lines

In flashclient,

New Bikeability_Rating.as class
- Finally: a Class for all the hard-coded ratings values! =)

To Combo_Box_V2, ability to show custom button when "Varies"
- I.e., when you select multiple items on the map and they
don't share the same values, we can draw a special button
on the combo box to indicate as such. Note that this special
button does _not_ appear as an option in the dropdown list.
- Instead of XML, using Objects now for dataProvider, which
are robustier.

Fix for editing Link_Value values: also be sure to update
the attached geofeature's attrs or tags collection, which
is supposed to be a lightweight mirror of the actual link
value values.

Don't forget to clear Dirty_Reason.item_schg in
update_item_committed.

Improvements to Byway.draw_bike_facil.

Regression: assertion when changing byway rating, because
new map mode was asserting that there is one or more
revisiony changes -- but a byway rating is not that type
of dirty.

Fix UI_Wrapper_Attr_Link to work with ComboBox.
- It used to just work with Steppers.
- This wires, e.g., the Bike_Facility widget to undo/redo
and other command stack features.

Lots of little tweaks to the item details panel widgets,
both visual and functional.
- Finish wiring the Bike Facility widget:
  - Undo/redo now works.
  - Using the Combobox is immediately reflected on the map.
- Bug nnnn: There's still a bug where zooming causes a
checkout, and the checked out item is being clone()d onto
the editing item (wiping its Geofeature.attrs, so the Bike
Facility value is getting clobbered, at least in the lightweight
lookup).

------------------------------------------------------------------------
r30294 | landonb | 2013-05-29 17:41:12 -0500 (Wed, 29 May 2013) | 1 line

Update skin generator script, and generated Flex skin classes.
------------------------------------------------------------------------
r30293 | landonb | 2013-05-29 17:20:22 -0500 (Wed, 29 May 2013) | 48 lines

Big Bug nnnn: apache_event table script on production
server (itamae) has been broken since last fall, so now
the upgrade script copies all of the archived apache logs
from itamae and repopulates the entire apache_event table.
- Lots of fixes to apache2sql.py, including logging warnings
rather than silently failing when input cannot be parsed.
- Also, apache2sql.py is now a Cyclopath script_base class.
- This fixes problems with the statistics graphs the nightly
script makes for the Wiki project page.

New Bash fcns. in ccp_base.sh:
- Get Cyclopath installation latest revision ID and timestamp.

Apache Tilecache cron job:
- Keep a touch file of the latest revision timestamp for each
branch, so it can quickly not do anything (the script runs
every minute, so it should figure out as painlessly as
possible if there's work to do and exit quickly if there is
none).
- In addition to the touch file, the script now doesn't do
anything on --changed if it sees that a branch's revision
ID hasn't changed since the last time the script ran.
- Change tilecache_update.py's option to make more sense:
  Replaced --skip-cache-table-remake w/ opposite, --cyclopath-cache
  Replaced --skip-cache-seed-remake w/ opposite, --tilecache-tiles

Fix issues with revision.Updated (just used by routed's tgraph
and tilecache_update, so not tested much recently, but now pyserver
code makes a temp table of stack IDs of geofeatures that changed
and of geofeatures with link_values that changed, and that temp
table is joined against when fetching geofeatures (it's a two-step
process when you use revision.Updated)).

Geofeature skins:
- To Attr_Pen, let skin set key_rank, so we can support hidden
options, e.g., Bicycle Facility sets a hidden option at
key_rank=-2 that's used when there are multiple items selected
and their values do not match (so the combo box shows the hidden
option on the button, but the hidden option does not appear in
the dropdown).
- Fiddle with skin_bikeways.py: regarding gap widths and gutter
widths: if a byway is drawn at an angle, e.g., downtown
Minneapolis, some ornamentation shows weird artifacts. Using
fatter line widths and gap widths hides the artifacts.
- Also use a white background now for the bike facilities,
so we don't just let whatever funky color beneath it bleed
through.

------------------------------------------------------------------------
r30275 | landonb | 2013-05-24 11:59:07 -0500 (Fri, 24 May 2013) | 1 line

Move htdocs/exports/team to htdocs/statistics.
------------------------------------------------------------------------
r30274 | landonb | 2013-05-24 00:12:37 -0500 (Fri, 24 May 2013) | 127 lines

Flashclient:
- Add Conflation_Job class because it's in the new
  item policy now ([ft] is implementing Conflation in
  the mobile/ svn branch, so this is just a placeholder).
- Cleanup build_id script: we might as well just add our
  own MXML and use the static BUILD_INFO class variables
  rather than hiding the UI elements in the Perl script.
- Fix layout and wording of the route-using-bike-facils
  option.
- Add route-using-approved-bikeways to basemap branch
  (using the new, non-approved /byway/cycle_facil attr).
  - Also add same to flash cookies and save with other
    user route preferences.
  - Also rename from 'metc_bikeways' to 'use_bike_facils'
    because the former doesn't quite capture the meaning.
- Decouple tile server from Cyclopath installation server,
  so developers can use the server's tiles.
- Add Terrain to some Geofeature class lists.
  - I.e., to Attachment.as, so Terrain can have attachments.
- Fix Geofeature.has_tag so that it checks the lightweight
  this.tags lookup.
- For the map legend, we have to manage a sometimes-there
  horizontal scrollbar.
  - Added complements to has_VerticalScrollBar and vsb_width:
    has_HorizontalScrollBar.
  - Made static fcn. wrappers for 'em so code can be reused.
- Add toolTip to Help_Link widget.
- Removed selective_attrs, which was a silly construct:
  - The idea was to lazy load important attributes after
    the viewport loaded all the geofeatures, but now
    pyserver includes the lightweight attrs collection
    on viewport checkout, so selective_attrs is redundant
    (and more cumbersome).
  - Oh, and -- haha -- it was never implemented correctly:
    it didn't specify a callback, and it didn't have an
    update request attached to it, so the response from
    pyserver was never processed! Though [lb] wonders why
    a particular assert never fired (the one that says
    there should be a callback or an update request, or maybe
    both, but never neither!) so my understanding of the
    problem is incomplete but it's solved so who cares.

- Major fix to boot load time, especially at fullscreen,
  which would time out for me (if I booted flashclient in
  a small browser window and then went fullscreen, it was
  okay, but if I booted at fullscreen, the flash plugin
  would time out and stop running flashclient).
  - The problem was the route library code from CcpV1
    causes the nodes_rebuild function to be called for
    every route in the library, which is a very expensive
    operation -- and grows exponentially (probably) as the
    size of the viewport grows!
  - And nodes_rebuild was being called redundantly: for
    every route in the library, it was recalculating all
    of the intersections for all of the byways on the map.
  - There might still be the case the Intersection_Detector
    and Node_Snapper are both calling nodes_rebuild when it
    should only be called once but it's late and I want to
    check in code... the situation is much improved, but
    probable not perfect (like lots of things in CcpV2!).

Flashclient Regressions:
- "Restricted" tag ornament was not being drawn on byways
  (was checking just the heaveyweight link_value tags and
  not the lightweight tags Set).
- Major fix to canvas clipping and height/width:
  - The 'map' component was wrapped in a new Canvas,
    map_canvas_print, when the print-to-pdf feature
    was implemented, but the map component sizes
    itself using its this.parent, but now map_canvas_print
    is its parent, and the width/height of map_canvas_print
    are not the same as those of map_canvas. I.e., we want
    G.app.map_canvas.width/height.
- Don't draw caps for byway shadow lines, otherwise roads
  with higher z-levels don't blend well w/ lower z-level
  roads.
- On new route panel, when you click "Show More Options",
  move the scrollbar so the new content shows, otherwise
  it looks like nothing happens.
  - Also, unique toolTips for each individual slider value.
- I flipped the order of the bikeability slider on the
  find new route panel:
  1. The 'Prefer roadways with bike facilities' widget
     (new to the basemap, but old on the metc branch)
     is left-aligned below the left-hand side of the
     slider, and it's a bikeability enhancer, so it
     feels unnatural being below the 'Fast' option and
     not the 'Friendly' one.
  2. What's more natural in human nature? Don't people
     tend to associate the left as being more friendly
     than the right? Well, at least here's an article
     that says "Face's Left Side More Attractive Than Its
     Right Side, Study Shows"
       http://www.huffingtonpost.com/2012/04/21/
        face-left-side-more-attractive_n_1443325.html

Flashclient Map Legend:
- Fixed a big problem with automatically sizing.
  - Pixel pushing... ug. If the app window is tight,
    we show one or both scrollbars and add a pixel
    of padding so they aren't clipped. If the app
    window is super loose, we restrain the legend
    from growing too large (or even overlaying the
    zoombar if the window is large enough to
    comfortably sit both).
  - Making great use of the ChangeWatcher object
    I recently leared about -- rather than watching
    for resize events (which fire duing a resize,
    perhaps), watch for the width and height attributes
    of a component to change).

Apache cron job:
- Script was being chatty (echo without $DTRACE &&).

CcpV1->V2 upgrade scripts:
- Bikeways import failing because code was handling
  ogr.OFTReal and ogr.String but forgetting about
  ogr.OFTInteger.
- make_new_branch script shouldn't fail if MetC
  username is not found in user_ table.

Route finder:
- Make use-bike-facilities option work on public basemap.
- Make use-bike-facilities option check what _type_ of
  facility is indicated so it can exclude negative facilites
  (e.g., Use Caution, Difficult Connection, etc.).

------------------------------------------------------------------------
r30267 | landonb | 2013-05-22 21:44:01 -0500 (Wed, 22 May 2013) | 21 lines

To tile cache update script:
- Release script and branch async locks when finished.

To apache cron script:
- Fix tars so whole directory ancestry is not included
  (i.e., 'cd' to the directory and tar from there).

New script to make the macros_*.m4 files.
- I added a new macro, m4_PPUSH, for trace statements
  that just report measurements of UI components
  (PPUSH stands for pixel pushing, i.e., when you're
  trying to nudge a component perfectly into place).
- See also Conf_Instance.debug_loggers_enabled, which
  is a Set() of enabled speciality trace macros (i.e.,
  not the normal m4_DEBUG, m4_INFO, m4_WARNING, etc.,
  macros).

New Conf_Instance.wms_url_base so developers can
use the tiles on the server and don't have to load
them locally.

------------------------------------------------------------------------
r30261 | landonb | 2013-05-20 15:35:05 -0500 (Mon, 20 May 2013) | 13 lines

A few fixes to apache_check_cache_now and
tilecache_update.py for the crontab job.
- Tilecache_update was not releasing the
  locks it claimed (the ones recorded
  in the database table, async_locks).
- The check_cache_now script was being
  overly verbose (emailing when it
  didn't have any work to do).
- The check_cache_now script now checks
  the dump it's about to write to make
  sure that, if it exists, it's writeable
  by the apache user.

------------------------------------------------------------------------
r30253 | landonb | 2013-05-16 22:00:13 -0500 (Thu, 16 May 2013) | 1 line

Fix path to log archive so it's not same as what's being tarred. Also, that's not how you copy a bash array\! =) I fixed an array copy problem that was causing the apache check_cache_now script to never stop waiting.
------------------------------------------------------------------------
r30249 | landonb | 2013-05-16 18:24:18 -0500 (Thu, 16 May 2013) | 1 line

Tweaks to width/height adjustment of map legend drawer.
------------------------------------------------------------------------
r30248 | landonb | 2013-05-16 18:03:55 -0500 (Thu, 16 May 2013) | 6 lines

- Rearrange map canvas so Map Key appears on top of 
  map scale.
- New Map Legend (Map Key) sizes itself based on the
  maximum size of any of its children.
- Move Branch List and Branch Actions to Map Legend.

------------------------------------------------------------------------
r30242 | landonb | 2013-05-16 14:34:03 -0500 (Thu, 16 May 2013) | 1 line

1. Move Cyclopath-specific stuff from bash_base.sh to ccp_base.sh. 2. Fix to track lengths (thanks, Fernando\!). 3. New bash fcn. to determine PYSERVER_HOME from working directory.
------------------------------------------------------------------------
r30237 | landonb | 2013-05-15 21:18:09 -0500 (Wed, 15 May 2013) | 1 line

bash_base fcns should not even 'set -e'. fixed.
------------------------------------------------------------------------
r30235 | landonb | 2013-05-15 21:09:17 -0500 (Wed, 15 May 2013) | 1 line

Fix to apache check_cache_now.
------------------------------------------------------------------------
r30232 | landonb | 2013-05-15 19:53:54 -0500 (Wed, 15 May 2013) | 1 line

So now I learn getint isn't happy if the option exists but is the empty string... fixed now to use the default when specified, so CONFIG can have integer options specified but they no longer need a value if the user just wants us to use the default.
------------------------------------------------------------------------
r30231 | landonb | 2013-05-15 19:39:47 -0500 (Wed, 15 May 2013) | 57 lines

These are all flashclient changes:

Revamp Map_Key:
- moved to flashclient/views/map_legend
- split into multiple classes
- split the map key into multiple smaller
  views
- you can navigate the map keys and other
  map-related views using a small side
  panel menu
- i moved and organized most of the
  branch details panel widgets here,
  in the map key -- the branch list
  (changing maps), accessing the
  attributes list (editing and adding
  new attributes), the software version
  and link to privacy, etc.

Has flashclient been missing overrides
of the deleted fcn?
- Now we remove items from the class
  lookups -- there's a fcn. to get
  deleted items, but flashclient hasn't
  been good about moving deleted items
  off of the active lists.
- This'll probably cause problems down
  the road, but this change seems
  necessary -- we have the items_deleted
  list, and we weren't using it right.

Fix problem seen hidden object's toolTip
on boot.

Lots of work to the Attribute details panel.

Fix problem with item details panel mouse
listener stealing focus -- now it only steals
focus when it knows it was clicked on and not
another control, which is how it is intended
to work (i.e., so that users can get rid of
the annoying blinking cursor (my Vim editor's
cursor doesn't even blink! -- though maybe
there's a flex way to turn this off, but that
might confuse some users...) -- anyway, some
users might want to look at the map and not
be distracted, or they might want to feel
like a change they made to an edit control
actually sticks, like, "type-type-type, click",
meaning my edit was a success!).

Fix Hyper_Link so its colors are more easily
configured.

Fix problem with map canvas background coming
to foreground on boot and covering half the
side panel. Yes, [lb] is annoyed easily.

------------------------------------------------------------------------
r30229 | landonb | 2013-05-15 19:11:06 -0500 (Wed, 15 May 2013) | 41 lines

Update apache_check_cache_now.sh to run asynchronously with
upgrade_ccpv1-v2.sh and publish_ccpv1-v2.sh.
- In Ccpdev repository, I renamed daily.huffy.v1-v2-update.sh
  to upgrade_ccpv1-v2.sh
  - This affects a lot of server scripts but I'm always
    manually mucking around with it and its lock dirs, and
    assigning a unique name makes tab completion work a lot
    better in bash. Also, this script isn't huffy-specific.
    Oh, and it's no longer a daily cron job -- it's meant
    to be run every minute in volley with the check_cache_now
    and publish_ccpv1-v2 scripts.
- V1->V2 scripts can run continuously now:
  - One script is always running the schema upgrade and
    scripts/setup/ruinc/* scripts.
  - Another script is always running the www-data
    check_cache_now script, which makes the tilecache
    cache database cache and mapserver tiles.
  - A final script to make database dumps after the two
    other scripts have run and to package the tiles for
    developers to download to their offline machines.
- The scripts using directory locks and check timestamps
  to coordinate their efforts and to only do work when
  work is ready.

Add some logcheck warnings to a text file in the throwaway
doc/landonb folder... hopefully these'll go away when we update
to the new CcpV2 server.

Typo in conflation.py from the last time I merged (my mistake!).

Lots of updates to service code (routed, mr_do, etc.).

Great new bash fcn., flock_dir, to handle using directories
as inter-process locking mechanisms.

Also a much more boring bash fcn., dir_resolve, to resolve
a relative file path to an absolute file path.

Bugfixes to tilecache_update to newish code that sets bike_facility
from last week's new /byway/cycle_facil attribute.

------------------------------------------------------------------------
r30216 | landonb | 2013-05-15 14:12:39 -0500 (Wed, 15 May 2013) | 1 line

Update files to ignore on 'svn status'.
------------------------------------------------------------------------
r30195 | landonb | 2013-05-14 01:32:58 -0500 (Tue, 14 May 2013) | 1 line

Bugfixes to mapserver scripts - tickled by Colorado instance (code was handling changing instances on the fly).
------------------------------------------------------------------------
r30194 | landonb | 2013-05-14 00:28:23 -0500 (Tue, 14 May 2013) | 6 lines

- Add additional apt-get requirements for SciPy.
- reports/.htpasswd now generated via m4.
- pyserver gwis fixed to accept attribute.spf_field_name.
- attribute.get_system_attr returns None instead of asserting.
- fix --force flag for mapserver/check_cache_now.py.

------------------------------------------------------------------------
r30184 | landonb | 2013-05-12 21:31:34 -0500 (Sun, 12 May 2013) | 1 line

Bugfix to previous (comma after set was making set within a set).
------------------------------------------------------------------------
r30183 | landonb | 2013-05-12 21:10:43 -0500 (Sun, 12 May 2013) | 1 line

Bugfixes to bike_facilities_populate.py.
------------------------------------------------------------------------
r30181 | landonb | 2013-05-12 04:15:53 -0500 (Sun, 12 May 2013) | 1 line

Fix problem discarding on branch change.
------------------------------------------------------------------------
r30180 | landonb | 2013-05-12 03:59:23 -0500 (Sun, 12 May 2013) | 1 line

Fix to previous: fix new name widget on attribute panel.
------------------------------------------------------------------------
r30179 | landonb | 2013-05-12 03:59:00 -0500 (Sun, 12 May 2013) | 39 lines

Fix to attachment highlights code:
- The new attachment_highlights_update fcn. broke opening
  the attribute panel, because the if/else block was
  asserting if not a thread or annotation panel.
  - I decoupled the if/else code, i.e., instead of calling
      if (item is type) ... else if (item is type)...
    we just call
      item.fcn()
    and use polymorphism to determine what to do (so the
    code was moved from UI.as to Panel_Item_Thread and
    Panel_Item_Annotation, and a base fcn. was added to
    Panel_Item_Versioned).

The recent track conflation upgrade script broke the
V1->V2 upgrade:
- The schema upgrade script specified @once-per-instance
  but was inserting into item_type, which is in the public
  schema, so the statement was failing the second time
  the script was run (e.g., it works the first time on,
  say, minnesota, and then fails the second time, on colorado).

Fix bug logging on if token expired: flashclient gets
stuck in a loop and continually asks for your password
over and over again.
- The problem was code that copied CcpV1's behavior
  and reused GWIS commands. Now we just scrap everything
  and start the Update over, firing off fresh GWIS
  commands.

Server now sends coverage_area to client so that the
branch details panel's "locate" feature works (the
map will pan and zoom to include, well, the whole
map).

Fix problem in Dual_Rect.valid: In addition to
checking !isNaN, we also have to check isFinite.

Some fixes/cleanup to the attribute panel.

------------------------------------------------------------------------
r30178 | landonb | 2013-05-11 21:49:28 -0500 (Sat, 11 May 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r30176 | landonb | 2013-05-11 21:00:37 -0500 (Sat, 11 May 2013) | 70 lines

DEVS: Please run

  psql -U cycling [your_ccpv3_database] < /scratch/runic/ccp/dev/cp_2628/2013.05.11.ccpv3_trunk-r30176.sql

or wait a few days and reload the CcpV2 database from

  /scratch/runic/ccp/var/dbdumps/ccpv2_lite.dump [~250 Mb db.]

or

  /scratch/runic/ccp/var/dbdumps/ccpv2_raw.dump [~1 Gb db. w/ logs]

CHANGES:
  
CcpV1->V2 SQL update script changes:
- Add column: attribute.spf_field_name
  (Shapefile field name).
  - So users have more control over import/export
    (so anyone can change the Shapefile field name
    used for each attribute using flashclient (or
    ccp.py, or GWIS) and we don't need to have an
    engineer edit any branches/*_defs.py source
    code files.
- Change track.x and track.y from INTEGERs
  to REALs (for [ft]'s track conflation).
- Copy-pasted code to convert private
  track.comments to CcpV2-style annotations
  (link_value, group_item_access, and all).

New array_in fcn. for bash.

Update auto_install scripts:
- New software: OAuth, Networkx, NumPy,
  QSopt, Concorde TSP, SciPy.

New /byway/cycle_facil attribute.
- Complements /metc/bike_facil.
- Populated by new script, bike_facilities_populate.py.

New new_item_policy for track conflation:
- Allow all users to start new conflation jobs
  (work_items).

Missed some changes from check_cache_now-wrap.sh
to check_cache_now.sh in earlier checkins.

Flashclient fixes...
- Problem not initing Geofeature's tags and attrs.
- Use Map Key button to show active branch name.
  - I'm not sure this is the right spot for it,
    but it's a start (we need to show the branch
    name somewhere that's always visible... and
    "Map Key" is useless text, or at least it was
    occupying precious text space).
- Fix bike facility items when not showing all rows
  in the dropdown (Flex reuses icon objects as the
  user scrolls the dropdown, so when the item gets a
  data change event, it needs to redraw itself).
- I finally learned about the parentDocument pointer,
  which lets us get from a dropdown item to the parent
  ComboBox (i.e., so our custom bike facility widget
  item renderers can get at our custom bike facility
  combo_box_v2 widget).
  - We can also auto-size the dropdown now, as the
    item renderer measures itself (using TextLineMetrics)
    to figure out its dimensions.
- Catch mouse in route reaction so detail panel base
  doesn't lose focus.
- Lots of fixes to the bike_facility widget.

------------------------------------------------------------------------
r30175 | landonb | 2013-05-11 19:51:22 -0500 (Sat, 11 May 2013) | 1 line

Cull obsolete notes.
------------------------------------------------------------------------
r30174 | landonb | 2013-05-11 19:50:48 -0500 (Sat, 11 May 2013) | 15 lines

Merge from Fernando (torre), r30116 through r30160 (track conflation)
  br/mobile

r30160 | torre | 2013-05-09 16:48:18 -0500 (Thu, 09 May 2013) | 1 line

small fix
------------------------------------------------------------------------
r30159 | torre | 2013-05-09 14:56:42 -0500 (Thu, 09 May 2013) | 1 line

track saving for logged in users now works again (except comments)
------------------------------------------------------------------------
r30158 | torre | 2013-05-09 14:56:04 -0500 (Thu, 09 May 2013) | 1 line

small changes to make track saving work

------------------------------------------------------------------------
r30173 | landonb | 2013-05-11 19:43:04 -0500 (Sat, 11 May 2013) | 1 line

Remove obsolete notes.
------------------------------------------------------------------------
r30149 | landonb | 2013-05-08 08:31:16 -0500 (Wed, 08 May 2013) | 4 lines

Cron fix:
- Typo: missing comma ',' in tgraph SQL
  (caught while updating transit cache)

------------------------------------------------------------------------
r30147 | landonb | 2013-05-08 08:00:24 -0500 (Wed, 08 May 2013) | 5 lines

Don't log 'ERROR' keyword from psycopg2 when we're
recovering gracefully so our log file doesn't contain the
keywork 'ERROR' so we don't get erroneous complaints from
check_prev_cmd_for_error.

------------------------------------------------------------------------
r30146 | landonb | 2013-05-07 18:22:34 -0500 (Tue, 07 May 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r30145 | landonb | 2013-05-07 18:17:11 -0500 (Tue, 07 May 2013) | 1 line

Oops from previous.
------------------------------------------------------------------------
r30144 | landonb | 2013-05-07 18:15:19 -0500 (Tue, 07 May 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r30143 | landonb | 2013-05-07 18:06:27 -0500 (Tue, 07 May 2013) | 44 lines

Big Change: Skins are now wired to flashclient.
- Rather than send them via GWIS, I wrote a Python
  script to auto-generate ActionScript classes so
  we can just import the skins like normal, easy-to-
  use classes. (I suppose GWIS could just send a big
  XML lookup that we could access directly, but hard-
  coding means we can access to the skin values on
  boot and don't have to wait for the server to start
  drawing.) See: flashclient_classes.py.
- Implemented Conf.tile_skin to replace draw class stuff,
  like Conf.draw_param and Conf.geofeature_layer_by_id.

Fix Nonwiki_Item classes to accept rev in constructor
so flashclient's bless_new works (otherwise, when the
item is being destroyed, some asserts complain that
the rev is null).

Awesome new Bicycle Facility widget!
- I swiped color and ornaments from the City of Portland:
    "Portland by Bicycle" Citywide Bike Map, by the City of Portland.
    http://www.portlandoregon.gov/transportation/article/391729
- It's a Combo_Box_V2 but with a custom item renderer that
  uses the same Paint.draw_line as Byway to paint the road
  to a Canvas -- meaning, the menu is drawn according to the
  active skin.

Don't show Geofeature vertices unless in edit mode.
- Only show the thin blue line.
- I'm not 100% convinced this is right, but it's at
  least better than having all vertices visible and
  active in view mode. We can work backwards from here.

Fix Byway.draw and Paint.line_draw to handle the ornaments
for the new Bicycle Facility widget, including a skate-border
(two thin lines outside the main line, separated by emptiness)
and better support for dashed lines.
- Also added new Byway.draw_bike_facil so the Bike Facility
  widget can draw its dropdown options using the same fcn.
  that the geofeatures use.

Changed some os.mkdir to os.mkdir(..., 02775).

Some more minor Map_Key cleanup, mostly pixel pushing.

------------------------------------------------------------------------
r30142 | landonb | 2013-05-07 17:07:10 -0500 (Tue, 07 May 2013) | 75 lines

Merge from Mikhil, r29992 through r30133
  br/masli_statewide-ui-discussions_2784
(well, more like r30049 through r30133).

I [lb] made a few changes to [mm]'s branch:
* Changed the Editing Button and edit mode behavior:
  - I restored the animation of the tool palette dissolving
    in and out of focus.
  - I fixed a problem with turning on the off the tool palette
    visibility -- it was jumping all around because play_effect()
    was being called incorrectly. I fixed the code to instead use
    map_editing_enabled and restored the animation code that
    makes the tool palette visible.
  - I made the button a ToggleButtonBar button so it doesn't
    flicker as badly when clicked.
  - I added dummy calls to on_mode_change so that widgets still
    setup if they're created late and miss the first mode change.
  - I moved the Print Map and Save PDF buttons to make more room
    in the map header. It's nice and sparse now, just the aerial/road
    toggle, the editing toggle, and a dropdown of less-used but still
    frequently used items.

------------------------------------------------------------------------
r30133 | masli | 2013-05-03 15:18:15 -0500 (Fri, 03 May 2013) | 1 line

Hooks into the route item object
------------------------------------------------------------------------
r30103 | masli | 2013-05-01 16:00:49 -0500 (Wed, 01 May 2013) | 1 line

Wiring in the historic mode.
------------------------------------------------------------------------
r30096 | masli | 2013-04-30 17:57:23 -0500 (Tue, 30 Apr 2013) | 1 line

Missed
------------------------------------------------------------------------
r30095 | masli | 2013-04-30 17:57:07 -0500 (Tue, 30 Apr 2013) | 1 line

Mode control over route feedback widget.
------------------------------------------------------------------------
r30094 | masli | 2013-04-30 17:20:56 -0500 (Tue, 30 Apr 2013) | 1 line

Mode control over item watcher editing.
------------------------------------------------------------------------
r30093 | masli | 2013-04-30 16:54:39 -0500 (Tue, 30 Apr 2013) | 1 line

More coverage of the application mode stuff.
------------------------------------------------------------------------
r30092 | masli | 2013-04-30 14:50:04 -0500 (Tue, 30 Apr 2013) | 1 line

Mode stuff in the routes and search panels.
------------------------------------------------------------------------
r30086 | masli | 2013-04-29 18:16:27 -0500 (Mon, 29 Apr 2013) | 1 line

More app mode checks
------------------------------------------------------------------------
r30085 | masli | 2013-04-29 16:59:51 -0500 (Mon, 29 Apr 2013) | 1 line

Replaced the item_mgr.editing_enabled boolean by the more robust app mode framework
------------------------------------------------------------------------
r30069 | masli | 2013-04-26 17:38:55 -0500 (Fri, 26 Apr 2013) | 1 line

A view/edit toggler.
------------------------------------------------------------------------
r30068 | masli | 2013-04-26 16:45:44 -0500 (Fri, 26 Apr 2013) | 1 line

Initial stuff for implementing map modes.
------------------------------------------------------------------------
r30053 | masli | 2013-04-25 17:41:37 -0500 (Thu, 25 Apr 2013) | 1 line

Regression fixes
------------------------------------------------------------------------
r30049 | masli | 2013-04-25 15:06:47 -0500 (Thu, 25 Apr 2013) | 1 line

Creating a branch to implement map modes.

------------------------------------------------------------------------
r30137 | landonb | 2013-05-03 17:20:26 -0500 (Fri, 03 May 2013) | 17 lines

Merge from Fernando (torre), r30082 through r30116 (track conflation)
  br/mobile

------------------------------------------------------------------------
r30116 | torre | 2013-05-02 11:21:35 -0500 (Thu, 02 May 2013) | 1 line

merge with trunk
------------------------------------------------------------------------
r30084 | torre | 2013-04-29 14:45:51 -0500 (Mon, 29 Apr 2013) | 1 line

server conflation code
------------------------------------------------------------------------
r30083 | torre | 2013-04-29 14:16:44 -0500 (Mon, 29 Apr 2013) | 1 line

Mobile conflation!
------------------------------------------------------------------------

------------------------------------------------------------------------
r30136 | landonb | 2013-05-03 16:28:20 -0500 (Fri, 03 May 2013) | 14 lines

Fix visualization of Metc Bike Facility attribute in
flashclient.
- Was referring to /metc_bikeways/bike_fac instead of
  /metc_bikeways/bike_facil.

Fix Map Key placement.
- We were listening on resize, but really we want to
  just listen on the height and width attributes of
  the canvas. The problem with on_resize is that it's
  called during a resize so we don't see the correct
  width and height values.

Have cron export job copy elevation files to htdocs/.

------------------------------------------------------------------------
r30131 | landonb | 2013-05-02 20:38:41 -0500 (Thu, 02 May 2013) | 1 line

Shapefile export was missing attributes referenced by name instead of by stack ID... weird that this hasn't been caught before.
------------------------------------------------------------------------
r30130 | landonb | 2013-05-02 19:01:04 -0500 (Thu, 02 May 2013) | 1 line

Bugfixes for nightly cron scripts.
------------------------------------------------------------------------
r30129 | landonb | 2013-05-02 18:08:24 -0500 (Thu, 02 May 2013) | 1 line

Oops, python's os.chmod(2775) is messed up, doesn't do what you think (I think 0775 means octal and 2775 is interpreted as demical, or something). Also fix the export to properly define the attribute types in the export Shapefile.
------------------------------------------------------------------------
r30128 | landonb | 2013-05-02 16:22:34 -0500 (Thu, 02 May 2013) | 1 line

fixperms not bash, so [[ ]] not recognized.
------------------------------------------------------------------------
r30127 | landonb | 2013-05-02 15:59:23 -0500 (Thu, 02 May 2013) | 1 line

Use unique temp dir location to avoid scripts overlapping.
------------------------------------------------------------------------
r30126 | landonb | 2013-05-02 15:33:46 -0500 (Thu, 02 May 2013) | 1 line

Update to previous.
------------------------------------------------------------------------
r30125 | landonb | 2013-05-02 15:24:10 -0500 (Thu, 02 May 2013) | 1 line

Do not log from ccp_export_routes (spit to stdout and let caller do the logging).
------------------------------------------------------------------------
r30119 | landonb | 2013-05-02 14:54:06 -0500 (Thu, 02 May 2013) | 1 line

Add metadata files (these are normally generated but pyserver needs one of them for the export zipfile, and it's easier just to include it in the source path); also adding READMEs for exports/ and reports/ publication locations.
------------------------------------------------------------------------
r30118 | landonb | 2013-05-02 14:52:33 -0500 (Thu, 02 May 2013) | 1 line

Complete swapping a link and its linked file (which you cannot do in one svn command).
------------------------------------------------------------------------
r30117 | landonb | 2013-05-02 14:51:37 -0500 (Thu, 02 May 2013) | 27 lines

Fix runic's daily cron job and the dozen or so
scripts it runs, including making the stats
dat files and images, backing up the production
machine, making lite database, publishing the
nightly data exports, etc.

Add 'publish_result' option to work_item to
tell ccp.py to copy the result of an export
job to a specified server location.
- This feature is used to publish the
  nightly Cyclopath data export.

Fix ccp.py to send ?rqst= first in the URL
so that apache2sql.sh doesn't gripe.

Fix import order in apache2sql.py so logging2
is picked up.

Lots of fixes to the ccp_export scripts,
which make the route summary exports and
the Cyclopath branch exports (oh, yeah,
now we export a Shapefile for each branch,
and we include metadata in the downloads! =)

At this point, the daily.runic.sh is ready
to be deployed (i.e., run every day, finally!).

------------------------------------------------------------------------
r30110 | landonb | 2013-05-02 00:43:44 -0500 (Thu, 02 May 2013) | 1 line

Update stats scripts' names.
------------------------------------------------------------------------
r30104 | landonb | 2013-05-01 18:11:09 -0500 (Wed, 01 May 2013) | 1 line

Rename tilecache scripts to be more obvious (and uniquer, so tab completion works after a single letter).
------------------------------------------------------------------------
r30102 | landonb | 2013-05-01 11:55:48 -0500 (Wed, 01 May 2013) | 1 line

Dropping temp table raises OperationalError. I guess that makes sense...
------------------------------------------------------------------------
r30099 | landonb | 2013-05-01 11:33:12 -0500 (Wed, 01 May 2013) | 1 line

mr_do was importing a module before logging2, so verbose2 was not working.
------------------------------------------------------------------------
r30098 | landonb | 2013-05-01 11:13:02 -0500 (Wed, 01 May 2013) | 1 line

Update to previous.
------------------------------------------------------------------------
r30097 | landonb | 2013-05-01 11:04:04 -0500 (Wed, 01 May 2013) | 51 lines

Fix some focus issues in the panel.
- E.g., in the sharing panel, after clicking on the weblink,
  it was losing focus because the panel's click listener
  was clearing focus.

Fix problem with route destinations not showing up.
- The first child of a DataGrid item renderer is the
  only child that gets rendered, so be sure to put all
  of your controls within a containing HBox or VBox.

Fix deep-links, both CcpV1-style and new CcpV2 style.
- The new style can find items of any type - i.e., no
  longer just routes.
- Here's an example of the new style. Note that you
  don't need to specify the item type (it's optional,
  but helpful to give a human user the context of the
  link). Note also that you can use the item stack ID
  or its stealth secret.
   http://ccpv3/#get?link=e3a9a9f7-0d8e-8e47-332d-1a42232350b8
   http://ccpv3/#get?link=1584955
   http://ccpv3/#get?type=route&link=e3a9a9f7-0d8e-8e47-332d-1a42232350b8
   http://ccpv3/#get?type=route&link=1584955
- Fixed the sharing widget's deeplink widget, which
  previously was just showing some hard-coded test text.
- Flashclient Query_Filters was missing use_stealth_secret.

Fix the sharing widget's action dropdown.
- It was firing the 0th-place event every time repopulate
  was called on the panel, because the change event is
  always called when the dataProvider changes. So now the
  callback checks that the dropdown's open() event has
  recently fired and not the corresponding close() event yet.
- Don't show the create-deeplink action if the deep link
  already exists, or if the user cannot at least edit the
  item.

Fix the secondary name widget on the route panel.
- The maxWidth needed to be set on the name widget...
- I'm still not sure we need the same editable name control
  in the panel header area and also in the route details
  tab panel... but it looks nice above the route length
  (otherwise the route length label looks really lonely...).

Fix problem checking out route.
- Pyserver was not using DISTINCT ON and was returning
  multiple identical route_steps.

Replaced a nasty tight loop in Route_Editor_UI with a
proper wait-for-event-callback-rather-than-spinning-
endlessly-you-silly-gimboid.

------------------------------------------------------------------------
r30082 | landonb | 2013-04-27 17:30:54 -0500 (Sat, 27 Apr 2013) | 48 lines

New ccp.py option, --wide-log, to ignore terminal width when
setting pyserver logging line width (useful for running ccp.py
from cron, where there is no terminal, per se, and output is
just being logged to a file).

Recent permissions changes have been causing failures in some
of the scripts that update uses (i.e., these aren't scripts
writ just for the update but general purpose scripts that
happen to be used by the V1->V2 update, and running the update
tickled these failures).
- They were mostly in item_user_access.prepare_and_save_item.
  The scripts, link_attributes_populate, make_new_branch, etc.,
  had been creating items with an explicit, unchecked collection
  of groups_accesses (GIA records). I enhanced the code to
  check access_style_id and then to vet the groups_accesses
  records the caller sends. So calling prepare_and_save_item is
  no longer a hack but now a valid alternative to commit
  when one wants to make new items (historically, i.e., in 
  CcpV1, you either created new items directly by crafting
  an SQL "INSERT", or you created them in flashclient and
  transmitted them to the server (put_feature/commit);
  in CcpV2, you can also use pyserver item class code to
  create items, but until now this was a little hacky
  because you could just use a collection of GIA records
  and they were blindly accepted. But now we check the
  access_style_id of the item and the GIA records and
  everything's golden and secure.
- New Item Policy was not checking item.real_item_type_id,
  which is used when we partially hydrate an item, e.g.,
  we want a byway's permissions so we just checkout an
  item_user_access object but not a real byway object. Our
  code was using isinstance, but that doesn't work, since
  we have an intermediate type that's masquerading as a
  leafy item; so we use the item class's child_item_types,
  which I thankfully created recently to handle just
  this case, where we want to know what leafy items an
  intermediate item _might_/_could_ be.

pyserver was not saving session_id to group_item_access for
new, anonymously requested routes (or, more accurately,
for new items with 'restricted'-style access created by
anonymous_username). So now when an anonymous user requests
a group, one GIA record is saved -- for the session ID
group along with the user's session ID.

Add constraint to group_membership table to prevent duplicates
(same group_id and user_id but different stack_ids).

------------------------------------------------------------------------
r30061 | landonb | 2013-04-26 02:51:14 -0500 (Fri, 26 Apr 2013) | 1 line

Small fix to route_get.
------------------------------------------------------------------------
r30060 | landonb | 2013-04-26 02:41:14 -0500 (Fri, 26 Apr 2013) | 1 line

Fix issue with debug routed port and running additional finders.
------------------------------------------------------------------------
r30059 | landonb | 2013-04-26 02:39:11 -0500 (Fri, 26 Apr 2013) | 1 line

Fix issue with debug routed port and running additional finders.
------------------------------------------------------------------------
r30058 | landonb | 2013-04-26 02:29:15 -0500 (Fri, 26 Apr 2013) | 1 line

Missing from earlier checkin (duplicate fcn in flashclient).
------------------------------------------------------------------------
r30057 | landonb | 2013-04-26 02:21:58 -0500 (Fri, 26 Apr 2013) | 1 line

What was VERSION.py doing in the source? Oh, well, see ya.
------------------------------------------------------------------------
r30056 | landonb | 2013-04-26 02:20:25 -0500 (Fri, 26 Apr 2013) | 1 line

Remove non-template version of script; shouldn't be in source.
------------------------------------------------------------------------
r30055 | landonb | 2013-04-26 01:09:49 -0500 (Fri, 26 Apr 2013) | 11 lines

Fix problems saving items from shapefile import.
- Caused by recent changes to access_style_id.
  and style_change.
- There were a dozen or so issues.

Fix problem with make_new_branch creating duplicate
group_membership rows (same user and group and
revision, unique stack IDs).

Moved common memory usage logging code to new fcn.

------------------------------------------------------------------------
r30052 | landonb | 2013-04-25 16:34:19 -0500 (Thu, 25 Apr 2013) | 1 line

Change cf.get default from None to '' else it complains if option missing from CONFIG.
------------------------------------------------------------------------
r30048 | landonb | 2013-04-25 08:02:53 -0500 (Thu, 25 Apr 2013) | 136 lines

Merge from Mikhil, r29906 through r29992
  br/masli_statewide-ui-discussions_2784

(Note earlier in r29910 I said I merged
 "r29861 through r29897" but the r29897
 should have been r29906.)

------------------------------------------------------------------------
r29992 | masli | 2013-04-16 17:53:14 -0500 (Tue, 16 Apr 2013) | 1 line

Debugging creating a new note.
------------------------------------------------------------------------
r29978 | masli | 2013-04-10 17:40:38 -0500 (Wed, 10 Apr 2013) | 1 line

Fixed undo, but redo is still broken.
------------------------------------------------------------------------
r29977 | masli | 2013-04-10 16:38:34 -0500 (Wed, 10 Apr 2013) | 1 line

Minor
------------------------------------------------------------------------
r29976 | masli | 2013-04-10 16:37:35 -0500 (Wed, 10 Apr 2013) | 33 lines

Undo-ing and redo-ing still doesn't work correctly. Tested saving new and
deleting existing place-annotation link-values. These work, but both result in
flashclient errors after the commit succeeds. Here are some notes on these
exceptions:

Deletion:

   In Item_Manager::update_items_committed(), there is a loop that iterates
   through all the items that have just been saved and has the command manager
   clear them. However, this loop ignores items that have been deleted.

   What if the item was deleted? In that case, it was item_discard()-ed before
   the commit was called. Hence, it won't be found in the .all[] lookups, and
   hence won't be processed above.

Addition:

   1. When a new link_value is created, Item_User_Access::init_permissions()
      is called, which in turn calls
      Item_User_Access::group_access_add_or_update().
         
   2. Item_User_Access::group_access_add_or_update() doesn't find the
      specified group_id in this.group_accesses and hence, creates a new one
      called grpa.

   3. It calls grpa.dirtyset_add(Dirty_Reason.item_grac).

   4. Group_Item_Access::dirtyset_add() adds itself to the parent item's (i.e.
      the link_value's) dirtyset_gia but doesn't add itself to the collection
      of objects to be sent to the server. This seems inconsistent. Either
      both should happen or neither. So, what's the right behaviour?


------------------------------------------------------------------------
r29971 | masli | 2013-04-09 18:57:34 -0500 (Tue, 09 Apr 2013) | 1 line

Some more minor fixes. Undoing-redoing not working properly w.r.t. deleted link_values.
------------------------------------------------------------------------
r29970 | masli | 2013-04-09 16:59:32 -0500 (Tue, 09 Apr 2013) | 1 line

Some more things about place attachment on notes are working. Undoing doesn't work. Saving untested.
------------------------------------------------------------------------
r29948 | masli | 2013-04-08 18:29:33 -0500 (Mon, 08 Apr 2013) | 1 line

The placebox has arrived on the annotation detail panel!
------------------------------------------------------------------------
r29946 | masli | 2013-04-08 16:14:27 -0500 (Mon, 08 Apr 2013) | 1 line

Fixed issue with place box refresh on re-checkout.
------------------------------------------------------------------------
r29945 | masli | 2013-04-08 15:51:26 -0500 (Mon, 08 Apr 2013) | 1 line

Debugging saving place attachments to posts.
------------------------------------------------------------------------
r29943 | masli | 2013-04-08 15:03:41 -0500 (Mon, 08 Apr 2013) | 1 line

Extract potential common functionality into new base class link_geofeature.py, fix some minor flashclient bugs.
------------------------------------------------------------------------
r29938 | masli | 2013-04-07 23:10:14 -0500 (Sun, 07 Apr 2013) | 1 line

Renaming annotation_highlight to attachment_highlight, adding a new attachment_hover_highlight, fixing other issues with place attachment.
------------------------------------------------------------------------
r29937 | masli | 2013-04-07 17:42:20 -0500 (Sun, 07 Apr 2013) | 1 line

Minor
------------------------------------------------------------------------
r29936 | masli | 2013-04-07 17:41:58 -0500 (Sun, 07 Apr 2013) | 1 line

Attachment mode development. Some things work, some don't.
------------------------------------------------------------------------
r29932 | masli | 2013-04-06 19:52:28 -0500 (Sat, 06 Apr 2013) | 1 line

Basic arrangements for the sticky item selection mode.
------------------------------------------------------------------------
r29931 | masli | 2013-04-06 19:17:12 -0500 (Sat, 06 Apr 2013) | 1 line

More place box integration.
------------------------------------------------------------------------
r29930 | masli | 2013-04-06 17:19:39 -0500 (Sat, 06 Apr 2013) | 1 line

Moving place attachment widgets to panel_items for a more generic use.
------------------------------------------------------------------------
r29929 | masli | 2013-04-05 18:53:29 -0500 (Fri, 05 Apr 2013) | 1 line

Made the posts panel act like the notes panel and share some of the features of being an attachment.
------------------------------------------------------------------------
r29927 | masli | 2013-04-04 19:08:49 -0500 (Thu, 04 Apr 2013) | 1 line

Fixed wierd paginator vanishing behaviour.
------------------------------------------------------------------------
r29926 | masli | 2013-04-04 18:42:31 -0500 (Thu, 04 Apr 2013) | 1 line

Expanding annotation highlighting to other attachment panels such as thread.
------------------------------------------------------------------------
r29925 | masli | 2013-04-04 18:19:32 -0500 (Thu, 04 Apr 2013) | 1 line

Fixed annotation panel highlighting.
------------------------------------------------------------------------
r29921 | masli | 2013-04-03 16:49:15 -0500 (Wed, 03 Apr 2013) | 1 line

Fixing closing of the thread panel and appropriate warnings.
------------------------------------------------------------------------
r29916 | masli | 2013-04-03 13:43:01 -0500 (Wed, 03 Apr 2013) | 1 line

Merge from trunk (untested)
------------------------------------------------------------------------
r29906 | masli | 2013-04-02 15:29:32 -0500 (Tue, 02 Apr 2013) | 1 line

Ensuring that the paginator total gets updated on filter change.
------------------------------------------------------------------------
r29897 | masli | 2013-04-01 19:35:28 -0500 (Mon, 01 Apr 2013) | 1 line

Making reaction counts work.

------------------------------------------------------------------------
r30047 | landonb | 2013-04-25 02:33:41 -0500 (Thu, 25 Apr 2013) | 45 lines

Wrapper for check_cache_now.sh so we don't have to stick a
bunch of environment variables in www-data's crontab (since
cron doesn't support line continuation, it's best to just
call a script from cron and not setup any paths).

Cool Feature: Remote Routed Debugging!
- Added a routed-host and routed-port param
  so you can force route_get.py to talk to
  another server's route daemon instead of
  one of its own.

Lots of scripts fixes:
- to V1->V2 scripts.
- to runic daily cron job scripts (and to lots of the
  scripts that itamae's cron job calls on the CcpV1
  production server that have been broken for, well,
  since the birth of CcpV2).
- to check_cache_now and kill_check_cache.
  - I wrote a bash fcn. to iterate over a faked
    multidimensional array and call a callback
    on each sub-array of parameters. This makes
    it easier to define the set of installation
    folders, database instances, and instance
    branches for each of the cyclopath server
    machines.
  - A new wrapper script template. It specifies
    the details of the installed Cyclopath servers
    so the check_cache_now script knows what to do.

Oops, my earlier calculation of 3000001 for the CcpV2
starting stack ID is wrong -- that was based on a post
v1-v2 update database. We now start at stack ID 1654321.

To svn propget svn:ignore: I addded .vimprojects-bak and log.txt.

Flashclient:
- Fix route finder to send route request if user presses
  Enter when focus is in the 'to' or 'from' text control.

Some comments changes and changes all over the place
because I wanted to remove all differences between my
working copy and the trunk. Next I will merge Mikhil's
and Stephanie's branches against a clean working copy.
Which feels nice.

------------------------------------------------------------------------
r30044 | landonb | 2013-04-24 14:26:08 -0500 (Wed, 24 Apr 2013) | 1 line

Update path to start-stop-daemon for www-data user to start and stop route daemon.
------------------------------------------------------------------------
r30042 | landonb | 2013-04-24 14:07:29 -0500 (Wed, 24 Apr 2013) | 1 line

Mirror of CcpV1 script: Cron job for www-data to update transit database. (This is not for CcpV2, which has a beefier python script that also updates the transit cache in the Cyclopath database; this is just for itamae (I know, "Finally\!").)
------------------------------------------------------------------------
r30036 | landonb | 2013-04-24 00:54:14 -0500 (Wed, 24 Apr 2013) | 7 lines

- Fix grep of pyserver/CONFIG.database from bash
  scripts to recognize underscores in database name.
- More fixes to V1->V2 SQL.
- More fixes to check_cache_now.
  - tilecache_update was missing starting a db transaction.
- kill_check_check now cleans up async_locks table.

------------------------------------------------------------------------
r30033 | landonb | 2013-04-23 22:05:36 -0500 (Tue, 23 Apr 2013) | 1 line

Ability to use --all instead of --changed when calling tilecache_update.
------------------------------------------------------------------------
r30032 | landonb | 2013-04-23 21:27:37 -0500 (Tue, 23 Apr 2013) | 45 lines

Fix saving groupy items in pyserver: need to select
a default for item_stack.access_style_id.
- The item_stack class will also look up this value
  when saving an existing item, if it's not set.

Lots of little fixes to CcpV2 upgrade scripts.
- make_new_branch.py needs to set branch's
  access_level_id to 'permissive'.
  - also wasn't clearing existing new_item_policy
    records when updating an existing branch.

V1-V2 fixes (ug... not more of these!)
- fixes to dupl. key conflicts trying to populate
  item_stack table from existing tables (this is
  new code from last week that hadn't been tested
  during update until now).
- a few places where new item_stack rows weren't
  being populated with access_style_id and/or
  access_infer_id.
- use inline pgsql fcns. to remove inline fcns.
  from where clauses to improve performance.
- Restarting the stack ID sequence at 3000001
  (item_stack_stack_id_seq) so tiles and Cycloplan
  shapefile can use a more static branch ID (otherwise
  I have to rebuild tiles and change the stack ID in
  the shapefile every time I run these dern scripts!;).

New kill_cache_chech.sh script to complement
check_cache_now. It sudo-kills cache checker and
its background child processes.

tilecache_update:
- The skip_cache_table_remake option wasn't
  totally implemented: the check_cache_now
  script showed that it was still going after
  the branch lock, which it doesn't need
  (otherwise we can't run scripts in
  parallel).

check_cache_new: Totally Multi-Threaded!! The script
updates all servers' branches' caches simultaneously, and
then it updates groups of all servers' branches' zoom
levels simultaneously. I've tested one server with two
branches and three zoom level groups and saw six cores in use!

------------------------------------------------------------------------
r30023 | landonb | 2013-04-22 12:54:26 -0500 (Mon, 22 Apr 2013) | 55 lines

DEVS: These are instructions for the changes I made over
the weekend to allow multiple installations of Cyclopath
to happily coexist.

Each Cyclopath installation now has its own sub-directory
in the tilecache-cache folder

You'll need to make the following changes.

1. Edit /etc/apache2/sites-enabled/*.

Change three paths to include the Cyclopath installation
folder name (e.g., your souce code folder in /ccp/dev).

E.g., if my installation is installed to
/ccp/dev/cycloplan_prod, I have this line in my apache conf:

  DocumentRoot /export/scratch/ccp/dev/cycloplan_prod/htdocs

I need to copy the folder name -- cycloplan_prod -- to
PythonInterpreter, MS_MAPFILE, and TileCacheConfig.

And please also note: wms_instance.map is also different,
and so is the path to tilecache.cfg.

  PythonInterpreter minnesota___cycloplan_prod
  ...
  SetEnv MS_MAPFILE /export/scratch/ccp/var/tilecache-cache/cycloplan_prod/wms_instance.map
  ...
  PythonOption TileCacheConfig /export/scratch/ccp/var/tilecache-cache/cycloplan_prod/tilecache.cfg

2. Chmod the daily log location.

When www-data runs check_cache_now.sh and tilecache_update.py,
it'll try to write to the daily log location:

  chmod 2777 /ccp/var/log/daily

3. Update pyserver/CONFIG.

Edit tilecache_cache_dir:

  tilecache_cache_dir: /ccp/var/tilecache-cache/cycloplan_prod

Now is also a good time to make sure server_ip is set. If it's
not set, ./ccp.py -U yourname --no-password will not work.

To get your machine's IP address,

  host -t a ${HOSTNAME} | awk '{print $4}' | egrep ^[1-9]

And then update server_ip. E.g.,

  server_ip: 128.101.34.16

------------------------------------------------------------------------
r30022 | landonb | 2013-04-22 01:25:56 -0500 (Mon, 22 Apr 2013) | 1 line

Update to previous.
------------------------------------------------------------------------
r30021 | landonb | 2013-04-22 01:17:26 -0500 (Mon, 22 Apr 2013) | 26 lines

More of "Fix to running mult. servers for routed.':
- don't set environment variables in pyserver, since
  they are preserved between apache processes.
  RACE CONDITION: If two apache requests are processed
  in parallel, their could be interleaving of examining
  and setting of enviornment variables. We don't want this
  to happen.

Shoveled a path to route analysis:
- A dozen or so little bugs in pyserver and flashclient
  (route analysis code and work item code has been untested
   against the last few months' of changes to pyserver).
- I got as far as downloading the route analysis zip
  file... which I will verify in a GIS app after reinstalling
  Arc (my license expired...)....

Update auto_install: add machine IP to CONFIG. Also
fixes/changes to mapserver and tilecache config and
cache file locations to support multiple Cyclopath
installations.

Fixes for check_cache_now.sh and related mapserver
and tilecache scripts.

Add /byway/cycle_route attribute.

------------------------------------------------------------------------
r30016 | landonb | 2013-04-20 15:01:00 -0500 (Sat, 20 Apr 2013) | 16 lines

More of 'Fix to running mult. servers for routed.':
- don't set environment variables in pyserver, since
  they are preserved between apache processes.
  RACE CONDITION: If two apache requests are processed
  in parallel, their could be interleaving of examining
  and setting of enviornment variables. We don't want this
  to happen.

Shoveled a path to route analysis:
- A dozen or so little bugs in pyserver and flashclient
  (route analysis code and work item code has been untested
   against the last few months' of changes to pyserver).
- I got as far as downloading the route analysis zip
  file... which I will verify in a GIS app after reinstalling
  Arc (my license expired...)....

------------------------------------------------------------------------
r30013 | landonb | 2013-04-20 00:15:06 -0500 (Sat, 20 Apr 2013) | 1 line

Fix to running mult. servers for routed.
------------------------------------------------------------------------
r30010 | landonb | 2013-04-20 00:02:03 -0500 (Sat, 20 Apr 2013) | 1 line

Fix to running mult. servers for routed.
------------------------------------------------------------------------
r30008 | landonb | 2013-04-19 23:33:03 -0500 (Fri, 19 Apr 2013) | 1 line

Fix to running mult. servers for routed.
------------------------------------------------------------------------
r30005 | landonb | 2013-04-19 23:14:01 -0500 (Fri, 19 Apr 2013) | 1 line

Fix to running mult. servers for routed.
------------------------------------------------------------------------
r30004 | landonb | 2013-04-19 22:49:53 -0500 (Fri, 19 Apr 2013) | 14 lines

Fixes for finding new route. Which now works again...
some pyserver stuff was confused because qb.username
is sometimes none for new routes (for node_endpoints,
for one) and flashclient was also confused about handling
a new route (replacing the existing dummy route, switching
to the new panel...).

New attr for clone_(), skip_ids, so callers can choose to
use clone for updating an existing item (via init_update)
or actually creating new items and start with blank IDs
(i.e., delete private item and make public copy, or make a
private copy of a public item). This was done because a
new route was tickling an assert in item_versioned.clone.

------------------------------------------------------------------------
r30001 | landonb | 2013-04-19 19:34:37 -0500 (Fri, 19 Apr 2013) | 1 line

Fix problem running multiple pyserver installations.
------------------------------------------------------------------------
r30000 | landonb | 2013-04-19 17:57:56 -0500 (Fri, 19 Apr 2013) | 1 line

Fixes to previous.
------------------------------------------------------------------------
r29999 | landonb | 2013-04-19 17:27:57 -0500 (Fri, 19 Apr 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r29998 | landonb | 2013-04-19 17:19:42 -0500 (Fri, 19 Apr 2013) | 25 lines

DEVS: Please run

  psql -U cycling [your_ccpv3_database] < /scratch/huffy/ccp/dev/cp_2628/2013.04.19.ccpv3_trunk-r29998.sql

or reload the CcpV2 data from from

  /scratch/huffy/ccp/var/dbdumps/ccpv3-pluto.dump

Changes:

- Reimplemented style_change, used by Gwis to indicate permissions
  changes, and replaced access_scope with access_infer, which does
  the same as both but more -- it indicates an item's general GIA
  records so we can better calculate access scope in the database.
  This is useful when, e.g., a client asks for a list of routes for
  the route library and the server's response includes an indication
  of whether each route is private, shared, public, etc.
  
- In flashclient, when an item is received via GWIS and we already
  have that item, we call item.init(), which calls init_update().
  init_update now calls clone, instead of implementing all that
  code itself.
  
- Fixed some bugs in init_cleanup() when you change branches.

------------------------------------------------------------------------
r29997 | landonb | 2013-04-18 14:24:40 -0500 (Thu, 18 Apr 2013) | 61 lines

Fixed issues saving new items with 'usr_choice'
(or 'pub_choice') access style (like regions
and points, which can be made public or private).
- style_change was not getting set right on the
  commit, or even processed right when it was
  set right... oh, yeah, this code was never
  debugged until now....

Fixed route 'history', or list of recently
viewed routes.
- Added item_findability table to enhance and
  replace route_view (route_views) table.
- Replaced CcpV1's route history get and route
  histor put (which didn't do the same thing:
  get would fetch the list of recent routes,
  and put would mark a route as having been
  recently viewed): now, getting the list of
  recently viewed routes is just a normal item
  checkout cmd, and route history put is replaced
  by item_finability_put (and a new get to
  actually get the settings, so the user
  can now determine an item's visibility, i.e.,
  so routes linked from a route reaction are
  publicly accessible but don't necessarily show
  up in the public route library).
- The route history is all maintained on the
  server now, so using the paginator is simple.
  In CcpV1, the route history was fetched once-
  when the user logged on- and the history was
  thereafter maintained by flashclient (in one
  long list, and clicking a route would immed.
  sent that route to the top of the list...).
  In CcpV2/3/n?, route history is fetched in
  pages by the server using the item_findability
  table and also by looking for new routes with
  matching session IDs (so, i.e., an anonymous
  user can request a route, the user can login,
  and then the user can claim the route and
  save it).
- New query_filters options:
    findability_ignore
      can be used by user to find routes they
      have hidden from their route library.
    findability_recent
      used by the route history panel so it
      can use normal checkout cmd; server
      will join routes against item_findability
      to filter on recent routes the user has
      viewed.
    gia_use_sessid
      to also find items by session ID; was
      implemented in pyserver but wasn't an
      enabled query_filters option until now
- The item_findability is used by the 'restricted'
  access style widget, to let the user configure
  how items are shared (via item library, Web
  link, being part of a discussion, etc.).

Ccp.py now sends a session ID. And pyserver now
actually verifies the client's ID is a valid UUID.

------------------------------------------------------------------------
r29996 | landonb | 2013-04-18 02:46:33 -0500 (Thu, 18 Apr 2013) | 1 line

Update schema update with new item_findability table to help implement route history list.
------------------------------------------------------------------------
r29993 | landonb | 2013-04-17 06:58:14 -0500 (Wed, 17 Apr 2013) | 46 lines

Access_Style:
- Cleaned up (removed obsolete options).
- Added pub_choice to complement usr_choice:
  both mean user is allowed to make new items
  public or private before saving, but usr_choice
  means default is usr_editor, and pub_choice means
  default is pub_editor (and by suggested default I
  mean that's what flashclient uses when the user
  creates the new item; the user can still toggle
  permissions between public and private until they
  save).

Fixed issue with --branch -1 from scripts (revision
gids were not getting initialized).

Flashclient: If you use route library filters while
map is loading, flashclient was not canceling old
library requests, so the last response was populating
the list. Now we cancel outstanding requests when a
new request is sent.

Flashclient: Clicking on emptiness in item details
panel removes focus from input controls.

Flashclient: Finished implementing sharing widget
views. Lots and lots of changes. I still have to
wire the widgets to response (e.g., send gwis req).
Added a copy-to-clipboard icon and functionality
for the stealth secret / web link.

Flashclient: Don't automatically fade out/minimize
tool palette when it's first shown.

Flaschlient: Fixed problem changing panels and old
active panel activating again (because active_panel
and effectively_active_panel weren't being used right).

Flashclient: Lots of cleanup to clone_() commands,
which are more of an update fcn -- it's called to
update local item copies with new data from the
database. We need to keep the original local items
because there are lots of object references to them.
So don't clone everything, but just update what data
you know if fresher and from the server (and not
locally generated).

------------------------------------------------------------------------
r29984 | landonb | 2013-04-12 19:13:35 -0500 (Fri, 12 Apr 2013) | 1 line

Fix region pointer widget to point to Map Settings dropdown instead of side panel tab button.
------------------------------------------------------------------------
r29983 | landonb | 2013-04-12 18:51:07 -0500 (Fri, 12 Apr 2013) | 24 lines

Fixed a problem getting track_points when checking out tracks:
enabling or not enabling dont_load_feat_attcs and/or
do_load_lval_counts made the track_points not always load
(db.dont_fetchall was in use, so when the load-track_points
fcn. was being called, the track hadn't actually being added
to the Many() collection yet).

Test variants of this command:

 ./ccp.py -U torre --no-password \
  -r -t track -G \
  -f only_stack_ids 1552293 \
  -f include_item_aux 1 \
  -f do_load_lval_counts 0 \
  -f dont_load_feat_attcs 0

and also:

  ./ccp.py -i -U landonb --no-password
  from item.feat import track
  tks = track.Many()
  self.qb.filters.include_item_aux = True
  tks.search_by_stack_id(1552293, self.qb)

------------------------------------------------------------------------
r29982 | landonb | 2013-04-12 17:47:12 -0500 (Fri, 12 Apr 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r29981 | landonb | 2013-04-12 17:12:46 -0500 (Fri, 12 Apr 2013) | 37 lines

Biggies:

  1. Recent Changes panel overhaul and fixes.

  2. Map defaults to not 'Allow Editing', and tool palette
     is hidden on startup.  Most item details panel widgets
     are non-editable is this mode (though this'll change
     in the future, as we determine which widgets should be
     useable).

Details:

A few bugfixes to pyserver for recent change gwis:
- Fixed getting geomsummary for group_revision.
- Code wasn't assembling group_revision group_ids, since
  there can be more than one group_id returned and client
  theneeds a list for each revision.
- A typo in filter_by_username.

A track.py typo Fernando pointed out.

Flashclient:

Wired 'Allow Editing' and default editing palette to being
hidden. It fades in when the user enables editing.

Default Point and Region to be named 'Unnamed [item type]'
so we don't have to throw a modal up asking for the name
(which is very disruptive and rude).
- Also animate a little red highlight around the name box
  indicating to the user that they should edit the name.

Overhauled recent changes panel. Much cleaner, better
mouse-list-button interactions, better background when
selected (we draw a custom background color which messes up
the DataGrid's background it draws when a row is selected).

------------------------------------------------------------------------
r29974 | landonb | 2013-04-10 00:35:52 -0500 (Wed, 10 Apr 2013) | 1 line

Update pdf project makefile
------------------------------------------------------------------------
r29973 | landonb | 2013-04-10 00:29:24 -0500 (Wed, 10 Apr 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r29972 | landonb | 2013-04-10 00:10:37 -0500 (Wed, 10 Apr 2013) | 22 lines

V1->V2 scripts: small tweaks for setting up
item_stack.creator_name and fixing some broken
access_style_id assignments.

Commit some comments and asserts I've had
lingering around.

Update Text_Field_Editable.as to highlight
edit control if we want user to know they
should edit the value in the edit control
(so we can get rid of the modal waypoint-
 name popup that disrupts your workflow
 when you create a new point).

Start of a Login_Dropdown class for inline
user registration (it just lines up in a
canvas rigth below the account dropdown in
the header; nothing else is implemented).

Fix some old usages of iterating through G.app.side_panel
when instead code should iterate through G.panel_mgr.panel_lookup.

------------------------------------------------------------------------
r29966 | landonb | 2013-04-09 12:09:06 -0500 (Tue, 09 Apr 2013) | 12 lines

For routes and tracks, new query_filter.include_item_aux,
to ask for route steps-stops or track points on any
request (and not just for search_by_stack_id requests,
which is how gwis.command_.route_get uses the now-
deprecated option dont_load_route_details.

Some fixes to creating geofeatures in flashclient (map
tools) and undo/redo. Also added lots of depopulate()
implementations to handle panels with empty selection
sets that normally expect a collection of a selection
of items.

------------------------------------------------------------------------
r29965 | landonb | 2013-04-09 08:57:43 -0500 (Tue, 09 Apr 2013) | 25 lines

Big Fix: Flashclient historic mode!

Also lots of fixes and beautifications of item details panel for
both Current/Working and Historic revisions.

Details:

* Fix Historic
  - Fix problems reloading revision (in Update_Revision and elsewhere).
  - Fix usage of rev_viewport and rev_workcopy and introduce
    rev_loadnext to help when changing revisions.
  - Fix disabling of map tools in historic mode, also fix widgets to
    hide editable and to display non-editable controls in historic mode.
  - Fix item cleanup when doing meticulous cleanup.

* Fix de-selecting items -- was first crashing on any deselect,
  and then crashing on final deselect, for many different reasons.

* Clean up logger names to be no more than 12 chars wide.
  - Also cleaned up some trace messages not to be so cluttery
    and to do a better job pretty-print-wrapping.

* Rename G.map.mode to G.map.rmode (it's for route reactions, hence
  'r'mode) to better tell it apart from all the other 'mode's.

------------------------------------------------------------------------
r29964 | landonb | 2013-04-09 08:03:32 -0500 (Tue, 09 Apr 2013) | 9 lines

New m4_TALKY log trace macro.

*** DEVS: IMPORTANT ***

You'll need to make a new macros.m4:

cp -f /ccp/dev/cp/flashclient/macros_development.m4 \
      /ccp/dev/cp/flashclient/macros.m4

------------------------------------------------------------------------
r29963 | landonb | 2013-04-09 08:00:55 -0500 (Tue, 09 Apr 2013) | 1 line

Remove incorrect assert. Fix paths to (moved) winpdb.
------------------------------------------------------------------------
r29940 | landonb | 2013-04-08 10:06:24 -0500 (Mon, 08 Apr 2013) | 1 line

Updates to previous.
------------------------------------------------------------------------
r29939 | landonb | 2013-04-08 09:42:52 -0500 (Mon, 08 Apr 2013) | 47 lines


A flock of flashclient fixes:

* Applied Mikhil's UI style on route-finder panel to item
  details panel and its widgets:
  - More whitespace and padding, larger section labels.
  - Using CSS to make tweaking style easy.

* Added Item_Stack class to flashclient.
  - It's not part of the item class hierarchy like in
    pyserver, but only created when needed, i.e., only
    when a user selects an item and we lazy-load more
    details about the item.

* A tiny bit of panel_item/* renaming.

* Fixed/Finished item details panel widgets:
  - Delete item from map
  - Merge selected roads
  - View discussions about item (this is why I split
    out item_stack, so we can lazy-load discussions
    counts)
  - Lots of fixes to sharing widget and to
    calculating selected items' access_style_id

Pyserver fixes and such:

* Tweaked last checkin's fetching of item type
  'Item_User_Access' to now allow fetching of
  'Geofeature' so client can lazy-load annotations
  and discussions counts (for the item details
  panel's discussion widget).

* Fixed query_filters' "do_load_lval_counts", which
  was only working if not "dont_load_feat_attcs",
  but the two should be able to run independently.

* Moved some pyserver/* folders to pyserver/bin:
  - rpy2    low-level R-interface; was maybe originally
            used for early route analysis code, but now
            unused, unless Milhil uses it
  - winpdb  remote python debugger, used regularly by
            Landon
  - rpdb    another remote python debugger, new to
            Landon


------------------------------------------------------------------------
r29935 | landonb | 2013-04-07 02:29:52 -0500 (Sun, 07 Apr 2013) | 1 line

Missing from previous's previous.
------------------------------------------------------------------------
r29934 | landonb | 2013-04-07 02:09:22 -0500 (Sun, 07 Apr 2013) | 1 line

Update database model.
------------------------------------------------------------------------
r29933 | landonb | 2013-04-07 02:04:58 -0500 (Sun, 07 Apr 2013) | 103 lines


Pyserver:

  * Add class attribute, child_item_types, so we can
    checkout intermediate item types (i.e., ask for
    geofeature by stack ID without knowing the type
    of geofeature). This is so the client can get an
    item's access_style without getting the rest of
    the item and so we don't have to write a new cmd.
    (Also added static fcn. get_class_item_lookup
    so we can get the item aggregator via the class.)

  * The branch_hier's leafiest tuple's revision should
    usually be the same as the query_builder's. That is,
    for revision.Current and revision.Historic,
    id(qb.branch_hier[0][1]) == id(qb.revision)

Branches:

  * The branch class does a better job setting
    qb.branch_hier_limit and now behaves like the other
    item types on checkout -- return all branches unless
    the user supplies filters.

  * When making a new branch, use rid_new, not rid_max.

Scripts:

  * Fix branch_coverage_area_update for V1->V2 upgrade.

Grammar:

  * "Descendent" is really spelled descendant.
    Remember: "Ants" have descendants, but who's ever heard
    of an "ent"? Probably only fans of fantasy, or doctors
    of the ear, nost, and throat.

Everything:

  * Sorry, I'm being OCD: For parallelism with similar
    variables, I've renamed instances of 'access_style'
    to 'access_style_id'. (This checkin already requires a
    database update so might as well sneak this in, too...)

Flashclient:

  * Detect if user is in a specific group and show a
    special icon in the banner area if so. We fire an
    event now when the group_memberships are loaded.
    * Members of the Cycloplan group now see Cycloplan and
      Met Council icons.

  * Move views.panel_item_branch to views.panel_branch.
    Also, some misc. updates to the Branch panel and to
    the Sharing widgets.

  * Fix scrolling and scrollbar problem with route item
    panel's TabNavigator (we have to calculate exact
    heights for TabNavigator dataProviders based on
    other components' heights).

  * Fix Query_Filters.equals: it wasn't using array_eqq,
     but was comparing Array == Array, ha!
    And, double ha, array_eqq itself was also broken.
    Oops, triple d'oh, Set.contains_any
     was using 'for' instead of 'for each'.

  * Fix repopulate() ordering so parents are repopulated
    before children widgets (the problem was triggered by
    the sharing widget, which needs data that Panel_Item_Versioned
    assembles in repopulate()). Also fixed some inconsistencies between
    on_panel_show/on_panel_hide and on_show_event/on_hide_event.

  * Lazy-load access_style_id when item is selected. I've
    got it wired to the sharing widget, which still needs
    to be implemented.

# *** Database update

DEVS: You need to do a quick database update.

Your easiest solution is to run a script I've got on huffy.

  psql -U cycling [your_ccpv3_database] < /scratch/huffy/ccp/dev/cp_2628/2013.04.05.ccpv3_trunk-r29933.sql

Your other option is to do it manually:

  INSERT INTO item_type (id, type_name) VALUES (50, 'item_user_access');

  ALTER TABLE new_item_policy RENAME COLUMN access_style TO access_style_id;

  ALTER TABLE item_stack RENAME COLUMN access_style TO access_style_id;

  DROP VIEW nip;
  DROP FUNCTION public.cp_access_style_id (IN style_name TEXT);
  DROP FUNCTION cp_group_make_private_group(TEXT, INT, INT, INT, INT);
  DROP FUNCTION cp_group_membership_new(INTEGER, TEXT, INTEGER, INTEGER, INTEGER, INTEGER, INTEGER);

  # MANUALLY: Search the codebase for the three CREATE FUNCTIONS and the one CREATE VIEW.

================================================


------------------------------------------------------------------------
r29928 | landonb | 2013-04-05 16:44:23 -0500 (Fri, 05 Apr 2013) | 8 lines


Pyserver: Fix item_stack filter to add item_stack to inner.join
          (instead of outer.join) when appropriate.
          
          Fixes flashclient problem using find-route panel's
          "Search in My routes / Everyone's routes".


------------------------------------------------------------------------
r29920 | landonb | 2013-04-03 16:23:59 -0500 (Wed, 03 Apr 2013) | 1 line

Client-side get-new-route fixes -- was adding Route to Geofeature.all twice, and item clone should check it's not trying to clone itself (otherwise bad things happen).
------------------------------------------------------------------------
r29919 | landonb | 2013-04-03 15:38:48 -0500 (Wed, 03 Apr 2013) | 1 line

Fixes to geocoding for route finding.
------------------------------------------------------------------------
r29918 | landonb | 2013-04-03 15:12:52 -0500 (Wed, 03 Apr 2013) | 1 line

I missed changing -a to && in ccpctl when we updated [] to [[]].
------------------------------------------------------------------------
r29914 | landonb | 2013-04-03 03:19:51 -0500 (Wed, 03 Apr 2013) | 40 lines


Pyserver-

* Allow item_stack to have unset access_style -- it just means
  user cannot change item permissions (but user can still edit
  and delete item).

* Fix assert in attachment with filter_by_nearby_edits.

* The item_stack table requires access_style now, just because.
  It's not really necessary for the code, but it requires devs
  to think twice about what they're doing.

Flashclient-

* Fix multiple problems creating new tag and then deleting it.
  Also fix saving and deleting tags and link_value-tags.

* Fix Do/Undo/Redo stack bugs.

* On do or undo or redo, go to the panel of the affected items
  and alter the panel's selection set and the map selection to
  reflect the affected items.

* Fix Save button (and dirty map calculation) to account for
  orphaned attachments (i.e., new tags or new annotations
  with no link values, e.g., make a new tag with a unique
  name and then delete it: the Save Changes button should
  be disabled).

* New depopulate() fcn. to run instead of repopulate() if no
  items are selected. I kept having problems with repopulate
  failing because this.items_selected was null or empty (the
  problems tend to happen on logout, presumably because all
  the items get discarded and maybe their panels are not
  cleaned up? anyway, some detail panels' repopulate()
  implementations blindly assume this.items_selected is set
  and nonzero items long).


------------------------------------------------------------------------
r29912 | landonb | 2013-04-02 20:06:37 -0500 (Tue, 02 Apr 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r29911 | landonb | 2013-04-02 19:50:55 -0500 (Tue, 02 Apr 2013) | 1 line

Fix new_item_policy to remove self from item_versioned and item_stack in addition to its own table on delete.
------------------------------------------------------------------------
r29910 | landonb | 2013-04-02 19:31:31 -0500 (Tue, 02 Apr 2013) | 47 lines


Merge from Mikhil, r29861 through r29897
  br/masli_statewide-ui-discussions_2784

------------------------------------------------------------------------
r29906 | masli | 2013-04-02 15:29:32 -0500 (Tue, 02 Apr 2013) | 1 line

Ensuring that the paginator total gets updated on filter change.
------------------------------------------------------------------------
r29897 | masli | 2013-04-01 19:35:28 -0500 (Mon, 01 Apr 2013) | 1 line

Making reaction counts work.
------------------------------------------------------------------------
r29890 | masli | 2013-04-01 13:44:42 -0500 (Mon, 01 Apr 2013) | 1 line

Getting view my reaction to work
------------------------------------------------------------------------
r29881 | masli | 2013-03-30 17:01:28 -0500 (Sat, 30 Mar 2013) | 1 line

Saving likes/dislikes and textual comments for reactions. Attaching the route and clicking on 'View my Reaction' don't work yet.
------------------------------------------------------------------------
r29875 | masli | 2013-03-29 18:00:47 -0500 (Fri, 29 Mar 2013) | 1 line

Merge from trunk, fix regressions and make create new thread work.
------------------------------------------------------------------------
r29872 | masli | 2013-03-28 17:31:33 -0500 (Thu, 28 Mar 2013) | 1 line

Fixed saving posts to existing threads.
------------------------------------------------------------------------
r29870 | masli | 2013-03-28 13:20:10 -0500 (Thu, 28 Mar 2013) | 1 line

Merge from trunk (the rest)
------------------------------------------------------------------------
r29869 | masli | 2013-03-28 13:19:32 -0500 (Thu, 28 Mar 2013) | 1 line

Merge from trunk
------------------------------------------------------------------------
r29868 | masli | 2013-03-28 12:36:22 -0500 (Thu, 28 Mar 2013) | 1 line

Leftover changes
------------------------------------------------------------------------
r29866 | masli | 2013-03-27 17:03:59 -0500 (Wed, 27 Mar 2013) | 1 line

Clicking on attached revisions and the filter revisions by revision ID filter.
================================================================================================================================


------------------------------------------------------------------------
r29905 | landonb | 2013-04-02 12:57:17 -0500 (Tue, 02 Apr 2013) | 1 line

Some notes for testing tracks.
------------------------------------------------------------------------
r29903 | landonb | 2013-04-02 03:48:22 -0500 (Tue, 02 Apr 2013) | 23 lines


Finally fixed track.py and track_point.py.

These tests work:

  Get all tracks without using GWIS:

    ./ccp.py -U landonb --no-password -r -t track

  Get first 10 results of list of tracks using GWIS:

    ./ccp.py -U landonb --no-password -r -t track -G -C 10

  Test search_by_stack_id:

    ./ccp.py -i -U landonb --no-password
    from item.feat import track
    stack_id = 1549944
    tracks = track.Many()
    tracks.search_by_stack_id(stack_id, self.qb)
    tracks[0].track_points[5].step_number


------------------------------------------------------------------------
r29901 | landonb | 2013-04-02 02:11:59 -0500 (Tue, 02 Apr 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r29900 | landonb | 2013-04-02 02:02:18 -0500 (Tue, 02 Apr 2013) | 16 lines



Pyserver: Set gia_userless when query_build's username=''.

          Also, more calls to finalize_query.

Import: Lots of little fixes to Shapefile import. (It's been a while
        since this script ran.)

        Also, some fixes to saving items, splitting byways, ....

SQL: Fix cp_user_new to work with newish item_stack table.

Scripts: Minor typo fix to link_attributes_populate.py.


------------------------------------------------------------------------
r29887 | landonb | 2013-04-01 10:59:03 -0500 (Mon, 01 Apr 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r29886 | landonb | 2013-04-01 10:57:22 -0500 (Mon, 01 Apr 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r29885 | landonb | 2013-04-01 10:56:39 -0500 (Mon, 01 Apr 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r29884 | landonb | 2013-04-01 10:49:38 -0500 (Mon, 01 Apr 2013) | 24 lines


The filter-by drop-down on the activity panels:

* Consolidated : Merged code from derived classes
  and moved to base class.

* Fixed filters:
  - Filter by a particular region
  - Filter by regions I'm watching
  - Filter by what's visible on the map

* New filters:
  - Filter by other items I'm watching

Pyserver:

* Added GWIS_Nothing_Found exception so we can
  short-circuit checkout if we know no items will
  be found (e.g., filter-by-region-name where name
  matches no region).

* Started fixing tracks checkout.


------------------------------------------------------------------------
r29874 | landonb | 2013-03-29 11:48:33 -0500 (Fri, 29 Mar 2013) | 14 lines


* Oops, last time I checked in link_attributes_populate.py
  I broke it!

* Some minor pyserver comments cleanup.

* Missing comment from previous checkin:
    In pyserver, moved sql_apply_query_filter_by_text (which
    makes the WHERE sub-clause for filters-by-text-search)
    to after calling all sql_apply_query_filters()s so we
    can OR the text searches (since sql_apply_query_filters
    generally ANDs everything instead).


------------------------------------------------------------------------
r29873 | landonb | 2013-03-28 18:53:48 -0500 (Thu, 28 Mar 2013) | 33 lines


DEVS: If "Filter by what is visible in the map" times out
      your link_value table is probably missing some
      indices.
        See: ccpv2-add_constraints.sql

* Fix problem creating new thread and
  displaying new thread panel (was not
  initializing new item via grac manager).

* Add lhs/rhs name to link_value checkout,
  so item_watcher links can tell user what
  name of linked item is.

* If user closes a panel and panel is not
  destroyed, panel_close_pending was not
  being reset, so next time panel was
  activated, it would close when you
  switched tabs.

* Fixed problem with User Account dropdown
  not resetting selectedIndex so you
  could not, e.g., choose the Item Alert
  link twice in a row (since a dropdown
  doesn't send you an event if user selects
  what's already selected).

* Got rid of old, stale item watching code
  and classes.

* Various fixes/changes to sql_apply_query_filters.


------------------------------------------------------------------------
r29865 | landonb | 2013-03-27 16:46:34 -0500 (Wed, 27 Mar 2013) | 10 lines


Merge from Mikhil, r29824 through r29838
  br/masli_statewide-ui-discussions_2784

YES: [lb] missed these two revisions from
     earlier merging...

* Various fixes to threads and thread panel.


------------------------------------------------------------------------
r29864 | landonb | 2013-03-27 15:00:15 -0500 (Wed, 27 Mar 2013) | 19 lines


Merge from Mikhil, r29853 through r29861
  br/masli_statewide-ui-discussions_2784

* Fixed problem in thread's sql_apply_query_filters
  leaving conjunction as "AND" when it should be "OR"
  before calling parent.

* Added about_stack_ids to query filter to find
  threads about certain items (i.e., rather than
  checking out link_values and using only_lhs_stack_ids,
  you checkout threads and use about_stack_ids).

* Various fixes to thread details panels,
  checking out using different filters,
  and attaching or viewing items attached
  to posts.


------------------------------------------------------------------------
r29863 | landonb | 2013-03-27 13:47:20 -0500 (Wed, 27 Mar 2013) | 86 lines


====

DEVS: Update the attribute name, the new_item_policies, and
      make the item watcher link_values. Run these commands.

psql -U cycling [your_ccpv3_database]

  BEGIN;

  UPDATE attribute
    SET value_internal_name = '/item/alert_email'
    WHERE value_internal_name = '/item/watcher/digest';

  -- Verify response is:
  --  UPDATE 1 

  COMMIT;

cd $cp/scripts/setup/runic

  ./new_item_policy_init.py \
    -U landonb --no-password \
    -b 0 --profile='standard' \
    -m "Create new item policies for basemap."

  ./new_item_policy_init.py \
    -U landonb --no-password \
    -b "Metc Bikeways 2012" \
    --profile='standard' \
    -m "Create new item policies for branch."

  ./link_attributes_populate.py

====

Item Watching (Item Alerts) Implementation

* New script link_attributes_populate.py (500 beautiful
  lines I wrote last night!) converts the temporary
  item_watcher_bug_nnnn table into private link_values
  between the /item/alert_email attribute and whatever
  items the users are watching.

* Relax only_lhs_stack_ids contraint in checkout:
  We used to not let the user specify an lhs stack
  ID and ask for all of the link_values because
  this could be a very large query (think asking
  for all speed_limits without specifying a bbox:
  you'd get all byways' speed_limit link_values).
  But item_watching is a private attribute, and
  the item watcher panel shows all of a users'
  watchers, so we need to support this type of
  checkout now (in the future, we might want to
  make a list of "okay" lhs stack IDs and not
  allow checkout on the others without a bbox.
  That, or we should use LIMIT on search results.

* New new_item_policy records for item watcher
  attribute link_values. Now you can specify
  an attribute name and the setup script will
  resolve it to the attribute's stack ID (used
  as the nip's link_left_stack_id).

* search_by_stack_id now returns item_type_id
  so callers can figure out an item type given
  a stack ID.

Statewide UI:

* Oops, I had m4_ASSERT() in search_map; replaced
  with g.assurt().

* Fix Account_Control dropdown's Log Out and Item
  Alerts wiring -- the callbacks were failing to
  fire.

* Started reimplementation of Item Watcher panel.
  When the panel is activated, it sends a GWIS
  checkout and asks the server for all of the
  user's /item/alert_email link_values, which
  is the list of all of the user's item watchers.

====


------------------------------------------------------------------------
r29858 | landonb | 2013-03-26 13:26:20 -0500 (Tue, 26 Mar 2013) | 1 line

Oops, previous changes to sharing widget broke item panel. This fixes it back.
------------------------------------------------------------------------
r29857 | landonb | 2013-03-26 13:17:54 -0500 (Tue, 26 Mar 2013) | 1 line

Undo [lb]'s changes to search: I mistook CcpV1 behavior. We should search internal database first, and then only geocode if nothing was found. See notes in search_map.py.
------------------------------------------------------------------------
r29856 | landonb | 2013-03-26 12:30:13 -0500 (Tue, 26 Mar 2013) | 1 line

Rename files in panel_item_branch to reflect recent changes to branch panel.
------------------------------------------------------------------------
r29855 | landonb | 2013-03-26 10:54:40 -0500 (Tue, 26 Mar 2013) | 28 lines


Merging from Mikhil: r29850 to r29853
Branch: br/masli_statewide-ui-discussions_2784

[ Skipping r29838 to r29850 (is just a merge from CcPV3 trunk). ]

Changes from Mikhil:

* Fix item_read_event_put to store system ID, not stack ID.
  This fixes server assert when viewing discussion posts.

* Misc. fixes to link-route (attaching routes to posts).

* Other minor fixes for discussions and reactions.

Changes from Landon:

* Fixed a problem with stealth secret -- item_stack table
  should be joined in the inner SQL clause.

* Reworked changes to search_map.py (code from [mm] that [lb]
  hadn't actually checked in...). We want geocoded results to
  come first, like in Ccpv1, and we want to return both geocoded
  results and database results together, not just one or the other.

* Panel tabs named after item type now (suggested by [mm]).


------------------------------------------------------------------------
r29849 | landonb | 2013-03-25 10:39:57 -0500 (Mon, 25 Mar 2013) | 20 lines


Statewide UI fixes:

* On Item Details Panel, notes were not loading until
  the second time you viewed a panel (e.g., click item
  on map and item details panel shows, click on empty
  space in map, then click item again).

  - Problem was the widgets marked dirty were not
    having their repopulate() called. The idea is
    that a widget can listen on events (such as 
    notes having been loaded) and repopulate()
    themselves, without bothering to repopulate()
    the entire panel (and all other widgets).

* Minor fixes to Manage Attributes widget on
  branch details panel.



------------------------------------------------------------------------
r29848 | landonb | 2013-03-23 20:41:41 -0500 (Sat, 23 Mar 2013) | 19 lines


More Statewide UI fixes:

- Fix 'Log Out' action.

- Fix scrollbar on viewed routes panel.

- Wire Branch panel and Cycloplan panels.

- Fix scrollbar on Branch panel.

- Minor fixes to changing branches (which
  is still buggy...).

- Changed panel_children -- a Detail_Panel_*'s
  collection of widgets -- from Array to Set
  to avoid possible duplicates.


------------------------------------------------------------------------
r29847 | landonb | 2013-03-22 22:10:51 -0500 (Fri, 22 Mar 2013) | 1 line

Add mxmlc config file for building on Windows (for debugging with fdb). Changes required because of new pdf_printer project.
------------------------------------------------------------------------
r29846 | landonb | 2013-03-22 22:10:15 -0500 (Fri, 22 Mar 2013) | 1 line

Fix 'Create new attribute' from geofeature panel.
------------------------------------------------------------------------
r29845 | landonb | 2013-03-22 21:50:40 -0500 (Fri, 22 Mar 2013) | 1 line

Bugfix: on geofeature panel, clicking button to create a new note and open new attachment panel was crashing.
------------------------------------------------------------------------
r29844 | landonb | 2013-03-22 21:23:46 -0500 (Fri, 22 Mar 2013) | 1 line

Fix panel tab bug: when closing the active panel and it's not the last tab in the side_panel_tabs, a Flex callLater fails because selectedIndex is out of bounds. Fix is to not call removeChild on side_panel_tabs until a later frame.
------------------------------------------------------------------------
r29843 | landonb | 2013-03-22 18:33:26 -0500 (Fri, 22 Mar 2013) | 1 line

Fixing opening and closing Attachment panels -- 1. on open, clear effectively_active_panel so Geofeature panel items do not mistakingly remove themselves from their panel, and 2. on close, unset item<->panel reference, otherwise you'll crash the next time you open the attachment panel.
------------------------------------------------------------------------
r29842 | landonb | 2013-03-22 15:26:00 -0500 (Fri, 22 Mar 2013) | 1 line

Make all DataGrid renderers Detail_Panel_Widgets and hook 'apply' method to set the renderers' detail_panel attributes. See: on_added_renderer_maybe.
------------------------------------------------------------------------
r29841 | landonb | 2013-03-22 14:41:21 -0500 (Fri, 22 Mar 2013) | 1 line

Hook Widget_Annotation_Entry's DataGrid's 'added' event so we can set this.detail_panel on the renderer.
------------------------------------------------------------------------
r29840 | landonb | 2013-03-22 14:00:48 -0500 (Fri, 22 Mar 2013) | 1 line

Fixed crash when opening Annotation panel from Geofeature panel (using 'open' button).
------------------------------------------------------------------------
r29839 | landonb | 2013-03-22 00:08:03 -0500 (Fri, 22 Mar 2013) | 47 lines


Statewide UI fixes:

Lots of item selection and detail panel fixes:

- Closing route details panel was failing if
  you were looking at the route panel.

  - You can now open multiple route panels and
    close them whether they're the active panel
    or not.

- Fixed Route_List issues (on route library panel
  and recently viewed routes panel):

  - The original, non-hydrated route was not
    being added to Geofeature.all, and when
    you clicked a route in the list, the new,
    hydrated route was living alongside the
    old, non-hydrated route.

  - Fixed problem closing route panel and route
    sprite not being removed from map (and client
    crashing if you clicked the sprite with no
    route and no panel).

  - Fixed crash when searching route library -- the
    route list being returned was conflicting with
    routes already in memory. Now, we either ignore
    the route list route or we update the existing
    route.

- Fixed bugs selecting map items (byways, points)
  and making multiple item selections and changing
  selection sets by clicking items on the map or
  tab bar buttons in the side_panel.

  - There was a bug with the custom attribute gridrow
    renderer -- after removeAllChildren, we have to
    callLater before addChild can be called, otherwise
    a Flex callLater throws a null exception.

At this point, you should be able to make item selections
and view routes, and to change the active panel, close
panels, etc., without any crashes.


------------------------------------------------------------------------
r29828 | landonb | 2013-03-21 11:42:42 -0500 (Thu, 21 Mar 2013) | 1 line

Oops, forgot to comment-out SWFExplorer from mxmlc-print.xml
------------------------------------------------------------------------
r29827 | landonb | 2013-03-21 03:39:59 -0500 (Thu, 21 Mar 2013) | 1 line

Bug 2783 - Statewide UI: Dynamically load PDF libraries. Add a new project, pdf_printer.mxml, and a new Makefile-pdf; update auto_install scripts to download third-party PDF libraries and install on dev machine; dynamic library must be loaded before using presses button to generate and save PDF, so we load it after the map has initialized.
------------------------------------------------------------------------
r29822 | landonb | 2013-03-20 17:29:27 -0500 (Wed, 20 Mar 2013) | 7 lines


Merge from Mikhil's br/masli_statewide-ui-more_2766:
  revisions 29812 through 29819

* Mostly label text changes.


------------------------------------------------------------------------
r29821 | landonb | 2013-03-20 17:06:22 -0500 (Wed, 20 Mar 2013) | 51 lines


Merge from Mikhil's br/masli_statewide-ui-more_2766:
  revisions 29790 through 29812

* See Bug 2782 more notes about the merge.

  http://bugs.cyclopath.org/show_bug.cgi?id=2782

* Changing target flash version from Flash 9 to Flash 10.

  See comments and useful SQL in mxmlc-config.xml.

* Added support for generating PDFs. Uses third-party
  PDF libraries and third-party JPEGEncoder replacement
  for Adobe's JPGEncoder.

  ** See Bug 2783 - Statewide UI: Dynamically load PDF libraries

     http://bugs.cyclopath.org/show_bug.cgi?id=2783

     We need to update auto_install with the new libraries,
     and we need to dynamically load the libraries (otherwise
     our main.swf increases from 1.5 Mb to 2.6 Mb).

* Various UI changes:

  ** Route list key now shared between library and recently-viewed tabs.

  ** Moved route feedback widget above all route tabs.

  ** Make tag preferences help toggleable (and collapsed by default).

  ** Replace Search panel back/fwd with proper paginator widget.

  ** Fix route panel cue sheet grid.

  ** Move some common route buttons from details tab to below all tabs.

Some changed from Landon:

* Fixed paddingRight when verticalScrollPolicy="auto" and
  scroll bar comes and goes: when it becomes visible, it
  messes up the paddingRight such that our components touch
  the edge of the scroll bar, so now we add paddingRight.

* On the settings panel I added a dropdown to select the layout style.
  I.e., [mm]'s or [lb]'s. Called Breezy and Squary. Breezy for Mikhil's
  since it utilizes more whitespace than [lb]'s, Squary, which uses more
  box outlines.


------------------------------------------------------------------------
r29820 | landonb | 2013-03-20 16:24:54 -0500 (Wed, 20 Mar 2013) | 1 line

Some minor pyserver bugs fixed and typos corrected, thanks to Mikhil.
------------------------------------------------------------------------
r29815 | landonb | 2013-03-19 14:52:59 -0500 (Tue, 19 Mar 2013) | 1 line

Bugfixes to Statewide UI: fixes to selecting map items and switching panels and item selection.
------------------------------------------------------------------------
r29814 | landonb | 2013-03-19 14:45:49 -0500 (Tue, 19 Mar 2013) | 1 line

Bash script 'fix': change single bracket control lists [] to double brackets [[]]. The latter is the newer, preferred convention; the former is a decades-old relic.
------------------------------------------------------------------------
r29806 | landonb | 2013-03-14 11:05:06 -0500 (Thu, 14 Mar 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r29805 | landonb | 2013-03-14 11:01:43 -0500 (Thu, 14 Mar 2013) | 1 line

Missing from previous.
------------------------------------------------------------------------
r29804 | landonb | 2013-03-14 11:00:41 -0500 (Thu, 14 Mar 2013) | 42 lines


Statewide UI: Continuing implementation and bug fixing of
the new tab bar buttons and their panels.

In this checkin:

  Each panel now has its own items_selected and feats_selected.

  * For Geofeatures, items_selected === feats_selected.

  * For Attachments, items_selected is the one attachment to which
    the panel belongs, and feats_selected is the selection set on
    the map (of Geofeatures).

  * For all other panels, items_selected is empty and feats_selected
    is the map selection, if the panel supports a map selection.

For the most part G.map.selectedset is the same as feats_selected.
With exceptions.

What's not working:

  Clicking items and switching panels -- which should update
  G.map.selectedset based on the panel's feats_selected -- is
  still very buggy.

  But the code at least compiles.

  Just know you'll get lots of runtimes!

  [lb] also left some left-justified priority fixmes that'll
  need to be cleaned up.
  [ compare: meld cp_trunk_v3 ccpv3_29803 & ]

  ** The state changes in the Panel_Item_* classes is not fixed
  (I got rid of a state change in a base class). See
  Panel_Item_Route (and its base class, Panel_Item_Geofeature)
  for an example of changes that need to propagate to the
  other item panel classes.



------------------------------------------------------------------------
r29788 | landonb | 2013-03-05 18:42:08 -0600 (Tue, 05 Mar 2013) | 19 lines


Statewide UI: Continuing implementation and bug fixing of
the new tab bar buttons and their panels.

Comments cleanup: I cleaned up a lot of comments. Got
rid of a lot of FIXMEs. Removed or rejustified lots of
left-justified comments (left-justified comments are
like super-important-FIXMEs, but most of the issues are
resolved, or at least we'll find them once we actually
start testing).

Whitespace cleanup (a/k/a beautification): As long as
I'm cleaning up comments, I figured I'd remove trailing
whitespace from lines, as well. This is mostly because
I've got OCD and I like my cursor to move around the code
predictably. In VIM, run:
  .,$s/ \+$//gc


------------------------------------------------------------------------
r29777 | landonb | 2013-02-20 15:05:35 -0600 (Wed, 20 Feb 2013) | 1 line

Update to previous.
------------------------------------------------------------------------
r29776 | landonb | 2013-02-20 15:00:05 -0600 (Wed, 20 Feb 2013) | 1 line

Update to previous.
------------------------------------------------------------------------
r29775 | landonb | 2013-02-20 14:54:56 -0600 (Wed, 20 Feb 2013) | 1 line

Tons of Statewide UI bugfixes and implementation. See Bug 2781: http://bugs.cyclopath.org/show_bug.cgi?id=2781.
------------------------------------------------------------------------
r29767 | landonb | 2013-02-15 18:17:12 -0600 (Fri, 15 Feb 2013) | 1 line

Add smaller Ccp logo.
------------------------------------------------------------------------
r29766 | landonb | 2013-02-15 18:15:53 -0600 (Fri, 15 Feb 2013) | 1 line

Add smaller Ccp logo.
------------------------------------------------------------------------
r29765 | landonb | 2013-02-15 18:09:43 -0600 (Fri, 15 Feb 2013) | 1 line

Hotfix to previous.
------------------------------------------------------------------------
r29762 | landonb | 2013-02-15 17:10:58 -0600 (Fri, 15 Feb 2013) | 1 line

Merge from Mikhil [mm]: Bug 2766: Statewide UI redesign.
------------------------------------------------------------------------
r29741 | landonb | 2013-02-13 18:17:58 -0600 (Wed, 13 Feb 2013) | 1 line

A few more Copyright year updates.
------------------------------------------------------------------------
r29740 | landonb | 2013-02-13 18:17:06 -0600 (Wed, 13 Feb 2013) | 1 line

A few more Copyright year updates.
------------------------------------------------------------------------
r29739 | landonb | 2013-02-13 18:16:51 -0600 (Wed, 13 Feb 2013) | 1 line

Fix anonymizer scripts (were not updated with route reactions). Fix node_cache_maker's use of db when vacuuming (db.close was indented incorrectly). Fix tilecache_update so --changed works (i.e., how it handles revision.Updated instead of revision.Historic).
------------------------------------------------------------------------
r29736 | landonb | 2013-02-12 10:52:07 -0600 (Tue, 12 Feb 2013) | 1 line

Fix anonymizer scripts, fix db_lite's error-detecting abilities, fix schema-upgrade when used with anonymizer scripts.
------------------------------------------------------------------------
r29733 | landonb | 2013-02-11 17:19:06 -0600 (Mon, 11 Feb 2013) | 1 line

Fixes to db_lite --src-instances
------------------------------------------------------------------------
r29730 | landonb | 2013-02-11 17:03:29 -0600 (Mon, 11 Feb 2013) | 1 line

Fixes to db_lite --src-instances
------------------------------------------------------------------------
r29724 | landonb | 2013-02-08 21:21:09 -0600 (Fri, 08 Feb 2013) | 1 line

Updates for V1-V2 scripts.
------------------------------------------------------------------------
r29720 | landonb | 2013-02-08 17:58:58 -0600 (Fri, 08 Feb 2013) | 1 line

Add Greater_Mn_Defs stub for new Statewide branch.
------------------------------------------------------------------------
r29715 | landonb | 2013-02-08 12:12:26 -0600 (Fri, 08 Feb 2013) | 1 line

Add --config switch to call to tilecache_seed.py from tilecache_update.py.
------------------------------------------------------------------------
r29714 | landonb | 2013-02-08 11:35:22 -0600 (Fri, 08 Feb 2013) | 1 line

Lots of GUI updates. Got rid of the sub-tabs on Item Details panel and put everything in a long list (looks better and works better on taller screens). Lots of FIXMEs, though... don't expect the item details panel to work much (but it looks good).
------------------------------------------------------------------------
r29694 | landonb | 2013-02-07 21:36:52 -0600 (Thu, 07 Feb 2013) | 1 line

fixperms.sh should prefer to use ccpdev's fixperms
------------------------------------------------------------------------
r29682 | landonb | 2013-02-06 15:46:00 -0600 (Wed, 06 Feb 2013) | 1 line

Silly typo.
------------------------------------------------------------------------
r29681 | landonb | 2013-02-06 15:43:34 -0600 (Wed, 06 Feb 2013) | 1 line

Silly typo.
------------------------------------------------------------------------
r29679 | landonb | 2013-02-06 13:36:07 -0600 (Wed, 06 Feb 2013) | 1 line

Update to previous.
------------------------------------------------------------------------
r29678 | landonb | 2013-02-06 13:12:45 -0600 (Wed, 06 Feb 2013) | 1 line

Update to previous.
------------------------------------------------------------------------
r29677 | landonb | 2013-02-06 13:11:39 -0600 (Wed, 06 Feb 2013) | 1 line

Performance enhancements to pyserver SQL (get rid of inner group by, replace user-group-memberships table joins with a where on the user group IDs, and make indices for common order by clauses). Also some update to mapserver scripts.
------------------------------------------------------------------------
r29676 | landonb | 2013-02-06 12:54:01 -0600 (Wed, 06 Feb 2013) | 1 line

Update Copyright headers.
------------------------------------------------------------------------
r29675 | landonb | 2013-02-06 12:45:28 -0600 (Wed, 06 Feb 2013) | 1 line

Update database model.
------------------------------------------------------------------------
r29663 | landonb | 2013-01-30 12:40:46 -0600 (Wed, 30 Jan 2013) | 1 line

Fix db_lite script. Various auto_install fixes/improvements.
------------------------------------------------------------------------
r29629 | landonb | 2013-01-16 19:18:31 -0600 (Wed, 16 Jan 2013) | 1 line

Fix bash_base.sh location
------------------------------------------------------------------------
r29625 | landonb | 2013-01-16 13:39:51 -0600 (Wed, 16 Jan 2013) | 79 lines


Overhauled TileCache and MapServer scripts.

- Now, tilecache.cfg and the wms.map file are generated by
  custom Python scripts. This is to get around some
  limitations with LAYER in MapServer, and limititations
  to how you can config layers in tilecache.cfg.

- Fixed tag problem -- there's now a "cluster" cache that
  coalesces connected byways with the same name and makes
  one long line segment. We still need to tweak how the
  label priority is determined, however.

- Lots of performance improvements... possibly with more
  to come.

  - Increased metasize from 3 to 20. This means TileCache
    asks MapServer to make a tile 20 times larger on each
    edge, and then TileCache chops it up into 400 smaller
    tiles of the desired size. This means there are 400
    times fewer database calls, and less separate rendering.
    Note that 20 is the ideal value only based on empherical
    evidence; this value might need to be decreased or
    increased for some machines (I've only tested on my
    laptop).

  - Fixed the line segment cache so it stores information
    about "embellishments" (i.e., bike facility, restricted,
    etc.) which greatly simplifies the MapServer SQL (so it
    doesn't have to join a bunch of tables).

- Implemented locking mechanisms. In CcpV1 on the live site,
  we only call tilecache update every 15 minutes, so that
  we can avoid overlapped calls, I assume. Now, the script
  can be called every minute, and it aborts quickly if it
  sees that it's already running. Also, developers can run
  the script themselves, and table row locks prevent working
  on the same branch cache simultaneously (so you don't have
  to disable the cron script if you want to run the script
  manually).

- Adding branch skinning and leafy branch tile creation! I.e.,
  now the Metc Bikeways branch on runic gets its own set of
  tiles. Also, it's easy to change the tile look-n-feel, and
  we can support multiple looks-n-feels for each branch, as 
  desired.

- Fixed/Automated branch bbox calculation. That is, in CcpV1,
  the coverage_area table was used to filter geocoded results.
  Also, there was a bbox in tilecache.cfg. But neither of these
  were ever updated (and there was no note anywhere indicating
  we should keep these values up to date). Now, the new cron
  script, check_cache_now.sh, calls gen_tilecache_cfg.py, which
  makes sure the bbox is up to date.

Some fixes and updates to pyserver based on aforementioned
TileCache script changes.

- Also, fixed route finding, which was broke (though not sure
  when -- the SQL was still referencing byway_node and not
  node_endpoint). There was also incorrect usage of the qb.
  (I think when I merged route reactions I messed this up.)

Flashclient is a bit of a mess. I'm working on the Item
Details panels and fixing the permissions widget, among
other improvements. I'll check in this code next, and then
I want to merge Mikhil's Statewide UI changes...

Changed SVN references from frost.cs to runic.cs, since
frost is MIA.

Consolidate specialized --groups script_args behavior:
now a class attr, and specifying special group 0 includes
both 'All Users' public group and _anon_user_[instance]
private group. CLI scripts can also now specify if they
expect just one group name or ID.



------------------------------------------------------------------------
r29575 | landonb | 2013-01-06 17:51:40 -0600 (Sun, 06 Jan 2013) | 16 lines


Long time no check in!

Fixed MapServer and TileCache.

Two new cache tables:
 * one for byways for which to make tiles;
 * and another for labels for which to label byways.

Respeks permissions and branching (i.e., one set of tiles for each branch).

Revamped skin file. Should be easier to make new color and design schemes for tiles.

Made mapfile-maker script to hack around MapServer limitations: new map file is 282842 lines long! Hooray for LAYERs!!


------------------------------------------------------------------------
r29558 | landonb | 2012-12-22 17:01:22 -0600 (Sat, 22 Dec 2012) | 1 line

Update CcpV2 upgrade scripts.
------------------------------------------------------------------------
r29477 | landonb | 2012-11-26 13:20:51 -0600 (Mon, 26 Nov 2012) | 38 lines


* V1->V2 Schema scripts: Add new well-known groups: one for session
  IDs and one for stealth secrets.

  ** By adding well-known groups, we can let the owner of a route
     specify specific permissions for people with the stealth UUID,
     i.e., in CcpV1, sharing a link would always give people just
     viewer access to an item and then the owner could not change
     those permissions. In CcpV2, owners can give viewer or editor
     access to a UUID link, and they can even mark UUID access
     denied, if they want.

  ** The session ID group is used to give arbiter access to items
     created by anonymous users. The user has arbiter access so long
     as their session ID is active.

* Simplified access level: removed stealth as an access level, since
  it makes more sense to use a special stealth user group and then
  to assign a real access level, like viewer or editor.

* Route Planner: bugfixes. The Routed Planner p1 seems to work now:
  you can request a route and it seems to get saved with the proper
  permissions (i.e., if you're anonymous, a session ID GIA record
  is created).

  ** The flashclient is not wired to change permissions, or to use
     the new style_change options.

* Flashclient Update_* classes: added some events so we can wait
  until the map loads before we waste bandwidth and cycles loading
  less important data, like latest activity and the route library
  (that is, we want the map tiles to be drawn as soon as possible
  on application start). There's still a little more work to be
  done to get tiles loaded faster, but this is a start...

* Misc. Flashclient fixes to UI widgets and whatnots.


------------------------------------------------------------------------
r29462 | landonb | 2012-11-20 17:03:19 -0600 (Tue, 20 Nov 2012) | 1 line

Update Config_Logging with new files' logger names.
------------------------------------------------------------------------
r29461 | landonb | 2012-11-20 16:44:47 -0600 (Tue, 20 Nov 2012) | 1 line

Missing Conf_Instance updates from previous.
------------------------------------------------------------------------
r29460 | landonb | 2012-11-20 16:33:10 -0600 (Tue, 20 Nov 2012) | 1 line

A ton of small fixes, mostly to the discussions and route panels in flashclient, but also a few bugs fixed in pyserver. Split the route library into two, since the same file had disparate code for each of the two tabs it handled. Also, the last build did not build because I missed a file on a checkin, oops.
------------------------------------------------------------------------
r29454 | landonb | 2012-11-16 19:40:13 -0600 (Fri, 16 Nov 2012) | 20 lines


* Bug 2765 - Flashclient: Discussions:
  Don't use [Bindable] on Array (use ArrayCollection)

** Also moved all [Bindable]s to same line as the 
   definition, so we can easily audit correct usage
   (what I did to find the half-dozen or so instances
    of "[Bindable] Array", which are pointless, since
    Array doesn't fire events on push/pop).

* Lots of little fixes to the Latest Activity panels
  (i.e., discussions and route reactions).

** I fixed the paginators, fixed the width of a few
   components, and fixed the height of the DataGrids
   (you have to wait for the DataGridColumn itemRenderers
    to render themselves before you can set the appropriate
    aggregate height).


------------------------------------------------------------------------
r29453 | landonb | 2012-11-16 11:08:14 -0600 (Fri, 16 Nov 2012) | 35 lines


REGARDING: There's a Big Bug in [the last] code drop.

           It's fixed.

           See: Bug 2764 - Flex bug?: Default
           horizontalScrollPolicy causing two minutes
           of blocking, memory-gobbling activity.

ALSO FIXED:

* A derived class was changing State and then the base
  class was changing State to one of the derived class'
  state. But since the parent class went first, the 
  effect was nilled. This was a cxpx error.

* Changed lingering names named WFS to GWIS.

* Added some explicit removeEventListener calls.

* Fixes to spam.py, emails_for_spam.py, and related fcns.
  in user.py.

PARTIALLY ADDRESSED:

* Bug 2763: No funny email addresses.

* Starting to fix view problems, cmd problems, etc. caused
  by the route sharing and route reactions code merge. That
  is to say, I've tested loading the application and looking
  at panels. The tiles load and features load when you zoom
  in. I haven't tested anything else, and you'll see some
  empty lists (e.g., the routes list).


------------------------------------------------------------------------
r29432 | landonb | 2012-11-13 12:54:09 -0600 (Tue, 13 Nov 2012) | 1 line

spam script bugfix
------------------------------------------------------------------------
r29429 | landonb | 2012-11-12 20:25:31 -0600 (Mon, 12 Nov 2012) | 1 line

Moving CcpV3 trunk to trunk dir.
------------------------------------------------------------------------
r29428 | landonb | 2012-11-12 20:17:40 -0600 (Mon, 12 Nov 2012) | 37 lines


//*//*//*//*//*//*//*//*//*//*//*//*//*//*//*//*//*//*//

WARNING: There's a Big Bug in this code drop.

It may also exist in earlier checkins that broke
Flashclient, since this is the first time since adding
route reactions and maybe route sharing that I've been
able to load Flashclient.

But on load, Flashclient spins for 1m54s, gobbling
memory and CPU, before finally loading tiles.

I'm not sure what's looping, since there was a lot of
code from route reactions and route sharing. It could
be anywhere!

Hopefully, this problem can be solved by using the flash
debugger, a/k/a fdb.

//*//*//*//*//*//*//*//*//*//*//*//*//*//*//*//*//*//*//

Client updates:

* Remove specialized GWIS_Route_Feedback_Ask_Me_Later.as
  and GWIS_Route_Share.as and just use GWIS_Commit.as.

* Replace Page_Selector with Paginator_Widget.

* Don't reload map on save -- update new items with their
  new permanent stack ID, and then checkout all the saved
  items and update them in the background.

* Lots and lots of little fixes to get new route reactions
  and route sharing code to run.


------------------------------------------------------------------------
r29427 | landonb | 2012-11-12 19:50:01 -0600 (Mon, 12 Nov 2012) | 32 lines


Lots of server updates:

* Universal support for saving anonymously even when logged
  in (a/k/a anon_coward).

* Renamed thread_id to thread_stack_id.
  Renamed context_item_id to context_stack_id.

* Inverted qb.filters.dont_load_lval_counts (now
  qb.filters.do_load_lval_counts) since the client doesn't
  always want it and its costly to calculate.

* New filters option, max_access_level, to handle route
  library list requests.

* A few filters were being incorrectly prepared by ccp.py.

* post.One objects now have a reference to the thread.One
  object, rather than just its stack_id.

* New thread_type.py class to complement route reaction's
  ttype attribute (which indicates if a thread and its
  posts are a general discussion or a route reaction
  discussion).

* When loading routes, creating XML was failing because
  geometry was empty string instead of None. So I loosened
  things to not be so strict (i.e., don't just check if 
  not None, but also if not '').


------------------------------------------------------------------------
r29426 | landonb | 2012-11-12 19:31:52 -0600 (Mon, 12 Nov 2012) | 1 line

Various scripts updates. Also fixed log_jammin to work with V3/V2/V1 hierarchy.
------------------------------------------------------------------------
r29425 | landonb | 2012-11-12 19:28:30 -0600 (Mon, 12 Nov 2012) | 1 line

Bug 2756: Emailing Users: Formal Instructions, Script Updates
------------------------------------------------------------------------
r29359 | landonb | 2012-10-31 16:47:43 -0500 (Wed, 31 Oct 2012) | 1 line

Update V1->V2 sql scripts.
------------------------------------------------------------------------
r29358 | landonb | 2012-10-31 10:21:15 -0500 (Wed, 31 Oct 2012) | 1 line

Bugfix to pyserver.
------------------------------------------------------------------------
r29357 | landonb | 2012-10-31 10:01:01 -0500 (Wed, 31 Oct 2012) | 1 line

Lots of updates to route reactions and route sharing widgets.
------------------------------------------------------------------------
r29356 | landonb | 2012-10-31 09:10:21 -0500 (Wed, 31 Oct 2012) | 1 line

Moving icons around in the assets folder.
------------------------------------------------------------------------
r29355 | landonb | 2012-10-31 09:10:04 -0500 (Wed, 31 Oct 2012) | 1 line

Moving icons around in the assets folder.
------------------------------------------------------------------------
r29353 | landonb | 2012-10-30 12:00:34 -0500 (Tue, 30 Oct 2012) | 15 lines


/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*

                      MERGE FROM V1 TRUNK                      

    Updated V2 from V1 trunk: revisions 27178 through 29280.    

        ** Includes Route Sharing and Route Reactions.**        

STATUS: flashclient compiles and pyserver loads, buts lots of
        runtime errors (null pointer exceptions, 'natch!) exist.

*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/


------------------------------------------------------------------------
r29334 | landonb | 2012-10-23 19:19:50 -0500 (Tue, 23 Oct 2012) | 15 lines


New item_stack class to complemented item_stack table.

Replaced new_item_rights construct with access_style.

Revamped item classes' "schema_cols" implementation.

Moved out email address from being embedded in the code
to the conf file.

Lots and lots of V2->V3 fixes... oh, yeah, "V3" is
CcpV2 + Route Sharing + Route Reactions... it's really
just CcpV2 + Everything new to CcpV1 since Feb, 2012.


------------------------------------------------------------------------
r29315 | landonb | 2012-10-22 18:13:39 -0500 (Mon, 22 Oct 2012) | 1 line

Bug 2739 - Scripts: Add Metadata to All Shapefiles
------------------------------------------------------------------------
r29312 | landonb | 2012-10-20 10:29:52 -0500 (Sat, 20 Oct 2012) | 1 line

V1->V2 fix: rename files to fix ordering.
------------------------------------------------------------------------
r29305 | landonb | 2012-10-19 11:16:53 -0500 (Fri, 19 Oct 2012) | 1 line

Update V1->V2 scripts.
------------------------------------------------------------------------
r29304 | landonb | 2012-10-19 11:14:59 -0500 (Fri, 19 Oct 2012) | 1 line

Update V1->V2 scripts.
------------------------------------------------------------------------
r29295 | landonb | 2012-10-18 16:25:37 -0500 (Thu, 18 Oct 2012) | 1 line

Missing from previous: shell script to define which tables we can exclude from lite db dumps.
------------------------------------------------------------------------
r29293 | landonb | 2012-10-18 16:01:26 -0500 (Thu, 18 Oct 2012) | 1 line

New script missing from previous.
------------------------------------------------------------------------
r29292 | landonb | 2012-10-18 16:00:52 -0500 (Thu, 18 Oct 2012) | 1 line

Update V1->V2 scripts: include new drag-based route feedback tables and missing route reaction tables, convert new_item_rights to new access_style feature, and remove some database setup that is now performed by helper scripts.
------------------------------------------------------------------------
r29291 | landonb | 2012-10-18 15:55:06 -0500 (Thu, 18 Oct 2012) | 1 line

Update db setup scripts: use new access_style feature, and fill in some missing new_item_policies.
------------------------------------------------------------------------
r29290 | landonb | 2012-10-18 15:53:41 -0500 (Thu, 18 Oct 2012) | 1 line

Replace db_clone with db_lite: db_clone did a simple pg_dump and pg_restore, but you should instead just pg_dump and postgis_restore (which is two easy commands, so really no need for a shell script wrapper; new db_lite script calls pg_dump and excludes heavy tables (like apache_event_session, log_event, etc.), uses postgis_restore to load the partial database, then pg_dumps the missing tables' schema and pg_restores said missing schema.
------------------------------------------------------------------------
r29289 | landonb | 2012-10-18 15:49:50 -0500 (Thu, 18 Oct 2012) | 1 line

Bug 2734 - Scripts: Fix ogr2ogr warnings and other issues.
------------------------------------------------------------------------
r29288 | landonb | 2012-10-18 15:48:43 -0500 (Thu, 18 Oct 2012) | 1 line

Add Shapefile export directory hierarchy, metadata files, and READMEs.
------------------------------------------------------------------------
r29279 | landonb | 2012-10-17 18:57:56 -0500 (Wed, 17 Oct 2012) | 1 line

Bug 2736 - Scripts: Apache2sql.py: Multiple issues
------------------------------------------------------------------------
r29269 | landonb | 2012-10-16 19:16:26 -0500 (Tue, 16 Oct 2012) | 1 line

Bug 2735 - Scripts: Aliases.py: A few issues
------------------------------------------------------------------------
r29265 | landonb | 2012-10-16 18:41:47 -0500 (Tue, 16 Oct 2012) | 1 line

Sync from CcpV1: schema scripts for Bug 2714 - Implement dragging-based route feedback mechanism.
------------------------------------------------------------------------
r29264 | landonb | 2012-10-16 18:41:36 -0500 (Tue, 16 Oct 2012) | 1 line

Sync CcpV1/V2/V3 schema scripts: Use same license so diff works better, and copy notes amongst the three branches.
------------------------------------------------------------------------
r29169 | landonb | 2012-10-01 12:15:35 -0500 (Mon, 01 Oct 2012) | 1 line

Convert aliases.py to CcpV2 (inherit from Script_Args and Script_Base), which allows us to fix bug 1572.
------------------------------------------------------------------------
r29168 | landonb | 2012-10-01 12:15:10 -0500 (Mon, 01 Oct 2012) | 1 line

Update V1->V2 scripts.
------------------------------------------------------------------------
r29156 | landonb | 2012-09-27 17:34:05 -0500 (Thu, 27 Sep 2012) | 1 line

Route Sharing and Other updates to V1->V2 SQL scripts.
------------------------------------------------------------------------
r29152 | landonb | 2012-09-26 16:50:37 -0500 (Wed, 26 Sep 2012) | 1 line

Route Sharing updates.
------------------------------------------------------------------------
r29144 | landonb | 2012-09-25 00:25:52 -0500 (Tue, 25 Sep 2012) | 1 line

Minor flashclient checkin
------------------------------------------------------------------------
r29141 | landonb | 2012-09-24 21:09:37 -0500 (Mon, 24 Sep 2012) | 1 line

Route Sharing pyserver bugfixes.
------------------------------------------------------------------------
r29136 | landonb | 2012-09-24 15:35:38 -0500 (Mon, 24 Sep 2012) | 1 line

New qb.filters: do_load_latest_note
------------------------------------------------------------------------
r29134 | landonb | 2012-09-24 15:27:05 -0500 (Mon, 24 Sep 2012) | 1 line

Split long SQL script into three.
------------------------------------------------------------------------
r29127 | landonb | 2012-09-24 11:47:57 -0500 (Mon, 24 Sep 2012) | 1 line

Update V1-V2 sql.
------------------------------------------------------------------------
r29126 | landonb | 2012-09-23 22:49:58 -0500 (Sun, 23 Sep 2012) | 1 line

schema-upgrade: simple bugfix
------------------------------------------------------------------------
r29124 | landonb | 2012-09-22 16:23:29 -0500 (Sat, 22 Sep 2012) | 1 line

1. Bug 2729- track_point has duplicate rows. 2. rename item_versioned_stack_id_seq to item_stack_stack_id_seq. 3. More V1->V2 bugfixes.
------------------------------------------------------------------------
r29117 | landonb | 2012-09-21 10:07:28 -0500 (Fri, 21 Sep 2012) | 1 line

Bugfixes: V1->V2 SQL upgrade scripts.
------------------------------------------------------------------------
r29115 | landonb | 2012-09-20 22:09:14 -0500 (Thu, 20 Sep 2012) | 1 line

Bugfixes: V1->V2 SQL upgrade scripts.
------------------------------------------------------------------------
r29114 | landonb | 2012-09-20 20:17:33 -0500 (Thu, 20 Sep 2012) | 1 line

Bug 2729 - Colorado: Database: Two tables have duplicate rows. Work-around: using DISTINCT ON in V1->V2 upgrade script (so the problem will persist in the CcpV1 database but it'll be fixed in the CcpV2 database).
------------------------------------------------------------------------
r29110 | landonb | 2012-09-20 15:00:42 -0500 (Thu, 20 Sep 2012) | 1 line

Bugfixes to V1->V2 script for route sharing.
------------------------------------------------------------------------
r29106 | landonb | 2012-09-20 14:10:38 -0500 (Thu, 20 Sep 2012) | 1 line

Preliminary CcpV2 updates to Route Sharing code. Pyserver has lots of work left, but hopefully we can get the SQL scripts running soon.
------------------------------------------------------------------------
r29078 | landonb | 2012-09-18 13:42:45 -0500 (Tue, 18 Sep 2012) | 1 line

Update from trunk. SIX MONTHS of changes... ug.
------------------------------------------------------------------------
r29068 | landonb | 2012-09-17 18:08:37 -0500 (Mon, 17 Sep 2012) | 1 line

Update doc/ from CcpV2 trunk.
------------------------------------------------------------------------
r29063 | landonb | 2012-09-17 17:54:45 -0500 (Mon, 17 Sep 2012) | 1 line

Copy android from V1 trunk.
------------------------------------------------------------------------
r29062 | landonb | 2012-09-17 17:54:11 -0500 (Mon, 17 Sep 2012) | 1 line

Unable to update android using merge, so whacking and re-copying from V1 trunk.
------------------------------------------------------------------------
r28677 | landonb | 2012-07-18 07:57:11 -0500 (Wed, 18 Jul 2012) | 1 line

Moving forked branch
------------------------------------------------------------------------
r27548 | landonb | 2012-03-13 22:03:58 -0500 (Tue, 13 Mar 2012) | 1 line

auto_install: consolidate common m4 --defines. Installed successfully on Ubuntu 11.04. Does that mean the auto_install scripts are finally perfect?
------------------------------------------------------------------------
r27547 | landonb | 2012-03-13 21:49:58 -0500 (Tue, 13 Mar 2012) | 1 line

auto_install: quirky bugfixes for Ubuntu 11.04 (things that are not problems in Ubuntu 10.04, like adding subdirs of site-packages to PYTHONPATH).
------------------------------------------------------------------------
r27545 | landonb | 2012-03-13 19:34:15 -0500 (Tue, 13 Mar 2012) | 1 line

auto_install: fix package expectations for Ubuntu 11.04; also cannot always copy ~/mm.cfg so do not bail if fail.
------------------------------------------------------------------------
r27543 | landonb | 2012-03-13 19:01:02 -0500 (Tue, 13 Mar 2012) | 1 line

auto_install updates: make log/pyserver writable by apache.
------------------------------------------------------------------------
r27542 | landonb | 2012-03-13 18:59:55 -0500 (Tue, 13 Mar 2012) | 1 line

auto_install updates: make log/pyserver writable by apache.
------------------------------------------------------------------------
r27536 | landonb | 2012-03-13 18:29:15 -0500 (Tue, 13 Mar 2012) | 1 line

fix sys.path[0] == '' prob
------------------------------------------------------------------------
r27533 | landonb | 2012-03-13 17:42:49 -0500 (Tue, 13 Mar 2012) | 1 line

auto_install: fix apache and postgres log file permissions.
------------------------------------------------------------------------
r27523 | landonb | 2012-03-13 12:18:42 -0500 (Tue, 13 Mar 2012) | 1 line

Fix pyserver_glue problem. It was working fine, but now sys.path[0] is coming up '' and so we get hosed looking for pyserver/. Replaced sys.path[0] with os.curdir and things seem to work....
------------------------------------------------------------------------
r27520 | landonb | 2012-03-13 11:54:28 -0500 (Tue, 13 Mar 2012) | 1 line

Fix fcsh-wrap: the PID files are not reliable, so try/except os.kill and do a smarter kill if that fails.
------------------------------------------------------------------------
r27519 | landonb | 2012-03-13 11:53:19 -0500 (Tue, 13 Mar 2012) | 1 line

auto_install: if sys files diff, show diff and prompt; fix perms on psycopg2 so apache can load it; support for installing more than one branch and database; setup new /ccp/var/log folders; make ccp_mkdir always chmod 2775.
------------------------------------------------------------------------
r27502 | landonb | 2012-03-12 21:42:46 -0500 (Mon, 12 Mar 2012) | 1 line

Ignore tags in services/
------------------------------------------------------------------------
r27496 | landonb | 2012-03-12 13:23:05 -0500 (Mon, 12 Mar 2012) | 1 line

auto_install: bugfixes (in bash, when using -z or -n, you must quote your env. var.; fixed the debug flash installer).
------------------------------------------------------------------------
r27492 | landonb | 2012-03-11 15:34:47 -0500 (Sun, 11 Mar 2012) | 1 line

Finished merging revisions 24623 through 27178, a/k/a route sharing (search 'route manip' in the code). The build is broken until the code is syntax-corrected (i.e., v1 names -> v2 names, permissions/visibility -> group access control, etc.) and debugged.
------------------------------------------------------------------------
r27491 | landonb | 2012-03-11 14:31:23 -0500 (Sun, 11 Mar 2012) | 1 line

More route sharing merges into pyserver. All that's left (aside from fixin' and debuggin') is to complete the merge of route_step.py.
------------------------------------------------------------------------
r27490 | landonb | 2012-03-11 14:04:17 -0500 (Sun, 11 Mar 2012) | 1 line

More route sharing merges into pyserver. All that's left to complete the merge (aside from fixing syntax and debugging) are two files: route.py and route_step.py.
------------------------------------------------------------------------
r27489 | landonb | 2012-03-11 12:19:19 -0500 (Sun, 11 Mar 2012) | 1 line

V1-V2 sql bugfix.
------------------------------------------------------------------------
r27488 | landonb | 2012-03-11 12:15:58 -0500 (Sun, 11 Mar 2012) | 1 line

V1-V2 sql bugfix.
------------------------------------------------------------------------
r27487 | landonb | 2012-03-11 12:05:40 -0500 (Sun, 11 Mar 2012) | 1 line

V1-V2 sql bugfix.
------------------------------------------------------------------------
r27485 | landonb | 2012-03-10 21:49:35 -0600 (Sat, 10 Mar 2012) | 1 line

More pyserver route manip/sharing integrate/ing.
------------------------------------------------------------------------
r27484 | landonb | 2012-03-10 21:17:44 -0600 (Sat, 10 Mar 2012) | 1 line

Integrating pyserver and route sharing (route manip). If you want a working copy of Cyclopath, go back to a previous revision. Or wait a week.
------------------------------------------------------------------------
r27483 | landonb | 2012-03-10 19:36:42 -0600 (Sat, 10 Mar 2012) | 1 line

V1-V2 sql. No such thing as create temporary function. Bah.
------------------------------------------------------------------------
r27482 | landonb | 2012-03-10 19:32:25 -0600 (Sat, 10 Mar 2012) | 1 line

Last of the flashclient route manip (route sharing) code to be 'integrated'. By which I mean, copy-and-pasted from the V1 trunk into V2. Happy debugging\!
------------------------------------------------------------------------
r27481 | landonb | 2012-03-10 19:14:27 -0600 (Sat, 10 Mar 2012) | 1 line

Fix v1-v2 update.
------------------------------------------------------------------------
r27480 | landonb | 2012-03-10 18:53:43 -0600 (Sat, 10 Mar 2012) | 1 line

Fix v1-v2 update.
------------------------------------------------------------------------
r27479 | landonb | 2012-03-10 18:08:15 -0600 (Sat, 10 Mar 2012) | 1 line

More route manip updates to flashclient.
------------------------------------------------------------------------
r27478 | landonb | 2012-03-10 17:38:00 -0600 (Sat, 10 Mar 2012) | 1 line

Working on v1-v2 update to consume route manip code.
------------------------------------------------------------------------
r27475 | landonb | 2012-03-10 15:42:42 -0600 (Sat, 10 Mar 2012) | 1 line

Bugfix: V1->V2 update script(s).
------------------------------------------------------------------------
r27474 | landonb | 2012-03-10 15:20:23 -0600 (Sat, 10 Mar 2012) | 1 line

Update db_load.sh
------------------------------------------------------------------------
r27472 | landonb | 2012-03-10 15:02:34 -0600 (Sat, 10 Mar 2012) | 1 line

Breaking SQL scripts with new code to handle database changes caused by route manip.
------------------------------------------------------------------------
r27471 | landonb | 2012-03-10 14:54:44 -0600 (Sat, 10 Mar 2012) | 1 line

Breaking flashclient with route manip code from v1. Also have to update three files still: Route.as, Route_Details_Panel.mxml, and Route_List_Entry.mxml.
------------------------------------------------------------------------
r27470 | landonb | 2012-03-10 14:34:14 -0600 (Sat, 10 Mar 2012) | 1 line

Update schema model to reflect v1 route manip.
------------------------------------------------------------------------
r27469 | landonb | 2012-03-10 14:33:24 -0600 (Sat, 10 Mar 2012) | 1 line

New files from v1 trunk (route manip; r24623 through r27178).
------------------------------------------------------------------------
r27463 | landonb | 2012-03-09 12:50:22 -0600 (Fri, 09 Mar 2012) | 1 line

Update android from cp_trunk (v1): revisions 24623 through 27178.
------------------------------------------------------------------------
r27462 | landonb | 2012-03-09 12:43:10 -0600 (Fri, 09 Mar 2012) | 1 line

auto_install: a few fixes, and added code to install flash debug plugin.
------------------------------------------------------------------------
r27461 | landonb | 2012-03-09 12:39:58 -0600 (Fri, 09 Mar 2012) | 1 line

Ug. Starting to consume trunk changes between revisions 24623 through 27178. Just some android changes to start....
------------------------------------------------------------------------
r27442 | landonb | 2012-03-08 12:49:21 -0600 (Thu, 08 Mar 2012) | 1 line

Fix db_load. Change all script to use /bin/bash instead of /bin/sh
------------------------------------------------------------------------
r27439 | landonb | 2012-03-08 11:46:41 -0600 (Thu, 08 Mar 2012) | 1 line

Fix permissions on /tmp/ files in auto_install. Fix db_load.sh not to croak on missing database it's trying to drop (who cares if it's missing?\!). Add cron job installation to auto_install.
------------------------------------------------------------------------
r27432 | landonb | 2012-03-07 12:56:21 -0600 (Wed, 07 Mar 2012) | 1 line

auto_install bugfix: chown logfile to postgres not to www-data, silly\!
------------------------------------------------------------------------
r27425 | landonb | 2012-03-06 04:18:06 -0600 (Tue, 06 Mar 2012) | 1 line

updates for auto_install
------------------------------------------------------------------------
r27423 | landonb | 2012-03-06 02:42:18 -0600 (Tue, 06 Mar 2012) | 1 line

updates for auto_install
------------------------------------------------------------------------
r27422 | landonb | 2012-03-06 02:35:36 -0600 (Tue, 06 Mar 2012) | 1 line

updates for auto_install
------------------------------------------------------------------------
r27420 | landonb | 2012-03-06 01:52:21 -0600 (Tue, 06 Mar 2012) | 1 line

auto_install: bugfixes, more options to not do stuff.
------------------------------------------------------------------------
r27418 | landonb | 2012-03-06 01:30:19 -0600 (Tue, 06 Mar 2012) | 1 line

auto_install: bugfix and option to not reload database and option to not reinstall software.
------------------------------------------------------------------------
r27417 | landonb | 2012-03-06 01:05:46 -0600 (Tue, 06 Mar 2012) | 1 line

rename file
------------------------------------------------------------------------
r27416 | landonb | 2012-03-06 01:00:56 -0600 (Tue, 06 Mar 2012) | 1 line

add some vacuum analyzes
------------------------------------------------------------------------
r27415 | landonb | 2012-03-06 00:17:30 -0600 (Tue, 06 Mar 2012) | 1 line

Updates for auto_install and fixes to update scripts.
------------------------------------------------------------------------
r27412 | landonb | 2012-03-05 21:31:00 -0600 (Mon, 05 Mar 2012) | 1 line

Fix V1->V2 update scripts: assign group memberships starting at valid_start_rid = 1.
------------------------------------------------------------------------
r27411 | landonb | 2012-03-05 20:51:05 -0600 (Mon, 05 Mar 2012) | 1 line

Fix tilecache_update to be able to just create tables (-N).
------------------------------------------------------------------------
r27409 | landonb | 2012-03-05 19:55:37 -0600 (Mon, 05 Mar 2012) | 1 line

db_load was failing without --template template0 (since new db is UTF8 and not ASCII). Commented-out setuptools install since Systems has since installed that for us.
------------------------------------------------------------------------
r27408 | landonb | 2012-03-05 18:41:06 -0600 (Mon, 05 Mar 2012) | 1 line

Fix RTree install. (New setuptools broke it; we force it to install locally by editing setup.cfg.)
------------------------------------------------------------------------
r27407 | landonb | 2012-03-05 17:49:03 -0600 (Mon, 05 Mar 2012) | 1 line

auto_install: missing files.
------------------------------------------------------------------------
r27406 | landonb | 2012-03-05 17:48:20 -0600 (Mon, 05 Mar 2012) | 1 line

auto_install: bugfixes.
------------------------------------------------------------------------
r27405 | landonb | 2012-03-05 17:14:46 -0600 (Mon, 05 Mar 2012) | 1 line

Fix bug created by installing python-setuptools (easy_install): hack gdal config to install python bindings locally.
------------------------------------------------------------------------
r27404 | landonb | 2012-03-05 16:59:03 -0600 (Mon, 05 Mar 2012) | 1 line

auto_install: tweaks.
------------------------------------------------------------------------
r27402 | landonb | 2012-03-05 16:37:55 -0600 (Mon, 05 Mar 2012) | 1 line

auto_install: Handle subtle differences between Ubuntu 10.04 and 11.04 (including handling Python 2.6 vs. 2.7); a few bugfixes (wasn't updating logrotate correctly); added python-setuptools and a bunch of other libraries, and also added Graphserver to install; fixed issue in Ubuntu 11.04 not finding libedit (\!).
------------------------------------------------------------------------
r27399 | landonb | 2012-03-05 12:51:39 -0600 (Mon, 05 Mar 2012) | 1 line

Fix schema scripts for auto_install and update transit feed cache script to derive from Ccp's cli args class and to create/drop cache tables.
------------------------------------------------------------------------
r27395 | landonb | 2012-03-05 01:03:33 -0600 (Mon, 05 Mar 2012) | 1 line

Renamed folders in ccpdev; updating to match.
------------------------------------------------------------------------
r27391 | landonb | 2012-03-05 00:54:49 -0600 (Mon, 05 Mar 2012) | 1 line

auto_install: fix gdal so it loads mod_python can find osgeo (use ldconfig to make library path permanent and add pythonpath to httpd.conf).
------------------------------------------------------------------------
r27381 | landonb | 2012-03-04 18:27:43 -0600 (Sun, 04 Mar 2012) | 1 line

GDAL must be compiled with --with-python.
------------------------------------------------------------------------
r27379 | landonb | 2012-03-04 17:28:33 -0600 (Sun, 04 Mar 2012) | 1 line

Uncomment scripts commented out for debugging.
------------------------------------------------------------------------
r27378 | landonb | 2012-03-04 17:27:45 -0600 (Sun, 04 Mar 2012) | 1 line

auto_install bugfix: $HOSTNAME not set unless /bin/bash instead of /bin/sh
------------------------------------------------------------------------
r27377 | landonb | 2012-03-04 17:06:54 -0600 (Sun, 04 Mar 2012) | 1 line

Minor auto_install updates.
------------------------------------------------------------------------
r27374 | landonb | 2012-03-04 15:49:22 -0600 (Sun, 04 Mar 2012) | 1 line

Minor auto_install updates.
------------------------------------------------------------------------
r27373 | landonb | 2012-03-04 15:47:50 -0600 (Sun, 04 Mar 2012) | 1 line

Minor auto_install updates.
------------------------------------------------------------------------
r27371 | landonb | 2012-03-04 12:16:27 -0600 (Sun, 04 Mar 2012) | 1 line

Fixed ctags usage in Makefile. Updated fcsh-wrap to Flex 3.4.0 build 9271A. Split preparing Cyclopath into final auto_install script and added db_load to seed database.
------------------------------------------------------------------------
r27370 | landonb | 2012-03-03 14:03:08 -0600 (Sat, 03 Mar 2012) | 1 line

Updates to auto_install.
------------------------------------------------------------------------
r27369 | landonb | 2012-03-02 18:53:32 -0600 (Fri, 02 Mar 2012) | 1 line

Bugfixes to auto_install GIS compile script.
------------------------------------------------------------------------
r27368 | landonb | 2012-03-02 17:50:47 -0600 (Fri, 02 Mar 2012) | 1 line

Bugfixes to auto_install GIS compile script.
------------------------------------------------------------------------
r27367 | landonb | 2012-03-02 17:45:08 -0600 (Fri, 02 Mar 2012) | 1 line

Bugfixes to auto_install. Just have to debug GIS compile...
------------------------------------------------------------------------
r27360 | landonb | 2012-03-02 13:04:34 -0600 (Fri, 02 Mar 2012) | 1 line

Bugfixes to auto_install. Works through dir_prepare.
------------------------------------------------------------------------
r27357 | landonb | 2012-03-02 01:29:30 -0600 (Fri, 02 Mar 2012) | 1 line

Minor update to auto_install.
------------------------------------------------------------------------
r27355 | landonb | 2012-03-02 00:33:17 -0600 (Fri, 02 Mar 2012) | 1 line

Finished coding the auto install scripts. But I haven't debugged. So I _just_ think I'm done.
------------------------------------------------------------------------
r27353 | landonb | 2012-03-01 22:18:47 -0600 (Thu, 01 Mar 2012) | 1 line

Shell scripts for automatic dev machine setup (for after installing Ubuntu -- hand's free install\!).
------------------------------------------------------------------------
r27350 | landonb | 2012-03-01 17:19:43 -0600 (Thu, 01 Mar 2012) | 1 line

Shell script to build GIS apps.
------------------------------------------------------------------------
r27287 | landonb | 2012-02-21 15:58:13 -0600 (Tue, 21 Feb 2012) | 21 lines


Flashclient bug: Item Access tab control crashes if two or 
more items selected on map.

Update tilecache/mapserver script to use new base classes, 
and to fix regression bugs since the byway_node table was 
introduced.

* Also fixed bug trying to get MetC attr for baseline branch.

* Found a bug in item_user_access SQL that sometimes did not
  add sql_clauses.outer.where clause.

Fixed a bug in MetC update with the 'name' field.

* Also some other bugs.

* Moved some commands to a base class to support the export 
  script and the upcoming route analytics work item.


------------------------------------------------------------------------
r27239 | landonb | 2012-02-15 22:58:01 -0600 (Wed, 15 Feb 2012) | 1 line

Simple bugfix to conny audit.
------------------------------------------------------------------------
r27238 | landonb | 2012-02-15 22:04:48 -0600 (Wed, 15 Feb 2012) | 1 line

Simple bugfix to conny audit.
------------------------------------------------------------------------
r27237 | landonb | 2012-02-15 21:42:21 -0600 (Wed, 15 Feb 2012) | 1 line

Simple bugfix to conny audit.
------------------------------------------------------------------------
r27236 | landonb | 2012-02-15 21:29:43 -0600 (Wed, 15 Feb 2012) | 1 line

Simple bugfix to conny audit.
------------------------------------------------------------------------
r27235 | landonb | 2012-02-15 21:11:53 -0600 (Wed, 15 Feb 2012) | 1 line

Regression bugfix to previous. Don't try to access Terrain's panel because Terrain doesn't (yet) have a panel.
------------------------------------------------------------------------
r27234 | landonb | 2012-02-15 20:58:56 -0600 (Wed, 15 Feb 2012) | 17 lines


Bug 2622 - GEOS 3.3.0 crashes postgres on ST_Buffer: 
           RightmostEdgeFinder::findEdge

Bugfixes to flashclient and pyserver:

* Things I broke while working on the import code.

Bugfixes to flashclient:

* MetC attributes not being drawn until item clicked.
  An event was firing too early; now bike lanes are 
  visualized when the map loads, and not just when 
  you select an item on the map.



------------------------------------------------------------------------
r27219 | landonb | 2012-02-14 20:29:34 -0600 (Tue, 14 Feb 2012) | 1 line

Told you so: bugfixes to previous.
------------------------------------------------------------------------
r27212 | landonb | 2012-02-14 18:06:28 -0600 (Tue, 14 Feb 2012) | 1 line

Bugfixes to the MetC import script. I think it'll run all the way through now...
------------------------------------------------------------------------
r27205 | landonb | 2012-02-13 23:06:38 -0600 (Mon, 13 Feb 2012) | 1 line

byway_node bugfixes, mostly fixing it so it has group_item_access rows (if it doesn't have gia rows it makes fetching byway_nodes very difficult since we can't use all the awesome sql in item_user_access). I had problems running the MetC import and the fixes extend back to the conny audit and byway_node conversion scripts.
------------------------------------------------------------------------
r27197 | landonb | 2012-02-10 14:02:51 -0600 (Fri, 10 Feb 2012) | 1 line

Bug 2621: Stacked Branch Checkout not respecting last_merge_rid. I combined the revision and branch_id sql, so revision.py is more like branch_hier_revision.py, or something. There's a lot of code that uses branch_hier and revision to make SQL, so this bugfix might be incomplete... I've only testing against the import scripts.
------------------------------------------------------------------------
r27188 | landonb | 2012-02-09 13:41:34 -0600 (Thu, 09 Feb 2012) | 1 line

Fixing some tricky import bugs: when you setup a new item with a ref item, the group item access records should come from a specific revision and not always just Current.
------------------------------------------------------------------------
r27180 | landonb | 2012-02-08 17:12:35 -0600 (Wed, 08 Feb 2012) | 1 line

Fix for BUG 2620: missing group_item_access rows for old byway_segment attributes that were NULL/unset for some version.
------------------------------------------------------------------------
r27177 | landonb | 2012-02-08 14:33:57 -0600 (Wed, 08 Feb 2012) | 1 line

Bugfixing v1-v2 update scripts.
------------------------------------------------------------------------
r27175 | landonb | 2012-02-08 14:05:11 -0600 (Wed, 08 Feb 2012) | 1 line

Bugfixes to scrub_db.py so I can run V1->V2 update scripts.
------------------------------------------------------------------------
r27174 | landonb | 2012-02-08 14:01:26 -0600 (Wed, 08 Feb 2012) | 1 line

Bugfixes to schema_update.py so I can run V1->V2 update scripts.
------------------------------------------------------------------------
r27173 | landonb | 2012-02-08 13:38:23 -0600 (Wed, 08 Feb 2012) | 87 lines


Fixed a ton of issues with saving split-from byways.

 * Both commit.py and merge_import.py assemble all 
   the stack IDs of byways being saved that are 
   split-from.

   * The link_values, permissions, and a couple 
     other associated pieces of information are 
     now replicated for each of the split-from 
     byways.

   * The permissions code is Very Tricky and most 
     likely Very Buggy. (I've tested the import 
     script on parts of the MetC import, and they 
     sometimes work and sometimes don't; I haven't 
     tested committing yet, either.)

BUG nnnn: I found a bug with group_item_access records 
for link_values whose value is NULL at some point -- 
the gia record does not exist. I added some code to 
the schema update scripts (v1->v2) to investigate this 
further.

Lots of updates to byway_node.py.

 * Got rid of elevation.py, and moved it into 
   byway_node.py

 * Made byway_node.One and byway_node.Many, like 
   most other item classes, but byway_node is 
   *special* -- it has no group_item_access rows.
   Users are allowed to access the nodes of whatever 
   byways they can access.

 * Added all the byway_nodes to byway (so when you 
   checkout a byway you get all the byway_nodes 
   columns, including dangle_ok, reference_n, 
   and elevation). You can now edit these values 
   using the import mechanism (and someday hopefully 
   using flashclient).

Lots of import updates:

 * Now supports all byway columns and associate links
   (import formerly just supported MetC attributes).

 * Exported shapefiles can be reimported (not that I've 
   tested, but the import compares what's in the import 
   shapefile to what's in the database and figures out 
   if anything's changed and what needs to be saved).

 * Byways are now bulk-loaded, using one SQL statement 
   for all byways instead of one for each. Will this 
   speed things up?

Some item class changes:

 * __init__ can be used to clone items, using copy_from.

 * save_insert can be used to 'update' existing rows 
   (by deleting the old row and recreating the new row).

   * This is necessary for split-from byways created in 
     a new branch, since we copy the old link_values 
     first but then need to update them -- and pyserver
     has never needed to do an SQL UPDATE until now.

Added pythonpath back to conf.py since psycopg2 is 
now installed locally (I didn't want to bother/wait 
for Systems...). 

 * This means 

     import conf
     import g

   *must* come before 

     import psycopg2

Renamed start_node_id to beg_node_id to better 
parallel end_node_id ('beg' is three letters like
'end', and 'beg' comes before 'end' alphabetically;
a similar scheme is used for valid_start/until_rid).


------------------------------------------------------------------------
r27168 | landonb | 2012-02-07 21:40:15 -0600 (Tue, 07 Feb 2012) | 1 line

Update db schema model to reflect names used in code.
------------------------------------------------------------------------
r27080 | landonb | 2012-01-25 22:59:52 -0600 (Wed, 25 Jan 2012) | 1 line

Progress-logger improvements. Writes to results.txt file for inclusion in the final zipfile. MetC import does a much better job of updating status text and progress percent in database, to be shown in flashclient. Also checks every second or so to see if work queue is being shutdown or if job is canceled.
------------------------------------------------------------------------
r27076 | landonb | 2012-01-25 17:57:39 -0600 (Wed, 25 Jan 2012) | 1 line

Fixed how the UUID file path is stored and d used (we just store the UUID now and not the complete path and not the file extension). Also, using prog_logger now in import script to check for cancelation and to update work_item_step's stage_progress, so user can monitor job progress from flashclient.
------------------------------------------------------------------------
r27063 | landonb | 2012-01-25 13:48:18 -0600 (Wed, 25 Jan 2012) | 23 lines


1. GrAC bugfixes.

* Relaxed some assurts I added recently that were tickled by 
running ./ccp.py to create new branch, group, and group memberships.

* Fixed a problem with new_item_policy's access_existing, which 
I also recently added and was triggered by running ./ccp.py to 
update the new branch.

2. Made generic Path_Helper module to use UUID to find a unique 
filename or directory path. Needed by the import code to work 
with zipfiles and shapefiles.

* Includes third-party portalocker module, which is used to 
lock a file to guarantee the UUID filename stays unique.

3. Lots and lots of little bugfixes to the import hierarchy: 
the old MetC import code is all wired and seems to complete 
without fail now! (I've only tested ten loop-iterations-deep
with a rollback, so I haven't tested the whole, 3 hour-long op.)


------------------------------------------------------------------------
r27047 | landonb | 2012-01-24 13:28:30 -0600 (Tue, 24 Jan 2012) | 1 line

Some import bugfixes, though mostly Hardening error handling. Specifically: getting raised errors to print their stack trace, which is apparently a bit tricky in Python. I changed all 1,025 calls to the built-in assert() to call g.assurt() instead (don't worry, I used Vim's bufdo to do the replacement). When work items fail, the stack trace is stored in the job object, so devs can get at it. And now all the asserts in pyserver are much more meaningful (they oftentimes would print blank lines to the log file).
------------------------------------------------------------------------
r27037 | landonb | 2012-01-24 01:27:55 -0600 (Tue, 24 Jan 2012) | 24 lines


Lots more bug fixes to the import framework. The yaml 
file, ccp.yml, seems in good shape. All the permissions 
for the branch and the groups and whatnot are checked.
The custom callback is finally reached. And now asserts 
work.

Figured out how to process asserts and print out a 
meaningful stack trace! (Ok, so it involves overloading 
AssertionError and defining our own class -- g.assurt -- 
and messing around with the traceback module, but, hey, 
it works.)

Three misspellings of 'isintance'.

Consolidated variable name used by 'except'. Was using 
e or x, but decided upon just 'e' (as in 'error' or 
'exception', e.g., 'except Exception, e:'). Also, 'x' 
is already used as a temp var for most list expansions.

Fixed usages of re.compile to use themselves and not 
call re.merge(), i.e., my_compiled_re.merge() instead.


------------------------------------------------------------------------
r27021 | landonb | 2012-01-23 01:27:12 -0600 (Mon, 23 Jan 2012) | 1 line

(I) Changed the 'required' GML setting. It was a bool, now an enum; was None, True, or False, now None, 0, 1 or 2. 0 is like False, 2 like True, and 1 means the GML attr is only required on item create. (II) Also: lots and lots of changes to the GRAC code. Decoupled self.req so work_queue (which isn't run via Apache) can access same GRAC code (without having to spoof an Apache request object). (III) Finally: Implemented the -u and -d -- update and delete -- commands for ccp.py\!\!
------------------------------------------------------------------------
r27020 | landonb | 2012-01-23 01:09:22 -0600 (Mon, 23 Jan 2012) | 1 line

Make new_item_policy_init derive from new Ccp_Args script base.
------------------------------------------------------------------------
r27019 | landonb | 2012-01-23 01:08:02 -0600 (Mon, 23 Jan 2012) | 1 line

Lots of bugfixes to the recently-generalized import scripts.
------------------------------------------------------------------------
r27018 | landonb | 2012-01-23 01:05:29 -0600 (Mon, 23 Jan 2012) | 1 line

Add two columns to branch: import_callback and export_callback, so we can write custom callbacks for each branch.
------------------------------------------------------------------------
r27017 | landonb | 2012-01-23 01:03:05 -0600 (Mon, 23 Jan 2012) | 1 line

Add two columns to branch: import_callback and export_callback, so we can write custom callbacks for each branch.
------------------------------------------------------------------------
r27006 | landonb | 2012-01-19 17:02:54 -0600 (Thu, 19 Jan 2012) | 22 lines


The orig. Metc import script had dozens of options, some 
hard-coded and some CLI options. I moved everything to 
a Yaml config file that gets zipped with the shapefiles.
This generalizes the import script and should allow us 
to easily work with shapefiles with different fields, etc.

I also split the 5K, single file, formerly-custom-MetC
import script into a handful of hierarchical class
files. This de-couples a lot of the code and should make
working with the import code a lot, lot easier as we
continue developing it. (The files are smaller (~ 1K or
smaller each), most of the fcns. in each file are only
called from within that file, and some files contain much
more stable code than others (so most files we won't
continue to develop, just the ones closer to the top).)

Be warned: this checkin is broken. I'll debug and checkin 
again after going for a ride... in the beautiful three 
degrees F weather ;).


------------------------------------------------------------------------
r27003 | landonb | 2012-01-18 22:05:41 -0600 (Wed, 18 Jan 2012) | 1 line

Fix ./ccp.py -c -t merge_job. Namely, small bugs in merge_import and the import_metc_* scripts. Now, the command calls into the MetC import script, and confix yml has additional params to help figure out what type of conflation to do and what the shapefile names and layers are. Next, I'll be updating the MetC code to check the type of conflation (roadmatcher vs. cyclopath) and teaching it how to work with the work queue so it can periodically check if it needs to halt processing.
------------------------------------------------------------------------
r27001 | landonb | 2012-01-18 15:14:50 -0600 (Wed, 18 Jan 2012) | 1 line

Fix minor SQL syntax issue that 8.4 does not care about but 8.3 does.
------------------------------------------------------------------------
r27000 | landonb | 2012-01-18 15:13:58 -0600 (Wed, 18 Jan 2012) | 1 line

Fix minor SQL syntax issue that 8.4 does not care about but 8.3 does.
------------------------------------------------------------------------
r26999 | landonb | 2012-01-18 14:58:53 -0600 (Wed, 18 Jan 2012) | 1 line

Tiny bugfix for conny audit.
------------------------------------------------------------------------
r26997 | landonb | 2012-01-18 14:49:40 -0600 (Wed, 18 Jan 2012) | 1 line

Resolve import interdependency (two files were importing each other).
------------------------------------------------------------------------
r26996 | landonb | 2012-01-18 14:32:35 -0600 (Wed, 18 Jan 2012) | 1 line

Wire merge_import job to existing conflation import code. Also fix db_glue for tilecache (for long lock waits).
------------------------------------------------------------------------
r26994 | landonb | 2012-01-17 15:54:59 -0600 (Tue, 17 Jan 2012) | 23 lines


Fixed race condition running job from ccp.py:

- an assert was throwing and the exception routine 
  was trying to get the same row lock that the 
  job handler still had. So I wrap a try/except in 
  the job handler so it can release the lock if/when
  it throws.

Fixed a problem checking out branches from flashclient:

- when changing branches, it was clearing group memberships 
  without re-requesting them. Now, group memberships are only 
  forgotten when the user logs in or out, but not when changing
  branches.

Added a bunch of __ne__ fcns. to pyserver to complement the 
existing __eq__ fcns:

- the sql builder was calling != on the sql clauses but we had
  only defined an __eq__ fcn.


------------------------------------------------------------------------
r26993 | landonb | 2012-01-17 13:19:50 -0600 (Tue, 17 Jan 2012) | 42 lines


Can now test work_item and merge_job requests 
using ccp.py, which speeds up debugging (you 
don't have to load the work queue thread and 
flashclient every time you want to test) and 
makes debugging simpler (the work queue threads 
don't report AssertionErrors very well (the 
stack trace is informationless)).

* Without the third-party 'poster' module, we 
cannot send multi-part content with urllib2, 
so we just fake a local file transfer. We also 
set the work item to 'starting' immediately, 
which prevents the work queue (if the service 
is running) from processing our new job. Then, 
pyserver returns to us the new stack_id (it 
sends a client ID => stack ID lookup) so we 
can find the job and send it to a fake Mr. Do!
service that we start in the context of ccp.py.

Updated the flashclient Makefile to make ctags 
for two missing Python source directories, 
services/ and scripts/.

Beginnings of genericizing the MetC Bikeways 
import. See services/merge/import_*.

WARNING: There's a race condition I still need 
to debug. E.g.,

  ./ccp.py -U landonb --no-password -c -t merge_job -m "Ignored." \
     -b "Metc Bikeways 2011 - Test 01" \
     -e download_fake "/ccp/dev/test.zip" \
     -e name "" \
     -e job_act "create" \
     -e for_group_id 0 \
     -e for_revision 0 \
     -e job_local_run 1

hangs in Mr. Do!


------------------------------------------------------------------------
r26986 | landonb | 2012-01-15 16:34:59 -0600 (Sun, 15 Jan 2012) | 1 line

Lots of fixes to the import feature. Zipfile is verified and extracted to a flat subdir. Lots of race condition fixes to Mr. Do! and the work queue.
------------------------------------------------------------------------
r26985 | landonb | 2012-01-14 15:51:40 -0600 (Sat, 14 Jan 2012) | 1 line

Row-level database locking. Augments old style ('revision' table lock) to avoid deadlocks with work items (like import/export jobs) and to provide better QOS to end customer (simultaneous map saves will not necessarily have to compete for the same lock anymore).
------------------------------------------------------------------------
r26970 | landonb | 2012-01-13 01:05:04 -0600 (Fri, 13 Jan 2012) | 1 line

Initial work on the jobs-queuer script.
------------------------------------------------------------------------
r26966 | landonb | 2012-01-12 19:12:16 -0600 (Thu, 12 Jan 2012) | 1 line

Fix merge_job to save uploaded files to unique locations and to store the paths in a dictionary object that gets pickled and stashed in the database when the job is created. Cleanup up leftover gunk in flashclient re: old panel_watched references. Fixed old bugs in elevation.py that I stumbled upon (the code expected TypeError to being thrown, but it's really struct.error that gets thrown, but either way you can avoid any raising if you just check the dimensions of the DEM raster first). Fixed conny audit to work with branches.
------------------------------------------------------------------------
r26962 | landonb | 2012-01-12 14:55:54 -0600 (Thu, 12 Jan 2012) | 1 line

Updated conny audit to write to new node table. Added byway_node class to handle the new node table. Traded slower ST_Expand PostGIS calls for speedier ST_DWithin.
------------------------------------------------------------------------
r26953 | landonb | 2012-01-11 17:33:48 -0600 (Wed, 11 Jan 2012) | 1 line

Update populate-node script to run a second time, after it's run a first time. Update database constraints and indices script to include the new tables added to the database within the last month. Started to update conny audit to populate new node table.
------------------------------------------------------------------------
r26941 | landonb | 2012-01-11 12:04:32 -0600 (Wed, 11 Jan 2012) | 1 line

New script converts old, unversioned nodes to new, versioned nodes. Also jostled some console code around. And this is only part one -- the conny_audit script is next.
------------------------------------------------------------------------
r26929 | landonb | 2012-01-10 15:09:31 -0600 (Tue, 10 Jan 2012) | 14 lines


Changes to nodes:

* Now part of item_versioned.

* New script to set up the new node tables.

New script base classes.

* Adds common CLI args, like username, branch, revision.

* Reusable code; makes it simpler to write powerful one-off scripts.


------------------------------------------------------------------------
r26928 | landonb | 2012-01-10 15:01:27 -0600 (Tue, 10 Jan 2012) | 1 line

Update db model: reflect new/modified node tables.
------------------------------------------------------------------------
r26888 | landonb | 2012-01-06 12:01:20 -0600 (Fri, 06 Jan 2012) | 1 line

Just some awesomeness.
------------------------------------------------------------------------
r26856 | landonb | 2012-01-04 22:16:36 -0600 (Wed, 04 Jan 2012) | 1 line

Regression fixes to previous checkins re Query_Filters. Also converted remaining stack ID query_filters lists from verbose-style to more compact style to reduce network usage and make ccp.py tool easier to use.
------------------------------------------------------------------------
r26851 | landonb | 2012-01-04 19:12:50 -0600 (Wed, 04 Jan 2012) | 1 line

Fix some issues with Query_Filters, and renamed and fixed documention of the filter attributes.
------------------------------------------------------------------------
r26850 | landonb | 2012-01-04 17:11:51 -0600 (Wed, 04 Jan 2012) | 19 lines


Renamed GWIS_Checkout_Viewport 
to GWIS_Checkout_Versioned_Items
(more accurate and parallels 
 GWIS_Checkout_Nonwiki_Items).

Fixed bug lazy-loading attrs when the gwis 
call fails.

Implement lazy-loading tags and annotations 
to speed up viewport loading. Users can use 
checkboxes on control panel to set this behavior.

Consolidated duplicate code in 
GWIS_Checkout_Base.as and 
GWIS_Checkout_Versioned_Items.as.
Also got rid of GWIS_Checkout_Qualities.


------------------------------------------------------------------------
r26841 | landonb | 2012-01-04 14:21:30 -0600 (Wed, 04 Jan 2012) | 66 lines



I implemented- what's it called? Gen 3 of the Item Watcher 
code. (Gen 1 being CcpV1 and Gen 2 being some code I wrote 
last year which isn't quite right.)

- Rather than being part of the item hierarchy (which was 
  really cumbersome and created extra overhead), item
  watchers are now nonwiki items.
  
  * Nonwiki items are stored just like item_versioned items 
    but they only have one copy in the database, whose
    version is always 1 and whose start and until revision IDs
    are always 1 and infinity, respectively.

- Some advantages:

  * Nonwiki Items -- and now Item Watchers -- can be saved 
    outside of the normal save-map button. The client can
    send an out-of-band save, and the server will create a
    new Item Watcher Change, which is basically the trick
    we employ to quasi-version nonwiki items (that is,
    changes to nonwiki items are still stored, kind of 
    like tag preferences in CcpV1).

  * Nonwiki items are a lot less coupled to the database 
    than versioned items. For those attributes we don't 
    want to search or sort on, we pickle (or marshall or
    flatten) the attributes into a single database cell. 
    So we can now make changes to Item Watchers a lot 
    more easily.

    + For instance, we could let the user configure 
      additional types of item watchers, like one that 
      sends you an SMS or sends a tweet, and we do not 
      need to modify the database at all!

    + This same approach can be used to store user 
      settings without having to add new columns or 
      tables to the database for every little change 
      to user settings -- if we store a pickled python 
      object, we can make changes to the python class 
      without having to touch the database.

  * In the future, we can use the same framework for 
    ratings. If we make ratings into Nonwiki items, we 
    can save them in the background without requiring 
    the user to hit the save map button.

I hardened the checkout code to do a better job checking
that the request won't produce hundreds or thousands of
records (I saw this issue debugging a problem checking 
out regions -- I got thousands of link_values back and 
my client brought my machine to a grind).

- This also made me see that discussions still had a 
  bug. I had fixed some requests to fetch pages of 
  threads, but on startup it was still fetching the 
  complete thread list.

Fixed checking out items user is watching.

Fixed checking out items by region name.



------------------------------------------------------------------------
r26819 | landonb | 2012-01-04 10:07:54 -0600 (Wed, 04 Jan 2012) | 1 line

Update database model: redo item watching (make into nonwiki class rather than be part of item_versioned hierarchy). Also redo item_read_event (make into generic messaging class that supports easy expansion).
------------------------------------------------------------------------
r26811 | landonb | 2011-12-30 16:42:47 -0600 (Fri, 30 Dec 2011) | 34 lines


Fixed: List not being updated when new items received:
filter regions and waypoints by tags.

Fixed Region AutoComplete widgets (labelField wasn't set...).

More tweaks to Recent Changes interface.

Added Region AutoComplete to Merge panel (so when you schedule 
an export-map job you can specify the region to export).

Fixed the group dropdown on the Merge panel. It was a stub -- 
just a fake list. Now it shows all the users to which the 
user belongs, and it also shows the group access scope.

Added email-me option to Merge import jobs. (Okay, I added 
the checkbox; item watchers is still broken in the client.
And the server.)

Fixed a weird layout problem on the item access panel. The 
label wasn't being drawn, and the combobox was being clipped 
by the next row in the list.

Started changing some of the AutoComplete widget widths from 
hard-coded to based-on-something-else. The third-party code 
for the AutoComplete widget doesn't do percent-based widths, 
so we need a trick to make 'em look good, know what I mean?

Ok, so, I've been living in flashclient for a while. I loves 
to tweak me a good gooey. I swear my next checkin will be an 
import or export script for Merge jobs......................



------------------------------------------------------------------------
r26806 | landonb | 2011-12-29 23:26:40 -0600 (Thu, 29 Dec 2011) | 1 line

Minor bugfix for demo: fix download (again).
------------------------------------------------------------------------
r26805 | landonb | 2011-12-29 23:16:38 -0600 (Thu, 29 Dec 2011) | 1 line

Minor bugfix for demo: fix download (again).
------------------------------------------------------------------------
r26804 | landonb | 2011-12-29 22:55:21 -0600 (Thu, 29 Dec 2011) | 1 line

Minor bugfix for demo: make download work again.
------------------------------------------------------------------------
r26803 | landonb | 2011-12-29 22:33:11 -0600 (Thu, 29 Dec 2011) | 1 line

Found a race condition in the work queue. Yikes\!
------------------------------------------------------------------------
r26802 | landonb | 2011-12-29 20:58:21 -0600 (Thu, 29 Dec 2011) | 1 line

Fixes for demo.
------------------------------------------------------------------------
r26801 | landonb | 2011-12-29 20:54:19 -0600 (Thu, 29 Dec 2011) | 1 line

Fixes for demo.
------------------------------------------------------------------------
r26800 | landonb | 2011-12-29 20:27:58 -0600 (Thu, 29 Dec 2011) | 1 line

Add Python 2.6 workaround.
------------------------------------------------------------------------
r26799 | landonb | 2011-12-29 20:18:29 -0600 (Thu, 29 Dec 2011) | 1 line

A few minor updates for the demo.
------------------------------------------------------------------------
r26798 | landonb | 2011-12-29 19:41:57 -0600 (Thu, 29 Dec 2011) | 1 line

Merge tab: Add email-me checkbox and make jobs list not selectable.
------------------------------------------------------------------------
r26797 | landonb | 2011-12-29 19:14:33 -0600 (Thu, 29 Dec 2011) | 1 line

Minor update to last checkin: disable Unselect all button when nothing is selected.
------------------------------------------------------------------------
r26796 | landonb | 2011-12-29 18:59:03 -0600 (Thu, 29 Dec 2011) | 1 line

Fixed the Recent Changes radio collection. The control was three radio buttons tall, sometimes six, the last three each having a text input box. The new control is a dropdown and sometimes a single text input box.
------------------------------------------------------------------------
r26795 | landonb | 2011-12-29 14:23:13 -0600 (Thu, 29 Dec 2011) | 22 lines


Implemented file upload!

What a doooooozy! =)

Learned about Flash's "User-initiated action requirements",
which limits how flashclient can interact with local files.

Added specific Content-Type headers to deal with multipart 
upload data as opposed to just dealing with text/xml.

Fixed Bug 2608 - Replace "Generated Tokens" with Random, 
Unique Tokens. Had to be done so pyserver can authenticate 
upload requests.

  http://bugs.grouplens.org/show_bug.cgi?id=2608

And as an added bonus, wired the recent changes paginator 
and started cleaning up (nay, fixing!) the interface.



------------------------------------------------------------------------
r26794 | landonb | 2011-12-29 11:36:34 -0600 (Thu, 29 Dec 2011) | 1 line

Moving Ccpv1 schema scripts to their own subfolder. It's getting unwieldy to deal with new scripts when there are hundreds in the same folder....
------------------------------------------------------------------------
r26781 | landonb | 2011-12-27 22:45:52 -0600 (Tue, 27 Dec 2011) | 1 line

Wire the Discussions and Recent Changes paginators.
------------------------------------------------------------------------
r26779 | landonb | 2011-12-27 20:52:06 -0600 (Tue, 27 Dec 2011) | 11 lines


Added GWIS support for Group Item Access. Lots of fixes 
and implementation to and of the group access panel.

Added GWIS support for getting counts of item types for 
paginators. Fixed the work queue paginator on the branch 
merge panel.

Lots of little bugfixes.


------------------------------------------------------------------------
r26771 | landonb | 2011-12-26 10:21:33 -0600 (Mon, 26 Dec 2011) | 1 line

Regression bugfix: wasn't populating details panels, e.g., item name not set on item selection (Dirty_Reason conversion from Set2 to uint bitmask had issue). Also renamed on_show_impl to repopulate since the latter is really what it does.
------------------------------------------------------------------------
r26770 | landonb | 2011-12-26 02:15:28 -0600 (Mon, 26 Dec 2011) | 30 lines



Lots of fixes to commit.

Lots of decoupling.

* Moved code clutter from general panel manager 
  class to new *_Manager.as classes.

* Got rid of the 'stype' hack from V1 discussions.

* Moved a lot of fcns. from G.as to two new pkgs., 
  utils.geom.Geometry.as and views.Paint.as.

Fixed a few bugs with the task queue.

* When a new work item step is added, tickle the 
  task manager (open a socket and send the 'kick'
  command).
  
Added the paginator to discussions and recent 
changes. Not fully implemented, but sorta.

De-static'ed two classes. Or maybe it's called 
de-singletoning.

Change Dirty_Reason collections from expensive
Set2 objects to bitmasked uints.


------------------------------------------------------------------------
r26755 | landonb | 2011-12-21 14:18:21 -0600 (Wed, 21 Dec 2011) | 1 line

Fix mr_do so it can be daemonized.
------------------------------------------------------------------------
r26754 | landonb | 2011-12-21 13:27:27 -0600 (Wed, 21 Dec 2011) | 1 line

Tweaks to the Merge Jobs list, esp.: now the lists shows the percentage progress of jobs as they are processed. Also implemented file downloads (it was mostly stubbed before). There's a new item type that dervies from the nonwiki item, but it masquerades as the same item type. This means the same SQL is used to fetch the item and, more importantly, that the user is checked to make sure they have view-access on the item. Then, instead return the item details as XML, the download file is returned instead.
------------------------------------------------------------------------
r26746 | landonb | 2011-12-20 18:21:05 -0600 (Tue, 20 Dec 2011) | 1 line

Lots of fixes to the jobs daemon. It works now! It's multi-threaded, so we'll see how well it works, but I've got it processing jobs. It updates the status in the database as it progresses, too, so the client can show progress. Now we just need to port/write the import/export scripts and the study (route analytics) script.
------------------------------------------------------------------------
r26745 | landonb | 2011-12-20 18:17:36 -0600 (Tue, 20 Dec 2011) | 1 line

Lots of fixes to the task queue and related work items.
------------------------------------------------------------------------
r26741 | landonb | 2011-12-19 19:09:37 -0600 (Mon, 19 Dec 2011) | 1 line

Fixed: missing Map Key.
------------------------------------------------------------------------
r26740 | landonb | 2011-12-19 18:21:47 -0600 (Mon, 19 Dec 2011) | 1 line

Fixes to last.
------------------------------------------------------------------------
r26739 | landonb | 2011-12-19 17:51:47 -0600 (Mon, 19 Dec 2011) | 1 line

A few psycopg2 fixes (did I mention?! I upgraded to psycopg2! Mostly, your %d substituions when using db.sql(foo, bar) must be changed to %s.) Also, fixes to new item policy script so I can give MetC rights to manage jobs on the MetC branch.
------------------------------------------------------------------------
r26737 | landonb | 2011-12-19 16:44:28 -0600 (Mon, 19 Dec 2011) | 30 lines



A few milestones[1]: 
  * Work Queue Service
  * Work Item State Manager

The Work Queue service, henceforth called Mr. Do!, 
starts a specified number of threads and processes 
tasks as they are plopped in the work_item table.

It is a powerful resource-management tool that 
handles the heavy lifting of geodata processing 
while also offering good quality of service to 
casual Web users and other clients using the system.

The Work Item State Manager handles transitioning 
work items between states as well as finding the 
list of hot jobs for the work queue to process.
Currently, it picks one job of each type for 
each branch. In the future, we may wiss to design 
a more full-featured system for prioritizing and 
processing clients' jobs.

[1]: Milestone Caveat: The Work Queue service has 
     not been debugged. It's 1K-ish lines new code.
     Yet Too Be Bugfixed. And hopefully before the 
     holidays... I got other fish to fry, and tofu
     to turkey.


------------------------------------------------------------------------
r26735 | landonb | 2011-12-19 16:00:13 -0600 (Mon, 19 Dec 2011) | 1 line

Twiddle with work item tables in the db model.
------------------------------------------------------------------------
r26728 | landonb | 2011-12-18 14:07:35 -0600 (Sun, 18 Dec 2011) | 1 line

Moving files around...
------------------------------------------------------------------------
r26726 | landonb | 2011-12-18 14:06:50 -0600 (Sun, 18 Dec 2011) | 1 line

Moving files around...
------------------------------------------------------------------------
r26725 | landonb | 2011-12-18 14:06:04 -0600 (Sun, 18 Dec 2011) | 1 line

Moving files around...
------------------------------------------------------------------------
r26723 | landonb | 2011-12-17 17:33:07 -0600 (Sat, 17 Dec 2011) | 1 line

Fixes to flashclient Branches tabs: fixed bug removing extra tabs (still need to figure out how to display 'em all at once, though, since there are a lot of 'em). Fixes to 'cancelling' a 'queued' work item: cleaned up the pyserver saving of nonwiki items. Still need to write the jobs queue server that does the real work, though......
------------------------------------------------------------------------
r26722 | landonb | 2011-12-17 16:49:44 -0600 (Sat, 17 Dec 2011) | 1 line

Regression bugfix: selected item widgets not displaying. Problem: widgets need to call their dp parent to get the selectedset.
------------------------------------------------------------------------
r26721 | landonb | 2011-12-17 16:25:09 -0600 (Sat, 17 Dec 2011) | 1 line

Fixed the Logging subsystem in flashclient (it wasn't respecting Config_Logging.as, and I was trying to set #Geofeature to VERBOSE\! =). Also upgraded it to the new enum style (which I used in Job_Action and Job_Status, which makes more sense given how Flex works; much cleaner and easier to understand/maintain). Also 'set fileformat=unix' on something that was dos-y.
------------------------------------------------------------------------
r26720 | landonb | 2011-12-17 02:14:08 -0600 (Sat, 17 Dec 2011) | 34 lines


Tons of fixes to work items.

Implement Merge_Job class.

Implement work_item_step.

Removed job_class from Query_Builder and instead just use 
item_type. That is, like, use the normal checkout and 
commit commands to deal with merge_job, study_job, and 
future work item types. Which are essential justs items.
Well, nonwiki items, which are not revisioned, but as 
items we can apply group access control and branching 
to them without writing new code.

Lots of changes to pyserver.

Making new items now get qb object so they can search 
database if necessary. I.e., for work_item_steps, when 
you load a work_item, it needs to load its steps.

BIG CHANGE: Upgrade to psycopg2!

This entailed changing sql() calls to always use %s and
never to use %d.

cPickle! is being used to pack job options so we don't 
have to make explicit database table columns. The 
disadvantage is these options are not sortable and don't 
work with pageination, kinda, but that's totally cool 
because there are a ton of options and it doesn't make 
sense to make them all keyable.


------------------------------------------------------------------------
r26719 | landonb | 2011-12-17 01:16:47 -0600 (Sat, 17 Dec 2011) | 1 line

Db model update.
------------------------------------------------------------------------
r26693 | landonb | 2011-12-14 10:01:40 -0600 (Wed, 14 Dec 2011) | 1 line

Squelch tilecache_update (I'm getting all-ok cron emails every 15 minutes).
------------------------------------------------------------------------
r26684 | landonb | 2011-12-13 19:36:17 -0600 (Tue, 13 Dec 2011) | 1 line

... and again.
------------------------------------------------------------------------
r26683 | landonb | 2011-12-13 18:50:13 -0600 (Tue, 13 Dec 2011) | 1 line

dia updates (ccp db model) -- see the 5 ft. poster behind my desk, it's out of date now...
------------------------------------------------------------------------
r26681 | landonb | 2011-12-13 00:24:34 -0600 (Tue, 13 Dec 2011) | 1 line

Continuing impl. of work items for merge.
------------------------------------------------------------------------
r26680 | landonb | 2011-12-12 22:17:55 -0600 (Mon, 12 Dec 2011) | 1 line

Regression fix from a day ago: tiles/vectors were not loading on boot.
------------------------------------------------------------------------
r26679 | landonb | 2011-12-12 19:52:03 -0600 (Mon, 12 Dec 2011) | 1 line

Made Work_Items derive from new Nonwiki_Item object.\n\nNonwiki_Items are access-controlled and versioned but not revisioned. I.e., you can take advantage of the existing item infrastructure on new items, but you don't have to force your new items to use revisions when they are modified -- so you can edit Nonwiki_Items without saving a new revision.\n\nOther classes in the future might become Nonwiki_Items, like item ratings and item watchers.
------------------------------------------------------------------------
r26668 | landonb | 2011-12-12 12:53:35 -0600 (Mon, 12 Dec 2011) | 1 line

Updates to last.
------------------------------------------------------------------------
r26667 | landonb | 2011-12-12 12:51:03 -0600 (Mon, 12 Dec 2011) | 1 line

Updates to last.
------------------------------------------------------------------------
r26666 | landonb | 2011-12-12 12:43:38 -0600 (Mon, 12 Dec 2011) | 1 line

Log_Jammin updates.
------------------------------------------------------------------------
r26658 | landonb | 2011-12-12 09:49:47 -0600 (Mon, 12 Dec 2011) | 1 line

Log_Jammin dev. script.
------------------------------------------------------------------------
r26657 | landonb | 2011-12-10 15:46:57 -0600 (Sat, 10 Dec 2011) | 1 line

Implement Job_Action classes.
------------------------------------------------------------------------
r26656 | landonb | 2011-12-10 15:17:34 -0600 (Sat, 10 Dec 2011) | 1 line

Script to auto-generate Config_Logging.as. Also added job_action and job_status enum classes to pyserver.
------------------------------------------------------------------------
r26655 | landonb | 2011-12-10 02:26:40 -0600 (Sat, 10 Dec 2011) | 1 line

Binary file download works\! (Though just the basics\! It'd be nice to show a progress bar and a completion notice\!) I tested download a zip file of shapefile files and it worked! Also fixed a bunch of bugs. And stubbed out the other import/export actions you can do on work items in the jobs queue.
------------------------------------------------------------------------
r26654 | landonb | 2011-12-09 19:48:17 -0600 (Fri, 09 Dec 2011) | 1 line

Branch-change Bugfixes. Renamed jobs_queue element: work_item.
------------------------------------------------------------------------
r26653 | landonb | 2011-12-09 17:40:45 -0600 (Fri, 09 Dec 2011) | 1 line

Awesome interactive pyserver: './ccp.py -i' loads pyserver and dumps you at a Python shell so you can play around with the system.
------------------------------------------------------------------------
r26651 | landonb | 2011-12-09 15:59:08 -0600 (Fri, 09 Dec 2011) | 1 line

Fixed bugs in Paginator (SQL offset was computed wrong, flashclient buttons were still responding to mouse events even though not enabled). Added Jobs_Queue object to flashclient. Cleaned up custom DataGrid item renderer (really just learned how it works and how to hook data change events so I can renderer customly). Fixed bug changes branches before baseline could load (branch list now returns parent_id so flashclient can determine baseline ID without having to actually checkout the baseline branch).
------------------------------------------------------------------------
r26640 | landonb | 2011-12-09 01:54:14 -0600 (Fri, 09 Dec 2011) | 1 line

Minor fix to last.
------------------------------------------------------------------------
r26639 | landonb | 2011-12-09 01:45:42 -0600 (Fri, 09 Dec 2011) | 1 line

Lots of work on the Paginator.
------------------------------------------------------------------------
r26637 | landonb | 2011-12-08 22:50:32 -0600 (Thu, 08 Dec 2011) | 1 line

More implementationn of jobs queue: Client returns list of jobs. Some fixes to switching branches while the map is loading.
------------------------------------------------------------------------
r26626 | landonb | 2011-12-07 23:48:25 -0600 (Wed, 07 Dec 2011) | 1 line

Add 'Study' branch tab slugs.
------------------------------------------------------------------------
r26618 | landonb | 2011-12-07 20:20:25 -0600 (Wed, 07 Dec 2011) | 1 line

Added Jobs Queue classes. Works from ccp.py but not tested from flashclient.
------------------------------------------------------------------------
r26616 | landonb | 2011-12-07 17:23:12 -0600 (Wed, 07 Dec 2011) | 1 line

Make MetC setup script to make it easier to setup database.
------------------------------------------------------------------------
r26615 | landonb | 2011-12-07 16:56:50 -0600 (Wed, 07 Dec 2011) | 1 line

Minor db_load.sh bugfix.
------------------------------------------------------------------------
r26613 | landonb | 2011-12-07 16:36:59 -0600 (Wed, 07 Dec 2011) | 1 line

Fix db_load to use postgis_restore rather than pg_restore. (My V1->V2 upgrade script was leaving the database in the 1.3.6 format but pyserver expects 1.5.3.)
------------------------------------------------------------------------
r26612 | landonb | 2011-12-07 15:36:56 -0600 (Wed, 07 Dec 2011) | 11 lines


De-coupled some code by making events:
- Item_Manager.attributesLoaded
- Item_Manager.tagsLoaded

Remove hardcoded magic numbers and 
replaced with less magic strings. For 
deciding which attrs to fetch w/ viewport 
items.


------------------------------------------------------------------------
r26609 | landonb | 2011-12-07 14:42:04 -0600 (Wed, 07 Dec 2011) | 1 line

Fix ccp.py to use bboxes.
------------------------------------------------------------------------
r26598 | landonb | 2011-12-07 09:32:37 -0600 (Wed, 07 Dec 2011) | 1 line

Mocked up the import/export interface. Created new class to encapsulate interface elements in a double-lined border whose contents can be collapsed (kind of like an accordion control, but not the same).
------------------------------------------------------------------------
r26596 | landonb | 2011-12-07 01:23:26 -0600 (Wed, 07 Dec 2011) | 23 lines


De-coupled some code by taking advantage of new 
branchChanged event.

Finish cleaning up MAPS interface:
* Use up/down arrow keys to change list entries
* Use ENTER key to 'Activate'
* Double-click to 'Activate'
* Cleaned up labels and title so they reflect 
  the state of the current map and branch.

Moved branch panel-related files 
  from flashclient/view/panel_items 
    to flashclient/view/panel_item_branch
This makes working with the gui files a lot easier, 
since I find myself switching between source files 
much more often while working on the user interface 
than with any other code. Most of the gui files are 
organized into packages based on their owner-panel.

New job_queue table to implement new... jobs queue.


------------------------------------------------------------------------
r26590 | landonb | 2011-12-06 13:17:16 -0600 (Tue, 06 Dec 2011) | 16 lines


Fixed branchChange event: you need a shim event in the
panel class.  So each panel class object listens on
the Item_Manager's branchChange event, and when that
happens, the panel object sends its own branchChange
event. All this just so we can use the event in MXML, 
e.g., branchChange="this.on_branch_change(event)".

Fixed main.mxml load order (I'm not sure why I didn't 
fix this long ago). Hooking the pre_initialize event, 
so we can load the Item_Manager and Panel_Manager and 
other subsystems before Flex hydrates all the MXML 
in main. Also moved some class-level code (ick!) out 
of G.as and into main.on_preinitialize (yea!).


------------------------------------------------------------------------
r26587 | landonb | 2011-12-06 02:34:19 -0600 (Tue, 06 Dec 2011) | 1 line

Missed some code from last checkin.
------------------------------------------------------------------------
r26586 | landonb | 2011-12-06 02:25:14 -0600 (Tue, 06 Dec 2011) | 20 lines


New Branch_Change_Event -- we should derive from 
Event more often! Classes can now listen on event 
that signals when branch changes.

Fixme import and package paths from last checkin.

Fix Branch list (MAP) so active branch is properly 
indicated. And now says Loading... while, well, 
loading. Got rid of copy and merge buttons.

Made Branch import/export tab with import and export 
buttons.

Fix slope and perpendicular calculations to handle 0.

Shpfile_wrap removes tmp files now.



------------------------------------------------------------------------
r26585 | landonb | 2011-12-06 01:35:35 -0600 (Tue, 06 Dec 2011) | 1 line

Rearrange flashclient/views package -- related files are in the same packages to make editing panels and widgets easier.
------------------------------------------------------------------------
r26584 | landonb | 2011-12-06 00:27:45 -0600 (Tue, 06 Dec 2011) | 1 line

New white paper: Route Finder Algorithms.
------------------------------------------------------------------------
r26539 | landonb | 2011-11-29 20:31:14 -0600 (Tue, 29 Nov 2011) | 1 line

Bikeways import script updates. Flashclient visualization updates (draw Bikeways bike lanes and indicate 'proposed').
------------------------------------------------------------------------
r26524 | landonb | 2011-11-28 10:21:47 -0600 (Mon, 28 Nov 2011) | 1 line

Make ccp.py executable:  propset svn:executable 1 pyserver/ccp.py
------------------------------------------------------------------------
r26523 | landonb | 2011-11-28 10:11:06 -0600 (Mon, 28 Nov 2011) | 1 line

bikeways import update
------------------------------------------------------------------------
r26511 | landonb | 2011-11-22 13:16:44 -0600 (Tue, 22 Nov 2011) | 1 line

Fixes to tilecache_update. Fixes to CcpV1->V2 scripts.
------------------------------------------------------------------------
r26509 | landonb | 2011-11-22 11:09:30 -0600 (Tue, 22 Nov 2011) | 1 line

CcpV1-V2 update scripts bugfix.
------------------------------------------------------------------------
r26508 | landonb | 2011-11-22 10:21:18 -0600 (Tue, 22 Nov 2011) | 1 line

Bikeways import: support for 'stacking' disparate field values when conjoined neighborly segments.
------------------------------------------------------------------------
r26504 | landonb | 2011-11-21 10:47:24 -0600 (Mon, 21 Nov 2011) | 1 line

Clean up scripts/setupcp. Organize into scripts for CcpV1 and CcpV2.
------------------------------------------------------------------------
r26503 | landonb | 2011-11-21 10:41:44 -0600 (Mon, 21 Nov 2011) | 1 line

Bikeways import: looser feature equality function means more split segments recombined. Also lots more field callbacks and target layers and bug fixeses.
------------------------------------------------------------------------
r26448 | landonb | 2011-11-16 18:28:47 -0600 (Wed, 16 Nov 2011) | 22 lines


Very Awesome Checkin.

The Shapefile import script runs against the Bikeways data.

If analyzes the features being imported and saves them to 
two places: a new shapefile and to the Cyclopath database.

Many statistics are maintained so that the script can complain 
about illegal or abnormal features. The complaints come at 
the end, so you can run the script and get a copy-and-paste 
list of IDs to paste into ArcMap to fix the problem features 
all at once.

At VERBOSE4 log level, the script completes in ~ 4/5 of an hour.

I've tested up to committing to the database (I've been rolling 
back). Also, I haven't inspected the target shapefile. So there 
will be more fixes once I run the script for real and inspect 
the new Cyclopath revisions and the new shapefile.


------------------------------------------------------------------------
r26393 | landonb | 2011-11-14 13:35:31 -0600 (Mon, 14 Nov 2011) | 1 line

Major changes to conflation import script. Will debug and annotate later.
------------------------------------------------------------------------
r26392 | landonb | 2011-11-14 13:35:01 -0600 (Mon, 14 Nov 2011) | 1 line

1. Fix debug trace setup (log.verbose was not working). 2. geometry_raw added to distinguish from geometry_wkt and geometry_svg.
------------------------------------------------------------------------
r26341 | landonb | 2011-11-09 09:49:44 -0600 (Wed, 09 Nov 2011) | 10 lines


Overhauled Shapefile Import scripts 
and cleaned up the Bikeways import.

Big changes so Matched features being 
imported are properly connected. See 
http://cyclopath.org/wiki/Tech:Cycloplan/Conflation



------------------------------------------------------------------------
r26228 | landonb | 2011-10-25 14:12:44 -0500 (Tue, 25 Oct 2011) | 1 line

Implement attribute lazy-loading and (alpha) highlighting of bikelanes.
------------------------------------------------------------------------
r26227 | landonb | 2011-10-25 14:04:56 -0500 (Tue, 25 Oct 2011) | 1 line

Style cleanup.
------------------------------------------------------------------------
r26226 | landonb | 2011-10-25 14:03:49 -0500 (Tue, 25 Oct 2011) | 1 line

Code to help with lazy-loading attribute link_values.
------------------------------------------------------------------------
r26225 | landonb | 2011-10-25 14:01:34 -0500 (Tue, 25 Oct 2011) | 1 line

Update developer script, ccp.py, to honor the only_lhs and only_rhs vars, to check out links for a particular attribute and/or byway.
------------------------------------------------------------------------
r26224 | landonb | 2011-10-25 14:00:37 -0500 (Tue, 25 Oct 2011) | 22 lines


Solved the problem with attributes that indicate 
"sides of the street", e.g., "bike lane side", 
which always felt like the wrong way to store this 
information.

E.g., a bike lane is not just on both sides of the 
street or just on one side: it could be on both sides 
of the street but be a different type of bike lane on 
either side.

Same with shoulder width. E.g., the shoulder on one 
side of the road is 5 feet wide and on the other side, 
there is no shoulder.

So I introduced the idea of "directional" attributes. 
An attribute that is marked directional either applies 
once -- equally -- to both "sides" of a street, or it 
applies twice -- two distinct link_values -- to either 
direction of the street.


------------------------------------------------------------------------
r26223 | landonb | 2011-10-25 13:52:46 -0500 (Tue, 25 Oct 2011) | 1 line

Oops, this file goes with the last checkin.
------------------------------------------------------------------------
r26222 | landonb | 2011-10-25 13:52:17 -0500 (Tue, 25 Oct 2011) | 8 lines


Major overhaul (and breakage) of the Bikeways import script.

I found a bunch of problems with the source data -- and I think for every bug found and fixed, and I found two more and left notes in the code (so there's lots of code to fix).

I also split the single Bikeways import script into two files -- one is a base class for reusing with future imports, and the other is a file that describes the Bikeways data.


------------------------------------------------------------------------
r26221 | landonb | 2011-10-25 13:46:34 -0500 (Tue, 25 Oct 2011) | 1 line

Script to audit connectivity. That is, analyze all the node IDs used by all the byways and indentify errors and print our statistics.
------------------------------------------------------------------------
r26086 | landonb | 2011-10-07 20:52:03 -0500 (Fri, 07 Oct 2011) | 58 lines


Highlight!: Save new and update link_values!

E.g., change speed limit on a street. (I know, 
it doesn't sound like much, but saving links 
is complicated business! =)

Also: Speed up map load by lazy-loading 
attribute link_values. (Loading attribute 
link_values using a PostGIS geometry query 
using the client viewport takes 10 to 20 
seconds.)

Bugfixes:

* Not setting/remembering public branch ID in 
  client for use when saving items and making 
  the group_item_access records.

* Pyserver link_value save was not calculating 
  name but accepting flashclient's name. And 
  Flashclient should not be setting name, anyway.

* Flashclient was sending values for the link_value
  value_* columns that were not set. And pyserver 
  was seeing 'nan' and 'null' and getting confused.

* Cleaned up Flashclient commit. changedset is now 
  just a Set, not a Set2

* Fixed problem sending similar, multiple, overlapped 
  out-of-band requests: the client was flagging second 
  and subsequent requests as copies of the first, even 
  though each request was unique.

* Added client GUI controls for attributes whose values 
  are boolean or string values (was only supporting 
  integer values up 'til now).

* Flashclient now gets one_way from geofeature, rather
  than from attribute link_value (z-level and one_way 
  had been set using attribute link_value, but they make 
  more sense as members of geofeature).

* Item_Type.as is dynamic, but the compiler flag 'static' 
  is enabled, so the silly lookup table hasn't been that 
  useful. So I made all the item types attributes of 
  the Item_Type class, for easy usage.

* Fixed lots of issues detecting changes to attributes and 
  updating the GUI panels in flashclient.

* Lots and tons of lots of lots of fixes to pyserver's 
  grac_manager: fixes bugs saving new and existing link_values.
  Also fixed new_item_policy when applied to links (bugs trying 
  to figure out the types of the left and right linked items).


------------------------------------------------------------------------
r26085 | landonb | 2011-10-07 20:25:29 -0500 (Fri, 07 Oct 2011) | 1 line

Update db model. Remove link_name from group_item_access table.
------------------------------------------------------------------------
r26032 | landonb | 2011-10-04 10:29:44 -0500 (Tue, 04 Oct 2011) | 1 line

Minor fixes to bikeways import, including creating dummy table for shared lock.
------------------------------------------------------------------------
r25896 | landonb | 2011-09-26 22:12:03 -0500 (Mon, 26 Sep 2011) | 1 line

Bugfixes to last.
------------------------------------------------------------------------
r25895 | landonb | 2011-09-26 21:58:55 -0500 (Mon, 26 Sep 2011) | 1 line

Bugfixes to previous. Something changed since yesterday, too: edit httpd.conf and increase Timeout from 60 to 600, otherwise you may get Mapserver timeouts on tilecache_update.
------------------------------------------------------------------------
r25894 | landonb | 2011-09-26 18:56:57 -0500 (Mon, 26 Sep 2011) | 1 line

Bugfix to previous checkin.
------------------------------------------------------------------------
r25889 | landonb | 2011-09-26 17:55:25 -0500 (Mon, 26 Sep 2011) | 62 lines


* Many fixes to MapServer.

  * Fixed layering, so byways are drawn according to their z-level. 
    This is tricky to do in MapServer because of how STYLEs are 
    defined (they should be predefined, but they can't be and must 
    be defined at render-time, but they only can be configured once, 
    so you can't change a STYLE once it's defined, but since STYLEs 
    are defined in the render code, you have to be tricky about how 
    they're defined). See the code for lots of comments about this 
    gotcha/caveat.

  * Fixed coloring and STYLE definitions, so that all of the draw 
    config is stored in the database, such that it can be used by 
    MapServer, Flashclient, and Android. (Up until now, because of 
    the trickiness with MapServer STYLEs, colors and whatnot were 
    hard-coded in the MapServer config, as well as being stored in 
    the database; now, the config is solely stored in the database.)

  * Beefed up labeling so we can configure more of the options 
    available in MapServer, like outlining text, changing font 
    faces, changing font size, etc.

  * Combined the shadows layer into the byways layer. Since MapServer 
    draws one layer and then another, the shadow layer didn't quite 
    work as intended: some byways would hide the shadows of other 
    byways, so shadowing appeared inconsistent.

  * Moved tilecache_update.py from pyserver/ to mapserver/, so that 
    it's alongside its brethren.

    * Added a handful more configurable visual styles to the skins, 
      and created a special zoom to get around the STYLE problem 
      described above -- we take our skins lookup table, which has one 
      row of style values for each unique (geofeature type, zoom level), 
      and we make a flat table view which just has rows for each unique 
      zoom level, such that all the style values for all the geofeature 
      types are made into their own columns. This is not elegant, and 
      it's not endlessly scalable: Postgres only supports around 1,500 
      columns in any given table.

* Making MapServer/TileCache and Flashclient "skinnable". See 
  mapserver/skins/skin_bikeways.py for the draw config for the 
  new bikeways map style. You can make a copy of that file and 
  edit it to make new "skins".
  
  * We need a drop-down in flashclient so the user to select 
    which skin they want to use.

* Added a README with comments regarding MapServer (since MapServer 
  is a very peculiar and picky piece of software).

* Added new serif fonts to MapServer (Liberation Sans, basically 
  the free version of Arial used by OpenOffice).

  * Moved fonts to a fonts/ subfolder to de-clutter mapserver/.

* Added the "extended skin config" to flashclient -- it requests 
  it on startup, so flashclient now has the draw config created 
  and used by tilecache_update.py to make the new tiles.


------------------------------------------------------------------------
r25881 | landonb | 2011-09-23 20:18:34 -0500 (Fri, 23 Sep 2011) | 1 line

New map colors. Lots of update to tilecache_update.py: it stores the zoom config for all the tiles now, rather than fetching from the database (makes it easier to work with the tiles).
------------------------------------------------------------------------
r25846 | landonb | 2011-09-21 12:42:17 -0500 (Wed, 21 Sep 2011) | 30 lines


* Overhauled tilecache_update.py.

  - It was using the old database schema; not it uses the new one.

  - The script takes one or more group IDs and one or more branch 
    IDs to use when fetching items from the database. This means, 
    e.g., we could create unique sets of tiles for each branch. 
    For now, we'll use this feature to create tiles and use the 
    metc bikeways data to draw bike lanes, etc.

  - Updates to *.map files to use new cache table.

  - Doubled the script size, from 425 lines to 950 lines....

* Combined some common functionality in link_attribute and link_post, 
  which both sometimes fetch attribute definitions, into a new 
  intermediate class, link_uses_attr.

* Found a BUGBUG in MapServer: it parses SQL line-by-line rather 
  than properly tokenizing, so your *.map files should be careful 
  with their SQL and not split certain lines. E.g., the "FROM" 
  keyword must be on the same line as the table name "FROM my_table"
  works, but "FROM \n my_table" does not work!

* Increased flashclient GWIS timeout to 10 minutes, to help 
  with development until we fix the leafy branch link_value 
  checkout problem (it's really slow!)


------------------------------------------------------------------------
r25798 | landonb | 2011-09-18 16:49:46 -0500 (Sun, 18 Sep 2011) | 1 line

Metc Bikeways Import bugfix: Skip calculating geometry for revision with tens of thousands of link_value attribute changes: PostGIS keeps assert()ing and crashing Postgres; not important data, anyway (changes affect so many byways that the revision geosummary is basically the whole map).
------------------------------------------------------------------------
r25796 | landonb | 2011-09-18 15:01:31 -0500 (Sun, 18 Sep 2011) | 38 lines


* Side-tracked by a PostGIS bug that occurs while creating 
  revision geometries during the metc bikeways import:

   There's a bug in PostGIS (at least I [lb] assume it's a bug):

     http://trac.osgeo.org/geos/ticket/473
       "RightmostEdgeFinder assertion killing postgres process"

   This happens if you try to ST_Buffer() too many geometries -- 
   I couldn't find a hard-and-fast number of geometries because it varies 
   on the query, but, on my laptop, it generally happens when processing 
   500 to 1000 geometries or more. The error occurs in both PostGIS
   v1.3.6/Geos v3.2.0 and PostGIS v.1.5.3/Geos v3.3.0, and reads:

    SELECT: RightmostEdgeFinder.cpp:77: 
      void geos::operation::buffer::RightmostEdgeFinder::findEdge(
        std::vector<geos::geomgraph::DirectedEdge*>*): 
        Assertion `checked>0' failed.

   After lots of fiddling, it turns out you can circumvent the error if
   you simplify a polygonized collection of the geometry. I assume the
   problem is resource-related and that simplifing the geometry collection
   just avoids the problem. As for polygonizing, that converts the 
   MULTILINESTRING to a MULTIPOLYGON (otherwise the simplify just returns 
   a GEOMETRYCOLLECTION which triggers a table constrainst complaint).

* Upgrade PostGIS 1.3 -> PostGIS 1.5

  - Also Geos 3.2 -> Geos 3.3

* Some tweaks to the mapserver config. Just the start...

  - Make highways less prominent.

  - Make bike trails more obvious.


------------------------------------------------------------------------
r25748 | landonb | 2011-09-17 15:31:55 -0500 (Sat, 17 Sep 2011) | 15 lines


* Regression bugfixes (via debugging metc import script):
    - saving byways
    - saving link_values
    - collecting geometry and geosummary information for 
      group_revision rows: was only getting it for changed 
      byways, so added geometry for unchanged byways whose 
      link_values changed.

* Moved client_id_map from static member of item_versioned.One 
  to Item_Query_Builder, since apache shares static members 
  between sessions (albeit not predictably -- I think it must 
  create a number of python threads to handle requests).


------------------------------------------------------------------------
r25741 | landonb | 2011-09-16 18:27:52 -0500 (Fri, 16 Sep 2011) | 10 lines


* Regression bugfix: loaded non-basemap branch at vector 
  level: no items returned from pyserver.

* Rearranged kvps in gwis req. to make debugging easier.

* __cmp__ and __str__ and diff_str fcns added to query 
  builder's sql clauses objects.


------------------------------------------------------------------------
r25726 | landonb | 2011-09-16 01:04:35 -0500 (Fri, 16 Sep 2011) | 1 line

Regression bugfix: create new group with ccp.py script.
------------------------------------------------------------------------
r25725 | landonb | 2011-09-16 00:08:11 -0500 (Fri, 16 Sep 2011) | 9 lines


* Regression bugfix: Create new branch (using ccp.py).

* Implement: Use access_existing when client sends commit
  request with existing items.

* Some __str__() tidy'ing__up


------------------------------------------------------------------------
r25724 | landonb | 2011-09-15 20:47:57 -0500 (Thu, 15 Sep 2011) | 23 lines


* V1->V2 upgrade scripts: In table group_, valid_start_rid
  should start at 1, not the latest revision (otherwise, 
  trying to find old group_revision records fails because 
  because the group does not exist at the older revisions).

* Renamed some of the GWIS key names and rearranged the URL 
  format so more import key/values come first, which makes 
  debugging easier, since WireShark only shows the first 
  part of the URL.

* Cleaned up some of the link_value-derived class' SQL 
  clauses setup.

* Fixed the link_value problem noted in the last checkin:
  pyserver was ignoring the bbox filter, so it was returning 
  _all_ link_values, which took a long time and produced a 
  huge GWIS packet, and flashclient either timedout while 
  waiting for the response or choked while trying to process 
  it (Flash's thread supervisor kills flashclient if a frame 
  takes too long to render because a function runs too long).


------------------------------------------------------------------------
r25720 | landonb | 2011-09-15 13:40:14 -0500 (Thu, 15 Sep 2011) | 1 line

Fifteen or so pyserver bugfixes to r25607. Map loads now without errors, but checking out links is broken in the client (and the excessive trace output causes flashclient to timeout).
------------------------------------------------------------------------
r25713 | landonb | 2011-09-15 10:15:38 -0500 (Thu, 15 Sep 2011) | 1 line

A few pyserver bugfixes to last the checkin, coded on the gate of a pickup truck next to Jones Creek Pond, IA (so I did a little work during vacation...).
------------------------------------------------------------------------
r25607 | landonb | 2011-09-08 00:40:17 -0500 (Thu, 08 Sep 2011) | 212 lines


Lots of Big Problems Solved[1] in pyserver.

^ Fixed Link_Value Fetching to Use Branch Hierarchy and 
Honor Permissions of the Items Being Linked.

^ Implemented Diffing.

^ New New Item Policy to Control Inherited Permissions.

^ Major Overhaul of Revision Class; Inclusion of Group Ids.

===========================================================

+ Because of branching and permissions, diffing no longer 
works the way it used to. 

In Ccpv1, the client would send three requests -- a.) one
for old items, b.) one for new, and c.) one for static --
and the server could just search a.) for items in both
revisions, b.) for items that only existed in the old
revision (their new version having been marked deleted),
and c.) for items that only exist in the new revision (the
item having been created since the old revision).

In Ccpv2, however, a 'new' item might appear new because 
the user does not have permissions to see the old item. 
Also, you cannot perform one search to find 'static' items -- 
the records in group_item_access represent subsets of
items' valid_start_rid and valid_until_rid values, so we
cannot use a fetched group_item_access record to figure out
if the item in question is 'new', 'old', or 'static'. 

Specifically, our query only tells us the access the user 
has to an item at a specific revision, so we have to use 
at least two queries when Diffing.

+ Because of branching and permissions, viewport fetching
is Very Tricky.

In Ccpv1, if you searched a viewport, you'd find all
the items within that viewport. There were basically
two types of items being fetched, geofeatures and
link_values. Attachments were also fetched, by only by way
of link_values. This approach works well in Ccpv1, because
there are no branches and every thing is public.

However, a few big problems affect this approach in Ccpv2.

* For one, viewport queries will find false-positives.

For example, consider a byway in the basemap that's in my
viewport. Now assume that in my branch, I drag the byway
outside the viewport. When you search for byways in that
viewport, you'll find the basemap item and not the item in
the branch.

To solve this, after fetching items based on the viewport,
pyserver has to inspect every item one by one and see if a
"leafier" item exists.

In the previous example, pyserver would find the basemap
item, see that it's branch ID is not the same as the
working branch, and so pyserver would query the item ID and
see if an item with the same ID is saved to a branch that 
descends from the basemap.

* The second big problem is permissions false-positives.

This is basically the same as the last problem, except this
happens when permissions change on an item, and so the
query finds an item in a parent branch and skips leafier
items to which the user does not have access.

The solution is similar to the earlier one: look for a
leafier item. If one is found and the user does not have
permissions to see it, ignore it (actually, rather than
searching a second time, pyserver does a more permissive
initial search that includes all items, and it filters on
access permissions when processing the results of the 
query).

* The third problem is how to get geometry for links.

We cannot just join link_value against geofeature, because
we have to check user permissions and make sure we get the
leafieast item, too.

So we join twice against the group_item_access table (once
for the attachment, and again for the geofeature), and then
we check the group IDs of the linked items to make sure
they match the user's group IDs, and then we check the
branch IDs of the linked items to make sure they match the
branch hierarchy.

The real trick is how to sort through all the mess, since
we've joined group_item_access against itself three times,
so we could end up with lots of rows for the same items,
some from different branches or with different access
levels. Fortunately, if you sort your results smartly and
run DISTINCT ON, you can select the "best match", that is,
the link value linked to the leafiest items with the best
access permissions.

* The third problem is how to actually Diff. Things are a 
lot more complicated than they used to be.

In Ccpv2, rather than have the client send three queries
like in Ccpv1, the client just sends one Diff query and the
server processes everything at once. It starts by fetching
all the items in both the old and the new revisions,
resolving leafiness as appropriate in each. Then, it goes
through the items and matches up stack IDs. If two stack
IDs match and their system IDs also match, then the item is
considered 'static' (not changed between revisions). If the
system IDs do not match, then one item is the 'former' item
and the other is the 'latter' item (hint: In Ccpv1, these
were 'old' and 'new'). Lastly, if one item was not found
and we're searching by viewport, we have to look up the
stack ID of the other ("counterpart") item. Kind of like
the reasons discussed above when searching by viewport, but
in this case, rather than ignore the item, we still want
to send it to the client -- e.g., if a geofeature is moved
outside the viewport, we still want to send it, so the
client can show the diff.

I also added a grac_hash variable, but it's not wholly 
implemented. The idea is to create a hash value of all 
of a user's group_item_access records for an item at a 
particular revision so that, even if a Diff item is 
considered 'static', we could indicate to the user if 
maybe their permissions changed. (Like I said, though, 
this is not completely implemented -- we need to write 
an SQL aggregate fcn. to calculate the grac_hash by 
bitwise XORing some of group_item_access's columns, 
like group_id, item_id, and access_level_id.)

===========================================================

+ Some other changes:

* When processing a request, pyserver gets the user's group
IDs at one or both revision IDs being requested.

* Made a handful of private variables in Item_Query_Builder
to better help build the SQL query. This includes sticking
use_filters_and_viewport and use_limit_and_offset in the
object, as well as a new diff_group value to help with
processing Diffs. I also added force_rev_gids, to control
if the SQL checks group_memberships by joining tables, or
if it does a WHERE IN () query. Also, leaf_gf_stack_id and
leaf_gf_branch_id are used when resolving leafiness issues,
as described above.

* Hydrated grac/group_item_access.py with all the columns 
in the schema that were not defined in the Python class 
but were present in the schema.

* Moved access_scope_id from item_user_access to
group_item_access. The value cannot be accurately
calculated in group_item_access when bulk-fetching items,
and it's only displayed on the Groups tab in flashclient,
so the value is now lazy-loaded and calculated on demand,
one item at a time. See grac.group_item_access.py.

* Cleaned up some grac/*.py SQL, especially in group_membership.

* Removed 'geometry' column from group_item_access. Besides 
being redundant, it's impossible to populate this value 
correctly for link_values, since the linked geofeature
could come from any branch or have any permissions. So the
geometry has to be linked in during the query so we can
verify permissions and make sure we get the item from the
correct branch.

* Made revision intermediate base class, Revision_Base, and
put all the @staticmethods in the base class, Revision.
Since the other classes -- Current, Historic, Diff, and
Updated -- all derive from the same class, splitting out
the staticmethods makes this class more readable.

* Got rid of Revision.as_sql_where_or, which never
solved the problem I had with Diff. Added some parms to
as_sql_where and added as_sql_where_strict, which is used
on any Revision object to check permissions one an item at
a given revision.

* Renamed some short-name GWIS values used by revision_get.
@u -> is_revert, @fb -> feedback_exists, and @ts -> timestamp.

* Cleaned up and fixed issues in group_revision not quite 
representing reality correctly.

* Lots and lots of changes to pyserver/item/item_user_access.py

===========================================================

[1]WARNING: This code isn't completed debugged. I've       
sucessfully ran it against ccp.py... well, specifically,   
  $ ./ccp.py -U landonb -r -t branch
The code needs to be debugged and will have errors. But I'm
going on vacation and want to get it checked in, and, well,
the ccpv2 "trunk" is really just a working branch, anyway,
until it's released, so this bothers me only a little. If
this code were being actively developed by others, or
if there was a cronjob somewhere checking this code out
and installing it on a nightly basis, then maybe I'd
care. But this is a lot of cool new code that apparently
solves Diffing and respeking branches and permissions on
link_values, so I couldn't be happier to check it in.


------------------------------------------------------------------------
r25600 | landonb | 2011-09-07 15:48:18 -0500 (Wed, 07 Sep 2011) | 18 lines


Some trivial things before a Really Big Checkin:

* Whitespace/comments changes.

* Renamed req.client.username_hack to username_friendly.

* Item_Query_Builder:

  * Caches branch hierarchy string;

  * Adds is_spent, to know if iqb is modified and cannot be 
    used on subsequent quieries (unfortunately, sql_clauses
    objects are not always reusable)

* scrub-db.py bugfix


------------------------------------------------------------------------
r25598 | landonb | 2011-09-07 15:13:59 -0500 (Wed, 07 Sep 2011) | 1 line

Added a few missing columns to the database model.
------------------------------------------------------------------------
r25553 | landonb | 2011-09-06 09:40:31 -0500 (Tue, 06 Sep 2011) | 1 line

minor scrub-db fix
------------------------------------------------------------------------
r25551 | landonb | 2011-09-05 16:53:51 -0500 (Mon, 05 Sep 2011) | 1 line

Fixes: (1) Syntax errors in V2 upgrade scripts. (2) schema-upgrade was not exiting on script failure (so subsequent scripts were run and the whole operation must be restarted.).
------------------------------------------------------------------------
r25498 | landonb | 2011-09-03 13:10:14 -0500 (Sat, 03 Sep 2011) | 60 lines


Ccpv2 Schema Changes

* Added access_existing to new_item_policy

So when you give the public access to your branch, 
you can control what __existing__ items they can 
edit (where existing mostly means items inherited 
from the parent branch, to which the public has 
edit access to -- so you can restrict their access 
to viewer, for example).

* Removed geometry and z from group_item_access

(1) I'm not sure the performance gain is significant 
(as opposed to just joining the geofeature table).

(2) There's not a reliable way to calculate the 
geometry for links, so the purpose of storing 
geometry in group_item_access can not be fulfilled.
That is, we wanted an easy to find links for items 
in a specific viewport: but we also need to check 
the user's access levels to the two items being 
linked (the LHS and RHS items), so, while a user 
may have editor access rights to a link, they 
may be denied access to the geofeature, and 
therefore, the link should not indicate the geometry, 
since the user technically cannot see the geofeature.

* Removed revision geometry functions (cp_revision_* et al)

These are better suited as pyserver functions. That 
way, they are easier to maintain, and we can call 
them when we want, since they can be lengthy operations.

* Dropped skip_geometry from revision and group_revision

The value is not used and can be inferred by checking
if revision.geometry IS NULL.

* Some other fixes to ccp.py and Metc bikeways import

Ccp.py support for link_value LHS and RHS types.

Fixed only_stack_ids filter.

Fixed filters in Ccp: was not appending to URL.

* Other fixes

Pyserver: Was not setting group_item_access.name for 
link_values.

Shortened query filter GWIS names.

Added lazy-loading to flashclient for link_values 
when geofeature is selected.



------------------------------------------------------------------------
r25473 | landonb | 2011-08-31 12:51:02 -0500 (Wed, 31 Aug 2011) | 1 line

Bugfix to last checkin
------------------------------------------------------------------------
r25472 | landonb | 2011-08-31 12:48:13 -0500 (Wed, 31 Aug 2011) | 1 line

Bugfix to last checkin
------------------------------------------------------------------------
r25471 | landonb | 2011-08-31 12:44:11 -0500 (Wed, 31 Aug 2011) | 1 line

Bugfix to last checkin
------------------------------------------------------------------------
r25470 | landonb | 2011-08-31 12:39:31 -0500 (Wed, 31 Aug 2011) | 1 line

Bugfix to last checkin
------------------------------------------------------------------------
r25469 | landonb | 2011-08-31 12:34:34 -0500 (Wed, 31 Aug 2011) | 15 lines


Removed ANALYZE commands from schema scripts;
- huffy hanged for 18 hours on analyze before I 
  killed script;
- instead having schema-upgrade.py script run 
  vacuum analyze after each script.

Moved geometry fcns. from pyserver/util/misc.py 
                       to pyserver/util/geometry.py.

Moved run_cmd() to misc.py.

Add FID to bikeways attributes that we import.


------------------------------------------------------------------------
r25432 | landonb | 2011-08-30 11:43:38 -0500 (Tue, 30 Aug 2011) | 1 line

Fixed wrong sql fcn name (matched name in my dev db, not in actually db)
------------------------------------------------------------------------
r25430 | landonb | 2011-08-30 11:25:34 -0500 (Tue, 30 Aug 2011) | 1 line

(1) Fix geometry fetch (as svg or wkt; was not always being added to sql). (2) Fix bikeways import: (a) new feature names were being fetches as int, not str (so feature names were all '0') and (b) new features from split features should use Cyclopath name, not bikeways name.
------------------------------------------------------------------------
r25427 | landonb | 2011-08-30 00:16:17 -0500 (Tue, 30 Aug 2011) | 19 lines


Osgeo bug workaround: 

ST_Buffer fails: and it crashes the psycopg plugin, too!

  cycling cycling3 [local] SELECT: RightmostEdgeFinder.cpp:77: 
      void geos::operation::buffer::RightmostEdgeFinder::findEdge(
      std::vector<geos::geomgraph::DirectedEdge*>*): 
      Assertion `checked>0' failed.

It might be a bad geometry, but they all check out as
ST_IsValid. 

Fortunately, of the three geosummary columns in the
revision and group_revision tables -- geometry, geosummary,
and bbox -- only geosummary and bbox are actually used: so
commenting-out calculation of geometry column.


------------------------------------------------------------------------
r25426 | landonb | 2011-08-29 22:36:04 -0500 (Mon, 29 Aug 2011) | 17 lines


A few hundred more lines for the Metc Bikeways
import. Fixing some bugs and mostly trying to 
get the import not to take forever (I killed it
this morning after it ran 8 hours overnight).

Updated revision geometry functions.

- Duplicated SQL fcns. in pyserver.

- Don't Collect() where geometry is null
  (I'm hoping this speeds up large updates).

Updated db_glue: let users control autocommit 
(to set True, for VACUUM).


------------------------------------------------------------------------
r25418 | landonb | 2011-08-29 13:59:14 -0500 (Mon, 29 Aug 2011) | 1 line

Fix memory usage issues with Metc Bikeways import: do not store 10s of 1000s of hydrated byway.One() objects, instead just store 10s of 1000s of byway stack IDs.
------------------------------------------------------------------------
r25417 | landonb | 2011-08-29 13:23:15 -0500 (Mon, 29 Aug 2011) | 1 line

One post-update bugfix.
------------------------------------------------------------------------
r25416 | landonb | 2011-08-29 13:02:44 -0500 (Mon, 29 Aug 2011) | 1 line

Insignificant changes from updating from trunk.
------------------------------------------------------------------------
r25415 | landonb | 2011-08-29 12:52:18 -0500 (Mon, 29 Aug 2011) | 1 line

Metc Bikeways Import Script actually runs\! =) This checkin adds code to split byways and make link_values. I added code to figure out start and end nodes, too, so hopefully the bikeways data will be somewhat connected to the existing Cyclopath byways. The script takes 100 minutes to run (I think) and still needs to be vetted: the last time I ran it, the group_item_access rows for geofeature items were missing their geometry. And there are bound to be a few other issues, too, but things are mostly coming together.
------------------------------------------------------------------------
r25414 | landonb | 2011-08-29 12:48:06 -0500 (Mon, 29 Aug 2011) | 22 lines


Lots of Bugfixes (regression bugs) for saving items to Ccpv2.

Bug 2522 (production bug from Ccpv1) for fetching
geofeatures.  Geofeature geometries have always been
fetched as SVG, but to save to the database, they need
to be in native or WKT format. This is because, usually,
when you fetch an item from the database, it's to send it
to flashclient.  But with the bikeways import script, we
fetch items that we intend to edit and then save back to
the database: and in Ccpv1, you can't fetch a geofeature
(and hydrate a geofeature.One() object) and then save
it back to the database, because the geometry is in the
wrong format. In Ccpv2, see the new geofeature members,
geometry_svg and geometry_wkt.

Prefixed a bunch of PostGIS fcns. with "ST_", to follow 
our convention of prefixing postgresql functions with 
common prefixes to figure out which libraries the 
functions are from.


------------------------------------------------------------------------
r25413 | landonb | 2011-08-29 11:56:18 -0500 (Mon, 29 Aug 2011) | 1 line

Added a few comments and asserts.
------------------------------------------------------------------------
r25412 | landonb | 2011-08-29 11:53:47 -0500 (Mon, 29 Aug 2011) | 1 line

Notes update
------------------------------------------------------------------------
r25337 | landonb | 2011-08-26 13:53:41 -0500 (Fri, 26 Aug 2011) | 1 line

Bikeways import runs until saving new byways: byway.py's SQL needs updating in generic rating calculator, still.
------------------------------------------------------------------------
r25336 | landonb | 2011-08-26 13:51:23 -0500 (Fri, 26 Aug 2011) | 1 line

Final fixes to schema-upgrade? Cron job has been running for a while without choking...
------------------------------------------------------------------------
r25332 | landonb | 2011-08-26 12:12:48 -0500 (Fri, 26 Aug 2011) | 1 line

Stumbling through schema-upgrade fixes since I made it import pyserver... fixed bug loading database from CONFIG, not the one from the command line.
------------------------------------------------------------------------
r25330 | landonb | 2011-08-25 23:25:45 -0500 (Thu, 25 Aug 2011) | 1 line

Big update to bikeways data import script. A few tweaks in pyserver.
------------------------------------------------------------------------
r25327 | landonb | 2011-08-25 18:03:03 -0500 (Thu, 25 Aug 2011) | 1 line

schema-upgrade.py: fix relative path
------------------------------------------------------------------------
r25325 | landonb | 2011-08-25 17:57:53 -0500 (Thu, 25 Aug 2011) | 1 line

Add hint to CONFIG.template
------------------------------------------------------------------------
r25324 | landonb | 2011-08-25 17:49:23 -0500 (Thu, 25 Aug 2011) | 1 line

Update schema_upgrade to use pyserver's db_glue, rather than it's own copy-n-pasted subset, which got out-of-step with the code in pyserver.
------------------------------------------------------------------------
r25322 | mludwig | 2011-08-25 17:27:02 -0500 (Thu, 25 Aug 2011) | 1 line

Fix tag adding to not crash, fix UI so tag widget is updated on adds/deletes
------------------------------------------------------------------------
r25320 | mludwig | 2011-08-25 15:48:07 -0500 (Thu, 25 Aug 2011) | 1 line

Hide unimplemented portions of the groups interface
------------------------------------------------------------------------
r25318 | mludwig | 2011-08-25 15:11:55 -0500 (Thu, 25 Aug 2011) | 1 line

Fix region name autocomplete for discussion/recent changes panels
------------------------------------------------------------------------
r25292 | mludwig | 2011-08-24 19:07:17 -0500 (Wed, 24 Aug 2011) | 1 line

Fix a number of bugs handling tags in ccpv2. Update tag.py to return counts for points and regions, and no longer return feat_link_exists. Update Attachment.as to compute feat_link_exists from link counts. Fix tag applied cache to properly separate cached counts by feature type. Update tag autocompletion to read correct property on Tag objects. Update Update_Viewport_Base to load region link values when not in vector mode
------------------------------------------------------------------------
r25291 | landonb | 2011-08-24 14:44:27 -0500 (Wed, 24 Aug 2011) | 20 lines


Script to create new item policies 
for a group for that group's branch.
Policies are similar to those for the 
basemap, but only for the grorp: so if 
you give the public editor access, they 
won't actually be able to edit anything 
(though they'll be able to view everything,
the same as if you gave the public viewer 
access to the branch).

  E.g.,

./new_item_policy_init.py \
  -U landonb \
  -b "Metc Bikeways 2011" \
  -g "Metc Bikeways 2011" \
  -m "Creating new item policies for branch"


------------------------------------------------------------------------
r25286 | landonb | 2011-08-24 11:15:40 -0500 (Wed, 24 Aug 2011) | 1 line

Partial fix to Bug 2517, Tag Delete regression: getting Link_Value item panel no longer crashes, but the tag widget does not update (so if user clicks 'x' again, a second item_delete is created and errors occur). Also a few other flashclient fixes I found along the way.
------------------------------------------------------------------------
r25285 | landonb | 2011-08-24 10:31:21 -0500 (Wed, 24 Aug 2011) | 42 lines


Reworked the rev_spec package hierarchy to match reality
a bit better. I was running into some issues switching
between branches and logging in and logging out, and this
helped with the problem.

   The revision classes hierarchy is split into two groups:
   one group for editable items, and one group for historic
   items. The former group is called 'follow', as in, the
   items follow the latest items on the server. The latter
   is called 'pinned', since the items are checked out just
   once and are not editable.

      Base
      | 
      | - Follow
      | | 
      | | - Current
      | | |
      | | | - Changed
      | | 
      | | - Working
      | 
      | - Pinned
      | |
      | | - Diff
      | | 
      | | - Historic

   In G.map, there's now rev_working and rev_canvas. The
   latter, rev_canvas, always reflects the state of the map
   (set to either follow or pinned; if follow, set to same
   object as rev_working.) The former, rev_working, just
   tracks the follow state: it begins life as Current and
   then cycles between Working and Changed.

Aliased Introspect.get_constructor to Introspect.ctor.

Fixed some bugs switching between branches and users in
flashclient.


------------------------------------------------------------------------
r25234 | landonb | 2011-08-22 23:20:41 -0500 (Mon, 22 Aug 2011) | 1 line

Fix ccp's revision option.
------------------------------------------------------------------------
r25232 | landonb | 2011-08-22 23:18:38 -0500 (Mon, 22 Aug 2011) | 22 lines


Refactored SQL query

* Old inner query got items and figured out the 
  (valid_start_rid, valid_until_rid) ranges, and 
  the outer query coalesced these results.
* But, really: we're only selecting items from one 
  specific revision, so the range is meaningless.
* Also: we can order-by and select-distinct-on to 
  replace aggregate fcns. we used to use (that is, 
  min(access_level_id); we need the distinct-on to 
  figure out stacked branching, so this is a winwin.

Bugfix: get leafiest-branch item

* When you checkout items for a particular viewport (bbox),
  you have to double-check every item for a leafier item,
  since, in a newer branch, an item in the viewport in an
  older branch may have beed moved in a newer branch, so
  the newer branch is not found in the query.


------------------------------------------------------------------------
r25231 | landonb | 2011-08-22 22:53:29 -0500 (Mon, 22 Aug 2011) | 24 lines


Added --revision option to ccp.py.

* Replaced optparse with argparse.

Fix to access_level_id default from ccp.py:
requires that shared_secret be used (since 
item_user_access wants to default to 
Access_Level.client and needs to trust change 
is ok).

Some whitespace/comments changes.

Silly/Embarrassing revision bugfix: was always 
setting allow_deleted to False.

Item_Query_Builder:

* Mirror request_is_secret

* New 'enabled', since outer select will no 
  longer be required (coming in next checkin)


------------------------------------------------------------------------
r25230 | landonb | 2011-08-22 22:39:21 -0500 (Mon, 22 Aug 2011) | 1 line

Hardening: wrapping SQL selects for 'id' with cast to Python int().
------------------------------------------------------------------------
r25221 | landonb | 2011-08-22 11:14:01 -0500 (Mon, 22 Aug 2011) | 1 line

Minor bugfixes for working with branches. About to refactor item_user_access's SQL builder to handle branches better....
------------------------------------------------------------------------
r25175 | landonb | 2011-08-19 17:28:21 -0500 (Fri, 19 Aug 2011) | 1 line

Bug 2189 - is_endpoint for Route_Step is incorrect - from Fernando.
------------------------------------------------------------------------
r25173 | landonb | 2011-08-19 16:57:13 -0500 (Fri, 19 Aug 2011) | 1 line

Fixed: Bug 2511 - Flashclient: Changing branches crashes Flashclient.
------------------------------------------------------------------------
r25170 | landonb | 2011-08-19 15:56:33 -0500 (Fri, 19 Aug 2011) | 35 lines


(1) Can now do some GrACcy things from ccp.py, like make 
    groups, group_memberships, and branches. E.g.,

./ccp.py -U landonb --no-password \
  -f request_is_a_test 0 \
  -c -t group \
  -m "Make Group: Metc Bikeways 2011" \
  -e name "Metc Bikeways 2011" \
  -e access_scope_id 2 \
  -e description "Metc Bikeways 2011" 

./ccp.py -U landonb --no-password \
  -f request_is_a_test 0 \
  -c -t group_membership \
  -m "Add user to group." \
  -e name "NA" \
  -e access_level_id 1 \
  -e opt_out 0 \
  -e username landonb \
  -e group_name "Metc Bikeways 2011"

./ccp.py -U landonb --no-password \
  -f request_is_a_test 0 \
  -c -t branch \
  -m "Make Branch: Metc Bikeways 2011" \
  -e name "Metc Bikeways 2011"

(2) Fixed some bool(x) typecasts that should be bool(int(x))
    in case x is a str.

(3) Can only get branch-context new_item_policies if branch 
    arbiter or owner.


------------------------------------------------------------------------
r25163 | landonb | 2011-08-19 10:26:45 -0500 (Fri, 19 Aug 2011) | 1 line

Rewrote pyserver_glue so it can be used anywhere within Cyclopath source directory, and not just the scripts/ directory.
------------------------------------------------------------------------
r25162 | landonb | 2011-08-19 10:04:00 -0500 (Fri, 19 Aug 2011) | 1 line

pyserver_glue now sets PYSERVER_HOME
------------------------------------------------------------------------
r25161 | landonb | 2011-08-19 10:03:09 -0500 (Fri, 19 Aug 2011) | 1 line

Setting up pyserver_glue.py links
------------------------------------------------------------------------
r25160 | landonb | 2011-08-19 10:02:41 -0500 (Fri, 19 Aug 2011) | 1 line

Setting up pyserver_glue.py links
------------------------------------------------------------------------
r25159 | landonb | 2011-08-19 10:01:57 -0500 (Fri, 19 Aug 2011) | 1 line

Starting to move pyserver_glue around. Added java to linecount.pl.
------------------------------------------------------------------------
r25158 | landonb | 2011-08-19 09:56:04 -0500 (Fri, 19 Aug 2011) | 1 line

Chicken-foot in db model missing pkey bar.
------------------------------------------------------------------------
r25157 | landonb | 2011-08-18 19:39:31 -0500 (Thu, 18 Aug 2011) | 1 line

Added sql saving to schema_cols and messed around with save, save_core, and save_insert fcns.
------------------------------------------------------------------------
r25140 | landonb | 2011-08-18 12:08:47 -0500 (Thu, 18 Aug 2011) | 37 lines



=================================

SWIZZLE! making branches seems to work (I'm testing w/ a rollback (request_is_a_test)):

  ./ccp.py -c -t branch -e name "Metc Bikeways 2011" -f request_is_a_test 1 -m "New Bikeways 2011 Branch" -U landonb --no-password

The request

  http://localhost/gwis?body=yes&branch_id=2372946&gwv=2&request=commit

with the payload

  <data>
    <metadata request_is_a_test="1">
      <user name="landonb" token="_redacted_"/>
      <changenote>New Bikeways 2011 Branch</changenote>
    </metadata>
    <ratings/>
    <watchers/>
    <items>
      <branch stack_id="-1" deleted="0" version="0" name="Metc Bikeways 2011"/>
    </items>
    <accesses/>
  </data>

returns

  <data rid_max="15068" major="not_a_working_copy" gwis_version="2" semiprotect="0">
    <result stype="ordinary" thread_id="-1"/>
  </data>

=================================



------------------------------------------------------------------------
r25139 | landonb | 2011-08-18 11:50:44 -0500 (Thu, 18 Aug 2011) | 1 line

Fixed from_gml fcns. (Bug 2508 - Pyserver: Missing XML attributes crash pyserver).
------------------------------------------------------------------------
r25134 | landonb | 2011-08-17 23:50:26 -0500 (Wed, 17 Aug 2011) | 1 line

Fixes to previous checkin. You can run ccp.py as any user without password. A shared secret is used, so ccp.py must be run from same directory as pyserver by interactive user, so I think it's secure.
------------------------------------------------------------------------
r25133 | landonb | 2011-08-17 23:29:10 -0500 (Wed, 17 Aug 2011) | 1 line

Beefier error handling: print stack trace for Exceptions which are lacking messages; don't crash pyserver of bad GWIS input, but return GWIS error instead. New 'shared secret' for ccp.py to convince apache/pyserver that it's 'special'. Ccp.py can now use GWIS for 'read' actions.
------------------------------------------------------------------------
r25132 | landonb | 2011-08-17 23:25:01 -0500 (Wed, 17 Aug 2011) | 1 line

Added some ctors; whitespace changes;.
------------------------------------------------------------------------
r25131 | landonb | 2011-08-17 20:45:18 -0500 (Wed, 17 Aug 2011) | 1 line

Fixed checking for user password v. token: check for password first, then token.
------------------------------------------------------------------------
r25130 | landonb | 2011-08-17 19:08:21 -0500 (Wed, 17 Aug 2011) | 1 line

Renamed pyserver.gwis.error.GWIS_Error to GWIS_Warning, and made a new GWIS_Error class: both classes write to the logfile, but one of 'em writes an error that'll be caught by logcheck (the other just records an 'info').
------------------------------------------------------------------------
r25128 | landonb | 2011-08-17 17:09:26 -0500 (Wed, 17 Aug 2011) | 1 line

Minor changes: working on being able to create new branch and groups using ccp.py.
------------------------------------------------------------------------
r25122 | landonb | 2011-08-17 13:49:54 -0500 (Wed, 17 Aug 2011) | 1 line

Bikeways import script update.
------------------------------------------------------------------------
r25104 | landonb | 2011-08-16 18:53:15 -0500 (Tue, 16 Aug 2011) | 1 line

Sweet script to import met council conflated data shapefile. I got code to read the shapefile and grab the attributes we're after; not I gotta write code to make the Cyclopath attributes, make conflicts for un-conflated features, and to find the Cyclopath byways, add link_values, and possibly split byways.
------------------------------------------------------------------------
r25103 | landonb | 2011-08-16 18:50:55 -0500 (Tue, 16 Aug 2011) | 1 line

Fix osgeo import paths.
------------------------------------------------------------------------
r25099 | landonb | 2011-08-16 15:11:22 -0500 (Tue, 16 Aug 2011) | 1 line

New script to import met council conflated bikeways (see bug 2476).
------------------------------------------------------------------------
r25098 | landonb | 2011-08-16 15:10:46 -0500 (Tue, 16 Aug 2011) | 1 line

scripts/: fix paths to db_glue import
------------------------------------------------------------------------
r25096 | landonb | 2011-08-16 14:28:40 -0500 (Tue, 16 Aug 2011) | 1 line

1. Fix db.commit() -> db.transaction_commit() in scripts/.
------------------------------------------------------------------------
r25095 | landonb | 2011-08-16 14:26:22 -0500 (Tue, 16 Aug 2011) | 1 line

1. Fix import paths in scripts/. 2. Fix db.commit() -> db.transaction_commit() in scripts/.
------------------------------------------------------------------------
r25094 | landonb | 2011-08-16 14:23:33 -0500 (Tue, 16 Aug 2011) | 1 line

Adding some notes of mine... for the time being...
------------------------------------------------------------------------
r25092 | landonb | 2011-08-16 13:33:05 -0500 (Tue, 16 Aug 2011) | 1 line

Remove executable bit from non-executables.
------------------------------------------------------------------------
r25079 | landonb | 2011-08-15 23:54:54 -0500 (Mon, 15 Aug 2011) | 1 line

It might help if I added the new Track files...
------------------------------------------------------------------------
r25077 | landonb | 2011-08-15 23:33:34 -0500 (Mon, 15 Aug 2011) | 19 lines



=================================

V1->V2 scripts added new_item_policy entries for track and track_point,
so I had to add dummy Track and Track_Point classes to flashclient.

* Fixed out-of-sync geofeature_layer values.

* Also Renamed Post_Link_Value to Link_Post, to match pyserver.

* Updated init_GetDefinitionByName to load new classes.

Some other bug-related comments changes.

=================================



------------------------------------------------------------------------
r25066 | landonb | 2011-08-15 16:03:05 -0500 (Mon, 15 Aug 2011) | 1 line

Anonymizer: bugfix.
------------------------------------------------------------------------
r25063 | landonb | 2011-08-15 14:47:10 -0500 (Mon, 15 Aug 2011) | 1 line

Anonymizer: bugfix.
------------------------------------------------------------------------
r25060 | landonb | 2011-08-15 13:52:04 -0500 (Mon, 15 Aug 2011) | 1 line

Anonymizer: bugfix.
------------------------------------------------------------------------
r25058 | landonb | 2011-08-15 13:08:30 -0500 (Mon, 15 Aug 2011) | 1 line

(1) Removed 'dynamic' from Record_Base class definition. (2) Anonymizer script bugfixes.
------------------------------------------------------------------------
r25056 | landonb | 2011-08-15 11:59:41 -0500 (Mon, 15 Aug 2011) | 1 line

Anonymizer: bugfix.
------------------------------------------------------------------------
r25055 | landonb | 2011-08-15 11:54:50 -0500 (Mon, 15 Aug 2011) | 1 line

Automatically checkout Discussions and Revision History on first load.
------------------------------------------------------------------------
r25050 | landonb | 2011-08-15 10:52:49 -0500 (Mon, 15 Aug 2011) | 1 line

Committing my personal [landonb's] notes (Ccpv2 fixmes that are not in bugzilla, mostly).
------------------------------------------------------------------------
r25049 | landonb | 2011-08-15 10:50:47 -0500 (Mon, 15 Aug 2011) | 1 line

Renamed: ./routing_analysis -> route_analytics
------------------------------------------------------------------------
r25048 | landonb | 2011-08-15 10:43:52 -0500 (Mon, 15 Aug 2011) | 1 line

Update anonymizer scripts.
------------------------------------------------------------------------
r25047 | landonb | 2011-08-15 10:42:52 -0500 (Mon, 15 Aug 2011) | 1 line

Copied generic and potentially useful-in-the-future SQL script from schema/ to setupcp/sql (the script that drops and rebuilds all table indices constraints, to ensure the database tables are properly contrained and indexed).
------------------------------------------------------------------------
r25046 | landonb | 2011-08-15 10:41:20 -0500 (Mon, 15 Aug 2011) | 1 line

Created bugs and added bug numbers to comments like 'Bug nnnn'.
------------------------------------------------------------------------
r25042 | landonb | 2011-08-15 09:58:34 -0500 (Mon, 15 Aug 2011) | 1 line

Renamed: scripts/routing_analysis -> route_analytics
------------------------------------------------------------------------
r25014 | landonb | 2011-08-12 16:30:35 -0500 (Fri, 12 Aug 2011) | 1 line

Bugfix: Anonymizer scripts.
------------------------------------------------------------------------
r25012 | landonb | 2011-08-12 13:58:26 -0500 (Fri, 12 Aug 2011) | 1 line

Remove executable bits.
------------------------------------------------------------------------
r25011 | landonb | 2011-08-12 13:07:32 -0500 (Fri, 12 Aug 2011) | 1 line

Make db_load less strict: use DROP DATABASE IF EXISTS, otherwise script fails prematurely on non-error.
------------------------------------------------------------------------
r25006 | landonb | 2011-08-11 17:18:14 -0500 (Thu, 11 Aug 2011) | 1 line

Bugfix: anonymizer scripts.
------------------------------------------------------------------------
r25002 | landonb | 2011-08-11 15:37:10 -0500 (Thu, 11 Aug 2011) | 1 line

Fix upgrade scripts.
------------------------------------------------------------------------
r24977 | landonb | 2011-08-10 15:42:38 -0500 (Wed, 10 Aug 2011) | 1 line

Scripts from Bug 2382.
------------------------------------------------------------------------
r24965 | landonb | 2011-08-10 14:33:17 -0500 (Wed, 10 Aug 2011) | 1 line

Scripts from Bug 2382
------------------------------------------------------------------------
r24954 | landonb | 2011-08-10 11:22:08 -0500 (Wed, 10 Aug 2011) | 22 lines



=================================

* Maybe fixed a mouse handling bug in flashclient
  (the double click detector is getting confused;
   mouse_up/down may not be synchronized with 
   normal on_mouse event?)

* Added wait() to subprocess module usage (Popen).

* Messed around with pyserver_glue to work with new 
  scripts/ directory structure.

* Bug 2381: New Instance UUID script.

* Bug 2379: Tracks have stolen Route IDs.

=================================



------------------------------------------------------------------------
r24952 | landonb | 2011-08-10 09:53:04 -0500 (Wed, 10 Aug 2011) | 1 line

Adding SQL script to delete erroneous track rows.
------------------------------------------------------------------------
r24943 | landonb | 2011-08-09 20:11:49 -0500 (Tue, 09 Aug 2011) | 1 line

V2 upgrade script...
------------------------------------------------------------------------
r24942 | landonb | 2011-08-09 20:05:57 -0500 (Tue, 09 Aug 2011) | 1 line

V2 upgrade script bugfix and some minor fixes to pyserver.
------------------------------------------------------------------------
r24941 | landonb | 2011-08-09 19:06:20 -0500 (Tue, 09 Aug 2011) | 1 line

Fixes to gtfsdb script.
------------------------------------------------------------------------
r24940 | landonb | 2011-08-09 18:56:51 -0500 (Tue, 09 Aug 2011) | 1 line

Fixes to gtfsdb script.
------------------------------------------------------------------------
r24939 | landonb | 2011-08-09 18:37:09 -0500 (Tue, 09 Aug 2011) | 1 line

Routed_v2 appears to be working now\!
------------------------------------------------------------------------
r24938 | landonb | 2011-08-09 18:29:53 -0500 (Tue, 09 Aug 2011) | 1 line

V1->V2 SQL upgrade: Fake Track Revisions do not exist, so creating dummy revision IDs in revision table.
------------------------------------------------------------------------
r24937 | landonb | 2011-08-09 18:09:53 -0500 (Tue, 09 Aug 2011) | 1 line

Update schema-upgrade script.
------------------------------------------------------------------------
r24936 | landonb | 2011-08-09 18:06:21 -0500 (Tue, 09 Aug 2011) | 1 line

Fix subprocess module usage.
------------------------------------------------------------------------
r24935 | landonb | 2011-08-09 17:56:43 -0500 (Tue, 09 Aug 2011) | 1 line

Oops. Reset filenames to keep schema-upgrade happy.
------------------------------------------------------------------------
r24934 | landonb | 2011-08-09 17:49:29 -0500 (Tue, 09 Aug 2011) | 1 line

Remove import popen2.
------------------------------------------------------------------------
r24933 | landonb | 2011-08-09 17:48:08 -0500 (Tue, 09 Aug 2011) | 16 lines



=================================

* Lots of bugfixes to routed_v2 multimodal route finder.

* Moved Item_Query_Builder to its own file so it can 
  always ensure viewport and filters are non-null.

* Replacing uses of deprecated popen2.popen* with 
  subprocess module.

=================================



------------------------------------------------------------------------
r24931 | landonb | 2011-08-09 13:58:55 -0500 (Tue, 09 Aug 2011) | 1 line

Fix simple assertion error. Routed_V1 should be all better now -- loads and returns routes and flashclient display route.
------------------------------------------------------------------------
r24930 | landonb | 2011-08-09 13:50:05 -0500 (Tue, 09 Aug 2011) | 12 lines



=================================

* Added Metro Transit icon to Route Finder dialog.

* Minor bugfixes to pyserver, re: route finding.

=================================



------------------------------------------------------------------------
r24929 | landonb | 2011-08-09 11:45:16 -0500 (Tue, 09 Aug 2011) | 1 line

Regression Bugfixes to flashclient for last two commits.
------------------------------------------------------------------------
r24928 | landonb | 2011-08-09 11:28:46 -0500 (Tue, 09 Aug 2011) | 1 line

More shuffling around of files under scripts/. Also de-coupled Logging.as from Conf.as.
------------------------------------------------------------------------
r24927 | landonb | 2011-08-09 11:26:33 -0500 (Tue, 09 Aug 2011) | 1 line

More shuffling around of files under scripts/. Also added some comments from my working copy to the branch so my diffs can come up clean.
------------------------------------------------------------------------
r24926 | landonb | 2011-08-09 10:18:49 -0500 (Tue, 09 Aug 2011) | 25 lines



=================================

* reorganized scripts/ directory.
  (seriously, it was a mess! =)

* route finders (v1/reid and v2/multimodal) now both
  derive from same common class, Trans_Graph_Base.

* speed fix: v2 route finder takes 30 minutes to load 
  if it has to run route.One.nodeid_from_xy() to find 
  the nearest Cyclopath node for each transit node; I 
  added a cache table to store nearest nodes, and now 
  load time is on the order of one minute.

* bugfixes: multimodal cronjob.

* changed remaining instances of max_rid to rid_max
  (to be parallel to rid_min, rid_max used elsewhere).

=================================



------------------------------------------------------------------------
r24925 | landonb | 2011-08-09 02:29:18 -0500 (Tue, 09 Aug 2011) | 1 line

New common base class for the route finders' tgraphs.
------------------------------------------------------------------------
r24924 | landonb | 2011-08-09 02:28:49 -0500 (Tue, 09 Aug 2011) | 1 line

Two biggies for Multimodal route finder: (1) New script for daily cronjob to download, compile, and cache new transit feeds from transit agency; (2) New cache table for transit-cyclopath links, i.e., transit_stop-cyclopath_node_id pairs, since this operation takes a half hour, and you don't want to wait that long to start the route finder.
------------------------------------------------------------------------
r24864 | landonb | 2011-08-05 22:14:42 -0500 (Fri, 05 Aug 2011) | 1 line

Tons of bugfixes to route finding. Can start routed_ver=v1 now, and it returns routes, and they draw on the map. Panel needs to be debugged. And route finder needs to be tested (does it return same results as Ccpv1 routed_v1, does it update properly when users save to the map, etc). And routed_v2 needs to be fixed. But this is awesome -- routes (sort of) work\!
------------------------------------------------------------------------
r24841 | landonb | 2011-08-05 01:54:57 -0500 (Fri, 05 Aug 2011) | 1 line

Bugfixes: routed partially starts now. It fails processing some SQL, but it's coming along. Also: renamed routed to routed.py, so that Vim knows it's file type and colors its syntax and enables all its nifty Python features.
------------------------------------------------------------------------
r24840 | landonb | 2011-08-05 00:48:06 -0500 (Fri, 05 Aug 2011) | 1 line

Find Route works up to contacting routed, which I haven't tested (or even tried running) yet. But Find Route doesn't crash flashclient and pyserver, at least. Now I just gotta start testing the daemon......
------------------------------------------------------------------------
r24839 | landonb | 2011-08-04 20:22:03 -0500 (Thu, 04 Aug 2011) | 1 line

(1) Find_Route_Popup: fixed formatting problem in the tag prefs help area (the FlowBar doesn't wrap Labels, so labels should be short but plentiful). (2) Find_Route_Popup: some formatting tweaks to make it look better while I test route finding. The dialog needs serious work, but we'll get to that in a few months.... (3) Minor bugfixes to pyserver when requesting route.
------------------------------------------------------------------------
r24837 | landonb | 2011-08-04 19:20:19 -0500 (Thu, 04 Aug 2011) | 1 line

V2 update scripts: move track table fix (it causes pending trigger event problem).
------------------------------------------------------------------------
r24836 | landonb | 2011-08-04 19:16:39 -0500 (Thu, 04 Aug 2011) | 16 lines




/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*

                      MERGE FROM V1 TRUNK                      

    Updated V2 from V1 trunk: revisions 22641 through 24623.    

              ** Includes Multimodal and Mobile.**              

*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/*\*/




------------------------------------------------------------------------
r24833 | landonb | 2011-08-04 16:58:30 -0500 (Thu, 04 Aug 2011) | 1 line

Bug nnnn: V1 tracks have valid_starting_rid = valid_before_rid = 0, which violates unique constraints.
------------------------------------------------------------------------
r24832 | landonb | 2011-08-04 16:18:04 -0500 (Thu, 04 Aug 2011) | 1 line

Typo/misspelling.
------------------------------------------------------------------------
r24831 | landonb | 2011-08-04 16:13:31 -0500 (Thu, 04 Aug 2011) | 1 line

Typo/misspelling: dropping wrong index.
------------------------------------------------------------------------
r24830 | landonb | 2011-08-04 16:07:55 -0500 (Thu, 04 Aug 2011) | 1 line

Add drop constraint to constraints SQL before re-creating constraint.
------------------------------------------------------------------------
r24829 | landonb | 2011-08-04 16:05:15 -0500 (Thu, 04 Aug 2011) | 1 line

Update schema-upgrade: print all of the error, not just the first line...
------------------------------------------------------------------------
r24825 | landonb | 2011-08-03 23:44:43 -0500 (Wed, 03 Aug 2011) | 1 line

Add android/ and doc/multimodal/ from trunk (updating v2 from v1@22641-24623).
------------------------------------------------------------------------
r24821 | landonb | 2011-08-03 18:42:55 -0500 (Wed, 03 Aug 2011) | 1 line

Search: Bugfixes: (1) Byways being grouped by name, but connectedness wrong (was doing UNION on set instead of INTERSECTION to test for connectedness). (2) Wasn't showing waypoint search results (was checking for 'point' gf_type instead of 'waypoint').
------------------------------------------------------------------------
r24820 | landonb | 2011-08-03 18:08:09 -0500 (Wed, 03 Aug 2011) | 1 line

Search: flashclient kind of works. E.g., search for 'longfellow': Search panel is populated with block matches. Bugs: (1) Blocks with same name but not connected are sent as a connected group. (2) Waypoints are being exclude (something to do with the new 'hood' option).
------------------------------------------------------------------------
r24819 | landonb | 2011-08-03 16:54:48 -0500 (Wed, 03 Aug 2011) | 1 line

V2 scripts: syntax error.
------------------------------------------------------------------------
r24816 | landonb | 2011-08-03 16:16:11 -0500 (Wed, 03 Aug 2011) | 1 line

ROLLBACk in unimplemented SQL script causing smarter schema-upgrade to bail.
------------------------------------------------------------------------
r24812 | landonb | 2011-08-03 15:10:52 -0500 (Wed, 03 Aug 2011) | 1 line

scripts/schema-upgrade.py: replace os.system() with popen2.popen4() so we can grep SQL output and fail on ERROR and some WARNING messages. If this works well, later, we can remove the prompt the asks the user if the SQL ran okay.
------------------------------------------------------------------------
r24804 | landonb | 2011-08-03 11:40:16 -0500 (Wed, 03 Aug 2011) | 1 line

V1->V2 scripts update: was assuming primary key on track_point when not there.
------------------------------------------------------------------------
r24802 | landonb | 2011-08-03 11:08:35 -0500 (Wed, 03 Aug 2011) | 1 line

Fix ccp.py problem with access_level/min_access_level cli opts.
------------------------------------------------------------------------
r24801 | landonb | 2011-08-03 10:57:21 -0500 (Wed, 03 Aug 2011) | 1 line

Major fix: byway connectedness grouping was only looping over results once, so not all byways were getting grouped completely. Minor fix: was setting the search match XML booleans backwards for two of the exclude match types.
------------------------------------------------------------------------
r24800 | landonb | 2011-08-03 00:50:43 -0500 (Wed, 03 Aug 2011) | 44 lines



==========

Fixed a bunch of problems in the search SQL.

ccp.py should now returns results! e.g.,

  py ccp.py -s -q "longfellow"

* Rewrote python to group connected byways. In V1, pyserver went 
  through byway results in a nested loop fashion to compare and 
  locate connect byways. Now, the byway results are iterated over 
  just once, but a bunch of lookups are used to figure out 
  connectedness, so I'm not sure if there's a big performance 
  difference. There was no choice but to rewrite the code, since 
  full text search changed how the results are returned. See 
  process_results_byways.

* Changed the include and exclude match information that's 
  returned to flaseclient. In V1, there were six match types -- 
  three sub types each for include and exclude; the three sub 
  types were names, tags, and comments. Included in the XML 
  returned to flashclient was an XML document for each query 
  term, for each result -- which is a lot of extra documents!
  flashclient only cares if there's a match for each of the sub 
  types, and it doesn't care about the terms that matched, so, 
  in V2, the return documents are not included. Instead, each 
  result indicates which of the match types had a hit or not.
  Also, in V1, the six match types were hard-coded in the class. 
  In V2, there are two include and exclude aggregates hard-coded 
  in the class, but they support a variable number of sub types,
  so it should be easy to add new ones.

* Moved Full_Text_Query class and its ilk to new file, so they 
  can be used by both search_map and search_result.

* NOTE: Still need to update flashclient to recognize new XML
        format.

==========



------------------------------------------------------------------------
r24792 | landonb | 2011-08-02 16:11:53 -0500 (Tue, 02 Aug 2011) | 43 lines



==========

* Major overhaul of the pyserver search functionality:

  ** address.py reduced to mostly a shell class.

  ** New class link_tag to help find geofeatures by
     linked-attachment criteria.

  ** New class geocode_address to de-couple code common 
     to address.py and geocode.py (otherwise we get 
     infinite import loop problem).

  ** geocode.py: moved addr_geocode to geocode_address.py 
     and class-ified geocode.py (made new Geocode class).

  ** Major overhaul of search_map.py: using Postgres 8.3 
     full text search, rather than the homegrown search 
     built into V1 (which assumes Postgres 8.2, which does 
     not support full text search).

* Updated ccp.py to test search.

  ** Try, e.g., py ccp.py -s -q "hennepin"

  *** (Search 'works' but is still broken: no rows returned.
       So the SQL is wrong, but at least the python 'works'.)

* Added search params to query_filter: query, centerx, and centery.

* Trying 'street' instead of 'byway' or 'block' or 'road'.

* Added two new Item_Types: track and track_point.

* Propragate from V2 update scripts to pyserver and flashclient:
rename owner_name to created_by, in honor of group access control.

==========



------------------------------------------------------------------------
r24790 | landonb | 2011-08-02 13:25:31 -0500 (Tue, 02 Aug 2011) | 1 line

Added track and track_point to update scripts.
------------------------------------------------------------------------
r24789 | landonb | 2011-08-02 13:22:58 -0500 (Tue, 02 Aug 2011) | 1 line

Added track and track_point to update scripts.
------------------------------------------------------------------------
r24788 | landonb | 2011-08-02 13:21:13 -0500 (Tue, 02 Aug 2011) | 1 line

Added track and track_point to update scripts.
------------------------------------------------------------------------
r24774 | landonb | 2011-08-01 11:45:44 -0500 (Mon, 01 Aug 2011) | 1 line

V2 update scripts: removed redundant insert from dev perms script.
------------------------------------------------------------------------
r24772 | landonb | 2011-08-01 11:21:41 -0500 (Mon, 01 Aug 2011) | 1 line

V2 update scripts.
------------------------------------------------------------------------
r24767 | landonb | 2011-08-01 11:05:56 -0500 (Mon, 01 Aug 2011) | 1 line

V2 update scripts: fix another bug related to dev perms script.
------------------------------------------------------------------------
r24754 | landonb | 2011-07-31 12:53:22 -0500 (Sun, 31 Jul 2011) | 1 line

V2 update scripts: add coverage_area index to constraints script (bug 2375)
------------------------------------------------------------------------
r24752 | landonb | 2011-07-31 12:27:09 -0500 (Sun, 31 Jul 2011) | 1 line

V2 update scripts: erroneous comma.
------------------------------------------------------------------------
r24746 | landonb | 2011-07-30 11:15:06 -0500 (Sat, 30 Jul 2011) | 1 line

V2 update scripts: fixes to ccp dev group creation (cp_add_item_policy).
------------------------------------------------------------------------
r24742 | landonb | 2011-07-30 00:34:38 -0500 (Sat, 30 Jul 2011) | 1 line

V2 update scripts: do not drop function that's needed later.
------------------------------------------------------------------------
r24727 | landonb | 2011-07-29 12:06:00 -0500 (Fri, 29 Jul 2011) | 1 line

Anonymizer: Scrub IPs from revision table.
------------------------------------------------------------------------
r24723 | landonb | 2011-07-29 09:38:59 -0500 (Fri, 29 Jul 2011) | 1 line

Fix bug in V1->V2 update scripts.
------------------------------------------------------------------------
r24717 | landonb | 2011-07-28 17:55:10 -0500 (Thu, 28 Jul 2011) | 1 line

Fix bug in V1->V2 update scripts.
------------------------------------------------------------------------
r24692 | landonb | 2011-07-27 12:33:12 -0500 (Wed, 27 Jul 2011) | 20 lines



==========

Bugfixes:

* Logged-in user fetching Rev Hist by Watched Items crashed pyserver.

* Infinite Import loop: geocode was import address, and vice versa.
  Not sure why this doesn't cause problems in V1. Maybe becuase in V2 
  those files are in a package?

* Infinite Import loop: address.py and search_map.py.

* Subtle bugfixes to search.

==========



------------------------------------------------------------------------
r24689 | landonb | 2011-07-27 11:46:02 -0500 (Wed, 27 Jul 2011) | 18 lines



==========

* Fixed an SQL problem that causes the V1->V2 scripts to fail:
  geofeature.one_way cannot be NOT NULL because colorado.byway_segment
  has NULL values (though we could set 'em all to 0, I suppose...).

* Fixed bug in V1/V2 where null geometry in post link_value crashes 
  flashclient (when user clicks button to view the attachment linked 
  to the post).

* Checked in some comments that were in my working branch.

==========



------------------------------------------------------------------------
r24688 | landonb | 2011-07-26 21:49:59 -0500 (Tue, 26 Jul 2011) | 1 line

Fix tooltip when user logged in (so it doesn't tell user to log in). Cleanup Watch Regions panel (added a border, and improved text layout).
------------------------------------------------------------------------
r24687 | landonb | 2011-07-26 20:47:16 -0500 (Tue, 26 Jul 2011) | 18 lines



==========

Bugfixes:

* Show revision number in Revision History list.

* Show username or host in Revision History list, not, e.g., _anon_user_minnesota.

* Don't computer rev. geosummaries for non-link_posts!

* Add TRIGGERS to item_read_post table, so read-events can be saved.

==========



------------------------------------------------------------------------
r24686 | landonb | 2011-07-26 18:51:48 -0500 (Tue, 26 Jul 2011) | 1 line

Get Revision_History list to populate. Still need to debug, but it's coming along. Also: Clicking on revision place in Discussions zooms map appropriately now.
------------------------------------------------------------------------
r24684 | landonb | 2011-07-26 17:53:33 -0500 (Tue, 26 Jul 2011) | 1 line

Added to link_post.py: query for geosummary for revisions attached to posts.
------------------------------------------------------------------------
r24683 | landonb | 2011-07-26 17:19:05 -0500 (Tue, 26 Jul 2011) | 25 lines



==========

I was going to work on Discussions today, but for post_revision 
link_values to work, the Revision_Get command needed work. So I 
worked on that GWIS command instead.

* Added revision-ish filters to Query_Filter.

* Implemented Group_Revision classes in pyserver and flashclient, 
  for fetching and processing group_revision records.

* Revamped pyserver/gwis/command_/revision_get.py to use new SQL 
  schema.

* The code is debugged, but it still doesn't work: the revision_get 
  command is returning 0 rows, but we're on the right path... 

Fixes to ccp.py script.

==========



------------------------------------------------------------------------
r24659 | landonb | 2011-07-25 20:02:13 -0500 (Mon, 25 Jul 2011) | 23 lines



==========

Fixme bugs with link_byways and link_points in flashclient Discussions.

- Pyserver fix: wasn't sending gf_name and gf_deleted.

- Variois flashclient bugs, and one Flex quirk.

- Haven't test link_regions.

- link_revision is broken: SQL links geofeature table, but needs 
  to link revision table instead (for geometry).

Fixed a null object error in flashclient, when updating the 
navbar early because the user navigated to a new panel while 
the client was loading.

==========



------------------------------------------------------------------------
r24653 | landonb | 2011-07-25 16:30:37 -0500 (Mon, 25 Jul 2011) | 1 line

Mostly implemented Discussions in flashclient: fixed SQL in pyserver and GUI elements in flashclient; still need to get post_link_values working again.
------------------------------------------------------------------------
r24601 | landonb | 2011-07-21 14:42:07 -0500 (Thu, 21 Jul 2011) | 1 line

Regression failure bugfix: GWIS_Error caused flashclient throbber to continue running (Update_Base object wasn't being marked created). Caused by, e.g., Login with Incorrect Password.
------------------------------------------------------------------------
r24580 | landonb | 2011-07-20 19:34:14 -0500 (Wed, 20 Jul 2011) | 42 lines



==========

* Implemented Out-Of-Band request handling in flashclient's
  Update Manager.

** Not completely implemented. GWIS_Handshake works.
   GWIS_Checkout_Discussions needs to be debugged. I haven't
   converted any other GWIS_* commands.

* Completely re-tooled the Update_Manager_* and GWIS_Update_* 
  classes in flashclient/views/update

** Got rid of the Update_Manager_* classes, which were just 
   silly wrappers around the GWIS_Update_* classes.

** Moved views/update to gwis/update, and 
   moved views/Update_Manager.as to gwis/.

** Any GWIS_* command can be fed to Update_Manager so it can 
   be managed intelligently.  That is, if user does something 
   that invalidates other commands, we can cancel the other
   commands, wait for them to complete, or whatever.

* All usages of consensus now use the consensus_f algorithm, 
  which accepts any container, not just an Array.

* Changed spelling: 'cancelled' to 'canceled', to be more 
  consistent. A search engine has 50M hits for 'canceled'
  and 200M for 'calcelled', but canceled is the proper 
  American English spelling. Cancelled is used in all other 
  English speaking countries, according to
   https://secure.wikimedia.org/wikipedia/en/wiki/Wikipedia:Manual_of_Style_%28spelling%29

* Removed Mikhil's Better Ccp By Spring (a/k/a compliance)
  code.

==========



------------------------------------------------------------------------
r24521 | landonb | 2011-07-19 09:54:07 -0500 (Tue, 19 Jul 2011) | 48 lines



==========

Generalized search filters from Discussions.

- Made a Query_Filters objects in both pyserver and
  flashclient. Use this to specify SQL WHERE-clause-ish
  things, like search strings, region constraints, etc., 
  and to specify LIMIT and OFFSET for pageination.

- Appy Query_Filters to Search, Discussions, and regular
  Checkout commands (in fact, Checkout is the new base 
  class for Search and Discussions commands).

- NOTE: Discussions would filter results by sendings 
  a new network request as the user selected different 
  filter options.
  -- But Search filters results solely in the client, 
     issuing only one network request and then filtering 
     what's displayed to the user.

- FIXME: Query_Filters is not completely implemented in 
         flashclient.

- Discussions: Changed names of filters to be consistent 
               and unique.

- Flashclient: Fixed Grid-height issue w/ Tab_Branch_Attrs.

- Flashclient: Fixed missing item type dropdown on Tab Geof 
               Adv.

- Pyserver: Fixed link_value checkout (wasn't honoring link 
            type IDs, so was fetching all links for eacy 
            query). Fix should make flashclient load a little 
            quicker.

- Pyserver: Implemented threads and posts. (Until flashclient 
            Discussions works, you can use Ccp.py script to 
            checkout threads and posts.)

- Pyserver: Updated winpdb to 1.4.8. (supports Pythin 2.7).

==========



------------------------------------------------------------------------
r24513 | landonb | 2011-07-18 16:15:21 -0500 (Mon, 18 Jul 2011) | 1 line

Renaming schema scripts from 102-* to 201-*.
------------------------------------------------------------------------
r24512 | landonb | 2011-07-18 16:14:43 -0500 (Mon, 18 Jul 2011) | 1 line

Merging from trunk: Recently added schema scripts
------------------------------------------------------------------------
r24511 | landonb | 2011-07-18 16:12:35 -0500 (Mon, 18 Jul 2011) | 1 line

Renaming schema scripts from 102-* to 201-*.
------------------------------------------------------------------------
r24509 | landonb | 2011-07-18 15:56:02 -0500 (Mon, 18 Jul 2011) | 25 lines



==========

SQL Schema changes:

* Added one_way column to geofeature: I think it's too
costly to fetch as an arbitrary attribute, since it's
needed by the client to draw the map. Also, geofeature
already has a few byway-specific attributes, like start_
and end_node_id.

* Added two aggregate functions, FIRST() and LAST(). (These
are common SQL fcns. that just happen not to be standard.)

* Dropping all Discussions SQL fcns. (1) These are broken 
because of user permissions; and (2) These were sometimes 
used poorly (as inline SELECTs that always returned the same 
value), which would cause Postgres to have to evaluate every 
row, such that it was unable to optimize the transaction.

==========



------------------------------------------------------------------------
r24507 | landonb | 2011-07-18 15:33:07 -0500 (Mon, 18 Jul 2011) | 1 line

Updated 'svn propset svn:ignore' to match CcpV1's: ignore common developer files that are not (and should not be) checked in, like CONFIX, macros.m4, database.map, etc.
------------------------------------------------------------------------
r23801 | landonb | 2011-06-16 11:55:54 -0500 (Thu, 16 Jun 2011) | 1 line

Fix to upgrade script.
------------------------------------------------------------------------
r23782 | landonb | 2011-06-15 22:47:41 -0500 (Wed, 15 Jun 2011) | 2 lines

Schema script fix.

------------------------------------------------------------------------
r23737 | landonb | 2011-06-14 17:16:17 -0500 (Tue, 14 Jun 2011) | 1 line

Fixes to update scripts (they failed last night). You cannot change the value of fcn. params. passed to plpgsql fcns, durrr.
------------------------------------------------------------------------
r23662 | landonb | 2011-06-13 16:43:56 -0500 (Mon, 13 Jun 2011) | 1 line

Updates to anonymizer scripts.
------------------------------------------------------------------------
r23661 | landonb | 2011-06-13 16:36:19 -0500 (Mon, 13 Jun 2011) | 1 line

Updates to anonymizer scripts.
------------------------------------------------------------------------
r23659 | landonb | 2011-06-13 16:27:05 -0500 (Mon, 13 Jun 2011) | 1 line

Updates to anonymizer scripts.
------------------------------------------------------------------------
r23653 | landonb | 2011-06-13 15:42:19 -0500 (Mon, 13 Jun 2011) | 1 line

Testing new scrub-db script.
------------------------------------------------------------------------
r23496 | landonb | 2011-06-08 13:34:39 -0500 (Wed, 08 Jun 2011) | 14 lines



==========

Anonymizer scripts: Can now be run against V1 database.

Bugfix: A few places in pyserver were still referring to 
        tag_preference_type's old column name, 'code', 
        rather than 'id'.

==========



------------------------------------------------------------------------
r23473 | landonb | 2011-06-08 09:48:12 -0500 (Wed, 08 Jun 2011) | 16 lines



==========

Selected Items navver:

- Bugfix:      Not always removing container when 
               activating new panel.

- Implemented: Disable hyper link when looking at 
               panel to which hyper link links.

==========



------------------------------------------------------------------------
r23455 | landonb | 2011-06-07 14:21:08 -0500 (Tue, 07 Jun 2011) | 117 lines



==========

Major changes to the panel infrastructure

- Renamed Side_Panel.as to Panel_Manager.as.

- Changed all the fcns. from static class members to 
  instance methods and made G.app.panel_mgr instance.
  (I'm trying to get away from static attributes and 
   methods, which aren't as flexible as instance 
   attributes and methods). It also helps debugging 
   and developing.

  - One benefit: Side_Panel.as was all static functions, 
    and all the fcns. had to refer to attributes 
    with the qualified class name, e.g., "Side_Panel.my_attr".
    By removing the static-ness, we can go back to normal 
    coding conventions and just reference the instance, 
    e.g., "this.my_attr".

- New items-panel navigation.

  - You can select items on the map and then view the 
    branch details without having your items be deseleted.

  - The active side panel is no longer directly tied to what's 
    selected. E.g., in V1, if active_attachment is set, the 
    attachment panel is always displayed (and the same goes 
    for the active thread, active route, etc.). Now, what's 
    selected in the map and the panel that's showing are 
    independent.

    - This lets the user, for example, select some items on 
      the map, then go to the branch panel, create a new 
      attribute, and then apply it to the selected map items.

- Bugfix: if some GWIS data is received before the tags are 
  received, the map never completes loading.

  - The problem was, when I wanted to call update_nudge, 
    I was accidentally looking for a GWIS_Update_Viewport_Items 
    instance when I really wanted to look for a 
    Update_Manager_Viewport_Items instance.

- Added the idea of a 'dirty' panel, so we can specify 
  when data is dirty, and when the user's access levels 
  have changed. This helps us avoid calling on_show 
  for each panel (even those that are hidden) in 
  response to the user messing around on the map.
  It also means we update controls when data is dirty, 
  but we enable/disable controls when the user's 
  access changes.

- Got rid of 'details_current', which was an unnecessary 
  abstraction. In V1, it's a Dictionary of panels, and 
  it's keyed by a String. But we already have collections 
  of panels, so this was an extra layer that just made 
  things more complex without actually solving anything.
  So now, the code just grabs the side_panel container 
  to figure out which panel is active, and we don't 
  need an extra lookup.

Renamed G.fcookies to G.fcookies_user to complement 
the already-named G.fcookies_anon.

GUI label name changes per Cycloplan useability testing.
E.g., "Routes" renamed "Find a Bike Route". None of these 
are finalized; we need to discuss as a team first, as I'd 
like team consensus on each of the name changes.

Moved G.map.active_attachment to G.item_mgr.active_attachment, 
along with active_thread and active_post. Also moved 
Branch.active_branch to G.item_mgr.

Cleaned up places in the panel and command classes where a Set() 
was converted to an Array via as_Array() and then later converted
back to a set via new Set(my_array). The classes should instead 
use a reference to the original Set whenever possible, and they 
should only create a copy when needed (i.e., when the user 
executes a command, set.clone() is called).

- Also changed places in Discussions code where Set() was converted 
  to Array() just for purposes of iteration -- because Set() is 
  already iterable, there's no need to convert to an Array.

The panel class now uses get_selected_items() to gets its 
selectionset, rather than just always using G.map.selected.
This lets a branch, for instance, use the tags widget.

- This also means we can clean up cases where the selected 
  set is only ever 0 or 1 items in length. In the code, 
  you'd find items_selected[0] a lot; it wasn't always 
  clear to me why we only got the first element, but it's 
  because the collection was only ever at most 1 in length.
  Also, since we don't convert Set()s to Array()s (see 
  earlier comment), indexing [0] won't work. To solve the 
  latter issue, and to make things more clear -- that is, 
  that sometimes items_selected is only ever a collection of 
  at most 1 item -- I added one() to Set(), which ensures the 
  Set has only 0 or 1 items, and returns the 1 item if it exists.
  
- I also added Set().every() to replace calls to Array().every().

Added code to resize the Attribute details panel contents -- it's
a Grid, and Grids don't know how to size themselves (they always 
display everything, even if it clips beneath other containers).

Added prelim. code to 'lock' new attribute definition once it's
used (e.g., users should not be able to change an Integer-type 
attribute to String-type).

==========



------------------------------------------------------------------------
r23320 | landonb | 2011-06-01 10:27:26 -0500 (Wed, 01 Jun 2011) | 40 lines



==========

Navigation improvements:

- Branch and Selected Items also show, above panel title.

- Right now this is just stubbed, but intent is:

  - Click on Branch or Selected Items to go to Item Details 
    panel for the branch or selected items.

  - You can edit the Branch (e.g., add attributes) without 
    needing to de-select selected map items.

- Moved and renamed some files in flashclient/views/widgets
  to flashclient/views/panels (these files represent panels, 
  not widgets, so they were in the wrong package).

- Renamed the modules in flashclient/views/panels, prefixing 
  panel modules with Panel_*.

  - Also, (most) panels now derive from Detail_Panel_Base 
    (two of the panels are not updated yet).

- Removed old code for empty panel, since there is no more 
  empty panel.

- Lots of cleanup to Side_Panel.as, some to main.mxml.

- Stacked branching: fixed pyserver's tag_counts SQL.

- Changed public map names from "Public Map" to "Mpls-St. Paul"
  and "Denver-Boulder".

==========



------------------------------------------------------------------------
r23300 | landonb | 2011-05-31 11:17:55 -0500 (Tue, 31 May 2011) | 36 lines



==========

Some changes from last Thursday and Friday in St. Paul, 
between usability testing with human subjects.

- Partial Bugfix: Cannot switch branches from client.

- Bugfix: Flex NumericStepper has issues with large numbers.
          Introduced a min and a max value, which I trial-and-
          errored to figure out.

- Bugfix: In flashclient, the steppers for new attributes 
          are exceedingly wide, causing the side panel 
          to show a horizontal scroll bar.

- Bugfix: Errant 'S' after search icon in TabBar.

- Bugfix: branch_hier_build set same stack id for each branch 
          in hier.

- Lots and lots of cleanup to the SQL schema.

  - Prefixing Cyclopath fcns with "cp_", just like PostGIS 
    prefixes its fcns. Makes it easier to tell whose fcn. is 
    whose when you execute '\df' in psql.

  - Delete unused fcns. Re-implement others to use V2 schema.

  - Update developer permissions script.

==========



------------------------------------------------------------------------
r23251 | landonb | 2011-05-26 08:44:36 -0500 (Thu, 26 May 2011) | 1 line

bugfixes
------------------------------------------------------------------------
r23250 | landonb | 2011-05-26 02:28:14 -0500 (Thu, 26 May 2011) | 42 lines



==========

Bugfixes for unit testing tomorrow, er, later this morning.

- Access_Scope.as IDs were flip-flopped, that is, public was 1 instead
  of 3 and private was 3 instead of 1. Shared was always 2.

- Moved alert-unsaved to own fcn. so it can be called when user wants 
  to change branches.

- Branch list in flashclient disable buttons until branches are selected 
  in the list. The active branch's label is italicized and appeded with 
  " (Active)".

- Fixed attribute value_type dropdown, which has wrong id for 'integer'.

- Exchanged assert for a logfile warning in the double-click detector, 
  which sometimes fire on_mouse_down even though it appears the double-
  click handler wasn't started. Maybe this has to do with clicking in 
  the panel and then quickly clicking in the map??

- Fixed bug with attribute list not being hidden for item types that 
  have no attributes defined.

- Fixed bug clicking 'edit' attribute, then navigating back to branch 
  panel, and then clicking 'edit' attribute again. The attribute panel 
  was not being rendered correctly the second time, because it didn't 
  think an attachment was selected.

- Only show branch conflicts tab if there are branch conflicts.

- Made new class for common pagination code. This class is still alpha....

- Fixed error with on_initialize() not always being called for Tab_Panel_*
  instances.

==========



------------------------------------------------------------------------
r23242 | landonb | 2011-05-25 12:52:14 -0500 (Wed, 25 May 2011) | 23 lines



==========

New Access Level: stealth (less than client but more than denied).

- Items with stealth access are not discoverable (like a route 
  whose link you shared with your friends). This is different from 
  items with client access, which are discoverable, but not really 
  viewable (like attribute definitions: flashclient knows about 
  them, but the user doesn't really).

==========

Bugfixes: Show branch list.

- SQL had "AND branch_id = %d" which doesn't make sense when you're 
  trying to compile a list of branches.

==========



------------------------------------------------------------------------
r23241 | landonb | 2011-05-25 12:39:39 -0500 (Wed, 25 May 2011) | 1 line

Adding some docs/ I've had in my working copy for a while.
------------------------------------------------------------------------
r23240 | landonb | 2011-05-25 12:39:32 -0500 (Wed, 25 May 2011) | 1 line

Adding some docs/ I've had in my working copy for a while.
------------------------------------------------------------------------
r23230 | landonb | 2011-05-24 17:25:51 -0500 (Tue, 24 May 2011) | 20 lines



==========

Bugfix: Check user's group_membership access_level_id when fetching items!

Show branches in maps list:

- made base class from GWIS_Region_Names_Get.as (GWIS_Item_Names_Get.as) 
  and made new GWIS_Branch_Names_Get.as.

- in pyserver, renamed region_names_get.py to item_names_get.py and made 
  generic, so you can get names and stack_ids of any item type.

- get branch list in same context as user, i.e., GWIS_Update_User.

==========



------------------------------------------------------------------------
r23210 | landonb | 2011-05-24 13:54:01 -0500 (Tue, 24 May 2011) | 41 lines



==========

Additional debug statments and asserts to help debug 
item saving and branches and group permissions.

- Added logging facility to pyserver like that which is 
  in flashclient.

- Added item.__str_abbrev__ to print fewer details about
  items.

- Some additional checks in branch.py when saving items.

Cannot simply, 
    if xml_doc: 
  you need to 
    if xml_doc is not None:
  Interesting.

Added concept of local-request to pyserver, so that ccp.py 
can exercise new commands not supported by flashclient, and 
we don't have to worry about someone 'hacking' cyclopath by 
sending these new commands.

Various bugfixes.

- Incl., branch must set branch_id to stack_id. Though not 
  used, the item_versioned class infrastructure expects it.

- Checkout cmd: Only confirm_leafiness if viewport not None.

- Mucked with the [logging] and [debugging] sections in CONFIG.

- Updates to ccp.py for creating branches.

==========



------------------------------------------------------------------------
r23201 | landonb | 2011-05-24 12:34:50 -0500 (Tue, 24 May 2011) | 1 line

V2 upgrade scripts: Set branch_id of public branch item.
------------------------------------------------------------------------
r23168 | landonb | 2011-05-23 00:26:04 -0500 (Mon, 23 May 2011) | 1 line

Add branch_id column to branch table since branch technically derives from geofeature and item_versioned.
------------------------------------------------------------------------
r23167 | landonb | 2011-05-23 00:14:48 -0500 (Mon, 23 May 2011) | 1 line

Some more ccp.py updates. Update new_item_policy to allow developers to create branches.
------------------------------------------------------------------------
r23164 | landonb | 2011-05-22 20:21:45 -0500 (Sun, 22 May 2011) | 1 line

Ccp dev script: open connection to server and get user token; some changes to OptionParser options.
------------------------------------------------------------------------
r23160 | landonb | 2011-05-22 13:42:15 -0500 (Sun, 22 May 2011) | 16 lines



==========

Renamed mapserver/tilecache.cfg to tilecache.cfg.template
-- Because it has hard-coded paths in it.

==========

Fixed another bug in the SQL V1->V2 scripts (they failed 
last night at 2:02 AM, d'oh!). Silly syntax errors......

==========



------------------------------------------------------------------------
r23157 | landonb | 2011-05-21 19:29:46 -0500 (Sat, 21 May 2011) | 19 lines



==========

New ccp.py script

Cyclopath Developer Script

For creating branches, groups, and group_memberships.

At least for now. Intent is for script to be easy way 
to interface with pyserver. So instead of implement 
flashclient or SQL scripts to do databasey things, 
developers can just use this new script.

==========



------------------------------------------------------------------------
r23156 | landonb | 2011-05-21 19:27:18 -0500 (Sat, 21 May 2011) | 35 lines



==========

Branch 'Extra' tab

  - Next to each attribute in the list, hid '+' and '-', and removed 'x'. We 
    will not implement the attribute gui sort order now (the + and - buttons)
    and we will not allow deleting attributes from the manage attributes widget
    (the user should click 'edit' and then find the 'delete attribute' button).

  - Fixed: Item Type dropdown was hidden but still taking up space in GUI. 
           I moved includeInLayout to parent/enclosing container.

==========

- Fixed bug in pyserver/item/util/item_factory.py

  - Raise error on module not found, don't just return None.

==========

- Fixed bugs in mapserver / tilecache_update:

  - Wrong table referenced for column in *.map files.

  - V1->V2 upgrade scripts accidentally deleted 'tiles_cache_byway' 
    PostGIS's geometry_columns (the scripts deleted any table in 
    geometry_columns that it didn't find in the current schema, and 
    I forgot to update geometry_columns when I renamed tiles_cache_byway
    from byway_name_cache).

==========


------------------------------------------------------------------------
r23155 | landonb | 2011-05-21 13:28:30 -0500 (Sat, 21 May 2011) | 75 lines



==========

- Fixed bug: Race condition btw. Group Membership and New 
             Item Policy GWIS commands somtimes caused 
             assertion on startup.

  - Made a new update class to get branchy stuff (regions names, 
    tag names, and user group memberships) after getting branch 
    ID but before getting attachments, geofeatures, and link_values.
    See views/update/GWIS_Update_User and Update_Manager_User.

  - Fixed GWIS_Region_Names_Get, which wasn't sending branch ID.

==========

- Fixed bug: User always prompted to save on browser close 
             even if nothing dirty.

  - Reworked: G.map.is_dirty_public/private.

    - These fcns. are used to prompt the user when saving or when 
      they navigate away from a dirty map. When saving, the old 
      rule of "is-public" no longer applies, since the client can 
      never know the true visibility of an item (since the user 
      only sees groups of which s/he is a member, the user may  
      not know if other groups also have access to the item).

    - Item now maintains a set of dirty group_item_access objects, 
      rather than storing them in the map's dirtyset.

- If dirtyset only includes ratings, watchers, and read 
  events, the user is not prompted for a changenote. If the 
  dirtyset include items or group access changes, the 
  user is prompted for a changenote.

- Flashclient only saves to the server group item accesses that 
  have changed. Before, it sent them all.

==========

- On Item Details 'Extra' tab

  - Hide Geofeature Layer type dropdown for geofeatures 
    whose only layer is 'default'

    - Added 'restrict_usage' column to geofeature_layer 
      table.

    - Updated SQL scripts and pyserver.

  - Hide Edit Attributes box for geofeature types that do not 
    have any attributes that apply to them.

==========

- New classes, Access_Scope and Dirty_Reason.

  - Dirty_Reason replaces a bunch of loose strings that 
    were passed around the code. By using a class, we can 
    document all of the possible 'reasons' (rather than 
    searching the code and getting a vague idea), and we 
    can more easily search the code for usages of reasons.

  - Added two new reasons for group item access.

==========

- Fixed tilecache_update, which was referencing wrong column name.

==========



------------------------------------------------------------------------
r23154 | landonb | 2011-05-21 13:09:08 -0500 (Sat, 21 May 2011) | 1 line

Updated database model
------------------------------------------------------------------------
r23148 | landonb | 2011-05-20 16:31:19 -0500 (Fri, 20 May 2011) | 1 line

Huffy v1->v2 cronjob failed last night. I had retooled cp_group_private_id to check group_membership, but this doesn't work when you're actually trying to populate the group_membership table.
------------------------------------------------------------------------
r23139 | landonb | 2011-05-20 13:06:03 -0500 (Fri, 20 May 2011) | 21 lines



Logging facility updates to pyserver:

1. Every python file nows gets its own logger, i.e.,

     log = g.log.getLogger('cmd.commit')

   The name of the logger is now printed in the logfile 
   preceeding the log message.

2. Cleaned up the formatting of some log messages to 
   be easier to read.

3. Added more messages to functions used during the commit 
   opertion, to help me debug.

==========



------------------------------------------------------------------------
r23137 | landonb | 2011-05-20 12:51:52 -0500 (Fri, 20 May 2011) | 1 line

Cleaned up import commands.
------------------------------------------------------------------------
r23125 | landonb | 2011-05-19 17:39:42 -0500 (Thu, 19 May 2011) | 50 lines



I was able to save a waypoint!

I haven't tested other item types.

And the waypoint was saved with two group_item_access rows, 
one for landonb and one for the public group, and both had 
access_level_ids of 1 (owner), so obviously things aren't 
perfect, but at least the python code and SQL are working!

Other significant changes include:

* I fiddled somewhat with route.py, but it still needs to be 
  worked on from top to bottom.

* Lots of changes to routed and tgraph. I worked on these files 
  from top to bottom, upgrading function calls and SQL to V2. 
  They need to be debugged and tested still.

* I fiddled somewhat with route.py, but it still needs to be 
  worked on from top to bottom. It's a long file, though...

* Grac_Error, rather than being a simple enum class, not holds 
  information about the error, so that the commit command can 
  compile a list of errors and return them to the client.

* New link_attribute class represents link_values for a given 
  attribute, like one_way or item_watcher. This is used by the 
  item class to maintain a list of item watchers, and it's 
  used by tgraph to find all the one_ways in a branch at a 
  particular revision.

* Reorganized the derived functions in the item class source 
  files to be consistently placed, that is, located in the same 
  relative places in the files.

* Extensive work on commit.py, grac_manager.py, and the item 
  classes' save routines. Also worked on the mark_deleted 
  routine and added a 'validizer' routine to prep items 
  for saving.

* After an item saves itself, it saves things associated 
  with it that might also be dirty, like group access 
  records for the item.

==========



------------------------------------------------------------------------
r23124 | landonb | 2011-05-19 17:14:56 -0500 (Thu, 19 May 2011) | 37 lines



Fixes to routed and route analytics.

* I worked on routed and tgraph from top to bottom, so they 
  should both be coded, but neither one has not been tested 
  or debugged.

* I changed a few things in route analytics, to make it more 
  versatile.

** Rather than wait 300 seconds after starting routed -- and 
   then just assuming that it started! -- I added code to test 
   when routed is ready. The route analytics script now sits in 
   a while True loop, sleeping for one second between iterations, 
   and tries to open a connection and send routed the new 'hello' 
   command.

** After the 'hello' command, route analytics sends the branch ID 
   and revision ID that it wants loaded. routed loads the graph 
   (which could take a while), and sends an OK packet when finished.
   When it gets the OK, route analytics starts running the route- 
   finding operations.

* Both routed and route analytics read like really long scripts:
  hundreds of lines of code that is in the script body (i.e., 
  not in a function), so I starting making functions and classes 
  as appropriate.

* routed now recognizes delay_load argument, which tells it not 
  to load the network graph until it's told what the revision 
  and branch are.

==========



------------------------------------------------------------------------
r23123 | landonb | 2011-05-19 17:06:59 -0500 (Thu, 19 May 2011) | 17 lines


SQL V2 upgrade scripts:

* Got rid of group_item_access.link_name.

* Added enum_definition table, since everytime we 
add an enum, we end up adding a table. This new 
table can consume all the other tables (like 
access_scope, access_level, etc.).

* Added attributes for tables that can be turned 
into attributes, like item watchers, byway 
rating, aadt, tag preference, etc.

Some minor changes and new comments to flashclient.


------------------------------------------------------------------------
r23122 | landonb | 2011-05-19 16:58:35 -0500 (Thu, 19 May 2011) | 1 line

Updates to the database model.
------------------------------------------------------------------------
r22982 | landonb | 2011-05-11 10:57:46 -0500 (Wed, 11 May 2011) | 27 lines



* Lots of new code and fixes in gwis/command_/commit.py

** I can save a waypoint and get an error back from pyserver, 
   without crashing the code. Granted, the save fails, but 
   there's still a lot of logic to debug.

* Lots of fixes and additions to grax/grac_manager.

* item/util/revision.py's revision_save now saves group_revision rows.

* Added more commit errors to Grac_Error.

* query_branch.py wasn't setting self.branch_hier initially.

* Added dirty, fresh, and valid attributes to item_base.

* On commit, item_user_access loads the item's groups_accesses.

* Now tracking client_id in item_versioned so we can give the client 
  a list of errors and working copy IDs.

==========



------------------------------------------------------------------------
r22947 | landonb | 2011-05-10 19:46:03 -0500 (Tue, 10 May 2011) | 1 line

Egads. Been missing this file! Gotta run svn status more often!
------------------------------------------------------------------------
r22901 | landonb | 2011-05-09 16:19:50 -0500 (Mon, 09 May 2011) | 1 line

Missing from last checkin: do not clone NoneType
------------------------------------------------------------------------
r22900 | landonb | 2011-05-09 16:15:19 -0500 (Mon, 09 May 2011) | 18 lines


Stacked-branching fixes in pyserver

- New class Item_Query_Builder bundles a bunch 
  of common parameters that get passed around:
    (db, username, branch_hier, revision)

- New feature Confirm/Correct Leafiness checks 
  results when fetching items in the viewport.
  This is a big "gotcha", since items in a 
  child branch may have been moved outside 
  the bbox in question, therefore the SQL 
  SELECT won't find the leafier items.

==========



------------------------------------------------------------------------
r22880 | landonb | 2011-05-07 18:51:25 -0500 (Sat, 07 May 2011) | 38 lines


Two Biggies in this checkin:

(1) Debugged item saving's decode_request, which uses much of the new GrAC code
    ported from flashclient, as well as some new code. The new item policies
    are applied to new items being saved, the user's access is checked on items
    being saved, and the user's group access settings are consumed.  I still
    need to debug the SQL that saves items to the database, and I have to
    finish implementing saving group_permissions and returning conflicts and
    permissions errors to the user.

(2) Implemented stacked branching in the SQL statements. For branches, SQL 
    checkout now retrieves items from each branch, and weeds out duplicates, 
    keeping items from the leafiest branch in which they appear. Committing 
    items is much easier, since items are only saved to the branch the user 
    is working on (but permissions are still considered based on the branch 
    hierarchy, so it's still a little tricky). Changing to stacked branching 
    affects lots of SQL, including the command classes, the item classes, 
    mapserver, and routed.

==========

* Fixed from_gml() in a lot of the item classes (it was missing!).

* Lots of changes to these pyserver files: 
    grax/grac_manager.py
    grax/
    item/item_user_access.py

* New grac_error collection maintains list of permissions and conflict 
  failures on commit, so server can return a complete list of problems 
  to the client (as opposed to throwing GWIS_Error on the first error, 
  which would make the user's task tedious to correct all errors).

==========



------------------------------------------------------------------------
r22855 | landonb | 2011-04-30 15:49:38 -0500 (Sat, 30 Apr 2011) | 26 lines


Updates to pyserver and flashclient to run against the latest database 
schema (I checked in updated database upgrade scripts yesterday).

==========

Moved and renamed some files to be more consistent and understandable.

* Renamed Group_Access to Group_Item_Access and Group_Item_Access to 
  Item_User_Access. The names of these classes were misleading: 
  the (former) Group_Item_Access class is an intermediate class in 
  the item hierarchy, not something in the group access hierarchy.

* Moved some files into flashclient/items/utils and pyserver/item/util

==========

Lots of bugfixes to item commit in pyserver.

* Renamed item_attachment, item_geofeature, item_link_value to just 
  attachment, geofeature and link_value, to fix a problem in item_factory.

* Lots of syntax fixes to the group access code that I ported over from
  flashclient, but which hasn't been completely tested and debugged.


------------------------------------------------------------------------
r22854 | landonb | 2011-04-30 15:26:43 -0500 (Sat, 30 Apr 2011) | 1 line

Guess it might help if I 'svn add'ed these. Oops- forgot to do this yesterday; goes with Friday's checkin.
------------------------------------------------------------------------
r22842 | landonb | 2011-04-29 13:53:19 -0500 (Fri, 29 Apr 2011) | 82 lines


Updates to pyserver and flashclient to run against the latest database 
schema (I checked in updated database upgrade scripts yesterday).

==========

* Reorganized the item type subpackage:

** In pyserver, made item/attc, item/feat, and item/grac 
   packages and removed item/type package.

** In flashclient, made items/attcs, items/feats, and items/gracs 
   packages and removed items/types package.

** New package, pyserver/grax, similar to flashclient/grax

* Renamed pyserver_glue.commit() to transaction_commit() to
  match transaction_begin().

* Duplicated (and re-coded in Python) a bunch of files from flashclient 
  to pyserver, including:
    grax/access_level 
    grax/grac_manager
    grax/item_manager 
    grax/new_item_policy
    grax/new_item_profile
    item/grac/group
    item/grac/group_acess
    item/grac/group_membership
    item/grac/group_revision
    item/grac/new_item_policy

==========

* Added new Access Level: 'arbiter'

** E.g., owner, arbiter, editor, viewer, client, denied.

** Arbiters can edit the permissions of editors and below, 
   but cannot edit the permissions of owners or other arbiters.

==========

* Added new Access_Scope table

** Replaces is_public, is_private and is_shared.

** Got rid of link_value's value_item_id: you can just use value_integer.

** Added link_value.value_date

==========

* Added two buttons to Access tab: Make Private Copy, and Make Public.

* When user logs in, now hiding the "Sign Up" link, otherwise the user's 
  name (e.g., "Welcome, Landon!") appears truncated (with ellipses), 
  because it doesn't have enough room (e.g., "Welcome, ...")

* To accomdate what were post_revision items, link_value can now link 
  attachments to attachments, i.e., posts to attributes.

  ** Changed attc_stack_id and feat_stack_id to lhs_stack_id and rhs_stack_id.
     By convention, the left-hand-side is always the attachment. The right-
     hand-side is either a geofeature or another attachment.

==========

* Pyserver fetches should run noticeably faster.

  ** Audited all the tables and added INDEXes as appropriate.

  ** Audited all the SQL and pulled cp_*() fcns. from WHERE clauses,
     otherwise SQL runs the fcn. for every row it fetches.
     
  *** E.g., replace "WHERE valid_until_rid = cp_rid_inf()" with 
                    "WHERE valid_until_rid = %d" % (..., )

==========



------------------------------------------------------------------------
r22841 | landonb | 2011-04-29 12:51:16 -0500 (Fri, 29 Apr 2011) | 1 line

Added proj. plan/test doc./feature list. and reorganized doc/ folder.
------------------------------------------------------------------------
r22838 | landonb | 2011-04-28 18:47:13 -0500 (Thu, 28 Apr 2011) | 1 line

Added DROP INDEX IF EXISTS to get around already-exists errors.
------------------------------------------------------------------------
r22837 | landonb | 2011-04-28 18:19:39 -0500 (Thu, 28 Apr 2011) | 1 line

Last checkin missed two vacuums.
------------------------------------------------------------------------
r22833 | landonb | 2011-04-28 17:30:13 -0500 (Thu, 28 Apr 2011) | 1 line

Cannot vacuum inside transaction block
------------------------------------------------------------------------
r22832 | landonb | 2011-04-28 17:03:56 -0500 (Thu, 28 Apr 2011) | 98 lines


A handful of changes to the database upgrade scripts and the V2 schema.

* Highlights

** Added post_revision to upgrade, so now all V1 tables are upgraded.

** Fixed database performance issues affecting both pyserver/flashclient 
   and the upgrade scripts.

NOTE: This is an incomplete checkin. I need to update pyserver, but I want 
      to check this in so I can check it out and start running the upgrade 
      scripts on it, to double-check that what I'm checking in work (and 
      the script take 10 hours to run, I think, so the upgrade will be 
      ready tomorrow morning.

==========

* Fixed schema/102-apb-* upgrade script performance problems.

** Scripts now manage constraints and indexes more deliberately,
   creating or dropping them as appropriate to improver performance.

*** The route_step table takes 8 hours to upgrade. All other scripts 
    should run in less than 2 hours. The last time I ran the upgrade 
    process, it took 24 hours: i.e., I eliminated 14 hours of bottleneck, 
    but I was unable to reduce the route_step table upgrade time.

** Removed cp_*() calls from SQL statement and made pl/PgSQL variables 
   to cache the value, so SQL doesn't call functions that return static 
   values.

==========

* Finally figured out how to handle V1's post_revision table.

** Made a new interval attribute, /post/revision, so post_revision 
   rows are now link_value rows that link a post to an attribute.

* Per post_revision, links are no longer strictly linking an 
  attachment and a geofeature, so I renamed attc_stack_id and 
  feat_stack_id to lhs_stack_id and rhs_stack_id. As in, left-
  hand side and right-hand side, as in equations.

** https://secure.wikimedia.org/wikipedia/en/wiki/Sides_of_an_equation

==========

* Fixed mapserver performance problems.

** Fixed tilecache_update.py (converted to V2 SQL).

** Renamed byway_name_cache to tiles_cache_byway.

*** Added GIST index to geometry column to improve bbox fetches.

** Renamed and recreated old views; coded to only fetch public items.

*** tiles_draw_byway (table; was byway_name_cache)

*** tiles_draw_byway (view; was byway_joined_current)

*** tiles_draw_terrain (view; was bmpolygon_joined_current)

==========

* Added new Access Level: 'arbiter'

** E.g., owner, arbiter, editor, viewer, client, denied.

** Arbiters can edit the permissions of editors and below, 
   but cannot edit the permissions of owners or other arbiters.

==========

* Added new Item Type: 'route_step'

** (It was partially implemented before, but not in all three 
    projects, i.e., SQL, pyserver and flashclient.)

==========

* Added new Access_Scope table

** Replaces is_public, is_private and is_shared.

** Got rid of link_value's value_item_id: you can just use value_integer.

** Added link_value.value_date

==========

* Removed scripts/worhints

==========



------------------------------------------------------------------------
r22771 | landonb | 2011-04-20 14:47:24 -0500 (Wed, 20 Apr 2011) | 1 line

Merge from V1: Mikhil's bettercp survey update
------------------------------------------------------------------------
r22707 | mludwig | 2011-04-18 14:40:27 -0500 (Mon, 18 Apr 2011) | 1 line

Tweak CONFIG template so that config.py has the correct parameters. I don't know if these are the right values, but it gets pyserver running again.
------------------------------------------------------------------------
r22646 | landonb | 2011-04-12 12:41:19 -0500 (Tue, 12 Apr 2011) | 1 line

Merge from Fernando: Bug 2057 / Generate tiles for closer zoom levels.
------------------------------------------------------------------------
r22642 | landonb | 2011-04-12 12:12:21 -0500 (Tue, 12 Apr 2011) | 7 lines


Merge from Mikhil:

Bug 2094: Better Cyclopath by Spring, April Edition



------------------------------------------------------------------------
r22640 | landonb | 2011-04-12 11:57:18 -0500 (Tue, 12 Apr 2011) | 10 lines


Fix: Strange error trying to override function and make [Bindable] (where 
     super()'s implementation is not [Bindable]:

/ccp/dev/cp_1051/flashclient/build/items/types/Group_Access.as(1): col: 1 Error: Method marked override must override another method.

/* Copyright (c) 2006-2011 Regents of the University of Minnesota.
^


------------------------------------------------------------------------
r22639 | landonb | 2011-04-12 11:52:44 -0500 (Tue, 12 Apr 2011) | 1 line

Oops, Grac_Record.as did not get checked in.
------------------------------------------------------------------------
r22638 | landonb | 2011-04-12 11:45:52 -0500 (Tue, 12 Apr 2011) | 88 lines


Item Saving (Mostly complete in the client, 
                 not so much in the server)

* Client changes:

** Fixed crash on map load when you try to use tools before the 
   map is done loading.

*** Mouse listeners are not added until map is ready (otherwise, 
    responding to mouse events can crash the client).

** Changed login popup to use Help_Links that use external link 
   icon.

** More implementation of the Group Access tab.

*** Added ComboBox dataProvider array to Access_Level.

*** Added list of Group objects to Grac_Manager.

**** When Group_Membership for user is received, it populates 
     Grac_Manager.groups.

*** New intermediate class, Item_Access_Scope, replaces/improves 
    is_public, is_private, and is_shared properties.

*** Fixed reading of public and private group IDs of logged-in user
    (they were getting set to 0).

*** Moved Group_Access and made to derive from Grac_Record (an 
    Item_Versioned intermediate class).

** Fixed bug when selecting item in map and quickly clicking away:
   Detail_Panel's on_show would get called, but the selected set 
   would be empty (or set to the Branch), so the panel would crash 
   trying to set itself up.

*** Added should_show() fcn. to check that the selected items set 
    matches the item type that the panel shows.

** Lots of changes to Widget_Access*.mxml panels.

*** Figured out the bug w/ Grid and DataGrid: they need to be wrapped 
    by Canvas, otherwise they're taller than their containing component, 
    and so the component bleeds underneath and over other components.
    This hides other components, and the Grid itselfs bleeds underneath 
    some other components, so even using the scroll bar is useless, 
    since the control doesn't think it needs a scroll bar, so it doesn't 
    enable it (which would not help much, anyway, since the down arrow 
    is hidden beneath other components, anyway).

* Server changes:

** Removing plpgsql fcns. from SQL queries: run the plpgsql 
   command first and use string substitition to make the 
   final query. If you use inline plpgsql functions, you 
   can dramatically slow down the SQL queries.

** Added indices to a few more tables' columns.

*** FIXME: We need to audit all of the tables to make sure they 
           are all properly indexed.

** Fiddled with ids_translate, making it fit better into the class 
   hierarchy. That is, rather than having one fcn. that checks the 
   item type of the item whose ID is being fixed, there's now a base 
   class fcn. which calls other class fcns. which derived classes 
   override to implement specific behavior.

*** Using uniform naming convention: stack_id_map is a misnomer; 
    it's really a client_id_map, since the IDs are not stack IDs, 
    they are negative IDs from the client's working copy.

** Instead of sending is_public/is_private/is_shared, now sending 
   "access scope", an int that's 1/2/3, i.e., private/shared/public.

** Replaced revision_check_access_current & revision_check_access_historic
   with access_level_enforce, which does a better job checking the user's 
   rights to do particular operations.

** Renamed item_get/item_put to checkout/commit, since Cyclopath shares 
   lots of similarities with popular source revision control software.
   Also, item_get and item_put do not just deal solely with items, they 
   also marshal ratings, watchers, and group access control information.



------------------------------------------------------------------------
r22593 | landonb | 2011-04-06 15:41:55 -0500 (Wed, 06 Apr 2011) | 27 lines


Merged Mikhi's work on Route Analytics.

* Code is still a little buggy.

* FIXME: Checking in pyserver/rpy2 and 
         scripts/routing_analysis/pychart, but

  (a) I'm not sure Route Analytics uses this code;

  (b) It's third party code, so it probably should 
      not get checked in?

Changes to route daemon code.

* ratings.py, tgraph.py, and route.py

* Hopefully my changes don't conflict with Michael's 
  efforts; the Route Analytics code affects the 
  route finder code.

* Route daemon tracks revision now, rather than using 
  a timestamp to determine when it needs to update 
  the transportation network graph from the server.



------------------------------------------------------------------------
r22592 | landonb | 2011-04-06 15:04:21 -0500 (Wed, 06 Apr 2011) | 12 lines


Merge from V1 trunk.

* V2 is now a complete superset of V1.

** (That's not to say all the code works.)

** Includes Fernando's new(ish) search feature.

** Includes a handful of miscellaneous bugfixes.


------------------------------------------------------------------------
r22587 | landonb | 2011-04-06 14:46:58 -0500 (Wed, 06 Apr 2011) | 4 lines


Mikhil's Ctrial code from V1 trunk.


------------------------------------------------------------------------
r22518 | mludwig | 2011-04-04 16:04:46 -0500 (Mon, 04 Apr 2011) | 1 line

Commit progress on upgrading routes to v2, routed now builds correctly. route.py has partial updates, Many fetches may work, mostly saving needs work
------------------------------------------------------------------------
r22400 | landonb | 2011-04-01 17:56:19 -0500 (Fri, 01 Apr 2011) | 160 lines


Lots of UX changes.

Some of these changes are requests from James Andrew and 
Greta Alquist voiced during a quasi-useability test last 
Friday, March 25. (The GUI was done, but not everything 
was wired, so I got feedback on the GUI.)

And ome of these changes are because I got side tracked fixing 
some UX bugs I found while implementing the new GUI. Some of 
the UX bugs existed in V1, and some of them I introduced in V2.

* Moved "Atlas" panel from Branch details and made into its 
  own special panel, as requested by Greta and James. For now, 
  it's the "MAPS" button next to the "?" help button. I'm not 
  sure if this is the best place for it, or if the name is right 
  or if it should be an icon, but I do like its new prominence 
  in the GUI. Before, it was buried and hard to find, which 
  diminished its importance.

* Added "external link icons" to all the help links that link to 
  the text wiki. Using external link icons is a convention used 
  by Web developers. This also lets us use normal links to link 
  to panels and things within the flashclient application. We 
  also will avoid irritating users who expect to know if a link 
  takes them to a new Web site or to a new tab within their browser.

* Changed the text below the Cyclopath banner. For anonymous users, 
  in V1 it says, "Not logged in". But I do not like negative messages, 
  so I renamed it, "Welcome!" There is a "Sign Up" link next to it, 
  and a "Log In" button above it to the right, so I do not think 
  we need to tell the user they are not logged in.

  ** Also added a toolTips to the label.

* Changed the Bikeability button to say "Please login" when it's 
  disabled because the user is not logged in. In V1, it says, 
  "Don't Know" which is confusing to me. We should indicate to 
  the user that the button is disabled because they are not logged 
  in. Also, "Don't Know" is another negative statement. I like  
  positive messages!

* Per a request from James and Greta, got rid of the "Close" button 
  on the Attachments panel. Greta mentioned that she didn't 
  understand where she was in the GUI after opening a Note. And the 
  "Close" button is placed near the Notes edit box, and it doesn't 
  indicate what's being closed, so Greta was unsure how to return 
  from the Notes panel and go back to the Geofeature panel. So I 
  made the navigation into another Web-ish standard using angle 
  brackets and displaying the level of the panel above.

  E.g., 

    Lyndale Ave >> This is my note

  where "Lyndale Ave" is a hyperlink back to the geofeature panel.

* Got rid of the Empty Selection panel. Greta pointed out that 
  this panel is meaningless now that we can show the Branch details.
  It's also confusing to her: why does it look different when an item 
  is selected then when it's not? But always showing a details panel 
  and never showing the Empty Selection panel, the user will always 
  recognize when they are viewing the Items tab, and the user will 
  not have to click to get to Branch details, it will just be there.

* Reduced the size of the "Map Key" button in the map when it is 
  minimized. When the browser is narrow, this button is wider than 
  the browser and the "Map Key" text can get hidden under the side 
  panel. Also, it's just too big. It should be a better citizen 
  and manager its use of screen real estate better by hiding in the 
  corner when it's not in use.

* Added pagination to the Conflicts and Maps panels, e.g., 

    << < Page 1 of 2. > >>

  Though it is not implemented and it should be moved to its own class.

* New Side_Panel class takes some functions out of UI.as, including

    Side_Panel.item_details_panel_update();
    Side_Panel.history_browser_update();
    Side_Panel.discussions_panel_update();
    etc.

* Major changes to mouse handling.

  ** Fixed the Double_Click_Detector class that I recently added.

  ** Coordinate event handlers better. The Map Canvas, the Geofeature 
     sprites, Geofeature Vertices, and the Tools all respond to mouse 
     events, but if something handles an event, the others should not 
     necessarily handle it, too. Also, if a double click could still 
     happen, the new code makes sure not to complete any mouse up 
     events until it can determine if the user is double clicking or 
     not.

* G.app.canvas was renamed G.app.map_canvas when I was tracking down 
  a bug. I did not change it back because map_canvas is a more unique 
  name and makes it easier to search the source code for its usages.

* Reworded the help panel to not be so verbose. This makes the panel 
  look nicer and less intimidating.

* Renamed the tab titles to be single words the end in 's', such that 
  they follow the rules of parallelism.

  E.g., Routes, Items, Settings, Discussions, Watchers, Changes.

  Why?
  
  ** "Control Panel" is synonymous with "Settings" but does not 
     follow the convention that the other titles use (ending in 's').
     Also, "Settings" seems less computer-geeky to me. Control Panel 
     is something you find in your Windows Start Menu.

  ** "Watched Regions" is now "Watchers" since you can watch 
     any item, not just regions.

  ** "Recent Changes" is just "Changes" because, really, they are 
     not just recent changes, they are all changes.

* Fixed the Zoom widget when loading the map for the first time. This 
  was a V2 regression: clicking the zoom widget when loading Cyclopath 
  for the first time did not work (the widget would change, but the 
  zoom would not, and clicking the widget again after the map was 
  loaded also did not work as expected (the widget would go to a 
  different zoom level than the one that you pressed)).

* Help_Link now has a complement, Hyper_Link. The former is for 
  external links, and is displayed with an external link icon; 
  the latter is for links within the application (currently 
  just the navigation title you see when looking at an 
  Attachment panel).

* Enabled mouse wheel for zooming in and out. It uses a timer so 
  that it is not overly sensitive, otherwise users could find 
  themselves zooming a lot more than they intended.

* Fixed V1 bugs:

** Bug 2085
   Mouse/Keyboard Events: Shift ignored after TabNavigator used

** Bug 2088
   Alt-Tab from Attachment panel crashes debug plugin 

** Bug 2089
   Notes Undo does not update edit control 

** Bug 2090
   Dragging map after clicking on item pans map but also selects item.

* This checkin (should) compile but the source needs to be cleaned up. 
  I commented out a lot of things that I want to delete, but I wanted to 
  checkin a snapshot before deleting them, just to have a record of the 
  changes without having to do an SVN diff (or having to clean up the 
  code now, I suppose =).


------------------------------------------------------------------------
r22395 | landonb | 2011-04-01 16:42:04 -0500 (Fri, 01 Apr 2011) | 16 lines


Changes to "import" convention.

* For Flex packages, generally specify the actual class.

  E.g., 

    import flash.display.Graphics;

* For Cyclopath packages, just specify the package.

  E.g., 

    import items.types.*;


------------------------------------------------------------------------
r22392 | landonb | 2011-04-01 16:21:38 -0500 (Fri, 01 Apr 2011) | 27 lines


What I showed James (Met Council) and Greta (Mn/DOT) last Friday, March 25.
(Not many changes since the previous checkin, however).

* New map mode dropdown: Viewing and Editing
  (minimally implemented; in viewing mode, 
   flashclient just pretends that user only
   has viewer access to items, even if user 
   might have editor access).

* New Double_Click_Handler class so that we do
  not need two, specially implemented double 
  click timers in two different classes, 
  Map_Canvas_Controller and Geofeature. Having
  just one double click handler makes it easier 
  control who handles the double click (in V1, 
  oftentimes the same mouse event would be 
  handled by more than one object).

* Reordered fcns. in views.panels.Tab_* files.

* Minor changes to Control Panel's Filter tab:
  Removed newline to improve layout.

* Don't expect to be able to build this checkin.


------------------------------------------------------------------------
r22169 | landonb | 2011-03-24 02:23:52 -0500 (Thu, 24 Mar 2011) | 10 lines


Done stubbing the new panels.

(Well, except for dealing with diffs and access control: 
 access control means every control might be editable, 
 or might not be editable. Right now, all the edit 
 controls are displayed, but those that are not 
 editable should be labels instead.)


------------------------------------------------------------------------
r22167 | landonb | 2011-03-23 22:11:46 -0500 (Wed, 23 Mar 2011) | 1 line

Missed a line...
------------------------------------------------------------------------
r22166 | landonb | 2011-03-23 22:10:29 -0500 (Wed, 23 Mar 2011) | 15 lines


Stubbed out the Groups, Changes, and Atlas tabs.

 * Renamed the tabs: Basic, Extra, Groups, Changes, Atlas.

 * Added a new dropdown control for selecting/deselecting all checkboxes in a
   list of items.
   
 * Created the Conflicts panel and support widgets.

 * Created the Atlas panel and support widgets.

 * Cleaned up the Empty Selection panel.


------------------------------------------------------------------------
r22146 | landonb | 2011-03-23 05:43:37 -0500 (Wed, 23 Mar 2011) | 21 lines


Lots of work on the panel classes.

 * Much like Michael and I did for the Map Tools, I added checks to see if the
   user can create each Attachment type.

   * In the panels, this info. enables/disables buttons, like "Add New Note".
   
   * It also shows/hides the "X" delete button in the tag and note lists.

 * Made new misc.utils.Objutil for some functions from G, like G.consensus and
   G.null_replace.

 * Fixed m4_ASSERT*() calls. Turns out m4 only strips newlines because of
   commas. So my compiler error line numbers were not matching my source file 
   line numbers.

 * Rating picker dropdown says "Please login" when it is disabled, rather than
   "Don't know" (former seems more cheery and helpful, and less negative).


------------------------------------------------------------------------
r22139 | landonb | 2011-03-22 18:20:38 -0500 (Tue, 22 Mar 2011) | 15 lines


Bugfixes. 

 (1) G.values_collect: was completely broke. 
 
 (2) Ignore links that link to wiki-deleted attachment or geofeature (otherwise
     discard fcn. gets testy; server really shouldn't send these, but that's a 
     separate issue).                                                          
 
 (3) Two more for-each changes.
 
 (4) Added developer fcn. to display item stack_ids in the item details panel.



------------------------------------------------------------------------
r22135 | landonb | 2011-03-22 16:37:14 -0500 (Tue, 22 Mar 2011) | 19 lines

Details Panels changes (views.panels.*):

  1. New intermediate classes for Tab_Panels_*: Tab_Panel_Base.as and Tab_Panel_Shim.mxml.

     Two tiny classes to do things common to their descendents, of which there isn't much.

     (It would just be one class, but I needed both an AS and an MXML file.)

  2. Re-organized fcns. within files into common, shared order.

  3. Removed panel_initialized and some other junk we don't need.

  4. Removed (zoom_is_vector:Boolean=true) from toggle_enabled/toggle_enabled_impl.

  5. Renamed dp_resize() to on_resize().

  6. Renamed this.selected to this.items_selected (selected is used a lot throughout the code, and it's almost always a Boolean, but here we use it as a Collection, so I renamed it to make that distinction more obvious).


------------------------------------------------------------------------
r22134 | landonb | 2011-03-22 16:23:07 -0500 (Tue, 22 Mar 2011) | 1 line

Reformatted XML in views.panels.* package similar to what I just did to views.mxmls.* package.
------------------------------------------------------------------------
r22133 | landonb | 2011-03-22 16:15:25 -0500 (Tue, 22 Mar 2011) | 1 line

Some things from recent checkins I missed in views.panels.*: rev_is_diffing and m4_ASSERT_FALSE changes. Also, some cleanup to imports and comments; removed some Diff cruft.
------------------------------------------------------------------------
r22132 | landonb | 2011-03-22 15:58:50 -0500 (Tue, 22 Mar 2011) | 1 line

Reformatted MXML XML. (1) It now matches views.panels.* module. (2) It uses consistent three-space tabs like the rest of the code instead of 4-3-3 tabs. (3) Per popular XML style guides, to increase readability, only one key/value pair per line.
------------------------------------------------------------------------
r22131 | landonb | 2011-03-22 15:54:04 -0500 (Tue, 22 Mar 2011) | 1 line

Forgotten update from earlier Michael's merge.
------------------------------------------------------------------------
r22130 | landonb | 2011-03-22 15:48:34 -0500 (Tue, 22 Mar 2011) | 1 line

Some useful utility fcns. to support upcoming GUI panels for permissions and branching.
------------------------------------------------------------------------
r22129 | landonb | 2011-03-22 15:47:17 -0500 (Tue, 22 Mar 2011) | 1 line

Renamed is_diffing to rev_is_diffing, along with is_current and is_historic (both prefixed with 'rev_').
------------------------------------------------------------------------
r22128 | landonb | 2011-03-22 15:43:48 -0500 (Tue, 22 Mar 2011) | 1 line

Deprecating m4_ASSERT_FALSE. It's a pretty useless alias, and m4_ASSERT(false) looks better because of syntax highlighting (the 'false' stands out).
------------------------------------------------------------------------
r22127 | landonb | 2011-03-22 15:40:55 -0500 (Tue, 22 Mar 2011) | 1 line

Merge w/ Michael's checkin' Minor changes.
------------------------------------------------------------------------
r22110 | mludwig | 2011-03-21 17:24:12 -0500 (Mon, 21 Mar 2011) | 1 line

Change Set.as to allow for-each iteration and update those classes to use the more efficient loop construct.  Also, refactor Geofeatures_Attachment_Add to correctly prepare attachments before link values are created (Fixes the missing tag issue)
------------------------------------------------------------------------
r22099 | landonb | 2011-03-21 14:27:46 -0500 (Mon, 21 Mar 2011) | 9 lines

Details Panels changes:

  1. Detail_Panel_Widget is now an AS file, not MXML.

  2. Added intermediate class, Tab_Item_Base.as, to hold code common to the other Tab_Item_* classes.

  3. Other misc.


------------------------------------------------------------------------
r22095 | landonb | 2011-03-21 14:02:29 -0500 (Mon, 21 Mar 2011) | 1 line

Making sure everything is super! (Added super() to some constructors that were missing it, mostly for consistency and just in case we add code to empty base class constructors, we don't want derived classes to miss out.) Also cleaned up some comments (Changed // ** Comments to // *** Comments to be consistent).
------------------------------------------------------------------------
r22091 | landonb | 2011-03-21 12:52:33 -0500 (Mon, 21 Mar 2011) | 1 line

Minor bugfix on login
------------------------------------------------------------------------
r22084 | landonb | 2011-03-21 12:12:43 -0500 (Mon, 21 Mar 2011) | 1 line

Bugfix: Split Block and other tools failed on attempt to re-create links. Problem was New Item Policy was checking for get_constructor equality rather than using derives_from, since New Item Policy allows one to use base classes.
------------------------------------------------------------------------
r22042 | landonb | 2011-03-18 16:51:54 -0500 (Fri, 18 Mar 2011) | 1 line

Indexing all the columns in group_item_access. My test suggests most queries went from four-tenths of a second to just a few hundredths of a second (though getting 1000 byways still takes a half-second). This does not solve the slowness in the flashclient, which happens when drawing byways, highlights, and labels. Oh, and I've read you're not suppose to just index every column willy-nilly in SQL, so we may want to not index all the columns, really. But for now, things seem much faster, so, go for it, I say. At least until we learn otherwise.
------------------------------------------------------------------------
r22041 | landonb | 2011-03-18 16:44:20 -0500 (Fri, 18 Mar 2011) | 1 line

Removed workhints code. Please see the V1 trunk if you'd like the code (it's just a mess in the V2 code, since I haven't updated any of it; seems like a better idea to remove it than leave it in all crufty and commented-out).
------------------------------------------------------------------------
r22035 | landonb | 2011-03-18 12:22:32 -0500 (Fri, 18 Mar 2011) | 1 line

Some bugfixes for last night's GRAC changes. (Not sure why these failures didn't reveal themselves last night, oh well....)
------------------------------------------------------------------------
r22033 | landonb | 2011-03-18 02:04:02 -0500 (Fri, 18 Mar 2011) | 1 line

Late Night St. Paddy's Day Checkin: Added permissions checking to Command_Manager's do_, undo, and redo. This seems like the most logical and easy-going fit for checking that the user can create new items and edit existing items. Edited every call to do_ to check for failure and to gracefully recover. PLEASE NOTE: Very much so untested. I've compiled and make a block, but once you start undoing and redoing, BEWARE.
------------------------------------------------------------------------
r22017 | mludwig | 2011-03-16 17:23:22 -0500 (Wed, 16 Mar 2011) | 1 line

Preserve link values when byway merge is undone and redone
------------------------------------------------------------------------
r22005 | landonb | 2011-03-15 17:59:01 -0500 (Tue, 15 Mar 2011) | 1 line

Updated Logger names in views.panels.
------------------------------------------------------------------------
r22004 | mludwig | 2011-03-15 17:50:00 -0500 (Tue, 15 Mar 2011) | 1 line

Make adding tags and editing notes properly update their panels. This was simply missing a call to UI.item_details_panel_update(). Investigate and cleanup Byway_Merge, although there are bugs with losing tags when a merge is undone.
------------------------------------------------------------------------
r22003 | landonb | 2011-03-15 17:35:50 -0500 (Tue, 15 Mar 2011) | 1 line

Fix for creating new annotation: Annotation.class_item_type was 'attachment' instead of 'annotation'. Silly CxPx (cut 'n' paste) error.
------------------------------------------------------------------------
r21993 | landonb | 2011-03-15 13:26:02 -0500 (Tue, 15 Mar 2011) | 30 lines


== Renamed Files ==

See packages:

  views.dpanels.* (now views.panels)
  views.mxmls.*   (now views.widgets)
  gwis.*

The Detail_Panel classes are all renamed. I tried to categorize them logically into their sub-groups: the Panels themselves, then the tabs, and then the widgets on the tabs.

I also renamed the GWIS classes significantly. E.g., I renamed GWIS_PutItem (WFS_PutFeature) to GWIS_Commit, since we're using the branch model now and that function doesn't just update items, it updates a few other things, too.

== Code Conventions ==

Applied *_Base naming convention to a few more base classes.

Added Loggers to a bunch of classes.

== Miscellaneous ==

Consumed Michael's previous changes (except I split an } else { ;).

Implemented Item_Watcher.

Implemented GWIS_Commit but have not tested. Also have not tested the Tools."

m4_ASSERT_SOFT replaces m4_ASSERT_WARNING: Intent is to log an error with the server but not to alert the user.


------------------------------------------------------------------------
r21982 | mludwig | 2011-03-14 17:52:50 -0500 (Mon, 14 Mar 2011) | 1 line

Fix labeling bug with Regions so labels no longer appear when they are filtered from view
------------------------------------------------------------------------
r21966 | mludwig | 2011-03-14 10:45:46 -0500 (Mon, 14 Mar 2011) | 1 line

Move bless/id assigning logic into a utility function in Item_Manager and make tools responsible for checking this before executing a command the first time. All features are creatable now, although Annotations don't have correct new item policies so it won't let you (but no crashes :) )
------------------------------------------------------------------------
r21951 | landonb | 2011-03-11 14:43:02 -0600 (Fri, 11 Mar 2011) | 1 line

Byway_Create tool works! Still debugging server saves, but GWIS packet gets sent. Also: moved some generic fcns. from G.as to utils.misc.Introspect and utils.misc.Collection
------------------------------------------------------------------------
r21942 | landonb | 2011-03-10 23:33:50 -0600 (Thu, 10 Mar 2011) | 1 line

Enable/disable tools (see: useable()) based on user access to existing items or rights to create new items. Moved get_constructor to new class, Introspect, along with new function to check derived class hierarchy at runtime. Still some bugs in creating new items, but getting better...
------------------------------------------------------------------------
r21938 | landonb | 2011-03-10 14:56:56 -0600 (Thu, 10 Mar 2011) | 1 line

bless_new working, but other asserts firing when creating new items. Some cleanup to other classes, esp. Map_Canvas and some views.dpanels classes.
------------------------------------------------------------------------
r21933 | landonb | 2011-03-09 17:27:46 -0600 (Wed, 09 Mar 2011) | 1 line

Flashclient code cleanup. All code cleaned except views.dpanels, views.update, and views.Map_Canvas_*.
------------------------------------------------------------------------
r21927 | landonb | 2011-03-09 00:32:31 -0600 (Wed, 09 Mar 2011) | 1 line

More item class cleanup; almost done! Removed workhints (look in V1 trunk if you want it; none of it was ported, anyway).
------------------------------------------------------------------------
r21926 | mludwig | 2011-03-08 20:33:27 -0600 (Tue, 08 Mar 2011) | 1 line

Fix/verify all vertex editing commands work, fix item deletion and 'scalar'/text editing, and fix support for generic link value editing, tag adding works but doesn't update the display properly, byway merge mostly works but its support for undo is broken with link values, and all commands that need to create features are broken
------------------------------------------------------------------------
r21913 | landonb | 2011-03-07 19:16:44 -0600 (Mon, 07 Mar 2011) | 1 line

Missed this
------------------------------------------------------------------------
r21912 | landonb | 2011-03-07 19:11:09 -0600 (Mon, 07 Mar 2011) | 1 line

Item class cleanup, mostly. A few other changes to comments elsewhere.
------------------------------------------------------------------------
r21884 | landonb | 2011-03-04 15:44:47 -0600 (Fri, 04 Mar 2011) | 1 line

Oops, forgot this one.
------------------------------------------------------------------------
r21883 | landonb | 2011-03-04 15:43:57 -0600 (Fri, 04 Mar 2011) | 1 line

Split m4 into two files: one for production builds and one for development builds. Makefile uses production macros by default, which omits Flash trace messages.
------------------------------------------------------------------------
r21878 | landonb | 2011-03-04 13:39:51 -0600 (Fri, 04 Mar 2011) | 1 line

Forgot Grac_Manager
------------------------------------------------------------------------
r21876 | mludwig | 2011-03-04 13:28:29 -0600 (Fri, 04 Mar 2011) | 1 line

If statement needs double quotes to properly evaluate for some reason
------------------------------------------------------------------------
r21864 | landonb | 2011-03-03 22:52:29 -0600 (Thu, 03 Mar 2011) | 1 line

Code cleanup 3: Starting with the item base classes. Also, new Strutil.as class, and m4_VERBOSE for when you don't want to overload m4_DEBUG.
------------------------------------------------------------------------
r21863 | landonb | 2011-03-03 20:51:21 -0600 (Thu, 03 Mar 2011) | 1 line

Removed dynamic from a few classes. Fixed a few type errors that followed.
------------------------------------------------------------------------
r21862 | landonb | 2011-03-03 19:59:12 -0600 (Thu, 03 Mar 2011) | 1 line

Code cleanup 2: Changed license header from 2006-2010 to 2006-2011
------------------------------------------------------------------------
r21861 | landonb | 2011-03-03 19:44:12 -0600 (Thu, 03 Mar 2011) | 1 line

Start of code cleanup.
------------------------------------------------------------------------
r21856 | landonb | 2011-03-03 14:42:25 -0600 (Thu, 03 Mar 2011) | 1 line

Flex build works with static flag set (resolved loosely-typed issues). Map should load and run (pan/zoom/select items/view details).
------------------------------------------------------------------------
r21853 | landonb | 2011-03-02 18:16:15 -0600 (Wed, 02 Mar 2011) | 1 line

Merge from Michael. Started fixing compilation bugs now that 'strict' is enabled. Not sure how many compiler errors left to fix, but I need dinner; I assume there's a few hours yet to get this to build.
------------------------------------------------------------------------
r21820 | mludwig | 2011-02-28 12:18:12 -0600 (Mon, 28 Feb 2011) | 1 line

Add get_constructor to G.as so that strict compiling can work. Make a number of small fixmes such as imports or bad var names, but the client still can't build on strict
------------------------------------------------------------------------
r21800 | landonb | 2011-02-24 19:44:05 -0600 (Thu, 24 Feb 2011) | 1 line

New Item Policy: Policy downloads to client. Started fcn. to create items for user based on policy, and to set initial permissions according to the policy (or to not create item if user doesn't have access). Also two name changes to schema table columns to avoid naming conflicts and to be more accurate (item_type_id in new_item_policy is renamed target_item_type_id)
------------------------------------------------------------------------
r21760 | landonb | 2011-02-21 16:38:20 -0600 (Mon, 21 Feb 2011) | 1 line

Bug fixes for new update classes. Pan/zoom seems stable at all zoom levels, incl. aerial and regions. Handles canceling requests as user zooms, pans or changes branch or revision. Details Panels seem stable, at least what is implemented so far.
------------------------------------------------------------------------
r21706 | landonb | 2011-02-16 12:04:50 -0600 (Wed, 16 Feb 2011) | 1 line

Creating baseline for Cyclopath V2
------------------------------------------------------------------------
r21702 | landonb | 2011-02-16 10:56:57 -0600 (Wed, 16 Feb 2011) | 1 line

More cleanup prior to cutting v2 branch
------------------------------------------------------------------------
r21701 | landonb | 2011-02-16 10:50:35 -0600 (Wed, 16 Feb 2011) | 1 line

bashrc machine-specific template files
------------------------------------------------------------------------
r21700 | landonb | 2011-02-16 10:48:54 -0600 (Wed, 16 Feb 2011) | 1 line

Rename folder
------------------------------------------------------------------------
r21699 | landonb | 2011-02-16 10:48:04 -0600 (Wed, 16 Feb 2011) | 1 line

Cleaning up dev scripts (bash and vim) prior to making public v2 branch
------------------------------------------------------------------------
r21697 | landonb | 2011-02-15 23:21:30 -0600 (Tue, 15 Feb 2011) | 12 lines

Created two class hierarchies to help update Map_Canvas and synchronize network requests.
- Partially debugged. 
- Fetching tiles seems quicker compared to previous weeks.
- Redundant network requests are ignored (not sent). 
- Separated fetching of branch, revision, and viewport items into different subclasses. Should reduce bandwidth and hopefully make it easier to maintain code.
- Implemented callLater infrastructure for sending, receiving, and processing network data, so we don't starve the GUI.
- Implemented cancellation mechanism for cancelling in-progress updates, such as when user pans or zooms, changes revisions, logs in or out, or or changes branches.
- Stubs for fetching new item policy and updating working copy (and getting branch conflicts).
- Need to debug lots more, but builds and loads tiles at vector level, and you can pan/zoom. Just don't zoom in too far, there's bugs very near the surface.
- Package is views.update and classes are GWIS_Update and Update_Manager_Base but I think the classes aren't named quite right.


------------------------------------------------------------------------
r21654 | landonb | 2011-02-12 01:35:00 -0600 (Sat, 12 Feb 2011) | 1 line

Work in progress: (1) Code to update map canvas now its own class hierarchy / (2) Client asks for branch and branch head revision ID before loading map / (3) Branch detects changes to branch head revision and updates Working Copy, including detecting branch conflicts / (4) This code is incomplete (broken build) but figured it's more important to check it in than not
------------------------------------------------------------------------
r21586 | landonb | 2011-02-07 15:51:04 -0600 (Mon, 07 Feb 2011) | 1 line

Fixed item_get:tags (was taking 15 seconds, now taking 1); Overhauled Map_Update to use callLater to process GWIS requests and responses, and to add and remove items from the map
------------------------------------------------------------------------
r21503 | landonb | 2011-02-02 15:34:08 -0600 (Wed, 02 Feb 2011) | 1 line

Some Group Access Control code, some tweaks to Map Update to better handle sending, receiving, and processing responses from the server.
------------------------------------------------------------------------
r21397 | landonb | 2011-01-26 17:46:54 -0600 (Wed, 26 Jan 2011) | 1 line

(Final) Check-in part 7 (of 7): new files
------------------------------------------------------------------------
r21396 | landonb | 2011-01-26 17:38:19 -0600 (Wed, 26 Jan 2011) | 1 line

Check-in part 6: updates on recently renamed files
------------------------------------------------------------------------
r21395 | landonb | 2011-01-26 17:35:59 -0600 (Wed, 26 Jan 2011) | 1 line

Check-in part 5: more renaming files
------------------------------------------------------------------------
r21394 | landonb | 2011-01-26 17:18:42 -0600 (Wed, 26 Jan 2011) | 1 line

Check-in part 4: flashclient changes (lots of correcting package paths to honor new project hierarchy)
------------------------------------------------------------------------
r21393 | landonb | 2011-01-26 17:03:45 -0600 (Wed, 26 Jan 2011) | 1 line

Check-in part 3: rename pyserver files
------------------------------------------------------------------------
r21392 | landonb | 2011-01-26 16:59:48 -0600 (Wed, 26 Jan 2011) | 1 line

Check-in part 2: flashclient project hierarchy
------------------------------------------------------------------------
r21391 | landonb | 2011-01-26 16:24:20 -0600 (Wed, 26 Jan 2011) | 1 line

First of a multi-part checkin. 1. Lots of updates to Schema. 2. Lots of changes to Pyserver. 3. Lots of new panels and code in Flashclient. 4. Checking in VIM scripts for Cyclopath project development
------------------------------------------------------------------------
r20961 | landonb | 2010-11-19 15:24:37 -0600 (Fri, 19 Nov 2010) | 1 line

Very much a work in progress... lots of changes from the past month or so, including complete SQL, pyserver fetches using permissions and branching, preliminary changes to flashclient to support permissions and branching
------------------------------------------------------------------------
r20619 | landonb | 2010-10-05 17:19:07 -0500 (Tue, 05 Oct 2010) | 1 line

Now in Full Color\!
------------------------------------------------------------------------
r20602 | landonb | 2010-10-02 12:54:23 -0500 (Sat, 02 Oct 2010) | 1 line

Added remainder of database to DIA model; now reflects complete database.
------------------------------------------------------------------------
r20601 | landonb | 2010-10-02 09:49:17 -0500 (Sat, 02 Oct 2010) | 1 line

More Db model refinements
------------------------------------------------------------------------
r20600 | landonb | 2010-10-01 22:08:08 -0500 (Fri, 01 Oct 2010) | 1 line

Updated database model with new permissions and branching design
------------------------------------------------------------------------
r20560 | landonb | 2010-09-28 13:34:03 -0500 (Tue, 28 Sep 2010) | 1 line

Refactor Detail_Panel hierarchy
------------------------------------------------------------------------
r20559 | landonb | 2010-09-28 13:21:56 -0500 (Tue, 28 Sep 2010) | 1 line

Bugfixes...
------------------------------------------------------------------------
r20463 | landonb | 2010-09-16 13:35:42 -0500 (Thu, 16 Sep 2010) | 63 lines


A month's worth of changes:

- New Map_Canvas_Update class serializes WFS calls when loading the map. This
  improves load time by removing redundant requests and by loading items in
  parallel. It improves application responsiveness by using CallLater to handle
  redraws and handle user interaction while processing WFS responses and
  loading features to the map. The class also uses a work queue to send WFS
  requests and to discard features, etc., while waiting for WFS responses, and
  responses are processed in a particular order (e.g., Terrain is processed
  and drawn first, then Byways, then Waypoints, then highlights and labels).

- Removed Sprite from the Item_Versioned hierarchy. This means Attachments and
  Link_Values and lightweight objects (though not quite flyweight!). E.g.,
  loading 4,000 Link_Values when Link_Values are derived from Sprite causes
  flashclient to run out of memory; loading 4,000 Link_Values when the class is
  not derived from Sprite does not cause memory issues and happens in just a
  few milliseconds.

- Implemented fetching Attributes. One-ways are now drawn appropriately, and
  the Block Details "Advanced" tab now shows the correct values. Annotations
  also now loaded, and clicking 'more' on an Annotation highlights all the
  blocks that have the annotation. So read-only use of the map should be
  completely implemented, save for bugs (mostly null pointer exceptions).

- Added WFS_GetConfig_Draw to request the draw config on startup, and to
  request it just once. (Previously, the draw config was duplicated in each
  GetItem response and was sent a number of times.)

- Changed the SQL schema script to not make Link_Values for Attributes that are
  NULL. This reduces the number of Link_Values in the system by over 100,000!
  (The net benefit is reduced load on the client when updating the map.)

- New debug log mechanism makes writing, viewing and analyzing trace messages
  simple, fast, effective... and fun!

- Watched Regions (public and private) were broken in last checkin and now
  work.

Remaining:

- Saving to the new schema is only partially implemented and completely
  untested.

- Diffing the new schema is implemented but probably broken and/or buggy.

- Posts and Threads are still not loaded, but Map_Canvas_Update should make
  implementing these easy, and we can fix the bug where three 
  WFS_GetDiscussions are sent every time the Discussion Panel's draw() command 
  is called (meaning there's currently a ton of unnecessary GML packets on the 
  wire).

- Complete test cycle. I'll write a test document for this and have different
  members of the team test different parts of the software.

- Code cleanup: remove comments and make bugs for FIXMEs that can be deferred
  until a later release; fix style issues.

- Full review: diffbr will be of limited value. I'll ask different team members
  to review different groups of code: SQL schema script; Item_Versioned
  hierarchy; Detail_Panel hierarchy; Debug Logging facility; Map_Canvas_Update.


------------------------------------------------------------------------
r20462 | landonb | 2010-09-16 13:07:45 -0500 (Thu, 16 Sep 2010) | 1 line

New and renamed files -- New WFS commands GetLinksExist and GetConfig_Draw; new Map_Canvas_Update class to serialize WFS calls when updating the map
------------------------------------------------------------------------
r20072 | landonb | 2010-08-13 13:18:38 -0500 (Fri, 13 Aug 2010) | 1 line

Arb. attrs. save implemented; everything needs extensive testing; watch_region currently busted
------------------------------------------------------------------------
r19969 | landonb | 2010-08-05 13:12:51 -0500 (Thu, 05 Aug 2010) | 22 lines


- pyserver, flashclient, GML, SQL updated to new schema

- Remaining work:
-- Wire flashclient's byway attributes (they're there but not plugged into Detail_Panel)
-- PutFeature still needs work on both ends
-- pyserver's discussions code needs attention
-- There are plenty of bugs

- Everything still needs testing, as most errors happen at runtime, so this will take an unknown while; at least progress is easy to gauge -- I can indicate what I've tested. Maybe now's a good time to write a test document for all of us to use?

- I changed a lot of discussions code since threads and posts are integral to attachments and geofeatures, and that code was mixed in a lot with those classes.

- I changed a lot of filenames and code conventions; I have good reasoning behind the changes. I will create some wiki pages and schedule time during a research meeting so we can discuss this. Since I'm changing all of the classes in the feature-versioned hierarchy, now seems like a good time to rename those files, and also to standardize names, i.e., be more consistent with what we call things.

- The code is very messy, with FIXMEs littered everywhere, and old code commented-out but nonetheless mixed in with new code. These are all hints to help me while testing and debugging and will be removed once I get everything working. I'll also do general cleanup, like grouping and alphabatizing public and protected functions, something I do at the end when overhauling whole files, since it doesn't make sense to spend time on these tasks until you've settled on function names and visibility.

- The new schema breaks a lot of scripts in scripts/, so we'll have to decide what scripts need updating now, and which can wait until later.

- I have more items but this is the bulk of 'em.


------------------------------------------------------------------------
r19968 | landonb | 2010-08-05 12:57:25 -0500 (Thu, 05 Aug 2010) | 1 line

Filename changes; I'll make a wiki page and we can discuss this in a research meeting. Since I'm reworking the feature_versioned classes and touching all of those files anyway, it makes sense to do this now. This also makes my workflow a lot easier; hopefully others will enjoy a similar benefit. But like I said, we'll discuss this and come to a concensus. In the least, I think our vocubulary should be consistent, so that the same things don't have multiple names.
------------------------------------------------------------------------
r19750 | landonb | 2010-07-22 16:16:06 -0500 (Thu, 22 Jul 2010) | 1 line

Set height to 100% otherwise the striping in the listbox looks incomplete when there are no threads populated
------------------------------------------------------------------------
r19749 | landonb | 2010-07-22 16:15:12 -0500 (Thu, 22 Jul 2010) | 1 line

Rename: Attachment_Geo ==> Link_Value
------------------------------------------------------------------------
r19747 | landonb | 2010-07-22 15:04:24 -0500 (Thu, 22 Jul 2010) | 1 line

Replace 'code' with 'id'. Also renaming SQL scripts to 1000s so I don't have to keep renaming 'em.
------------------------------------------------------------------------
r19746 | landonb | 2010-07-22 14:58:13 -0500 (Thu, 22 Jul 2010) | 1 line

Rename 'code' to 'id'
------------------------------------------------------------------------
r19745 | landonb | 2010-07-22 14:57:09 -0500 (Thu, 22 Jul 2010) | 1 line

Lots of changes to pyserver
------------------------------------------------------------------------
r19744 | landonb | 2010-07-22 14:52:28 -0500 (Thu, 22 Jul 2010) | 1 line

Lots of changes to pyserver/layers
------------------------------------------------------------------------
r19743 | landonb | 2010-07-22 14:49:41 -0500 (Thu, 22 Jul 2010) | 1 line

Changed draw_class_code to draw_class_id; geofeature_type_code to geofeature_type_id
------------------------------------------------------------------------
r19742 | landonb | 2010-07-22 14:48:04 -0500 (Thu, 22 Jul 2010) | 11 lines

- Support for new geofeature_type table; got rid of magic numbers, too

- Changed geofeature_type and draw_class 'code' to 'id'

- Lots of FIXME comments

- GetFeature supports just geofeatures; commented-out attachments (tags, annotations, and threads/posts)

- Moved 'name' from geofeature and attachment to feature_versioned


------------------------------------------------------------------------
r19409 | landonb | 2010-07-08 16:45:49 -0500 (Thu, 08 Jul 2010) | 1 line

Merge from trunk
------------------------------------------------------------------------
r19408 | landonb | 2010-07-08 16:43:26 -0500 (Thu, 08 Jul 2010) | 1 line

Changed table names to use new-schema's old-table views; will change to use new-schema's new-table tables as I update the actual SQL
------------------------------------------------------------------------
r19108 | landonb | 2010-06-23 15:55:52 -0500 (Wed, 23 Jun 2010) | 1 line

Move rp_gf_current from instance to public schema script
------------------------------------------------------------------------
r19106 | landonb | 2010-06-23 15:17:35 -0500 (Wed, 23 Jun 2010) | 1 line

Fix geometry_revision update (it's a shared fcn., not an instance fcn.)
------------------------------------------------------------------------
r19099 | landonb | 2010-06-23 13:59:16 -0500 (Wed, 23 Jun 2010) | 1 line

Cleanup comments
------------------------------------------------------------------------
r19096 | landonb | 2010-06-23 13:38:53 -0500 (Wed, 23 Jun 2010) | 1 line

Completed byway_segment CREATE TABLE. Changes to satisfy coloraro schema.
------------------------------------------------------------------------
r19094 | landonb | 2010-06-23 13:26:08 -0500 (Wed, 23 Jun 2010) | 1 line

Python wrapper for verification scripts
------------------------------------------------------------------------
r19093 | landonb | 2010-06-23 13:25:42 -0500 (Wed, 23 Jun 2010) | 1 line

Renaming arb. attrs. verification scripts
------------------------------------------------------------------------
r19079 | landonb | 2010-06-22 12:14:18 -0500 (Tue, 22 Jun 2010) | 1 line

SQL updates per new colorado instance
------------------------------------------------------------------------
r19078 | landonb | 2010-06-22 12:13:05 -0500 (Tue, 22 Jun 2010) | 1 line

Updated data model visualization
------------------------------------------------------------------------
r19075 | landonb | 2010-06-22 11:34:46 -0500 (Tue, 22 Jun 2010) | 1 line

Merge from trunk
------------------------------------------------------------------------
r19074 | landonb | 2010-06-22 10:26:46 -0500 (Tue, 22 Jun 2010) | 1 line

Moved re-creation of complete byway_segment table from schema update script to sql verification script. The table takes over an hour to build (it is still building on my machine) and the table is only needed for verification purposes.
------------------------------------------------------------------------
r19073 | landonb | 2010-06-22 10:08:50 -0500 (Tue, 22 Jun 2010) | 1 line

Moving arb_attrs verification scripts to scripts/sql/arb_attrs
------------------------------------------------------------------------
r19070 | landonb | 2010-06-22 09:24:16 -0500 (Tue, 22 Jun 2010) | 1 line

Updated new-old byway_segment table to grab the one_way, etc, attrs, so we can diff properly
------------------------------------------------------------------------
r19067 | landonb | 2010-06-21 21:08:06 -0500 (Mon, 21 Jun 2010) | 1 line

Lots of changes, mostly (1) per Andrew's review, and (2) per arb_attrs-verify_data-2.sh revealing missing data. FIXME Cleanup comments.
------------------------------------------------------------------------
r19066 | landonb | 2010-06-21 20:56:53 -0500 (Mon, 21 Jun 2010) | 1 line

Verification scripts. Complete except for (1) implement @@@instance@@@ like in schema-update.py, and (2) compare byway_segment one_way, shoulder_width, etc. Otherwise, all the minnesota tables are compared against all the archive_minnesota_1 tables.
------------------------------------------------------------------------
r19065 | landonb | 2010-06-21 20:52:07 -0500 (Mon, 21 Jun 2010) | 1 line

Minor tweaks per review.
------------------------------------------------------------------------
r19064 | landonb | 2010-06-21 20:45:37 -0500 (Mon, 21 Jun 2010) | 1 line

Remove check_is_user, since schema-update.py takes care of taht
------------------------------------------------------------------------
r19063 | landonb | 2010-06-21 20:42:47 -0500 (Mon, 21 Jun 2010) | 1 line

Schema change: Post body has to be in post table, not in link_value table as value_text (else same post text must be duplicated for every geofeature it talks about)
------------------------------------------------------------------------
r18957 | landonb | 2010-06-16 18:40:30 -0500 (Wed, 16 Jun 2010) | 1 line

Merge to trunk
------------------------------------------------------------------------
r18865 | landonb | 2010-06-09 17:49:05 -0500 (Wed, 09 Jun 2010) | 1 line

Renumbering SQL scripts
------------------------------------------------------------------------
r18761 | landonb | 2010-06-04 16:58:38 -0500 (Fri, 04 Jun 2010) | 1 line

Scripts to verify arb. attrs. data integrity against old schema
------------------------------------------------------------------------
r18760 | landonb | 2010-06-04 16:58:05 -0500 (Fri, 04 Jun 2010) | 1 line

Forgot start_node_id and end_node_id; minor bugfixes.
------------------------------------------------------------------------
r18746 | landonb | 2010-06-03 15:02:54 -0500 (Thu, 03 Jun 2010) | 1 line

Working arb. attrs. (a.a.) SQL scripts (data integrity still needs to be verified! =)
------------------------------------------------------------------------
r18745 | landonb | 2010-06-03 15:01:57 -0500 (Thu, 03 Jun 2010) | 1 line

Working revert scripts
------------------------------------------------------------------------
r18744 | landonb | 2010-06-03 14:57:28 -0500 (Thu, 03 Jun 2010) | 1 line

Removing unneccessary SQL scripts since no longer using intermediate schema.
------------------------------------------------------------------------
r18743 | landonb | 2010-06-03 14:55:33 -0500 (Thu, 03 Jun 2010) | 1 line

VACUUM must run outside SQL transacation so moved to own script.
------------------------------------------------------------------------
r18739 | landonb | 2010-06-03 12:02:17 -0500 (Thu, 03 Jun 2010) | 1 line

renumbered schema scripts due to merge from trunk
------------------------------------------------------------------------
r18737 | landonb | 2010-06-03 12:01:47 -0500 (Thu, 03 Jun 2010) | 1 line

renumbered schema scripts due to merge from trunk
------------------------------------------------------------------------
r18736 | landonb | 2010-06-03 12:00:38 -0500 (Thu, 03 Jun 2010) | 1 line

renumbered schema scripts due to merge from trunk
------------------------------------------------------------------------
r18727 | landonb | 2010-06-03 10:02:21 -0500 (Thu, 03 Jun 2010) | 1 line

merge from trunk
------------------------------------------------------------------------
r18723 | landonb | 2010-06-02 17:12:47 -0500 (Wed, 02 Jun 2010) | 1 line

Bugfixes for revert
------------------------------------------------------------------------
r18719 | landonb | 2010-06-02 16:07:48 -0500 (Wed, 02 Jun 2010) | 1 line

Added support for revert scripts
------------------------------------------------------------------------
r18718 | landonb | 2010-06-02 16:07:31 -0500 (Wed, 02 Jun 2010) | 1 line

Bugfixes
------------------------------------------------------------------------
r18713 | landonb | 2010-06-02 14:36:09 -0500 (Wed, 02 Jun 2010) | 1 line

Cannot change view schema in Psql 8.3 (just 8.4+) so need to re-create views on revert
------------------------------------------------------------------------
r18712 | landonb | 2010-06-02 14:35:19 -0500 (Wed, 02 Jun 2010) | 1 line

Bugfixes through l.689
------------------------------------------------------------------------
r18711 | landonb | 2010-06-02 13:37:06 -0500 (Wed, 02 Jun 2010) | 1 line

Removed 2 geofeature constraints and converted to auditor.sql checks
------------------------------------------------------------------------
r18710 | landonb | 2010-06-02 13:16:01 -0500 (Wed, 02 Jun 2010) | 15 lines

Almost ready to see if pyserver runs; there's a little cleanup left and the SQL isn't tested.

1. region.comments now picked up and made into new link_values and annotations

2. Changed CREATE OR REPLACE to just CREATE and removed all DROP TABLEs -- now that the revert script is writ, we can be more strict.

3. Created VIEWs for all the TABLEs moved to the archive schema. For TABLEs of the same name (geofeature, tag, etc.), I made VIEWs named with a _fv and updated other VIEWs to use the new names.

4. The byway_segment VIEW fakes values for one_way, speed_limit, etc., until pyserver is updated to use the new attributes table. This should allow us to test the new database sooner.

5. Commented-out routes, watch_regions, and work_hints until figured out.

6. Collected all the FIXMEs at the bottom of the file so I know what's left to do.


------------------------------------------------------------------------
r18709 | landonb | 2010-06-02 13:02:02 -0500 (Wed, 02 Jun 2010) | 1 line

Arb. attr. revert script
------------------------------------------------------------------------
r18708 | landonb | 2010-06-02 13:01:03 -0500 (Wed, 02 Jun 2010) | 1 line

On revert, be careful to check that table exists in archival schema before deleting table of same name in current schema
------------------------------------------------------------------------
r18697 | landonb | 2010-06-02 09:39:08 -0500 (Wed, 02 Jun 2010) | 1 line

Create VIEWs for tables being archived, usurped by arb. attrs.
------------------------------------------------------------------------
r18696 | landonb | 2010-06-02 09:38:04 -0500 (Wed, 02 Jun 2010) | 1 line

Updated db model
------------------------------------------------------------------------
r18695 | landonb | 2010-06-02 09:37:20 -0500 (Wed, 02 Jun 2010) | 1 line

Create VIEWs for all old db tables being usurped by arb. attrs.
------------------------------------------------------------------------
r18694 | landonb | 2010-06-02 09:35:49 -0500 (Wed, 02 Jun 2010) | 1 line

Code to consume point.comments; since comments were 1-to-1 and link_values are many-to-many, we create new feature_version link_values for the comments
------------------------------------------------------------------------
r18669 | landonb | 2010-06-01 11:49:54 -0500 (Tue, 01 Jun 2010) | 1 line

Checkin so Reid can review.
------------------------------------------------------------------------
r18583 | landonb | 2010-05-28 17:52:23 -0500 (Fri, 28 May 2010) | 1 line

Splitting into two SQL files, one Shared (all instances) and one for each instance (@once-per-instance)
------------------------------------------------------------------------
r18582 | landonb | 2010-05-28 17:51:24 -0500 (Fri, 28 May 2010) | 1 line

Adding instance schemas
------------------------------------------------------------------------
r18574 | landonb | 2010-05-28 16:37:50 -0500 (Fri, 28 May 2010) | 1 line

Bug 1853: ensure non-overlapping feature rids; also ensure strict ordering of feature version numbers
------------------------------------------------------------------------
r18481 | landonb | 2010-05-27 18:16:09 -0500 (Thu, 27 May 2010) | 1 line

Checking in minor changes before Huffy Version 2 gets copied back to Huffy Version 1 by ops
------------------------------------------------------------------------
r18444 | landonb | 2010-05-27 12:08:03 -0500 (Thu, 27 May 2010) | 1 line

Merge from trunk
------------------------------------------------------------------------
r18443 | landonb | 2010-05-27 12:00:09 -0500 (Thu, 27 May 2010) | 1 line

removing renamed file
------------------------------------------------------------------------
r18432 | landonb | 2010-05-27 10:45:19 -0500 (Thu, 27 May 2010) | 1 line

Added Contraint to prevent overlapping rids, per Bug 1296
------------------------------------------------------------------------
r18412 | landonb | 2010-05-26 12:39:41 -0500 (Wed, 26 May 2010) | 1 line

Finished impl. of fcn. to make byway_segment attributes for one_way, etc.; also to create link_values and attachment rows for discussions, tags, and annotations; found problem with tag_bs rows in violation of unique id,valid_starting_rid constraint
------------------------------------------------------------------------
r18405 | landonb | 2010-05-25 19:28:41 -0500 (Tue, 25 May 2010) | 1 line

Added fcns. to consume tags, annotations, threads and post and make them link_values; shortened and simplifed long fcn. (but still testing it) that creates attributes, link_values and related rows for byway_segment attrs like one_way, etc.
------------------------------------------------------------------------
r18404 | landonb | 2010-05-25 19:26:32 -0500 (Tue, 25 May 2010) | 1 line

Renamed schema script and added test schema (for views and such to compare against public and feat_vers schemas to verify the database changes for arb. attrs.)
------------------------------------------------------------------------
r18222 | landonb | 2010-05-19 17:38:09 -0500 (Wed, 19 May 2010) | 1 line

Fixed geofeature and geofeature_type tables and data marshalling; joining geofeature with old tables to get correct ID from geofeature_type; implementing node_id and geometry NOT NULL constraints using TRIGGER fcns. since we need to SELECT from other tables to verify the CONSTRAINT
------------------------------------------------------------------------
r18185 | landonb | 2010-05-18 15:48:54 -0500 (Tue, 18 May 2010) | 1 line

Implementing suggestions from mtg w/ Reid and Andrew; cleaned up feature_versioned and geometry_type table; still need to finish geofeature and link_value updates
------------------------------------------------------------------------
r18183 | landonb | 2010-05-18 15:46:24 -0500 (Tue, 18 May 2010) | 1 line

Add node_ids to geofeature table
------------------------------------------------------------------------
r18154 | landonb | 2010-05-17 16:55:48 -0500 (Mon, 17 May 2010) | 1 line

Added notes from the mtg. w/ Reid and Andrew; still a broken script
------------------------------------------------------------------------
r18044 | landonb | 2010-05-13 14:50:31 -0500 (Thu, 13 May 2010) | 1 line

More geofeature data marshalling SQL
------------------------------------------------------------------------
r18043 | landonb | 2010-05-13 14:50:01 -0500 (Thu, 13 May 2010) | 1 line

Added name column to geofeature_type table
------------------------------------------------------------------------
r18020 | landonb | 2010-05-13 09:08:39 -0500 (Thu, 13 May 2010) | 1 line

Added geofeature type marshalling code; still a broken script...
------------------------------------------------------------------------
r17997 | landonb | 2010-05-12 18:19:26 -0500 (Wed, 12 May 2010) | 1 line

Unfinished SQL scripts; creates new schema, marshalls data from old tables to new tables, cleans up old schema
------------------------------------------------------------------------
r17961 | landonb | 2010-05-12 10:38:04 -0500 (Wed, 12 May 2010) | 1 line

Updated database LDS per discussions w/ Reid
------------------------------------------------------------------------
r17319 | landonb | 2010-04-15 14:43:52 -0500 (Thu, 15 Apr 2010) | 1 line

merge from trunk
------------------------------------------------------------------------
r17265 | landonb | 2010-04-14 12:57:19 -0500 (Wed, 14 Apr 2010) | 1 line


------------------------------------------------------------------------
r17237 | reid | 2010-04-12 20:01:19 -0500 (Mon, 12 Apr 2010) | 2 lines

Some illustrations for the wiki not committed earlier.

------------------------------------------------------------------------
r17236 | reid | 2010-04-12 20:00:01 -0500 (Mon, 12 Apr 2010) | 3 lines

Merged from Landon:
Bug 1687  - Tool Palette Redesign

------------------------------------------------------------------------
r17222 | reid | 2010-04-12 16:52:05 -0500 (Mon, 12 Apr 2010) | 3 lines

Merged from yours truly:
Bug 1718  - can't revert 11875

------------------------------------------------------------------------
r17220 | reid | 2010-04-12 16:32:05 -0500 (Mon, 12 Apr 2010) | 3 lines

Merged from Fernando:
Bug 1693  - Green highlight indicating non-geographic changes does not appear when aerial photos are on

------------------------------------------------------------------------
r17218 | reid | 2010-04-12 16:24:33 -0500 (Mon, 12 Apr 2010) | 3 lines

Merged from Mikhil:
Bug 1266  - cyclopath application has no title

------------------------------------------------------------------------
r17212 | reid | 2010-04-12 14:53:48 -0500 (Mon, 12 Apr 2010) | 3 lines

Merged from Michael:
Bug 1628  - routes: extract server-side route permissions and enable route sharing via links

------------------------------------------------------------------------
r17051 | reid | 2010-04-05 12:01:50 -0500 (Mon, 05 Apr 2010) | 3 lines

Merged from Fernando:
Bug 1701  - region tags not being reverted correctly

------------------------------------------------------------------------
r16932 | reid | 2010-03-31 17:15:34 -0500 (Wed, 31 Mar 2010) | 3 lines

Make "Can't Find Route" friendlier by adding a button that goes to a help page.
Bug 1715  - "Can't Find Route" dialog should be friendlier 

------------------------------------------------------------------------
r16855 | reid | 2010-03-29 16:32:16 -0500 (Mon, 29 Mar 2010) | 2 lines

Set zoom bar in the right place; thanks Fernando!

------------------------------------------------------------------------
r16849 | reid | 2010-03-29 15:49:44 -0500 (Mon, 29 Mar 2010) | 3 lines

Merge from yours truly:
Bug 1669  - recolor map using progress so far on visual design 

------------------------------------------------------------------------
r16836 | reid | 2010-03-29 14:32:42 -0500 (Mon, 29 Mar 2010) | 3 lines

Merged from Michael:
Bug 1710  - byway vertex does not snap with sticky intersections when only 1 vertex is moved

------------------------------------------------------------------------
r16835 | reid | 2010-03-29 14:23:48 -0500 (Mon, 29 Mar 2010) | 1 line

correct link syntax
------------------------------------------------------------------------
r16833 | reid | 2010-03-29 14:20:27 -0500 (Mon, 29 Mar 2010) | 4 lines

1. Remove unneeded class="last"
2. Remove redundant link tooltip texts.
3. Correct margins on Twitter image link.

------------------------------------------------------------------------
r16832 | reid | 2010-03-29 14:13:38 -0500 (Mon, 29 Mar 2010) | 3 lines

Merged from Jordan:
Bug 1691  - Put links to Twitter and our schwag sales on the front page

------------------------------------------------------------------------
r16826 | reid | 2010-03-29 11:22:16 -0500 (Mon, 29 Mar 2010) | 3 lines

Merged from Fernando:
Bug 1698  - Orphan tag_region

------------------------------------------------------------------------
r16675 | reid | 2010-03-23 17:57:03 -0500 (Tue, 23 Mar 2010) | 6 lines

1. Remove Cancel button from Save Successful dialog (bug 1699).

2. Put in a note clarifying why there isn't a Cancel button in the
   Please_Wait_Popup for PutFeature, and don't try to set focus on it (b/c it
   doesn't exist).

------------------------------------------------------------------------
r16671 | reid | 2010-03-23 17:26:24 -0500 (Tue, 23 Mar 2010) | 2 lines

More fixes for bug 1657. See bug 1700 for what went wrong.

------------------------------------------------------------------------
r16584 | reid | 2010-03-19 18:00:26 -0500 (Fri, 19 Mar 2010) | 7 lines

Reverse r16234 because the exception handler crashes because req isn't
defined. This maintains the status quo of crashiness but prevents the crash
from coming out of the exception handler, which is unhelpful.

Fixes:
Bug 1685  - wfs_mod_python raises UnboundLocalVariable on 'req'

------------------------------------------------------------------------
r16583 | reid | 2010-03-19 17:45:53 -0500 (Fri, 19 Mar 2010) | 3 lines

Fixed:
Bug 1616  - Selection Resolver is activated too often

------------------------------------------------------------------------
r16579 | reid | 2010-03-19 17:20:14 -0500 (Fri, 19 Mar 2010) | 3 lines

Merged from Jim Nordgaard and Michael:
Bug 973  - sticky intersections snap to bogus grid

------------------------------------------------------------------------
r16578 | reid | 2010-03-19 17:08:37 -0500 (Fri, 19 Mar 2010) | 3 lines

External merge from James Nordgaard:
Bug 1651  - Some byway types become invisible when aerial maps are on at low vector zooms.

------------------------------------------------------------------------
r16576 | reid | 2010-03-19 17:01:48 -0500 (Fri, 19 Mar 2010) | 3 lines

Merged from Landon:
Bug 1612  - keyboard shortcuts in dialogs and for zooming

------------------------------------------------------------------------
r16564 | reid | 2010-03-19 14:28:22 -0500 (Fri, 19 Mar 2010) | 2 lines

Fix: Bug 1380  - creating new regions requires two clicks of the undo button to undo

------------------------------------------------------------------------
r16484 | reid | 2010-03-17 12:41:21 -0500 (Wed, 17 Mar 2010) | 2 lines

forgotten add for bug 1656 diagnostics

------------------------------------------------------------------------
r16482 | reid | 2010-03-17 12:19:40 -0500 (Wed, 17 Mar 2010) | 2 lines

add additional diagnostic code for bug 1656

------------------------------------------------------------------------
r16468 | reid | 2010-03-16 19:14:32 -0500 (Tue, 16 Mar 2010) | 5 lines

Fix for bug 1657 - update block ratings on revert.

Also, add a transaction_begin_rw() so generic_ratings_update.py will run.


------------------------------------------------------------------------
r16467 | reid | 2010-03-16 19:11:47 -0500 (Tue, 16 Mar 2010) | 1 line

add a threshold for unparseable lines, to reduce e-mail noise
------------------------------------------------------------------------
r16396 | reid | 2010-03-12 16:39:14 -0600 (Fri, 12 Mar 2010) | 2 lines

Move the trunk into the public zone.

------------------------------------------------------------------------
r16383 | reid | 2010-03-12 12:56:07 -0600 (Fri, 12 Mar 2010) | 1 line

someone else with open browser and auth fail
------------------------------------------------------------------------
r16319 | reid | 2010-03-11 14:42:16 -0600 (Thu, 11 Mar 2010) | 3 lines

Merged re-colored widget from Andrew - part of but not all of:
  Bug 912  - route widget: update to reflect cyclopath changes

------------------------------------------------------------------------
r16318 | reid | 2010-03-11 14:39:14 -0600 (Thu, 11 Mar 2010) | 1 line

merge a couple of bugfixes from release/40
------------------------------------------------------------------------
r16278 | reid | 2010-03-10 15:20:10 -0600 (Wed, 10 Mar 2010) | 1 line

change path to reduce downtime on upgrade (clashes with existing path)
------------------------------------------------------------------------
r16256 | reid | 2010-03-09 18:35:52 -0600 (Tue, 09 Mar 2010) | 2 lines

Remove random seed (Bug 1572)

------------------------------------------------------------------------
r16254 | reid | 2010-03-09 18:22:33 -0600 (Tue, 09 Mar 2010) | 3 lines

Merged from Landon:
 Bug 1333 -  WFS failure due to missing POST body

------------------------------------------------------------------------
r16243 | reid | 2010-03-09 16:10:55 -0600 (Tue, 09 Mar 2010) | 3 lines

Merged from Fernando:
 Bug 1574 -  number of 'park' tag applications in route finder wrong

------------------------------------------------------------------------
r16234 | reid | 2010-03-09 12:34:10 -0600 (Tue, 09 Mar 2010) | 5 lines

Expand the coverage of the try/except block which dumps requests on exception.
This is in response to "SystemError: ../Objects/stringobject.c:4135: bad
argument to internal function" which has appeared in logs a couple of times
recently.

------------------------------------------------------------------------
r16192 | reid | 2010-03-07 15:15:21 -0600 (Sun, 07 Mar 2010) | 1 line

fix possible SQL injection; bug 1599
------------------------------------------------------------------------
r16154 | reid | 2010-03-04 14:59:20 -0600 (Thu, 04 Mar 2010) | 3 lines

Merged from Michael:
 Bug 1304 -  finding route gives "warning: unable to bind to property"

------------------------------------------------------------------------
r16151 | reid | 2010-03-04 14:47:52 -0600 (Thu, 04 Mar 2010) | 8 lines

Merged from Fernando:

 Bug 1530 -  Changes to main page

Also, I tweaked the layout of the small links at the bottom slightly, and I
removed the tooltips for these links, since they were redundant with link
text.

------------------------------------------------------------------------
r16150 | reid | 2010-03-04 14:37:39 -0600 (Thu, 04 Mar 2010) | 2 lines

Don't crash when trying to log aerial photos being turned off. Thanks Fernando!

------------------------------------------------------------------------
r16071 | reid | 2010-03-03 11:24:53 -0600 (Wed, 03 Mar 2010) | 3 lines

Add an exemption to silence warnings from that Cyclopath instance that's been
left open and its heartbeat auth is failing.

------------------------------------------------------------------------
r16050 | reid | 2010-03-02 15:55:49 -0600 (Tue, 02 Mar 2010) | 2 lines

set svn:executable - thanks Andrew!

------------------------------------------------------------------------
r15981 | reid | 2010-02-26 12:01:08 -0600 (Fri, 26 Feb 2010) | 2 lines

Log which aerial photo layer is used (bug 1561).

------------------------------------------------------------------------
r15980 | reid | 2010-02-26 11:51:59 -0600 (Fri, 26 Feb 2010) | 4 lines

1. Suspend heartbeat when reauthenticating (bug 1562).
2. Make SQL script work - seems that new FK's aren't deferred.
3. Spacing tweaks.

------------------------------------------------------------------------
r15967 | reid | 2010-02-25 18:23:14 -0600 (Thu, 25 Feb 2010) | 3 lines

Merged from Anthony, Andrew, Landon, and myself:
 Bug 967 -  multiple aerial photography layers + simplify tile access

------------------------------------------------------------------------
r15621 | reid | 2010-02-19 13:23:11 -0600 (Fri, 19 Feb 2010) | 3 lines

Merged from Jordan:
 Bug 1524 - indentation fix in Conf.as

------------------------------------------------------------------------
r15551 | reid | 2010-02-17 12:46:43 -0600 (Wed, 17 Feb 2010) | 3 lines

Merged from Landon:
 Bug 1282 -  phone home if the throbber runs endlessly

------------------------------------------------------------------------
r15547 | reid | 2010-02-17 12:16:19 -0600 (Wed, 17 Feb 2010) | 3 lines

Merged from me:
 Bug 1479 -  Improved exception handling in wfs_mod_python.py

------------------------------------------------------------------------
r15534 | reid | 2010-02-16 19:01:55 -0600 (Tue, 16 Feb 2010) | 1 line

merge pyserver_except_notify.py silencing from version 39 branch
------------------------------------------------------------------------
r15468 | reid | 2010-02-15 13:21:01 -0600 (Mon, 15 Feb 2010) | 3 lines

Merged from Fernando:
 Bug 842 -  tagging: consider combining functions in Tag_Box_Historic.mxml

------------------------------------------------------------------------
r15466 | reid | 2010-02-15 13:17:34 -0600 (Mon, 15 Feb 2010) | 3 lines

Merged from Jordan:
 Bug 1402 -  too much space between "find a route" fields on IE

------------------------------------------------------------------------
r15398 | reid | 2010-02-13 12:07:41 -0600 (Sat, 13 Feb 2010) | 2 lines

Moving regions scripts out of the trunk to make SVN release of source code easier.

------------------------------------------------------------------------
r15383 | reid | 2010-02-12 17:22:02 -0600 (Fri, 12 Feb 2010) | 1 line

merge quick fix for reauth crash (bug 1521) from releases/39
------------------------------------------------------------------------
r15375 | reid | 2010-02-12 14:40:49 -0600 (Fri, 12 Feb 2010) | 1 line

correct bugs identified by Andrew
------------------------------------------------------------------------
r15178 | reid | 2010-02-04 13:48:13 -0600 (Thu, 04 Feb 2010) | 3 lines

Merged from Fernando:
Bug 1356 -  fix tagging graphs by adding fake users to user table

------------------------------------------------------------------------
r15175 | reid | 2010-02-04 13:31:14 -0600 (Thu, 04 Feb 2010) | 3 lines

Merged from Landon:
 Bug 1498 -  Replace md5 with hashlib

------------------------------------------------------------------------
r15173 | reid | 2010-02-04 13:28:34 -0600 (Thu, 04 Feb 2010) | 3 lines

Merged from Landon:
Bug 1499 -  Postgresql 8.3 Support

------------------------------------------------------------------------
r15171 | reid | 2010-02-04 13:22:05 -0600 (Thu, 04 Feb 2010) | 3 lines

Merged from Michael:
 Bug 1442 -  block editing can still create an error-causing null block

------------------------------------------------------------------------
r15169 | reid | 2010-02-04 13:05:51 -0600 (Thu, 04 Feb 2010) | 3 lines

Merged from Jordan:
Bug 991 -  routes: rename "visualization" to "viz"

------------------------------------------------------------------------
r15143 | reid | 2010-02-03 15:23:35 -0600 (Wed, 03 Feb 2010) | 1 line

removed constraint which caused logged asserts from non-debug clients to barf
------------------------------------------------------------------------
r15121 | reid | 2010-02-03 13:06:51 -0600 (Wed, 03 Feb 2010) | 1 line

merged from v39: correct log_event_joined
------------------------------------------------------------------------
r15098 | reid | 2010-02-02 18:20:36 -0600 (Tue, 02 Feb 2010) | 3 lines

Merged from Landon:
Bug 1327 -  track clients and sessions more robustly

------------------------------------------------------------------------
r15082 | reid | 2010-02-02 16:24:35 -0600 (Tue, 02 Feb 2010) | 1 line

enforce immutability of logs
------------------------------------------------------------------------
r15071 | reid | 2010-02-02 16:08:45 -0600 (Tue, 02 Feb 2010) | 2 lines

Update wfs_Log to user transaction_create_rw() (bug 1463).

------------------------------------------------------------------------
r15065 | reid | 2010-02-02 16:00:31 -0600 (Tue, 02 Feb 2010) | 3 lines

Merged from Reid (that's me!):
Bug 1203 -  drop "serializable" transactions and switch to explicit locking when needed

------------------------------------------------------------------------
r14868 | reid | 2010-01-29 20:32:54 -0600 (Fri, 29 Jan 2010) | 1 line

exclude build
------------------------------------------------------------------------
r14866 | reid | 2010-01-29 20:02:01 -0600 (Fri, 29 Jan 2010) | 1 line

add blurb about source code
------------------------------------------------------------------------
r14865 | reid | 2010-01-29 19:38:10 -0600 (Fri, 29 Jan 2010) | 2 lines

Bug 1268 -  single database definition script

------------------------------------------------------------------------
r14862 | reid | 2010-01-29 18:25:02 -0600 (Fri, 29 Jan 2010) | 3 lines

Sanitize code for open-source.
Bug 1373 - audit Cyclopath code for open-sourcing problems 

------------------------------------------------------------------------
r14861 | reid | 2010-01-29 17:49:21 -0600 (Fri, 29 Jan 2010) | 1 line

add additional copyright notices
------------------------------------------------------------------------
r14860 | reid | 2010-01-29 17:36:01 -0600 (Fri, 29 Jan 2010) | 2 lines

Bug 1374 -  add license information to source code

------------------------------------------------------------------------
r14859 | reid | 2010-01-29 17:34:49 -0600 (Fri, 29 Jan 2010) | 1 line

script to make sure all files are licensed
------------------------------------------------------------------------
r14846 | reid | 2010-01-29 14:27:17 -0600 (Fri, 29 Jan 2010) | 1 line

add license info
------------------------------------------------------------------------
r14758 | reid | 2010-01-26 12:10:11 -0600 (Tue, 26 Jan 2010) | 3 lines

Merged from Fernando:
Bug 1462 -  duplicate tag_bs's caused by merging

------------------------------------------------------------------------
r14591 | reid | 2010-01-21 14:13:48 -0600 (Thu, 21 Jan 2010) | 3 lines

Merged from Landon:
Bug 1443 -  don't send watch region emails to users without email addresses

------------------------------------------------------------------------
r14586 | reid | 2010-01-20 17:26:04 -0600 (Wed, 20 Jan 2010) | 3 lines

Merged from Michael:
Bug 1208 -  make explicit client logging sane

------------------------------------------------------------------------
r14236 | reid | 2009-12-31 17:48:51 -0600 (Thu, 31 Dec 2009) | 1 line

prevent use of script again until bug is fixed
------------------------------------------------------------------------
r14230 | reid | 2009-12-31 16:21:35 -0600 (Thu, 31 Dec 2009) | 4 lines

Merged from Andrew:

Bug 1364 - change dumpfile naming scheme

------------------------------------------------------------------------
r14227 | reid | 2009-12-31 16:10:49 -0600 (Thu, 31 Dec 2009) | 4 lines

Merged from Landon:

Bug 100 -  cleanup: add defaultdict use when appropriate

------------------------------------------------------------------------
r14225 | reid | 2009-12-31 15:59:01 -0600 (Thu, 31 Dec 2009) | 4 lines

Merged from Andrew:

Bug 1386 -  verbosely compare two cyclopath databases

------------------------------------------------------------------------
r14191 | reid | 2009-12-30 17:46:01 -0600 (Wed, 30 Dec 2009) | 4 lines

Merged from Landon:

Bug 1412 -  inappropriate re-sort in Find Route panel

------------------------------------------------------------------------
r14124 | reid | 2009-12-23 16:38:47 -0600 (Wed, 23 Dec 2009) | 4 lines

Merged from Landon:

Bug 1381 -  text box horizontal scroll incorrect after contents shrink, hiding text

------------------------------------------------------------------------
r14121 | reid | 2009-12-23 16:23:16 -0600 (Wed, 23 Dec 2009) | 4 lines

Merged from Landon:

Bug 831 -  throbber spins endlessly if geocoding service fails

------------------------------------------------------------------------
r14119 | reid | 2009-12-23 16:01:29 -0600 (Wed, 23 Dec 2009) | 4 lines

Merged from Michael:

Bug 1270 -  Connected loop block becomes unconnected

------------------------------------------------------------------------
r14115 | reid | 2009-12-23 14:21:51 -0600 (Wed, 23 Dec 2009) | 1 line

rm unneeded debug log call
------------------------------------------------------------------------
r14079 | reid | 2009-12-18 18:06:06 -0600 (Fri, 18 Dec 2009) | 2 lines

Make selection resolver work again (bug 1399).

------------------------------------------------------------------------
r14070 | reid | 2009-12-17 18:10:30 -0600 (Thu, 17 Dec 2009) | 6 lines

Delete spurious mergeinfo from doc/bugzilla.dia

Merged from Fernando:

Bug 1378 -  remove passwords from CONFIG that's checked into SVN

------------------------------------------------------------------------
r14068 | reid | 2009-12-17 17:43:37 -0600 (Thu, 17 Dec 2009) | 4 lines

Merged from Jordan:

Bug 1265 -  current home page is a bit ugly in IE

------------------------------------------------------------------------
r13943 | reid | 2009-12-09 18:03:50 -0600 (Wed, 09 Dec 2009) | 4 lines

Merged from Jordan:

Bug 1235 -  Tagging: Create a script that auto tags all hills of grade > 4%

------------------------------------------------------------------------
r13941 | reid | 2009-12-09 17:51:10 -0600 (Wed, 09 Dec 2009) | 4 lines

Merge from Jordan:

Bug 964 -  some tag-related WFS requests are quite slow

------------------------------------------------------------------------
r13913 | reid | 2009-12-08 17:35:32 -0600 (Tue, 08 Dec 2009) | 1 line

update bug diagram
------------------------------------------------------------------------
r13907 | reid | 2009-12-08 14:15:55 -0600 (Tue, 08 Dec 2009) | 1 line

move bugzilla.dia to trunk
------------------------------------------------------------------------
r13904 | reid | 2009-12-08 13:55:15 -0600 (Tue, 08 Dec 2009) | 1 line

fix bug 1379
------------------------------------------------------------------------
r13874 | reid | 2009-12-04 19:42:23 -0600 (Fri, 04 Dec 2009) | 1 line

update home page
------------------------------------------------------------------------
r13873 | reid | 2009-12-04 19:37:43 -0600 (Fri, 04 Dec 2009) | 4 lines

Merged from Mikhil:

 Bug 1320 -  regions-appeals: release

------------------------------------------------------------------------
r13782 | reid | 2009-12-02 15:01:38 -0600 (Wed, 02 Dec 2009) | 4 lines

Merged from Mikhil:

 Bug 1358 -  can't edit within regions with multiple watchers

------------------------------------------------------------------------
r13500 | reid | 2009-11-17 18:41:11 -0600 (Tue, 17 Nov 2009) | 4 lines

Merged from Mikhil:

Bug 1307 - update needed when doing "go to" without zooming

------------------------------------------------------------------------
r13439 | reid | 2009-11-13 17:14:44 -0600 (Fri, 13 Nov 2009) | 4 lines

Merged from Mikhil:

Bug 1219 -  private changes survive across log in/out through commands

------------------------------------------------------------------------
r13437 | reid | 2009-11-13 17:10:21 -0600 (Fri, 13 Nov 2009) | 1 line

fix style
------------------------------------------------------------------------
r13436 | reid | 2009-11-13 17:08:49 -0600 (Fri, 13 Nov 2009) | 4 lines

Merged from Mikhil:

 Bug 1261 -  cleanup save(), save_db() copy/paste parallel code

------------------------------------------------------------------------
r13432 | reid | 2009-11-13 16:29:30 -0600 (Fri, 13 Nov 2009) | 4 lines

Merged from Mikhil:

Bug 1253 -  going to a region should lookat the whole region

------------------------------------------------------------------------
r13429 | reid | 2009-11-13 16:21:09 -0600 (Fri, 13 Nov 2009) | 4 lines

Merged from Jordan:

Bug 1330 -  route visualization causes excessive PutPreference requests

------------------------------------------------------------------------
r13282 | reid | 2009-11-05 15:33:04 -0600 (Thu, 05 Nov 2009) | 4 lines

Merged from Mikhil:

 Bug 1278 -  turn selection resolver off in node builder tool

------------------------------------------------------------------------
r13275 | reid | 2009-11-05 14:36:26 -0600 (Thu, 05 Nov 2009) | 4 lines

Merged from Mikhil:

Bug 1139 -  reduce the user average threshold from 3 to 1

------------------------------------------------------------------------
r13266 | reid | 2009-11-05 11:31:49 -0600 (Thu, 05 Nov 2009) | 4 lines

Merged from Fernando:

Bug 1241 -  tag application breaks when entering the same tag twice

------------------------------------------------------------------------
r13233 | reid | 2009-11-04 11:19:16 -0600 (Wed, 04 Nov 2009) | 4 lines

Merged from Jordan:

Bug 1264 -  home page route find should go to instance it's running on

------------------------------------------------------------------------
r13224 | reid | 2009-11-02 19:00:38 -0600 (Mon, 02 Nov 2009) | 4 lines

Merged from Fernando:

Bug 1288 -  Find Route -> Restore Defaults should scroll tag list to top

------------------------------------------------------------------------
r13221 | reid | 2009-11-02 18:52:53 -0600 (Mon, 02 Nov 2009) | 4 lines

Merged from Andrew:

Bug 1260 -  add constraints to ensure valid version numbers

------------------------------------------------------------------------
r13114 | reid | 2009-10-26 20:11:58 -0500 (Mon, 26 Oct 2009) | 4 lines

Merged from Andrew:

Bug 1135 - create a new special tag "prohibited"

------------------------------------------------------------------------
r13112 | reid | 2009-10-26 19:48:34 -0500 (Mon, 26 Oct 2009) | 4 lines

Merged from Michael:

Bug 1269 - selection resolver is too enthusiastic in history browser mode

------------------------------------------------------------------------
r13110 | reid | 2009-10-26 19:43:44 -0500 (Mon, 26 Oct 2009) | 4 lines

Merged from Mikhil:

 Bug 1279 -  regions: reverting a region edit does nothing

------------------------------------------------------------------------
r12894 | reid | 2009-10-17 14:56:29 -0500 (Sat, 17 Oct 2009) | 4 lines

Merged from Andrew:

 Bug 1258 -  tags not kept current in Find_Route_Popup

------------------------------------------------------------------------
r12866 | reid | 2009-10-15 20:42:36 -0500 (Thu, 15 Oct 2009) | 4 lines

Fixed:

Bug 1251 -  regions import script assigns all regions a version = 0

------------------------------------------------------------------------
r12825 | reid | 2009-10-14 16:17:15 -0500 (Wed, 14 Oct 2009) | 4 lines

Merged from Fernando:

 Bug 1242 -  from/to address validation can return blank message

------------------------------------------------------------------------
r12823 | reid | 2009-10-14 16:09:56 -0500 (Wed, 14 Oct 2009) | 4 lines

Merged from Mikhil:

 Bug 1247 -  regions code cleanup (part 2)

------------------------------------------------------------------------
r12820 | reid | 2009-10-14 15:52:30 -0500 (Wed, 14 Oct 2009) | 4 lines

Merged from Andrew:

 Bug 1238 -  fix AutoComplete logging

------------------------------------------------------------------------
r12819 | reid | 2009-10-14 15:40:51 -0500 (Wed, 14 Oct 2009) | 1 line

finish committing merge; oops
------------------------------------------------------------------------
r12816 | reid | 2009-10-14 15:31:59 -0500 (Wed, 14 Oct 2009) | 4 lines

Merged from Fernando, with some tweaking:

 Bug 1210 -  Search text boxes need some examples

------------------------------------------------------------------------
r12813 | reid | 2009-10-14 14:48:43 -0500 (Wed, 14 Oct 2009) | 4 lines

Merged from Michael:

Bug 998 - External routing does not work with one-field addresses

------------------------------------------------------------------------
r12763 | sheppard | 2009-10-08 18:00:32 -0500 (Thu, 08 Oct 2009) | 1 line

tiny format fix
------------------------------------------------------------------------
r12732 | reid | 2009-10-08 12:37:40 -0500 (Thu, 08 Oct 2009) | 10 lines

Merged from Mikhil:

 Bug 1237 -  tag removal broken

with subordinate bugs:

 Bug 1239 -  improve region public/private toggle
 Bug 1240 -  code cleanup in Region.as


------------------------------------------------------------------------
r12722 | reid | 2009-10-07 17:00:26 -0500 (Wed, 07 Oct 2009) | 1 line

add anonymous route requests to usage graph
------------------------------------------------------------------------
r12704 | reid | 2009-10-07 13:33:02 -0500 (Wed, 07 Oct 2009) | 4 lines

Merged:

Bug 1234 -  Region label background disappears when region is selected

------------------------------------------------------------------------
r12703 | reid | 2009-10-07 13:20:32 -0500 (Wed, 07 Oct 2009) | 1 line

create revision_geosummaries_update.py
------------------------------------------------------------------------
r12701 | reid | 2009-10-07 12:57:29 -0500 (Wed, 07 Oct 2009) | 4 lines

Fixed:

Bug 1136 -  reduce default rating on sidewalks

------------------------------------------------------------------------
r12700 | reid | 2009-10-07 12:56:43 -0500 (Wed, 07 Oct 2009) | 1 line

rm leftover debug code
------------------------------------------------------------------------
r12698 | reid | 2009-10-07 12:53:30 -0500 (Wed, 07 Oct 2009) | 4 lines

Merge from Mikhil:

Bug 970 -  revision has null geometry columns - "look at" then goes to never-never land

------------------------------------------------------------------------
r12667 | reid | 2009-10-06 13:33:47 -0500 (Tue, 06 Oct 2009) | 12 lines

Merged from Mikhil:

Bug 1209 -  regions: logging in/out discards dirty regions

and 4 subordinate bugs:

bug 1199: need some indication in region name/crosshairs that the region is selected
bug 1200: no way to easily see recent changes in watched regions
bug 1209: regions: logging in/out discards dirty regions
bug 1211: clicking on regions crashes after r12546


------------------------------------------------------------------------
r12664 | reid | 2009-10-06 13:01:49 -0500 (Tue, 06 Oct 2009) | 4 lines

Merged from Fernando:

Bug 1165 -  add created column to routes table

------------------------------------------------------------------------
r12660 | reid | 2009-10-05 18:58:40 -0500 (Mon, 05 Oct 2009) | 4 lines

Merged from Reid and Mikhil:

Bug 1204 - browser locks up with 100% cpu when zooming in

------------------------------------------------------------------------
r12657 | reid | 2009-10-05 18:36:48 -0500 (Mon, 05 Oct 2009) | 4 lines

Merged from Fernando:

 Bug 1189 -  tag preferences not set correctly after login

------------------------------------------------------------------------
r12655 | reid | 2009-10-05 18:31:10 -0500 (Mon, 05 Oct 2009) | 5 lines

Merged from Michael:

 Bug 1160 -  route refinements
 Bug 1206 -  improve is_clickable() in Geofeature

------------------------------------------------------------------------
r12653 | reid | 2009-10-05 18:18:32 -0500 (Mon, 05 Oct 2009) | 4 lines

Merged from Michael:

Bug 1207 -  route panel doesn't always show from/to fields

------------------------------------------------------------------------
r12593 | reid | 2009-09-30 12:16:53 -0500 (Wed, 30 Sep 2009) | 4 lines

Fixed, as suggested by Anthony:

Bug 1220 -  Unable to create new geopoints after inclusion of point types

------------------------------------------------------------------------
r12582 | reid | 2009-09-28 17:31:38 -0500 (Mon, 28 Sep 2009) | 3 lines

Create a script to detect, organize, and complain about server crash dumps.
(Bug 836)

------------------------------------------------------------------------
r12579 | reid | 2009-09-28 16:16:33 -0500 (Mon, 28 Sep 2009) | 5 lines

Merge from Mikhil:

Bug 1213 -  regions: fix region thicknesses, colors, selectability as appropriate
Bug 1197 -  search should report both points and regions, if appropriate

------------------------------------------------------------------------
r12577 | reid | 2009-09-28 14:59:32 -0500 (Mon, 28 Sep 2009) | 4 lines

Merged from Anthony:

 Bug 1054 -  Implement point types

------------------------------------------------------------------------
r12550 | reid | 2009-09-24 19:10:54 -0500 (Thu, 24 Sep 2009) | 4 lines

Merged from Michael:

Bug 1046 - clean up orphan tag_bs (and perhaps tag)

------------------------------------------------------------------------
r12548 | reid | 2009-09-24 19:03:04 -0500 (Thu, 24 Sep 2009) | 4 lines

Merged from Fernando:

Bug 1190 - fix tagged blocks graph to allow more space for byways with two tags

------------------------------------------------------------------------
r12546 | reid | 2009-09-24 18:58:51 -0500 (Thu, 24 Sep 2009) | 5 lines

Merged from Fernando:

 Bug 944 -  tagging: tons of tagging-related warnings from flashclient
 Bug 1175 -  tagging: split vocabulary in drop-down

------------------------------------------------------------------------
r12543 | reid | 2009-09-24 18:27:45 -0500 (Thu, 24 Sep 2009) | 4 lines

Merged from Fernando:

 Bug 956 -  simple address parser

------------------------------------------------------------------------
r12540 | reid | 2009-09-24 18:10:24 -0500 (Thu, 24 Sep 2009) | 4 lines

Merged from Andrew:

 Bug 1049 -  Automatically report 2032 errors

------------------------------------------------------------------------
r12528 | reid | 2009-09-24 15:01:13 -0500 (Thu, 24 Sep 2009) | 4 lines

Merged from Fernando:

Bug 994 -  tagging: remove tag encouragement code when it's no longer needed

------------------------------------------------------------------------
r12526 | reid | 2009-09-24 14:28:45 -0500 (Thu, 24 Sep 2009) | 4 lines

Merged from Michael:

Bug 1163 -  Geosummaries appear in Selection Resolver list

------------------------------------------------------------------------
r12524 | reid | 2009-09-24 14:12:38 -0500 (Thu, 24 Sep 2009) | 4 lines

Merged from Mikhil:

Bug 1192 -  regions: "watch this region" toggle not activated/deactivated correctly

------------------------------------------------------------------------
r12517 | reid | 2009-09-23 17:55:03 -0500 (Wed, 23 Sep 2009) | 1 line

flag orphan regions which existed at any point in history
------------------------------------------------------------------------
r12516 | reid | 2009-09-23 17:53:54 -0500 (Wed, 23 Sep 2009) | 4 lines

Merged from Mikhil:

Bug 937 - regions: implement      (w00t!)

------------------------------------------------------------------------
r12241 | reid | 2009-09-04 14:14:43 -0500 (Fri, 04 Sep 2009) | 7 lines

Tweak auditor.sql:

1. Restore no-output if no problems.

2. Modify orphan tag_bs code to detect orphans present at any time during
   history.

------------------------------------------------------------------------
r12240 | reid | 2009-09-04 14:10:40 -0500 (Fri, 04 Sep 2009) | 2 lines

merge small fix from production

------------------------------------------------------------------------
r12237 | reid | 2009-09-04 13:12:51 -0500 (Fri, 04 Sep 2009) | 4 lines

Merge from Michael:

Bug 1046 -  clean up orphan tag_bs (and perhaps tag)

------------------------------------------------------------------------
r12228 | reid | 2009-09-03 19:17:07 -0500 (Thu, 03 Sep 2009) | 2 lines

Create script to guess sessions from apache_event log.

------------------------------------------------------------------------
r12227 | reid | 2009-09-03 17:37:29 -0500 (Thu, 03 Sep 2009) | 2 lines

Fixed:  Bug 1044 -  guess PYSERVER_HOME if not given

------------------------------------------------------------------------
r12226 | reid | 2009-09-03 17:04:45 -0500 (Thu, 03 Sep 2009) | 2 lines

tweak build to require Flex 3.4

------------------------------------------------------------------------
r12218 | reid | 2009-09-03 15:29:59 -0500 (Thu, 03 Sep 2009) | 4 lines

Merged from Michael:

Bug 1093 -  multiple-routes improvements

------------------------------------------------------------------------
r12214 | reid | 2009-09-03 11:52:59 -0500 (Thu, 03 Sep 2009) | 3 lines

Start and end node elevations were incorrectly considered non-geographic
changes, causing a bogus green change highlight in historic mode. Fixed.

------------------------------------------------------------------------
r12176 | reid | 2009-09-01 12:46:40 -0500 (Tue, 01 Sep 2009) | 4 lines

Merged from Fernando:

 Bug 1137 -  daily tagging graph underestimating applications

------------------------------------------------------------------------
r12174 | reid | 2009-09-01 12:43:51 -0500 (Tue, 01 Sep 2009) | 4 lines

Merged from Reid:

Bug 1084 - elevation_update failing for some requests

------------------------------------------------------------------------
r12172 | reid | 2009-09-01 12:16:39 -0500 (Tue, 01 Sep 2009) | 4 lines

Merged from Reid:

Bug 1059 -  rate-limit authentication failures - security

------------------------------------------------------------------------
r12149 | reid | 2009-08-28 16:11:14 -0500 (Fri, 28 Aug 2009) | 1 line

shortcut for the usual fixperms invocation
------------------------------------------------------------------------
r12147 | reid | 2009-08-28 15:58:57 -0500 (Fri, 28 Aug 2009) | 4 lines

Merged from Mikhil:

Bug 1130 -  node builder gives unconnected blocks after save

------------------------------------------------------------------------
r12101 | reid | 2009-08-25 17:34:03 -0500 (Tue, 25 Aug 2009) | 4 lines

Merged from Jordan:

 Bug 996 -  route visualization: color route by rating yields black blocks sometimes

------------------------------------------------------------------------
r12100 | reid | 2009-08-25 17:06:35 -0500 (Tue, 25 Aug 2009) | 1 line

add check for low alias_source to auditor.sql
------------------------------------------------------------------------
r12092 | reid | 2009-08-25 13:23:13 -0500 (Tue, 25 Aug 2009) | 4 lines

Merged from Reid:

 Bug 1067 -  create aliases for all users

------------------------------------------------------------------------
r12063 | reid | 2009-08-21 17:15:45 -0500 (Fri, 21 Aug 2009) | 4 lines

Merged from Michael:

Bug 982 - routes: allow for multiple routes

------------------------------------------------------------------------
r12055 | reid | 2009-08-21 16:31:00 -0500 (Fri, 21 Aug 2009) | 4 lines

Merge from Michael:

Bug 983 - resolve selection collisions

------------------------------------------------------------------------
r12048 | reid | 2009-08-21 15:38:54 -0500 (Fri, 21 Aug 2009) | 4 lines

Merged from Fernando:

Bug 984 -  tag count on graphs incorrect

------------------------------------------------------------------------
r12046 | reid | 2009-08-21 15:33:30 -0500 (Fri, 21 Aug 2009) | 1 line

merge Fernando's tag encouragement fix from release branch
------------------------------------------------------------------------
r12034 | reid | 2009-08-21 11:56:32 -0500 (Fri, 21 Aug 2009) | 1 line

merge doc fix from production
------------------------------------------------------------------------
r11929 | reid | 2009-08-13 13:30:53 -0500 (Thu, 13 Aug 2009) | 1 line

update home page
------------------------------------------------------------------------
r11923 | reid | 2009-08-13 11:15:45 -0500 (Thu, 13 Aug 2009) | 4 lines

Merged from Fernando:

Bug 978 -  tagging: simple tag encouragement

------------------------------------------------------------------------
r11913 | reid | 2009-08-12 16:20:07 -0500 (Wed, 12 Aug 2009) | 4 lines

Merge from Michael:

Bug 992 -  steepness category breaks are wrong?

------------------------------------------------------------------------
r11911 | reid | 2009-08-12 16:04:22 -0500 (Wed, 12 Aug 2009) | 2 lines

Tweak a color.

------------------------------------------------------------------------
r11910 | reid | 2009-08-12 15:54:05 -0500 (Wed, 12 Aug 2009) | 4 lines

Merge from Michael:

Bug 995 -  route visualization: bonus/penalty viz doesn't work

------------------------------------------------------------------------
r11842 | reid | 2009-08-05 20:11:05 -0500 (Wed, 05 Aug 2009) | 1 line

change encouragement timeout to something reasonable
------------------------------------------------------------------------
r11840 | reid | 2009-08-05 20:05:48 -0500 (Wed, 05 Aug 2009) | 4 lines

Merge from Fernando:

#978 tagging: simple tag encouragement

------------------------------------------------------------------------
r11837 | reid | 2009-08-05 19:40:40 -0500 (Wed, 05 Aug 2009) | 7 lines

Merge route visualization stuff from Jordan:

#953 Add elevation visualization to routes
#927 Add geometry library utils
#926 Create elevation database update scripts
#925 Create elevation SQL scripts

------------------------------------------------------------------------
r11831 | reid | 2009-08-05 16:27:40 -0500 (Wed, 05 Aug 2009) | 4 lines

1. A few visual tweaks to the upper-left. (#943)
2. Actually fix the scroll-bar bug described in #943.


------------------------------------------------------------------------
r11830 | reid | 2009-08-05 16:00:24 -0500 (Wed, 05 Aug 2009) | 2 lines

Install Zach's new favicon.ico (#989)

------------------------------------------------------------------------
r11814 | reid | 2009-08-04 18:49:10 -0500 (Tue, 04 Aug 2009) | 5 lines

Merged from Jordan/Zach:

#962 re-design upper left corner of app
#963 move 'what's new?' link from splash screen to control pannel

------------------------------------------------------------------------
r11810 | reid | 2009-08-04 18:06:16 -0500 (Tue, 04 Aug 2009) | 1 line

add sanity check - did we create any orphan annotations?
------------------------------------------------------------------------
r11809 | reid | 2009-08-04 17:56:56 -0500 (Tue, 04 Aug 2009) | 4 lines

Merged from Michael:

#960 investigate duplicate annot_bs

------------------------------------------------------------------------
r11716 | reid | 2009-07-30 16:02:09 -0500 (Thu, 30 Jul 2009) | 4 lines

Merge from Michael:

#972 revisit structure of GPX export

------------------------------------------------------------------------
r11713 | reid | 2009-07-30 14:20:28 -0500 (Thu, 30 Jul 2009) | 4 lines

Merge from me:

#961 revert: doesn't property restore notes on merged byways

------------------------------------------------------------------------
r11707 | reid | 2009-07-30 13:16:02 -0500 (Thu, 30 Jul 2009) | 7 lines

Merged from Jordan:

#518 route finding: show start/end points even if no route can be found

This also speeds route finding greatly in the normal case.


------------------------------------------------------------------------
r11651 | sheppard | 2009-07-24 16:45:37 -0500 (Fri, 24 Jul 2009) | 1 line

changed CycloAuth.php to use db password (fixes #738)
------------------------------------------------------------------------
r11639 | reid | 2009-07-23 18:51:12 -0500 (Thu, 23 Jul 2009) | 4 lines

Merged from Michael:

#965 inappropriate disconnection of blocks

------------------------------------------------------------------------
r11637 | reid | 2009-07-23 18:40:05 -0500 (Thu, 23 Jul 2009) | 4 lines

Merge from Fernando:

#951: attachments: dirty attachments aren't preserved on login/out

------------------------------------------------------------------------
r11635 | reid | 2009-07-23 18:20:47 -0500 (Thu, 23 Jul 2009) | 4 lines

Merge from Michael:

#942: notes panel: fix 'add to'/'remove from'

------------------------------------------------------------------------
r11627 | reid | 2009-07-23 14:58:09 -0500 (Thu, 23 Jul 2009) | 1 line

don't need this script any more
------------------------------------------------------------------------
r11595 | reid | 2009-07-20 13:47:10 -0500 (Mon, 20 Jul 2009) | 1 line

fix typo
------------------------------------------------------------------------
r11588 | reid | 2009-07-17 19:17:52 -0500 (Fri, 17 Jul 2009) | 1 line

partial fix to Facebook link sharing (#966)
------------------------------------------------------------------------
r11586 | reid | 2009-07-17 18:34:54 -0500 (Fri, 17 Jul 2009) | 1 line

merge home page fixed from Jordan
------------------------------------------------------------------------
r11572 | reid | 2009-07-16 14:41:07 -0500 (Thu, 16 Jul 2009) | 1 line

merge new home page
------------------------------------------------------------------------
r11571 | reid | 2009-07-16 12:40:00 -0500 (Thu, 16 Jul 2009) | 1 line

home page as of July 16, 2009
------------------------------------------------------------------------
r11570 | reid | 2009-07-16 12:39:39 -0500 (Thu, 16 Jul 2009) | 1 line

home page as of July 7, 2009
------------------------------------------------------------------------
r11564 | reid | 2009-07-15 17:51:48 -0500 (Wed, 15 Jul 2009) | 1 line

install new logo icon and new color
------------------------------------------------------------------------
r11554 | reid | 2009-07-14 19:11:26 -0500 (Tue, 14 Jul 2009) | 4 lines

Merge from Mikhil:

#858 watch regions: enable batching of notification e-mails

------------------------------------------------------------------------
r11508 | reid | 2009-07-10 16:27:00 -0500 (Fri, 10 Jul 2009) | 5 lines

Merged from Michael:

#947 continuous throbber spinning, high cpu usage


------------------------------------------------------------------------
r11505 | reid | 2009-07-10 16:08:12 -0500 (Fri, 10 Jul 2009) | 5 lines

Merged from Fernando:

#933 add tagging stats to usage scripts


------------------------------------------------------------------------
r11477 | reid | 2009-07-09 16:31:17 -0500 (Thu, 09 Jul 2009) | 5 lines

Merged from Fernando:

#404 aerial photos: translucent blocks (NF 2.9)


------------------------------------------------------------------------
r11473 | reid | 2009-07-09 16:20:29 -0500 (Thu, 09 Jul 2009) | 5 lines

Merged from Fernando:

#933 add tagging stats to usage scripts


------------------------------------------------------------------------
r11471 | reid | 2009-07-09 16:07:17 -0500 (Thu, 09 Jul 2009) | 5 lines

Merged from Michael:

#940 private changes: warn on exit


------------------------------------------------------------------------
r11464 | reid | 2009-07-09 15:34:04 -0500 (Thu, 09 Jul 2009) | 1 line

make stale browser complaint a little better (#945)
------------------------------------------------------------------------
r11463 | reid | 2009-07-09 15:33:18 -0500 (Thu, 09 Jul 2009) | 1 line

make stale browser complaint a little better (#945)
------------------------------------------------------------------------
r11435 | reid | 2009-07-07 17:50:44 -0500 (Tue, 07 Jul 2009) | 1 line

be less noisy
------------------------------------------------------------------------
r11434 | reid | 2009-07-07 17:50:26 -0500 (Tue, 07 Jul 2009) | 1 line

add option to copy apache_event too
------------------------------------------------------------------------
r11235 | reid | 2009-06-17 17:19:38 -0500 (Wed, 17 Jun 2009) | 5 lines

Merged from Michael:

#923 install a route widget on the cyclopath.org front page


------------------------------------------------------------------------
r11233 | reid | 2009-06-17 17:10:43 -0500 (Wed, 17 Jun 2009) | 5 lines

Merged from Michael:

#913 add vertex: fails with Watch Region


------------------------------------------------------------------------
r11232 | reid | 2009-06-17 17:02:44 -0500 (Wed, 17 Jun 2009) | 5 lines

Merged from Fernando:

#404 aerial photos: translucent blocks (NF 2.9)


------------------------------------------------------------------------
r11229 | reid | 2009-06-17 16:44:14 -0500 (Wed, 17 Jun 2009) | 6 lines

Merged:

#914 routefinding: log host, source of request
#915 tagging: a little encouragement text


------------------------------------------------------------------------
r11228 | reid | 2009-06-17 16:21:06 -0500 (Wed, 17 Jun 2009) | 2 lines

Exclude researchers from the usage graphs. (#935)

------------------------------------------------------------------------
r11223 | reid | 2009-06-17 12:51:50 -0500 (Wed, 17 Jun 2009) | 3 lines

Merged from Michael: #720 Don't drag map unexpectedly


------------------------------------------------------------------------
r11213 | reid | 2009-06-16 19:01:18 -0500 (Tue, 16 Jun 2009) | 1 line

merged: Michael, exporting routes as GPX
------------------------------------------------------------------------
r11210 | reid | 2009-06-16 18:07:53 -0500 (Tue, 16 Jun 2009) | 4 lines

Include Cyclopath version number (i.e., branch name) in watch region e-mails
so that I stop freaking out when people make test edits on dev/test boxes.


------------------------------------------------------------------------
r11208 | reid | 2009-06-16 17:45:39 -0500 (Tue, 16 Jun 2009) | 4 lines

Merged from Anthony:
1. #628 watch region e-mails don't give IPs of anonymous users
2. #637 wfs_op_base.Op_Handler.username: remove

------------------------------------------------------------------------
r11173 | reid | 2009-06-12 19:31:41 -0500 (Fri, 12 Jun 2009) | 1 line

merge from Fernando: draw tags differently if on not all selected blocks (#922)
------------------------------------------------------------------------
r11171 | reid | 2009-06-12 19:27:10 -0500 (Fri, 12 Jun 2009) | 1 line

merge Mikhil's researcher list into database (#598)
------------------------------------------------------------------------
r11169 | reid | 2009-06-12 19:07:33 -0500 (Fri, 12 Jun 2009) | 1 line

complain if printer friendly directions don't open (#921)
------------------------------------------------------------------------
r11166 | reid | 2009-06-12 18:40:45 -0500 (Fri, 12 Jun 2009) | 1 line

minor cleanups
------------------------------------------------------------------------
r11158 | reid | 2009-06-12 12:24:49 -0500 (Fri, 12 Jun 2009) | 1 line

improve usage analysis scripts
------------------------------------------------------------------------
r11105 | reid | 2009-06-08 18:18:46 -0500 (Mon, 08 Jun 2009) | 1 line

clean up manual endpoint calculations (#423)
------------------------------------------------------------------------
r11104 | reid | 2009-06-08 17:55:48 -0500 (Mon, 08 Jun 2009) | 1 line

fix obscure routed crash (#903)
------------------------------------------------------------------------
r11103 | reid | 2009-06-08 17:53:54 -0500 (Mon, 08 Jun 2009) | 1 line

clean up unneeded tables (#928)
------------------------------------------------------------------------
r11099 | reid | 2009-06-08 17:33:12 -0500 (Mon, 08 Jun 2009) | 1 line

make the message you get when you click the How can I help deep link a little less stupid (#824)
------------------------------------------------------------------------
r11098 | reid | 2009-06-08 17:30:27 -0500 (Mon, 08 Jun 2009) | 1 line

Clarify Discard Changes warning dialogs (#864)
------------------------------------------------------------------------
r11096 | reid | 2009-06-08 17:08:45 -0500 (Mon, 08 Jun 2009) | 1 line

merge route widget source tagging (#902)
------------------------------------------------------------------------
r11095 | reid | 2009-06-08 16:47:18 -0500 (Mon, 08 Jun 2009) | 1 line

Add What's New? to splash (#918)
------------------------------------------------------------------------
r11086 | reid | 2009-06-05 17:51:29 -0500 (Fri, 05 Jun 2009) | 1 line

merge geodiff fix (#908)
------------------------------------------------------------------------
r11085 | reid | 2009-06-05 17:34:11 -0500 (Fri, 05 Jun 2009) | 1 line

create script to analyze disk usage in database
------------------------------------------------------------------------
r11069 | reid | 2009-06-03 18:30:54 -0500 (Wed, 03 Jun 2009) | 1 line

move talks to cp-scholarly
------------------------------------------------------------------------
r10745 | reid | 2009-05-22 16:04:12 -0500 (Fri, 22 May 2009) | 1 line

merge Michael's route fixes (#909)
------------------------------------------------------------------------
r10620 | reid | 2009-05-08 15:33:00 -0500 (Fri, 08 May 2009) | 1 line

merge embeddable widget
------------------------------------------------------------------------
r10602 | reid | 2009-05-05 15:32:17 -0500 (Tue, 05 May 2009) | 1 line

let environment variable override database; lame config leak into SVN
------------------------------------------------------------------------
r10574 | reid | 2009-04-30 19:03:53 -0500 (Thu, 30 Apr 2009) | 4 lines

Merged from releases/29:

make table_columns() work correctly in the face of dropped columns

------------------------------------------------------------------------
r10565 | reid | 2009-04-30 15:10:20 -0500 (Thu, 30 Apr 2009) | 1 line

merge favicon.ico symlink fix from Andrew
------------------------------------------------------------------------
r10562 | reid | 2009-04-30 14:52:48 -0500 (Thu, 30 Apr 2009) | 1 line

merge style fix from Fernando (#896)
------------------------------------------------------------------------
r10556 | reid | 2009-04-30 10:08:54 -0500 (Thu, 30 Apr 2009) | 2 lines

Merge rest of final tagging stuff (doh!).

------------------------------------------------------------------------
r10555 | reid | 2009-04-30 10:01:20 -0500 (Thu, 30 Apr 2009) | 2 lines

Merge final tagging stuff (lots of bugs).

------------------------------------------------------------------------
r10313 | reid | 2009-04-14 14:50:39 -0500 (Tue, 14 Apr 2009) | 2 lines

Merge tag filtering branch. (#776, #859, #860, #867, #869)

------------------------------------------------------------------------
r10206 | sheppard | 2009-04-03 14:50:25 -0500 (Fri, 03 Apr 2009) | 1 line

fix comments
------------------------------------------------------------------------
r10189 | reid | 2009-04-03 12:47:24 -0500 (Fri, 03 Apr 2009) | 2 lines

Merged: address length in Routes panel (#832), thanks Michael

------------------------------------------------------------------------
r10187 | reid | 2009-04-03 12:20:07 -0500 (Fri, 03 Apr 2009) | 2 lines

Merged: send watch region e-mails for reverts (#845), thanks Anthony.

------------------------------------------------------------------------
r10175 | reid | 2009-04-02 18:44:56 -0500 (Thu, 02 Apr 2009) | 3 lines

Work-in-progress: these scripts load Apache logs into the database. May be
useful in work hints analysis.

------------------------------------------------------------------------
r10174 | reid | 2009-04-02 18:43:33 -0500 (Thu, 02 Apr 2009) | 2 lines

Merge tagging branch - #582 and dozens of other bugs. Nice work guys!!

------------------------------------------------------------------------
r10172 | reid | 2009-04-02 18:10:54 -0500 (Thu, 02 Apr 2009) | 3 lines

Merge Jordan's e-mail cleanups (#484, #576, #602) and revision feedback dialog
fix (#591).

------------------------------------------------------------------------
r10146 | reid | 2009-04-01 12:34:52 -0500 (Wed, 01 Apr 2009) | 1 line

rect can produce its WKT format
------------------------------------------------------------------------
r10084 | reid | 2009-03-27 18:09:27 -0500 (Fri, 27 Mar 2009) | 1 line

add Flex version check
------------------------------------------------------------------------
r10075 | reid | 2009-03-26 23:19:42 -0500 (Thu, 26 Mar 2009) | 1 line

rm vacuums, which can't run inside a transaction
------------------------------------------------------------------------
r10073 | reid | 2009-03-26 18:50:10 -0500 (Thu, 26 Mar 2009) | 1 line

do these tweaks stop the constraint failure?
------------------------------------------------------------------------
r10069 | reid | 2009-03-26 15:17:42 -0500 (Thu, 26 Mar 2009) | 1 line

add number of participating users; fix bug in revisions stat
------------------------------------------------------------------------
r10049 | reid | 2009-03-25 15:48:08 -0500 (Wed, 25 Mar 2009) | 1 line

put in experiment start date/time
------------------------------------------------------------------------
r10009 | sheppard | 2009-03-23 13:26:32 -0500 (Mon, 23 Mar 2009) | 1 line

replaced favicon with logo version (fixes #700)
------------------------------------------------------------------------
r10000 | sheppard | 2009-03-20 12:19:45 -0500 (Fri, 20 Mar 2009) | 1 line

added favicon (fixes #700)
------------------------------------------------------------------------
r9999 | sheppard | 2009-03-20 12:19:44 -0500 (Fri, 20 Mar 2009) | 1 line

updated to current version of logo (fixes #305)
------------------------------------------------------------------------
r9970 | reid | 2009-03-17 17:20:13 -0500 (Tue, 17 Mar 2009) | 1 line

move out of main sequence because it won't be applied in sequence
------------------------------------------------------------------------
r9967 | reid | 2009-03-17 16:33:00 -0500 (Tue, 17 Mar 2009) | 1 line

add script to delete bike paths which obscure other blocks
------------------------------------------------------------------------
r9952 | reid | 2009-03-16 17:36:44 -0500 (Mon, 16 Mar 2009) | 2 lines

Merge intersection builder fix (#837)

------------------------------------------------------------------------
r9950 | reid | 2009-03-16 16:26:23 -0500 (Mon, 16 Mar 2009) | 1 line

count watch regions correctly
------------------------------------------------------------------------
r9886 | reid | 2009-03-12 18:15:28 -0500 (Thu, 12 Mar 2009) | 1 line

add work hints experiment analysis scripts
------------------------------------------------------------------------
r9853 | reid | 2009-03-10 18:07:37 -0500 (Tue, 10 Mar 2009) | 2 lines

Fix bad assumption.

------------------------------------------------------------------------
r9844 | reid | 2009-03-10 16:32:54 -0500 (Tue, 10 Mar 2009) | 2 lines

Merge Anthony's work on watch region e-mail friendliness. (#815)

------------------------------------------------------------------------
r9840 | reid | 2009-03-10 15:32:24 -0500 (Tue, 10 Mar 2009) | 4 lines

1. Merge Michael's Routing panel fix (#798).
2. Add ellipses on cut-off addresses in Routing panel.
3. Make Microsoft MapPoint stop giving 404s, I think. ???

------------------------------------------------------------------------
r9838 | reid | 2009-03-10 12:16:59 -0500 (Tue, 10 Mar 2009) | 2 lines

Merge Google Analytics fix. (#812)

------------------------------------------------------------------------
r9795 | reid | 2009-03-06 17:55:35 -0600 (Fri, 06 Mar 2009) | 2 lines

deal with open-ended trials (#829)

------------------------------------------------------------------------
r9774 | reid | 2009-03-06 15:15:12 -0600 (Fri, 06 Mar 2009) | 3 lines

1. Stop crash when invalid log line is encountered.
2. Word-wrap work hints detail panel correctly.

------------------------------------------------------------------------
r9773 | reid | 2009-03-06 15:02:04 -0600 (Fri, 06 Mar 2009) | 3 lines

1. Correct count of unrated blocks slightly.
2. Performance improvement in selecting blocks needing ratings.

------------------------------------------------------------------------
r9764 | reid | 2009-03-05 18:56:42 -0600 (Thu, 05 Mar 2009) | 1 line

rm obsolete fixme. This completes #707
------------------------------------------------------------------------
r9763 | reid | 2009-03-05 18:54:01 -0600 (Thu, 05 Mar 2009) | 4 lines

Clean up wording in Work Hint Details panel.

This completes #827.

------------------------------------------------------------------------
r9762 | reid | 2009-03-05 18:30:52 -0600 (Thu, 05 Mar 2009) | 2 lines

Don't count blocks with differing bridge levels as missed-X.

------------------------------------------------------------------------
r9761 | reid | 2009-03-05 18:28:33 -0600 (Thu, 05 Mar 2009) | 2 lines

Various wording changes.

------------------------------------------------------------------------
r9758 | reid | 2009-03-05 17:10:06 -0600 (Thu, 05 Mar 2009) | 2 lines

Prevent edit summaries during experiment.

------------------------------------------------------------------------
r9755 | reid | 2009-03-05 16:18:30 -0600 (Thu, 05 Mar 2009) | 6 lines

1. Robustify UI.popup_present() infrastructure (PopUpManagerChildList.POUP
   causes popups to stack underneath one another... yeccch.)
2. Text improvements in consent dialog.
3. Text improvements in opt out dialog.


------------------------------------------------------------------------
r9754 | reid | 2009-03-05 15:52:01 -0600 (Thu, 05 Mar 2009) | 3 lines

1. Add appropriate glow around Suggest Work button.
2. Add a button which pops up the Instructions dialog box.

------------------------------------------------------------------------
r9753 | reid | 2009-03-05 15:24:31 -0600 (Thu, 05 Mar 2009) | 3 lines

Add a one-minute grace period after trial completion when we still consider
activity to be part of the trial. (#826)

------------------------------------------------------------------------
r9752 | reid | 2009-03-05 14:52:02 -0600 (Thu, 05 Mar 2009) | 4 lines

I think this solves the problem of the solicitation widget showing up on top
of the splash screen, but since that's a race condition I'm not 100% sure. We'll see. (#825)


------------------------------------------------------------------------
r9742 | reid | 2009-03-04 14:20:34 -0600 (Wed, 04 Mar 2009) | 2 lines

Implement "do another" dialog. (#760)

------------------------------------------------------------------------
r9739 | reid | 2009-03-04 13:33:44 -0600 (Wed, 04 Mar 2009) | 2 lines

Merge node builder fixes from br/masli_ib-misc_820. (#820)

------------------------------------------------------------------------
r9737 | reid | 2009-03-03 16:37:16 -0600 (Tue, 03 Mar 2009) | 2 lines

Record wfs_GetWHTrial.fetch() performance. (#807)

------------------------------------------------------------------------
r9732 | reid | 2009-03-03 16:11:50 -0600 (Tue, 03 Mar 2009) | 2 lines

Add new users or users with no familiarity to the experiment. (#740)

------------------------------------------------------------------------
r9730 | reid | 2009-03-03 15:59:10 -0600 (Tue, 03 Mar 2009) | 2 lines

Make familiarity-compute.sql re-runnable during experiment. (#740)

------------------------------------------------------------------------
r9724 | reid | 2009-03-03 15:01:49 -0600 (Tue, 03 Mar 2009) | 3 lines

Better message when suggest work deep link is followed and experiment is
turned off. (#805)

------------------------------------------------------------------------
r9723 | reid | 2009-03-03 14:49:35 -0600 (Tue, 03 Mar 2009) | 2 lines

Tweak Suggest Work button according to Joe's suggestion.

------------------------------------------------------------------------
r9688 | reid | 2009-02-27 20:23:09 -0600 (Fri, 27 Feb 2009) | 2 lines

Merge user partitioning. (#625)

------------------------------------------------------------------------
r9686 | reid | 2009-02-27 19:01:56 -0600 (Fri, 27 Feb 2009) | 2 lines

Merge spontaneous disconnection bugfix (#813).

------------------------------------------------------------------------
r9684 | reid | 2009-02-27 18:50:58 -0600 (Fri, 27 Feb 2009) | 2 lines

Merge crash on returning to original location after work hints trial (#814).

------------------------------------------------------------------------
r9683 | reid | 2009-02-27 18:46:54 -0600 (Fri, 27 Feb 2009) | 2 lines

Fix geocoding KeyError failure.

------------------------------------------------------------------------
r9682 | reid | 2009-02-27 18:23:16 -0600 (Fri, 27 Feb 2009) | 1 line

fix typo
------------------------------------------------------------------------
r9680 | reid | 2009-02-27 18:07:08 -0600 (Fri, 27 Feb 2009) | 4 lines

Make intersection builder active in terms of screen pixels, not map distance.
(#811)


------------------------------------------------------------------------
r9678 | reid | 2009-02-27 17:46:48 -0600 (Fri, 27 Feb 2009) | 2 lines

Remove spurious solicitation.

------------------------------------------------------------------------
r9677 | reid | 2009-02-27 17:43:01 -0600 (Fri, 27 Feb 2009) | 2 lines

Merge T-intersection detector failing to detect. (#799)

------------------------------------------------------------------------
r9675 | reid | 2009-02-27 17:18:13 -0600 (Fri, 27 Feb 2009) | 4 lines

Merge Suggest Work button reappearing after idle, though with heavy
modification. (#706)


------------------------------------------------------------------------
r9666 | reid | 2009-02-27 13:29:34 -0600 (Fri, 27 Feb 2009) | 6 lines

Merge color flattening (#732) and showing the right type of hints (#781).

Note that I didn't flatten as fully as we'd discussed, because I thought it
was confusing. We can discuss this at the final critique.


------------------------------------------------------------------------
r9653 | reid | 2009-02-26 19:48:40 -0600 (Thu, 26 Feb 2009) | 2 lines

Merge aerial photo logging (#668).

------------------------------------------------------------------------
r9652 | reid | 2009-02-26 19:36:51 -0600 (Thu, 26 Feb 2009) | 4 lines

Merge choosing viewport with minimum number n of work hints. (#764)

I chose n = 2. It just felt like a better choice than 3.

------------------------------------------------------------------------
r9651 | reid | 2009-02-26 19:14:33 -0600 (Thu, 26 Feb 2009) | 5 lines

Decrease the probability of viewport collisions slightly (to 0.01 collisions
per day using rather pessimistic assumptions), by increasing the offset along
a shared random viewport order to a random choice in (0,39). We can't use a
random offset in (0,30000) because access time is linear by offset.

------------------------------------------------------------------------
r9650 | reid | 2009-02-26 18:59:37 -0600 (Thu, 26 Feb 2009) | 2 lines

Don't show bogus consent form request.

------------------------------------------------------------------------
r9649 | reid | 2009-02-26 18:53:56 -0600 (Thu, 26 Feb 2009) | 2 lines

Merged daily limit on work units (#714).

------------------------------------------------------------------------
r9646 | reid | 2009-02-26 17:41:10 -0600 (Thu, 26 Feb 2009) | 2 lines

Return to original area correctly if zoom level != 15. (#808)

------------------------------------------------------------------------
r9643 | reid | 2009-02-26 16:46:04 -0600 (Thu, 26 Feb 2009) | 2 lines

Merge force save/discard when entering/exiting trial. (#761)

------------------------------------------------------------------------
r9640 | reid | 2009-02-26 16:21:22 -0600 (Thu, 26 Feb 2009) | 2 lines

Merge auto-check-off of work hints (#756).

------------------------------------------------------------------------
r9629 | reid | 2009-02-24 20:09:29 -0600 (Tue, 24 Feb 2009) | 6 lines

1. A few SQL fixes.

Merge:
2. Popping up a dialog if experimental viewports are unavailable. (Bug #763)
3. Excluding familiarity points earned during trial. (Bug # 741)

------------------------------------------------------------------------
r9618 | reid | 2009-02-23 17:31:17 -0600 (Mon, 23 Feb 2009) | 2 lines

Merge MetroGIS geocoder from Fernando (#685).

------------------------------------------------------------------------
r9613 | reid | 2009-02-23 10:28:39 -0600 (Mon, 23 Feb 2009) | 2 lines

Merge connectivity widget drawing fix from release/27 branch (r9612).

------------------------------------------------------------------------
r9606 | reid | 2009-02-20 18:43:19 -0600 (Fri, 20 Feb 2009) | 2 lines

don't need these tags; they're to facilitate removal of experiment code later.

------------------------------------------------------------------------
r9603 | reid | 2009-02-20 18:28:28 -0600 (Fri, 20 Feb 2009) | 2 lines

Merge route-finding deep link (#745).

------------------------------------------------------------------------
r9598 | reid | 2009-02-20 17:57:27 -0600 (Fri, 20 Feb 2009) | 2 lines

Merge nagging less about spatially large changes. (#782)

------------------------------------------------------------------------
r9596 | reid | 2009-02-20 17:49:36 -0600 (Fri, 20 Feb 2009) | 2 lines

Merge new point labeling code. (#144, yay!)

------------------------------------------------------------------------
r9592 | reid | 2009-02-20 16:36:27 -0600 (Fri, 20 Feb 2009) | 2 lines

rm more mergeinfo on files???

------------------------------------------------------------------------
r9589 | reid | 2009-02-20 16:05:18 -0600 (Fri, 20 Feb 2009) | 4 lines

Removing mergeinfo from these files... how did it get there? I think it's
causing problems.


------------------------------------------------------------------------
r9588 | reid | 2009-02-20 16:01:46 -0600 (Fri, 20 Feb 2009) | 2 lines

Merge a couple of intersection builder bugfixes. (#783, #784)

------------------------------------------------------------------------
r9563 | reid | 2009-02-17 19:13:49 -0600 (Tue, 17 Feb 2009) | 2 lines

Don't show work hints that bulge outside the experiment viewport. (#794)

------------------------------------------------------------------------
r9562 | reid | 2009-02-17 18:51:21 -0600 (Tue, 17 Feb 2009) | 2 lines

Don't serve the same viewport to the same user more than once. (#742)

------------------------------------------------------------------------
r9561 | reid | 2009-02-17 18:26:01 -0600 (Tue, 17 Feb 2009) | 6 lines

1. Only do the disjoint-from-viewport filtering in vector mode.

2. Really choose viewports randomly in the random condition (#785). This was a
   lot harder than it looked due to performance issues. :(


------------------------------------------------------------------------
r9532 | reid | 2009-02-13 18:54:22 -0600 (Fri, 13 Feb 2009) | 2 lines

Make Mikhil's suggested adjustment to #762.

------------------------------------------------------------------------
r9531 | reid | 2009-02-13 18:45:33 -0600 (Fri, 13 Feb 2009) | 1 line

merge br/reid_wh-work-avail_762
------------------------------------------------------------------------
r9521 | reid | 2009-02-13 16:19:16 -0600 (Fri, 13 Feb 2009) | 3 lines

Pool of experiment viewports covers 7-county metro uniformly, without regard
to previous viewing by anyone. (#778)

------------------------------------------------------------------------
r9514 | reid | 2009-02-12 17:51:48 -0600 (Thu, 12 Feb 2009) | 2 lines

Fix stray node widgets.

------------------------------------------------------------------------
r9511 | reid | 2009-02-12 17:21:45 -0600 (Thu, 12 Feb 2009) | 2 lines

Merge intersection builder. (#623, #726, #728, #737, #757)

------------------------------------------------------------------------
r9507 | reid | 2009-02-12 14:46:14 -0600 (Thu, 12 Feb 2009) | 6 lines

Couple of improvements on intersection visualization:

1. Don't draw the viz on zoom level 15 (first vector level).
2. Draw viz properly when blocks are moved.


------------------------------------------------------------------------
r9502 | reid | 2009-02-11 14:21:34 -0600 (Wed, 11 Feb 2009) | 2 lines

merged br/mludwig_compact-saves_614

------------------------------------------------------------------------
r9489 | reid | 2009-02-10 17:29:56 -0600 (Tue, 10 Feb 2009) | 2 lines

Log familiarity when giving out a trial viewport. (#765)

------------------------------------------------------------------------
r9487 | reid | 2009-02-10 16:29:27 -0600 (Tue, 10 Feb 2009) | 2 lines

A simple indicator at intersections. (#691)

------------------------------------------------------------------------
r9463 | reid | 2009-02-06 18:33:20 -0600 (Fri, 06 Feb 2009) | 9 lines

(Misbehaving and commiting a mess of small things, because I was waiting on the
database while I did other work.)

1. Misc bug fixes in the work hints stuff.
2. Add/edit/remove notes now earns familiarity points (#743).
3. Byway rating changes are now logged (#622).
4. Experiment flow cleanups (#731).


------------------------------------------------------------------------
r9412 | reid | 2009-01-29 18:40:25 -0600 (Thu, 29 Jan 2009) | 3 lines

Rating-needed hints now work. (#657, #662, #758.) Thanks to Mikhil who
implemented #657, but I couldn't test it until now.

------------------------------------------------------------------------
r9366 | reid | 2009-01-23 18:59:11 -0600 (Fri, 23 Jan 2009) | 2 lines

Merge Reid's viewport/experiment flow work.

------------------------------------------------------------------------
r9332 | reid | 2009-01-20 17:05:32 -0600 (Tue, 20 Jan 2009) | 2 lines

Remove svnmerge metadata for unneeded branches.

------------------------------------------------------------------------
r9331 | reid | 2009-01-20 17:02:09 -0600 (Tue, 20 Jan 2009) | 10 lines

Merged revisions 9246 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r9246 | mludwig | 2009-01-09 13:06:21 -0600 (Fri, 09 Jan 2009) | 1 line
  
  Fixed bug in measureTextHeight(), pw resizes correctly (Fixed Bug #639)
........


------------------------------------------------------------------------
r9330 | reid | 2009-01-20 16:53:47 -0600 (Tue, 20 Jan 2009) | 2 lines

Flubbed the last commit. Here's the rest.

------------------------------------------------------------------------
r9329 | reid | 2009-01-20 16:51:33 -0600 (Tue, 20 Jan 2009) | 16 lines

Merged Mikhil's familiarity scoring, with some tweaks.

Merged revisions 9170-9175 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/masli

........
  r9170 | masli | 2008-12-11 14:44:16 -0600 (Thu, 11 Dec 2008) | 1 line
  
  Familiarity scoring script version 1 (Bug #624)
........
  r9175 | masli | 2008-12-15 13:20:32 -0600 (Mon, 15 Dec 2008) | 1 line
  
  Familiarity Scoring Version 2 after Reid's extensive feedback (Thanks a lot, Reid!) (Bug #624)
........


------------------------------------------------------------------------
r9285 | reid | 2009-01-14 17:14:06 -0600 (Wed, 14 Jan 2009) | 3 lines

Merge overlapping work hints. The total number of geometric work hints is now
about 6,000.

------------------------------------------------------------------------
r9235 | reid | 2009-01-08 18:42:03 -0600 (Thu, 08 Jan 2009) | 2 lines

Implement nasty hack to exclude work hints that aren't within the trial bounds.

------------------------------------------------------------------------
r9234 | reid | 2009-01-08 18:01:32 -0600 (Thu, 08 Jan 2009) | 18 lines

Merged revisions 9206-9214 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r9206 | mludwig | 2008-12-30 12:54:12 -0600 (Tue, 30 Dec 2008) | 1 line
  
  Remove defaults from ban table and improve checks (Fixed Bug #507)
........
  r9207 | mludwig | 2008-12-30 13:24:16 -0600 (Tue, 30 Dec 2008) | 1 line
  
  Byway splitting properly removes new vertex (Fixed Bug #717)
........
  r9214 | mludwig | 2009-01-02 12:00:26 -0600 (Fri, 02 Jan 2009) | 1 line
  
  Remove item_details_update call in Scalar_Edit (Fixed Bug #730)
........


------------------------------------------------------------------------
r9233 | reid | 2009-01-08 17:45:49 -0600 (Thu, 08 Jan 2009) | 10 lines

Merged revisions 9186 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r9186 | mludwig | 2008-12-17 15:32:49 -0600 (Wed, 17 Dec 2008) | 1 line
  
  Point widget now sizes itself based on content and max width (Fixed Bug #639)
........


------------------------------------------------------------------------
r9232 | reid | 2009-01-08 17:21:54 -0600 (Thu, 08 Jan 2009) | 18 lines

Merged revisions 9160-9161,9163-9198 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/torre

........
  r9160 | torre | 2008-12-10 13:33:23 -0600 (Wed, 10 Dec 2008) | 2 lines
  
  Comitting partial work so that I can merge in changes from trunk.
........
  r9188 | torre | 2008-12-18 16:39:42 -0600 (Thu, 18 Dec 2008) | 2 lines
  
  Go to address revisions (Bug #718)
........
  r9198 | torre | 2008-12-22 14:21:38 -0600 (Mon, 22 Dec 2008) | 2 lines
  
  Google Analytics tracking code (Bug #724)
........


------------------------------------------------------------------------
r9230 | reid | 2009-01-08 16:52:51 -0600 (Thu, 08 Jan 2009) | 2 lines

Work hints can be fetched, manipulated, and saved. (#661)

------------------------------------------------------------------------
r9202 | reid | 2008-12-26 17:12:14 -0600 (Fri, 26 Dec 2008) | 3 lines

Completed draft script which identifies geo-editing work hints and creates
work hint objects (part of #661).

------------------------------------------------------------------------
r9196 | reid | 2008-12-19 19:45:53 -0600 (Fri, 19 Dec 2008) | 4 lines

1. Visual experiment bounding box (#710).
2. Log work hints trial parameters (#708).
3. Work hints pan & zoom tested and working (#655).

------------------------------------------------------------------------
r9173 | reid | 2008-12-12 17:32:06 -0600 (Fri, 12 Dec 2008) | 3 lines

Make AUTHENTICATED deep links work when user is not logged in, or when his/her
token is invalid and so s/he requires reauthentication.

------------------------------------------------------------------------
r9172 | reid | 2008-12-12 17:02:43 -0600 (Fri, 12 Dec 2008) | 4 lines

1. Consent form infrastructure, including opt-out and draft text (#627, #658).
2. Fix bug in suggest_work deep link (#654).


------------------------------------------------------------------------
r9164 | reid | 2008-12-10 16:06:52 -0600 (Wed, 10 Dec 2008) | 2 lines

Implement server-side config variable to turn experiment on/off. (#704)

------------------------------------------------------------------------
r9158 | reid | 2008-12-10 12:05:57 -0600 (Wed, 10 Dec 2008) | 26 lines

Merged revisions 9122-9123,9125-9139 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r9122 | mludwig | 2008-12-05 16:10:30 -0600 (Fri, 05 Dec 2008) | 1 line
  
  Implement prev/next view buttons (Fixed Bug #669)
........
  r9123 | mludwig | 2008-12-05 16:21:37 -0600 (Fri, 05 Dec 2008) | 1 line
  
  Minor edit to View_Stack, fixing a paste error
........
  r9127 | mludwig | 2008-12-05 17:06:31 -0600 (Fri, 05 Dec 2008) | 1 line
  
  Improve ban_hammer.py
........
  r9136 | mludwig | 2008-12-08 15:21:46 -0600 (Mon, 08 Dec 2008) | 1 line
  
  Byway split doesn't crash when user not logged in (Fixed Bug #711)
........
  r9139 | mludwig | 2008-12-08 15:31:27 -0600 (Mon, 08 Dec 2008) | 1 line
  
  Undone byways splits don't stay in dirty set (Fixed Bug #712)
........


------------------------------------------------------------------------
r9155 | reid | 2008-12-09 18:57:41 -0600 (Tue, 09 Dec 2008) | 4 lines

Fix #666: "please wait" for save doesn't go away if save crashes

Also, put methods in WFS.as in proper order.

------------------------------------------------------------------------
r9154 | reid | 2008-12-09 18:25:39 -0600 (Tue, 09 Dec 2008) | 28 lines

Merge a bunch of Mikhil's stuff, with tweaks.

Merged revisions 8903,8905-9117 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/masli

........
  r8903 | masli | 2008-10-27 16:29:40 -0500 (Mon, 27 Oct 2008) | 1 line
  
  [Bugs #638, #641] Fixed the pointing widget to point to geofeatures correctly.
........
  r8905 | masli | 2008-10-27 17:08:51 -0500 (Mon, 27 Oct 2008) | 1 line
  
  Undoing some test code
........
  r9075 | masli | 2008-11-25 16:53:16 -0600 (Tue, 25 Nov 2008) | 1 line
  
  Nailing the problem with IE!
........
  r9100 | masli | 2008-12-03 14:59:37 -0600 (Wed, 03 Dec 2008) | 1 line
  
  [Bug #689] Removing scrollbars: Nobody would make the window that small!
........
  r9117 | masli | 2008-12-05 12:59:15 -0600 (Fri, 05 Dec 2008) | 1 line
  
  [Bugs 654, 657, 656, 627, 655] Work Hints Clientside First Draft
........


------------------------------------------------------------------------
r9149 | reid | 2008-12-09 15:03:50 -0600 (Tue, 09 Dec 2008) | 2 lines

Correct previous commit; hope it's right this time.

------------------------------------------------------------------------
r9131 | reid | 2008-12-08 12:57:54 -0600 (Mon, 08 Dec 2008) | 4 lines

Tweak regex to silence complaints about the libwww-perl line which has
appeared in the logs.


------------------------------------------------------------------------
r9121 | reid | 2008-12-05 16:07:48 -0600 (Fri, 05 Dec 2008) | 10 lines

Merged revisions 9119 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r9119 | mludwig | 2008-12-05 15:52:57 -0600 (Fri, 05 Dec 2008) | 1 line
  
  Fixed crash in WFS_PutFeature (Fixed Bug #702)
........


------------------------------------------------------------------------
r9114 | reid | 2008-12-04 17:36:33 -0600 (Thu, 04 Dec 2008) | 14 lines

Merged revisions 8621-8644,8646-8879 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/torre

........
  r8646 | torre | 2008-10-01 14:56:34 -0500 (Wed, 01 Oct 2008) | 2 lines
  
  more merging.
........
  r8879 | torre | 2008-10-24 13:47:22 -0500 (Fri, 24 Oct 2008) | 2 lines
  
  Go To Address now works (Bug #399)
........


------------------------------------------------------------------------
r9106 | reid | 2008-12-03 18:37:30 -0600 (Wed, 03 Dec 2008) | 30 lines

Merged revisions 9015-9060,9062-9077 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r9015 | mludwig | 2008-11-07 18:03:18 -0600 (Fri, 07 Nov 2008) | 1 line
  
  Text for one-way direction updates on user click (Fixed Bug #673)
........
  r9032 | mludwig | 2008-11-14 16:22:21 -0600 (Fri, 14 Nov 2008) | 1 line
  
  Fixed user rating transfer in split blocks (Fixed Bug #517)
........
  r9037 | mludwig | 2008-11-17 12:12:48 -0600 (Mon, 17 Nov 2008) | 1 line
  
  Split blocks saving is handled better in client (re-fixed Bug #517)
........
  r9063 | mludwig | 2008-11-21 17:37:56 -0600 (Fri, 21 Nov 2008) | 1 line
  
  Modify Byway_Vertex to not drag duplicates (Fixed Bug #686)
........
  r9065 | mludwig | 2008-11-24 13:00:36 -0600 (Mon, 24 Nov 2008) | 1 line
  
  Minor style change to last bug fix
........
  r9077 | mludwig | 2008-11-25 19:18:50 -0600 (Tue, 25 Nov 2008) | 1 line
  
  Removed unnecessary variable
........


------------------------------------------------------------------------
r9105 | reid | 2008-12-03 18:19:21 -0600 (Wed, 03 Dec 2008) | 24 lines

Merge Michael's ban hammer script.

Merged revisions 8991-9014 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r8991 | mludwig | 2008-11-05 18:20:14 -0600 (Wed, 05 Nov 2008) | 1 line
  
  Initial support for user/ip banning. Fixed (Bug #611)
........
  r9011 | mludwig | 2008-11-07 17:17:24 -0600 (Fri, 07 Nov 2008) | 1 line
  
  Changed ban semantics from private/public to public/full (Fixed Bug #669)
........
  r9012 | mludwig | 2008-11-07 17:21:47 -0600 (Fri, 07 Nov 2008) | 1 line
  
  db quoted username in client_ban (Fixed Bug #672)
........
  r9014 | mludwig | 2008-11-07 17:51:42 -0600 (Fri, 07 Nov 2008) | 1 line
  
  Improved popups when a banned user attempts save (Fixed Bug #671)
........


------------------------------------------------------------------------
r9102 | reid | 2008-12-03 16:24:15 -0600 (Wed, 03 Dec 2008) | 14 lines

Merged revisions 8884-8921,8923,8925-8943 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r8891 | mludwig | 2008-10-24 17:34:32 -0500 (Fri, 24 Oct 2008) | 1 line
  
  Make the detail panels interactive while in raster mode (Fixed Bug #435)
........
  r8943 | mludwig | 2008-10-31 16:21:07 -0500 (Fri, 31 Oct 2008) | 1 line
  
  Patched conf.py to write to the correct log files
........


------------------------------------------------------------------------
r9097 | reid | 2008-12-02 18:07:53 -0600 (Tue, 02 Dec 2008) | 32 lines

Merge Andrew's stuff with tweaks.

Merged revisions 8925-8930 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/sheppard

........
  r8925 | sheppard | 2008-10-29 17:34:07 -0500 (Wed, 29 Oct 2008) | 1 line
  
  WFS Timeout Timer (Fixes #340)
........
  r8926 | sheppard | 2008-10-29 18:24:08 -0500 (Wed, 29 Oct 2008) | 1 line
  
  Simplified username filter entry per discussion; also now matches on partial usernames & hostnames. (Fixes #617)
........
  r8927 | sheppard | 2008-10-29 18:51:01 -0500 (Wed, 29 Oct 2008) | 1 line
  
  Created logos directory, added original logo version.
........
  r8928 | sheppard | 2008-10-29 18:55:11 -0500 (Wed, 29 Oct 2008) | 1 line
  
  Logo skyline version (8/27)
........
  r8929 | sheppard | 2008-10-29 18:56:15 -0500 (Wed, 29 Oct 2008) | 1 line
  
  Logo skyline version (8/27)
........
  r8930 | sheppard | 2008-10-29 19:00:16 -0500 (Wed, 29 Oct 2008) | 1 line
  
  Logo - realistic spokes (10/23)
........


------------------------------------------------------------------------
r9083 | reid | 2008-11-26 17:24:52 -0600 (Wed, 26 Nov 2008) | 13 lines

We'd discussed this change last month and decided it wasn't ready to be merged
yet, requiring significant updates. I'm blocking it using svnmerge, but only
for convenience; it's easy enough to merge in later.

Blocked revisions 8784 via svnmerge

........
  r8784 | masli | 2008-10-16 14:25:32 -0500 (Thu, 16 Oct 2008) | 1 line
  
  [Bug # 613] Limiting saves by users less than 5 days old to 10.
........


------------------------------------------------------------------------
r9082 | reid | 2008-11-26 17:21:28 -0600 (Wed, 26 Nov 2008) | 3 lines

Initialized merge tracking via "svnmerge" with revisions "1-8941" from 
file:///project/Grouplens/svn/cyclingproject/branches/focht

------------------------------------------------------------------------
r8936 | reid | 2008-10-30 15:59:59 -0500 (Thu, 30 Oct 2008) | 2 lines

fix crash on save

------------------------------------------------------------------------
r8935 | reid | 2008-10-30 14:53:32 -0500 (Thu, 30 Oct 2008) | 10 lines

Merged revisions 8924 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r8924 | mludwig | 2008-10-29 17:07:10 -0500 (Wed, 29 Oct 2008) | 1 line
  
  Text fields no longer lose focus (Fixed Bug #664)
........


------------------------------------------------------------------------
r8912 | reid | 2008-10-28 14:16:16 -0500 (Tue, 28 Oct 2008) | 10 lines

Merged revisions 8898-8899 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/sheppard

........
  r8898 | sheppard | 2008-10-26 22:56:38 -0500 (Sun, 26 Oct 2008) | 1 line
  
  Implemented username filter (#617)
........


------------------------------------------------------------------------
r8873 | reid | 2008-10-23 19:03:53 -0500 (Thu, 23 Oct 2008) | 24 lines

Merge Mikhil's pointing widget, with many modifications.

Merged revisions 8821-8847 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/masli

........
  r8821 | masli | 2008-10-21 13:26:49 -0500 (Tue, 21 Oct 2008) | 1 line
  
  [Bug#621] Work hints: pointing widget - Implemented.
........
  r8826 | masli | 2008-10-21 13:52:50 -0500 (Tue, 21 Oct 2008) | 1 line
  
  [Bug#621] Work hints: pointing widget - Implemented.
........
  r8827 | masli | 2008-10-21 14:04:26 -0500 (Tue, 21 Oct 2008) | 1 line
  
  Previous commit [8826] was a mistake. No value in it. Undoing it with this.
........
  r8847 | masli | 2008-10-22 16:29:59 -0500 (Wed, 22 Oct 2008) | 1 line
  
  [Bug#621] Forgot to commit main.mxml
........


------------------------------------------------------------------------
r8868 | reid | 2008-10-23 15:35:39 -0500 (Thu, 23 Oct 2008) | 30 lines

Block svnmerge overhead.

Blocked revisions 8787-8791 via svnmerge

........
  r8787 | masli | 2008-10-16 16:45:14 -0500 (Thu, 16 Oct 2008) | 3 lines
  
  Initialized merge tracking via "svnmerge" with revisions "1-8786" from 
  file:///project/Grouplens/svn/cyclingproject/trunk
........
  r8788 | masli | 2008-10-16 17:01:46 -0500 (Thu, 16 Oct 2008) | 3 lines
  
  Initialized merge tracking via "svnmerge" with revisions "1-8787" from 
  file:///project/Grouplens/svn/cyclingproject/trunk
........
  r8789 | masli | 2008-10-16 17:11:46 -0500 (Thu, 16 Oct 2008) | 2 lines
  
  Init
........
  r8790 | masli | 2008-10-16 17:18:31 -0500 (Thu, 16 Oct 2008) | 3 lines
  
  Initialized merge tracking via "svnmerge" with revisions "1-8505" from 
  file:///project/Grouplens/svn/cyclingproject/trunk
........
  r8791 | masli | 2008-10-16 18:42:29 -0500 (Thu, 16 Oct 2008) | 1 line
  
  Big fat merge!
........


------------------------------------------------------------------------
r8854 | reid | 2008-10-22 18:36:39 -0500 (Wed, 22 Oct 2008) | 1 line

clean up config setting
------------------------------------------------------------------------
r8852 | reid | 2008-10-22 18:09:35 -0500 (Wed, 22 Oct 2008) | 2 lines

Rename "undo revisions" to "revert revisions" per discussion. #615

------------------------------------------------------------------------
r8851 | reid | 2008-10-22 18:00:33 -0500 (Wed, 22 Oct 2008) | 9 lines

Merged revisions 8774-8777 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/sheppard

........
  r8777 | sheppard | 2008-10-16 10:58:50 -0500 (Thu, 16 Oct 2008) | 1 line
  
  Limit number of selectable revisions (Fixes #564)
........

------------------------------------------------------------------------
r8850 | reid | 2008-10-22 17:56:20 -0500 (Wed, 22 Oct 2008) | 12 lines

Merge Andrew's bugfix w/ minor tweaks.

Merged revisions 8756 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/sheppard

........
  r8756 | sheppard | 2008-10-15 18:07:25 -0500 (Wed, 15 Oct 2008) | 1 line
  
  Improvements to max_rid processing (Fixes #609)
........


------------------------------------------------------------------------
r8849 | reid | 2008-10-22 17:42:23 -0500 (Wed, 22 Oct 2008) | 15 lines

See discussion in #508 -- block unfruitful solution attempts from being merged.

Blocked revisions 8546,8611 via svnmerge

........
  r8546 | masli | 2008-09-18 15:57:48 -0500 (Thu, 18 Sep 2008) | 1 line
  
  Showing the unsatisfactory hourglass. (Bug #508)
........
  r8611 | masli | 2008-09-25 16:23:41 -0500 (Thu, 25 Sep 2008) | 1 line
  
  Making the hourglass more satisfying.
........


------------------------------------------------------------------------
r8841 | reid | 2008-10-22 14:51:54 -0500 (Wed, 22 Oct 2008) | 16 lines

Merge Michael's split-ratings and UI work, with tweaks.

Merged revisions 8795-8832 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r8802 | mludwig | 2008-10-17 15:37:00 -0500 (Fri, 17 Oct 2008) | 1 line
  
  User ratings preserved when byways are split (Fixed Bug #517, #586)
........
  r8804 | mludwig | 2008-10-17 18:12:53 -0500 (Fri, 17 Oct 2008) | 1 line
  
  item_details_panel() behaves itself (Fixed Bug #620)
........


------------------------------------------------------------------------
r8833 | reid | 2008-10-21 17:18:50 -0500 (Tue, 21 Oct 2008) | 1 line

add convenience view
------------------------------------------------------------------------
r8832 | reid | 2008-10-21 17:16:09 -0500 (Tue, 21 Oct 2008) | 2 lines

Improve memory use and error reporting.

------------------------------------------------------------------------
r8749 | reid | 2008-10-15 15:54:48 -0500 (Wed, 15 Oct 2008) | 12 lines

Merge some geodiffing improvements from Andrew, with very minor tweaks.

Merged revisions 8608-8691,8693-8733 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/sheppard

........
  r8730 | sheppard | 2008-10-14 20:29:26 -0500 (Tue, 14 Oct 2008) | 1 line
  
  Geodiff old/new/both toggle and other improvements (fixes #601, #581, #469)
........


------------------------------------------------------------------------
r8743 | reid | 2008-10-15 15:04:43 -0500 (Wed, 15 Oct 2008) | 1 line

minor wording tweak (#610)
------------------------------------------------------------------------
r8739 | reid | 2008-10-15 13:18:26 -0500 (Wed, 15 Oct 2008) | 2 lines

Permit undoing the same revision multiple times. (#616)

------------------------------------------------------------------------
r8738 | reid | 2008-10-15 13:00:18 -0500 (Wed, 15 Oct 2008) | 10 lines

Merged revisions 8721 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/masli

........
  r8721 | masli | 2008-10-14 17:23:28 -0500 (Tue, 14 Oct 2008) | 1 line
  
  [Bug#604] Fixed minimum shoulder width for bike lane.
........


------------------------------------------------------------------------
r8720 | reid | 2008-10-14 16:58:19 -0500 (Tue, 14 Oct 2008) | 2 lines

Dump RSL stuff due to unreliability (sigh). #608.

------------------------------------------------------------------------
r8719 | reid | 2008-10-14 16:49:01 -0500 (Tue, 14 Oct 2008) | 18 lines

Merged revisions 8645-8675 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r8649 | mludwig | 2008-10-01 16:32:23 -0500 (Wed, 01 Oct 2008) | 1 line
  
  Robustify direction generation for routes (Fixed Bug #597)
........
  r8674 | mludwig | 2008-10-03 16:25:54 -0500 (Fri, 03 Oct 2008) | 1 line
  
  Refactor code in Route.as as requested for Bug #597
........
  r8675 | mludwig | 2008-10-03 17:38:43 -0500 (Fri, 03 Oct 2008) | 1 line
  
  Improve flex/html cue sheets (Fixed Bug #603)
........


------------------------------------------------------------------------
r8718 | reid | 2008-10-14 16:20:57 -0500 (Tue, 14 Oct 2008) | 12 lines

Merge Mikhil's user-protection code with minor tweaks.

Merged revisions 8665 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/masli

........
  r8665 | masli | 2008-10-02 16:40:36 -0500 (Thu, 02 Oct 2008) | 1 line
  
  Adding warning to save for unsaved changes on close of app. Also alerting user to Save button. [Bug #239]
........


------------------------------------------------------------------------
r8709 | reid | 2008-10-14 12:03:48 -0500 (Tue, 14 Oct 2008) | 1 line

merge bugfix from release 22
------------------------------------------------------------------------
r8699 | reid | 2008-10-10 18:21:31 -0500 (Fri, 10 Oct 2008) | 2 lines

Make reverting of anonymous revisions work.

------------------------------------------------------------------------
r8664 | reid | 2008-10-02 16:11:37 -0500 (Thu, 02 Oct 2008) | 2 lines

rm useless code. Thanks Michael.

------------------------------------------------------------------------
r8663 | reid | 2008-10-02 15:21:54 -0500 (Thu, 02 Oct 2008) | 2 lines

Use correct 24-hour clock in timestamp.

------------------------------------------------------------------------
r8655 | reid | 2008-10-01 17:46:23 -0500 (Wed, 01 Oct 2008) | 4 lines

Stop count-ratings.sql from including deleted byways in its counts of "byways
with n ratings". This is a drop of up to about 5%, so it will be visible on
the graphs.

------------------------------------------------------------------------
r8650 | reid | 2008-10-01 16:44:39 -0500 (Wed, 01 Oct 2008) | 12 lines

Merged Mikhil's fix for #595 with some tweaks.

Merged revisions 8639 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/masli

........
  r8639 | masli | 2008-09-30 15:55:16 -0500 (Tue, 30 Sep 2008) | 1 line
  
  Handling routes to places outside of CP
........


------------------------------------------------------------------------
r8648 | reid | 2008-10-01 16:15:28 -0500 (Wed, 01 Oct 2008) | 2 lines

Update usage statistic computation.

------------------------------------------------------------------------
r8635 | reid | 2008-09-29 17:45:03 -0500 (Mon, 29 Sep 2008) | 2 lines

Usability improvements for user-user feedback. (#593)

------------------------------------------------------------------------
r8633 | reid | 2008-09-29 12:58:23 -0500 (Mon, 29 Sep 2008) | 3 lines

1. Don't throb endlessly if a place can't be geocoded.
2. Make error message a bit more friendly. (#596)

------------------------------------------------------------------------
r8632 | reid | 2008-09-29 12:23:58 -0500 (Mon, 29 Sep 2008) | 2 lines

add db_load.sh to go along with db_clone.sh

------------------------------------------------------------------------
r8627 | reid | 2008-09-26 18:02:39 -0500 (Fri, 26 Sep 2008) | 10 lines

Merged revisions 8623 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r8623 | mludwig | 2008-09-26 17:19:12 -0500 (Fri, 26 Sep 2008) | 1 line
  
  Tool cursors now remove themselves properly when finished (Fixed Bug #417)
........


------------------------------------------------------------------------
r8626 | reid | 2008-09-26 17:53:54 -0500 (Fri, 26 Sep 2008) | 12 lines

Merged Michael's case fix with minor tweaks.

Merged revisions 8621 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r8621 | mludwig | 2008-09-26 16:12:54 -0500 (Fri, 26 Sep 2008) | 1 line
  
  Direction generation ignores case (Fixed Bug #563)
........


------------------------------------------------------------------------
r8624 | reid | 2008-09-26 17:28:19 -0500 (Fri, 26 Sep 2008) | 16 lines

Merge Mikhil's dialog box with a little tweaking.

Merged revisions 8547-8597,8599-8610,8612-8615 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/masli

........
  r8547 | masli | 2008-09-18 16:00:32 -0500 (Thu, 18 Sep 2008) | 1 line
  
  Showing the Please wait dialog while saving. (Bug #568)
........
  r8615 | masli | 2008-09-25 17:24:25 -0500 (Thu, 25 Sep 2008) | 1 line
  
  Save is not not cancelable.
........


------------------------------------------------------------------------
r8617 | reid | 2008-09-25 18:27:19 -0500 (Thu, 25 Sep 2008) | 12 lines

Merge Mikhil's button bar fix, with a few tweaks.

Merged revisions 8598 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/masli

........
  r8598 | masli | 2008-09-24 14:59:54 -0500 (Wed, 24 Sep 2008) | 1 line
  
  Making toolbar buttons greyed out when disabled.
........


------------------------------------------------------------------------
r8614 | reid | 2008-09-25 17:05:56 -0500 (Thu, 25 Sep 2008) | 4 lines

Initialized merge tracking via "svnmerge" with revisions "1-8505" from 
file:///project/Grouplens/svn/cyclingproject/branches/masli


------------------------------------------------------------------------
r8612 | reid | 2008-09-25 17:00:26 -0500 (Thu, 25 Sep 2008) | 2 lines

Auto-delete degenerate byways. (#588)

------------------------------------------------------------------------
r8597 | reid | 2008-09-24 14:15:00 -0500 (Wed, 24 Sep 2008) | 2 lines

Clean up invalid basemap polygons which were causing pyserver crashes. (#589)

------------------------------------------------------------------------
r8590 | reid | 2008-09-22 17:58:29 -0500 (Mon, 22 Sep 2008) | 28 lines

Merge from Fernando with a few tweaks.

Merged revisions 8444-8560 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/torre

........
  r8444 | torre | 2008-09-05 13:50:09 -0500 (Fri, 05 Sep 2008) | 2 lines
  
  Address_Choose box now uses Flex Validators. (Bug #506)
........
  r8449 | torre | 2008-09-05 16:01:52 -0500 (Fri, 05 Sep 2008) | 2 lines
  
  Address_Grid is now used in Find_Route_Popup. (Bug #521)
........
  r8453 | torre | 2008-09-05 16:59:36 -0500 (Fri, 05 Sep 2008) | 2 lines
  
  Resulting address is now stored after route finding and loaded into find window on next search. (Bug #516)
........
  r8532 | torre | 2008-09-16 14:50:22 -0500 (Tue, 16 Sep 2008) | 2 lines
  
  Search string in route finding is now treated as a list of keywords. (Bug #540)
........
  r8560 | torre | 2008-09-19 14:55:06 -0500 (Fri, 19 Sep 2008) | 2 lines
  
  Directions now let the user know if an unnamed path changes type. (Bug #509)
........


------------------------------------------------------------------------
r8579 | reid | 2008-09-22 15:51:05 -0500 (Mon, 22 Sep 2008) | 2 lines

merge a couple of minor fixes from the release branch

------------------------------------------------------------------------
r8567 | reid | 2008-09-19 17:44:29 -0500 (Fri, 19 Sep 2008) | 14 lines

Merged revisions 8457-8493,8495-8499 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/sheppard

........
  r8498 | sheppard | 2008-09-10 18:34:41 -0500 (Wed, 10 Sep 2008) | 1 line
  
  Minor changes to geosummary display logic (Fixes #559, #560)
........
  r8499 | sheppard | 2008-09-10 19:34:50 -0500 (Wed, 10 Sep 2008) | 1 line
  
  Implemented lookat for multiple objects (Fixes #579)
........


------------------------------------------------------------------------
r8566 | reid | 2008-09-19 17:32:14 -0500 (Fri, 19 Sep 2008) | 18 lines

Merged revisions 8509-8565 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r8509 | mludwig | 2008-09-12 17:48:58 -0500 (Fri, 12 Sep 2008) | 1 line
  
  Fix annot_bs geodiffing (Fixed Bug #578)
........
  r8510 | mludwig | 2008-09-12 17:53:48 -0500 (Fri, 12 Sep 2008) | 1 line
  
  Improve comments in annotation.py
........
  r8511 | mludwig | 2008-09-12 18:02:07 -0500 (Fri, 12 Sep 2008) | 1 line
  
  WFS_Hello handles enable_wr_email flag correctly (Fixed Bug #583)
........


------------------------------------------------------------------------
r8564 | reid | 2008-09-19 16:43:17 -0500 (Fri, 19 Sep 2008) | 2 lines

Implement user-user feedback. (#487)

------------------------------------------------------------------------
r8529 | reid | 2008-09-16 12:46:16 -0500 (Tue, 16 Sep 2008) | 1 line

merge bikeways.htm
------------------------------------------------------------------------
r8503 | reid | 2008-09-11 16:03:34 -0500 (Thu, 11 Sep 2008) | 2 lines

merge vertex add/delete fix from R19 branch

------------------------------------------------------------------------
r8493 | reid | 2008-09-10 15:24:22 -0500 (Wed, 10 Sep 2008) | 2 lines

Mapped bikeability estimates now always match route-finder. (#389)

------------------------------------------------------------------------
r8483 | reid | 2008-09-09 17:22:59 -0500 (Tue, 09 Sep 2008) | 1 line

forgot password button now works
------------------------------------------------------------------------
r8472 | reid | 2008-09-09 13:00:40 -0500 (Tue, 09 Sep 2008) | 2 lines

Encourage people to report bugs resulting in I/O error.

------------------------------------------------------------------------
r8455 | reid | 2008-09-05 17:25:23 -0500 (Fri, 05 Sep 2008) | 2 lines

Make geosummaries purtier again. #571

------------------------------------------------------------------------
r8454 | reid | 2008-09-05 17:17:40 -0500 (Fri, 05 Sep 2008) | 10 lines

Merged revisions 8419-8442 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/torre

........
  r8442 | torre | 2008-09-05 13:16:05 -0500 (Fri, 05 Sep 2008) | 2 lines
  
  RSL framework is now used to reduce SWF size. (Bug #280)
........


------------------------------------------------------------------------
r8443 | reid | 2008-09-05 13:26:16 -0500 (Fri, 05 Sep 2008) | 3 lines

1. Don't repeat WFS_Log requests on reauthenticate.
2. Fix duplicate reauth dialog. (#558)

------------------------------------------------------------------------
r8435 | reid | 2008-09-04 18:40:01 -0500 (Thu, 04 Sep 2008) | 1 line

log annotations viewed by tooltip
------------------------------------------------------------------------
r8433 | reid | 2008-09-04 16:51:53 -0500 (Thu, 04 Sep 2008) | 2 lines

Log undo/redo. (#567)

------------------------------------------------------------------------
r8431 | reid | 2008-09-04 16:18:46 -0500 (Thu, 04 Sep 2008) | 1 line

full restart isn't needed, yielding faster results and a shorter window when clients get nothing at all
------------------------------------------------------------------------
r8419 | reid | 2008-09-02 18:40:01 -0500 (Tue, 02 Sep 2008) | 10 lines

Fix 3 bugs:

1. Flash app no longer makes bogus loops when one end of a block is dragged
   over the other. (#444).

2. Add Vertex too no longer causes exception.

3. Endpoints of loop blocks can now be moved.


------------------------------------------------------------------------
r8403 | reid | 2008-08-29 16:37:29 -0500 (Fri, 29 Aug 2008) | 2 lines

Fix another stupid route-finder mistake.

------------------------------------------------------------------------
r8399 | reid | 2008-08-29 14:02:52 -0500 (Fri, 29 Aug 2008) | 1 line

merged from release 17: fix failure to reauth
------------------------------------------------------------------------
r8396 | reid | 2008-08-29 13:02:33 -0500 (Fri, 29 Aug 2008) | 1 line

turn off forced login
------------------------------------------------------------------------
r8395 | reid | 2008-08-29 12:59:25 -0500 (Fri, 29 Aug 2008) | 5 lines

Couple of minor tweaks:

1. Change "alpha" tag to "beta".
2. Help button now goes to help landing pad, not directly to the user manual.

------------------------------------------------------------------------
r8393 | reid | 2008-08-29 12:15:05 -0500 (Fri, 29 Aug 2008) | 48 lines

Merge several improvements and bugfixes from Michael.

Merged revisions 8351-8378 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r8351 | mludwig | 2008-08-27 17:24:01 -0500 (Wed, 27 Aug 2008) | 1 line
  
  annotation geodiff implemented (Fixed Bug #532)
........
  r8354 | mludwig | 2008-08-28 11:52:37 -0500 (Thu, 28 Aug 2008) | 1 line
  
  Add sql script necessary for annotation geodiffing
........
  r8356 | mludwig | 2008-08-28 12:14:42 -0500 (Thu, 28 Aug 2008) | 1 line
  
  Use geopoints real name in route finder (Fixed Bug #547)
........
  r8358 | mludwig | 2008-08-28 13:34:40 -0500 (Thu, 28 Aug 2008) | 1 line
  
  Annots are diffed correctly in panel (Fixed Bug #552)
........
  r8359 | mludwig | 2008-08-28 13:59:34 -0500 (Thu, 28 Aug 2008) | 1 line
  
  Null numeric values display correctly in historic panel (Fixed Bug #553)
........
  r8360 | mludwig | 2008-08-28 14:02:26 -0500 (Thu, 28 Aug 2008) | 1 line
  
  Fix up byway_annot entry coloring logic (Fixed Bug #555)
........
  r8375 | mludwig | 2008-08-28 16:59:42 -0500 (Thu, 28 Aug 2008) | 1 line
  
  Add a busy image for use whenever we can fix bug #508
........
  r8376 | mludwig | 2008-08-28 17:13:47 -0500 (Thu, 28 Aug 2008) | 1 line
  
  Routefinding properly clears cached geocode vars (Fixed Bug #548)
........
  r8377 | mludwig | 2008-08-28 17:34:46 -0500 (Thu, 28 Aug 2008) | 1 line
  
  Labels for static features are subdued, plus minor bug fix (Fixed Bug #302)
........
  r8378 | mludwig | 2008-08-28 17:41:33 -0500 (Thu, 28 Aug 2008) | 1 line
  
  Clean up more bugs with annotation diffing (Fixed Bug #556)
........


------------------------------------------------------------------------
r8389 | reid | 2008-08-29 11:14:55 -0500 (Fri, 29 Aug 2008) | 2 lines

Make watch regions send e-mail again in the unfiltered configuration.

------------------------------------------------------------------------
r8381 | reid | 2008-08-28 19:20:04 -0500 (Thu, 28 Aug 2008) | 4 lines

Viewport and watch regions now operate on revision geometry, not bounding box
of revision geometry. (#524)


------------------------------------------------------------------------
r8380 | reid | 2008-08-28 19:06:21 -0500 (Thu, 28 Aug 2008) | 2 lines

Implement very basic semi-protect switch. (#454)

------------------------------------------------------------------------
r8379 | reid | 2008-08-28 17:45:34 -0500 (Thu, 28 Aug 2008) | 2 lines

Scripts to fix segments which can be connected on only one end. (#444)

------------------------------------------------------------------------
r8353 | reid | 2008-08-27 18:36:14 -0500 (Wed, 27 Aug 2008) | 2 lines

Bridge node cleanups weren't always drawing correctly.

------------------------------------------------------------------------
r8352 | reid | 2008-08-27 18:07:53 -0500 (Wed, 27 Aug 2008) | 16 lines

Merge some changes from Michael, with modifications.

Merged revisions 8336-8346 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r8336 | mludwig | 2008-08-26 16:44:32 -0500 (Tue, 26 Aug 2008) | 1 line
  
  Fixed exception toggling wr checkbox (Fixed Bug #545)
........
  r8346 | mludwig | 2008-08-27 13:43:56 -0500 (Wed, 27 Aug 2008) | 1 line
  
  Server exception dumps are easier to view (Fixed Bug #543)
........


------------------------------------------------------------------------
r8350 | reid | 2008-08-27 17:19:42 -0500 (Wed, 27 Aug 2008) | 16 lines

Merge from Fernando with some modifications.

Merged revisions 8322-8325 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/torre

........
  r8322 | torre | 2008-08-26 11:34:22 -0500 (Tue, 26 Aug 2008) | 2 lines
  
  Checkbox now allows toggling sticky intersections. (Bug #501)
........
  r8325 | torre | 2008-08-26 12:17:11 -0500 (Tue, 26 Aug 2008) | 2 lines
  
  Route finding now shows error message when one of the addresses is not found. (Bug #539)
........


------------------------------------------------------------------------
r8348 | reid | 2008-08-27 14:57:43 -0500 (Wed, 27 Aug 2008) | 2 lines

Limit SQL query to current versions of byways. (#550)

------------------------------------------------------------------------
r8343 | reid | 2008-08-27 10:15:26 -0500 (Wed, 27 Aug 2008) | 1 line

merge stupid mistake from release 16 branch
------------------------------------------------------------------------
r8340 | reid | 2008-08-26 19:26:12 -0500 (Tue, 26 Aug 2008) | 1 line

add forgotten file
------------------------------------------------------------------------
r8338 | reid | 2008-08-26 18:37:59 -0500 (Tue, 26 Aug 2008) | 4 lines

Display an error message instead of just failing if server is down for
maintenance.


------------------------------------------------------------------------
r8337 | reid | 2008-08-26 17:03:36 -0500 (Tue, 26 Aug 2008) | 2 lines

Create splash screen (#504).

------------------------------------------------------------------------
r8333 | reid | 2008-08-26 15:20:00 -0500 (Tue, 26 Aug 2008) | 1 line

remove stale JavaScript file
------------------------------------------------------------------------
r8332 | reid | 2008-08-26 14:53:18 -0500 (Tue, 26 Aug 2008) | 60 lines

Merge large number of fixes from Michael with some minor tweaks.

Merged revisions 8283-8308,8310-8320 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r8283 | mludwig | 2008-08-20 14:35:10 -0500 (Wed, 20 Aug 2008) | 1 line
  
  Vertex editing doesn't deselect if ctrl isn't down (Fixed Bug #522)
........
  r8284 | mludwig | 2008-08-20 14:50:32 -0500 (Wed, 20 Aug 2008) | 1 line
  
  Minor change in vertex select behavior
........
  r8291 | mludwig | 2008-08-21 14:02:39 -0500 (Thu, 21 Aug 2008) | 1 line
  
  Globally disable watch region emails (Fixed Bug #461)
........
  r8294 | mludwig | 2008-08-21 15:09:56 -0500 (Thu, 21 Aug 2008) | 1 line
  
  Don't send email from dev environment (Fixed #527)
........
  r8308 | mludwig | 2008-08-25 13:52:57 -0500 (Mon, 25 Aug 2008) | 1 line
  
  Fix sql number conflict over 028
........
  r8310 | mludwig | 2008-08-25 14:27:13 -0500 (Mon, 25 Aug 2008) | 1 line
  
  Forced login is now a variable in Conf.as (Fixed Bug #336)
........
  r8312 | mludwig | 2008-08-25 18:22:56 -0500 (Mon, 25 Aug 2008) | 1 line
  
  Can now open annotations in historic byway panel (Fixed Bug #502)
........
  r8313 | mludwig | 2008-08-25 18:30:34 -0500 (Mon, 25 Aug 2008) | 1 line
  
  Don't reset geodiff filter pref on update (Fixed Bug #535)
........
  r8314 | mludwig | 2008-08-25 18:36:47 -0500 (Mon, 25 Aug 2008) | 1 line
  
  Make connectivity on be the default (see Bug #538)
........
  r8315 | mludwig | 2008-08-25 18:40:27 -0500 (Mon, 25 Aug 2008) | 1 line
  
  Filter by view is now default filter in geodiff (Fixed Bug #534)
........
  r8317 | mludwig | 2008-08-25 18:51:10 -0500 (Mon, 25 Aug 2008) | 1 line
  
  Watch region list ui is in-sync with map data (Fixed Bug #541)
........
  r8318 | mludwig | 2008-08-25 19:21:52 -0500 (Mon, 25 Aug 2008) | 1 line
  
  Geosummaries not displayed when diffing (Fixed Bug #536)
........
  r8320 | mludwig | 2008-08-25 19:56:30 -0500 (Mon, 25 Aug 2008) | 1 line
  
  Don't draw old version of non-geo features (Fixed Bug #292)
........


------------------------------------------------------------------------
r8329 | reid | 2008-08-26 13:23:06 -0500 (Tue, 26 Aug 2008) | 8 lines

Database tweaks:

1. Change the computation of revision bbox slightly to make it work in cases
when the changed geometry is a single point. (#542)

2. Add a more precise geometry to revision table, preparing for #524.


------------------------------------------------------------------------
r8319 | reid | 2008-08-25 19:26:30 -0500 (Mon, 25 Aug 2008) | 2 lines

If routed crashes, give a more friendly error message than Error #2032.

------------------------------------------------------------------------
r8316 | reid | 2008-08-25 18:50:08 -0500 (Mon, 25 Aug 2008) | 13 lines

Merge Fernando's node ID cache work, with some tweaks.

Merged revisions 8242-8257,8259-8288 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/torre

........
  r8242 | torre | 2008-08-18 14:40:23 -0500 (Mon, 18 Aug 2008) | 3 lines
  
  Eliminated use of node id cache. Closest bikeable byway is used. Then id of start or end node of that byway (whichever is closer) is chosen. (Bug #507)
  The byway_node table is still referenced from some sql scripts in .scripts.
........


------------------------------------------------------------------------
r8304 | reid | 2008-08-22 19:04:33 -0500 (Fri, 22 Aug 2008) | 56 lines

Merge from Andrew.

Merged revisions 7073-7091,7093-7137,7139-7395,7398,7401,7403-7405,7407,7409-7668,7671-7672,7674-7725,7727-7741,7743-7766,7768-7872,7874,7877-7886,7888-7916,7919-7930,7932-7979,7982-8133,8135-8206,8208-8303 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/sheppard

........
  r7935 | sheppard | 2008-07-24 17:07:39 -0500 (Thu, 24 Jul 2008) | 1 line
  
  Implemented unlimited history browsing (fixes Bug #282)
........
  r8206 | sheppard | 2008-08-13 11:57:47 -0500 (Wed, 13 Aug 2008) | 1 line
  
  Minor pyserver updates (reid)
........
  r8220 | sheppard | 2008-08-13 18:46:16 -0500 (Wed, 13 Aug 2008) | 1 line
  
  Unlimited history browsing via a NumericStepper (Fixes #282).
........
  r8221 | sheppard | 2008-08-13 18:46:21 -0500 (Wed, 13 Aug 2008) | 1 line
  
  Unlimited history browsing via a NumericStepper (Fixes #282).
........
  r8236 | sheppard | 2008-08-17 17:44:59 -0500 (Sun, 17 Aug 2008) | 1 line
  
  Load and display geosummaries when revisions are selected (Fixes #283).
........
  r8245 | sheppard | 2008-08-18 17:52:54 -0500 (Mon, 18 Aug 2008) | 1 line
  
  Changed 'Map Shows:' options. Now possible to simply view changes made in a specific revision (Fixes #520).
........
  r8274 | sheppard | 2008-08-19 22:00:22 -0500 (Tue, 19 Aug 2008) | 1 line
  
  Always keep selected revisions in list (Fixes #447)
........
  r8280 | sheppard | 2008-08-20 13:11:33 -0500 (Wed, 20 Aug 2008) | 1 line
  
  Various improvements to UI experience when browsing historic revisions (Related to #283).
........
  r8282 | sheppard | 2008-08-20 14:01:31 -0500 (Wed, 20 Aug 2008) | 1 line
  
  Other improvments related to #283
........
  r8287 | sheppard | 2008-08-20 17:39:57 -0500 (Wed, 20 Aug 2008) | 1 line
  
  Color changes, added arrows to diff points (Fixes #294, #468, #526)
........
  r8288 | sheppard | 2008-08-20 21:56:19 -0500 (Wed, 20 Aug 2008) | 1 line
  
  Implemented byway diffing (Fixes #297)
........
  r8292 | sheppard | 2008-08-21 14:36:32 -0500 (Thu, 21 Aug 2008) | 1 line
  
  Minor bugfix
........


------------------------------------------------------------------------
r8300 | reid | 2008-08-21 18:32:01 -0500 (Thu, 21 Aug 2008) | 5 lines

1. Compute byway.One.geometry_len on save (preventing bike paths and sidewalks
   from erroneously being rated down). (#523)
2. Make watch regions work with PostGIS 1.3. (#525)


------------------------------------------------------------------------
r8296 | reid | 2008-08-21 16:44:09 -0500 (Thu, 21 Aug 2008) | 4 lines

Expose null values in some byway columns by offering blankable fields in the
UI. Clean up nulls which had been transformed to zeroes by the UI. #514


------------------------------------------------------------------------
r8286 | reid | 2008-08-20 17:00:36 -0500 (Wed, 20 Aug 2008) | 2 lines

Add permissions repair script to make installs easier.

------------------------------------------------------------------------
r8268 | reid | 2008-08-19 18:47:13 -0500 (Tue, 19 Aug 2008) | 2 lines

Code changes to make Cyclopath work with PostGIS 1.3. (#281)

------------------------------------------------------------------------
r8264 | reid | 2008-08-19 16:14:15 -0500 (Tue, 19 Aug 2008) | 26 lines

Merged revisions 6831,6834-6844,6846,6849-6850,6852-6892,6897-6899,6901,6903-6921,6925-6949,6952-6974,6978-6983,6985,6987-6992,6994-7034,7036-7047,7049-7251,7253-7254,7257-7276,7278-7408,7411-7412,7416-7426,7430-7442,7444-7726,7730-7732,7735-7736,7738-7784,7787,7790-7880,7882,7885-7894,7896-7904,7906,7908,7910-7911,7916-7921,7924-7931,7933-7997,7999-8026,8029,8032-8033,8035-8053,8055,8057-8144,8147,8149-8181,8183-8240,8242-8261 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r8230 | mludwig | 2008-08-15 14:04:10 -0500 (Fri, 15 Aug 2008) | 1 line
  
  Doubel click selects all vertices (Fixed Bug #500)
........
  r8232 | mludwig | 2008-08-15 14:24:40 -0500 (Fri, 15 Aug 2008) | 1 line
  
  Moved double click time parameter over to Conf
........
  r8233 | mludwig | 2008-08-15 17:00:04 -0500 (Fri, 15 Aug 2008) | 1 line
  
  Tweaked double click times to work better with some OS's
........
  r8240 | mludwig | 2008-08-18 14:02:53 -0500 (Mon, 18 Aug 2008) | 1 line
  
  Ctrl clicking on a vertex does the right thing (Fixed Bug #496)
........
  r8254 | mludwig | 2008-08-19 12:13:14 -0500 (Tue, 19 Aug 2008) | 1 line
  
  Vertex deletion works (Fixed Bug #512)
........


------------------------------------------------------------------------
r8255 | reid | 2008-08-19 14:27:08 -0500 (Tue, 19 Aug 2008) | 25 lines

1. Merge Fernando's work with some changes.
2. Minor tweak to work with mod_python 3.3.

Merged revisions 7851-7910,7912-8035,8037-8128,8130-8234 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/torre

........
  r8044 | torre | 2008-07-31 13:59:14 -0500 (Thu, 31 Jul 2008) | 2 lines
  
  The Microsoft MapPoint geocoder is now used. The code for the Yahoo geocoder is still there, so we can switch to it at any time. (Bug #382)
........
  r8128 | torre | 2008-08-07 12:39:42 -0500 (Thu, 07 Aug 2008) | 2 lines
  
  incomplete commit while I merge from trunk.
........
  r8141 | torre | 2008-08-07 18:10:42 -0500 (Thu, 07 Aug 2008) | 2 lines
  
  Can now route to most user-entered points (the rest will work when bug #507 is fixed). List of address choices is now limited to five (unless you are using Yahoo geocoder). Also, route finder does not re-geocode is not needed. (Bugs #505, #375)
........
  r8209 | torre | 2008-08-13 12:28:37 -0500 (Wed, 13 Aug 2008) | 2 lines
  
  Changed route slider low end to "ignore". Also, now three fields are used for address input during route finding. (Bugs #513, #493)
........


------------------------------------------------------------------------
r8234 | reid | 2008-08-15 18:27:46 -0500 (Fri, 15 Aug 2008) | 18 lines

Merged revisions 6831,6834-6844,6846,6849-6850,6852-6892,6897-6899,6901,6903-6921,6925-6949,6952-6974,6978-6983,6985,6987-6992,6994-7034,7036-7047,7049-7251,7253-7254,7257-7276,7278-7408,7411-7412,7416-7426,7430-7442,7444-7726,7730-7732,7735-7736,7738-7784,7787,7790-7880,7882,7885-7894,7896-7904,7906,7908,7910-7911,7916-7921,7924-7931,7933-7997,7999-8026,8029,8032-8033,8035-8053,8055,8057-8144,8146-8229 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r8146 | mludwig | 2008-08-08 13:07:37 -0500 (Fri, 08 Aug 2008) | 1 line
  
  Deuglify watch regions, must run new sql script (Fixed Bug #495)
........
  r8148 | mludwig | 2008-08-08 13:50:48 -0500 (Fri, 08 Aug 2008) | 1 line
  
  Toggle watch region visibility (Fixed Bug #462)
........
  r8182 | mludwig | 2008-08-12 15:01:42 -0500 (Tue, 12 Aug 2008) | 1 line
  
  Cleaned up delete handling (Fixed Bug #492)
........


------------------------------------------------------------------------
r8229 | reid | 2008-08-14 18:59:33 -0500 (Thu, 14 Aug 2008) | 2 lines

Implement reverting (#335).

------------------------------------------------------------------------
r8193 | reid | 2008-08-12 19:24:44 -0500 (Tue, 12 Aug 2008) | 2 lines

Use a different background for private data within the geowiki. (#242)

------------------------------------------------------------------------
r8177 | reid | 2008-08-11 17:22:02 -0500 (Mon, 11 Aug 2008) | 1 line

merged from release 14: pass version in route responses too
------------------------------------------------------------------------
r8174 | reid | 2008-08-11 16:58:53 -0500 (Mon, 11 Aug 2008) | 3 lines

1. Gripe in UI if server/client version mismatch.
2. Wording changes to pre-save gripe.

------------------------------------------------------------------------
r8153 | reid | 2008-08-08 18:22:20 -0500 (Fri, 08 Aug 2008) | 3 lines

1. Stop Add_Vertex tool from inappropriately unchoosing itself. (#490)
2. Split byways at arbitrary places. (#489)

------------------------------------------------------------------------
r8152 | reid | 2008-08-08 17:28:30 -0500 (Fri, 08 Aug 2008) | 2 lines

Snap to intersections created by Split Byway tool. (#485)

------------------------------------------------------------------------
r8149 | reid | 2008-08-08 15:46:33 -0500 (Fri, 08 Aug 2008) | 2 lines

Add a help button (#479).

------------------------------------------------------------------------
r8138 | reid | 2008-08-07 16:09:15 -0500 (Thu, 07 Aug 2008) | 2 lines

Draw bike paths on top of other byway types. (#510)

------------------------------------------------------------------------
r8115 | reid | 2008-08-06 20:11:09 -0500 (Wed, 06 Aug 2008) | 2 lines

De-emphasize purple comment indicator slightly in some zoom levels. (#497)

------------------------------------------------------------------------
r8114 | reid | 2008-08-06 19:45:51 -0500 (Wed, 06 Aug 2008) | 2 lines

Add "sidewalk" byway type. (#393)

------------------------------------------------------------------------
r8113 | reid | 2008-08-06 19:34:06 -0500 (Wed, 06 Aug 2008) | 2 lines

Save computed routes. (#467)

------------------------------------------------------------------------
r8109 | reid | 2008-08-06 17:08:08 -0500 (Wed, 06 Aug 2008) | 2 lines

Re-word Delete Block(s) blurb (#486).

------------------------------------------------------------------------
r8101 | reid | 2008-08-06 15:09:32 -0500 (Wed, 06 Aug 2008) | 13 lines

Merge Fernando's ambiguous-address work, with some tinkering.

Merged revisions 7912-8036 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/torre

........
  r8036 | torre | 2008-07-30 14:55:42 -0500 (Wed, 30 Jul 2008) | 3 lines
  
  When an address isn't unique, a list of choices is now shown. (Bug #77)
  Possible Release Note: I think the commit message above could be used.
........


------------------------------------------------------------------------
r8082 | reid | 2008-08-04 18:50:01 -0500 (Mon, 04 Aug 2008) | 2 lines

Better visual feedback for selecting vertices (#466).

------------------------------------------------------------------------
r8081 | reid | 2008-08-04 17:36:50 -0500 (Mon, 04 Aug 2008) | 15 lines

Block reflected revisions.

Blocked revisions 7980-7981 via svnmerge

........
  r7980 | sheppard | 2008-07-28 13:27:14 -0500 (Mon, 28 Jul 2008) | 1 line
  
  Merged in from branch.
........
  r7981 | sheppard | 2008-07-28 13:50:52 -0500 (Mon, 28 Jul 2008) | 1 line
  
  Fixed incorrect check-in
........


------------------------------------------------------------------------
r8080 | reid | 2008-08-04 17:32:32 -0500 (Mon, 04 Aug 2008) | 22 lines

Merged revisions 6831,6834-6844,6846,6849-6850,6852-6892,6897-6899,6901,6903-6921,6925-6949,6952-6974,6978-6983,6985,6987-6992,6994-7034,7036-7047,7049-7251,7253-7254,7257-7276,7278-7408,7411-7412,7416-7426,7430-7442,7444-7726,7730-7732,7735-7736,7738-7784,7787,7790-7880,7882,7885-7894,7896-7904,7906,7908,7910-7911,7916-7921,7924-7931,7933-7997,7999-8026,8029,8031-8079 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r8031 | mludwig | 2008-07-30 13:44:28 -0500 (Wed, 30 Jul 2008) | 1 line
  
  Added a close button to annot panel(for real) (Fixed Bug #481)
........
  r8034 | mludwig | 2008-07-30 14:03:28 -0500 (Wed, 30 Jul 2008) | 1 line
  
  Made the geodiff wr ui better (Fixed Bug #482)
........
  r8054 | mludwig | 2008-08-01 15:00:03 -0500 (Fri, 01 Aug 2008) | 1 line
  
  Geofeatures drawn correctly at all z-levels (Fixed Bug #438)
........
  r8056 | mludwig | 2008-08-01 15:10:05 -0500 (Fri, 01 Aug 2008) | 1 line
  
  Active annotation clears when expected (Fixed Bug #483)
........


------------------------------------------------------------------------
r8079 | reid | 2008-08-04 17:10:33 -0500 (Mon, 04 Aug 2008) | 10 lines

Merged revisions 7998 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r7998 | mludwig | 2008-07-28 17:35:47 -0500 (Mon, 28 Jul 2008) | 1 line
  
  Changed the angles for directions in the route finder (Fixed Bug #465)
........


------------------------------------------------------------------------
r8063 | reid | 2008-08-01 18:01:30 -0500 (Fri, 01 Aug 2008) | 3 lines

1. Deuglify alerts.
2. Fix mergeability of blocks which intersected deleted blocks (#457).

------------------------------------------------------------------------
r8062 | reid | 2008-08-01 16:11:10 -0500 (Fri, 01 Aug 2008) | 2 lines

Fix incorrect placement of Add Vertex new vertices (#480).

------------------------------------------------------------------------
r8048 | reid | 2008-07-31 18:33:25 -0500 (Thu, 31 Jul 2008) | 2 lines

Remove all world permissions from files created by Pyserver etc. (fixed: #334)

------------------------------------------------------------------------
r8040 | reid | 2008-07-30 18:03:14 -0500 (Wed, 30 Jul 2008) | 2 lines

A few additions to activity logging (#459), plus other minor fixes.

------------------------------------------------------------------------
r7964 | reid | 2008-07-27 16:58:11 -0500 (Sun, 27 Jul 2008) | 4 lines

Make "Sign up" button work. MediaWiki page contains explanation for why they
can't sign up. Fixed: #458.


------------------------------------------------------------------------
r7963 | reid | 2008-07-27 16:42:37 -0500 (Sun, 27 Jul 2008) | 18 lines

Merged revisions 7887-7917,7919-7931 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/sheppard

........
  r7887 | sheppard | 2008-07-22 16:44:47 -0500 (Tue, 22 Jul 2008) | 1 line
  
  Automatically refresh history browser list (fixes #286).
........
  r7917 | sheppard | 2008-07-23 16:46:55 -0500 (Wed, 23 Jul 2008) | 1 line
  
  Changed 'Recenter' to 'Look At' in History Browser (fixes #448)
........
  r7931 | sheppard | 2008-07-24 13:43:05 -0500 (Thu, 24 Jul 2008) | 1 line
  
  Code formatting cleanup
........


------------------------------------------------------------------------
r7962 | reid | 2008-07-27 15:56:42 -0500 (Sun, 27 Jul 2008) | 2 lines

Merge replay.py script and friends from release 10 branch.

------------------------------------------------------------------------
r7961 | reid | 2008-07-27 15:47:52 -0500 (Sun, 27 Jul 2008) | 54 lines

Merged revisions 6831,6834-6844,6846,6849-6850,6852-6892,6897-6899,6901,6903-6921,6925-6949,6952-6974,6978-6983,6985,6987-6992,6994-7034,7036-7047,7049-7251,7253-7254,7257-7276,7278-7408,7411-7412,7416-7426,7430-7442,7444-7726,7730-7732,7735-7736,7738-7784,7787,7790-7880,7882-7908,7910-7935 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r7883 | mludwig | 2008-07-22 15:40:07 -0500 (Tue, 22 Jul 2008) | 1 line
  
  Notify by email now works for watch regions (Fixed Bug #353)
........
  r7884 | mludwig | 2008-07-22 15:45:04 -0500 (Tue, 22 Jul 2008) | 1 line
  
  Fixed small watch region bug in client (Fixed Bug #449)
........
  r7895 | mludwig | 2008-07-22 17:32:01 -0500 (Tue, 22 Jul 2008) | 1 line
  
  Update the direction computations (Fixed Bug #442)
........
  r7905 | mludwig | 2008-07-23 13:15:46 -0500 (Wed, 23 Jul 2008) | 1 line
  
  Reapplied scroll policy to route panel (Fixed Bug #451)
........
  r7907 | mludwig | 2008-07-23 13:29:10 -0500 (Wed, 23 Jul 2008) | 1 line
  
  Removed watch region valid geom constraint (Fixed Bug #445)
........
  r7912 | mludwig | 2008-07-23 15:16:05 -0500 (Wed, 23 Jul 2008) | 1 line
  
  Updated shift-selection in Pan_Select (Fixed Bug #385)
........
  r7913 | mludwig | 2008-07-23 15:33:53 -0500 (Wed, 23 Jul 2008) | 1 line
  
  Add Note action goes into note panel (Fixed Bug #407)
........
  r7914 | mludwig | 2008-07-23 15:38:29 -0500 (Wed, 23 Jul 2008) | 1 line
  
  Fixed Vertex_Move merging code (Fixed Bug #452)
........
  r7915 | mludwig | 2008-07-23 16:20:34 -0500 (Wed, 23 Jul 2008) | 1 line
  
  Annotation panel isn't so sticky (Fixed Bug #391)
........
  r7922 | mludwig | 2008-07-23 21:32:33 -0500 (Wed, 23 Jul 2008) | 1 line
  
  Implemented geodiff filter by watch regions (Fixed Bug #352)
........
  r7923 | mludwig | 2008-07-24 11:44:33 -0500 (Thu, 24 Jul 2008) | 1 line
  
  Stopped SQL injection bug with wfs_GetRevision (Fixed Bug #455)
........
  r7932 | mludwig | 2008-07-24 13:59:52 -0500 (Thu, 24 Jul 2008) | 1 line
  
  Used Reid's suggestions for regex in wfs_GetRevision
........


------------------------------------------------------------------------
r7933 | reid | 2008-07-24 15:26:45 -0500 (Thu, 24 Jul 2008) | 2 lines

Draw intersecting byways with different z levels better. Fixed: #401.

------------------------------------------------------------------------
r7916 | reid | 2008-07-23 16:42:20 -0500 (Wed, 23 Jul 2008) | 5 lines

1. Fix server crash (#453).
2. A few small tweaks & cleanups, including removing someone else's leftover
   trace() statements, please don't do that.


------------------------------------------------------------------------
r7893 | reid | 2008-07-22 17:08:42 -0500 (Tue, 22 Jul 2008) | 1 line

fix crashing routed
------------------------------------------------------------------------
r7892 | reid | 2008-07-22 16:56:59 -0500 (Tue, 22 Jul 2008) | 14 lines

Merged revisions 7073-7091,7093-7137,7139-7395,7398,7401,7403-7405,7407,7409-7668,7671-7672,7674-7725,7727-7741,7743-7766,7768-7874,7876-7886 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/sheppard

........
  r7873 | sheppard | 2008-07-21 17:15:53 -0500 (Mon, 21 Jul 2008) | 1 line
  
  Filter revisions by visible area (Fixes #287), initial 'look at revision' code.
........
  r7876 | sheppard | 2008-07-21 18:54:39 -0500 (Mon, 21 Jul 2008) | 1 line
  
  Minor file/directory handling improvments.
........


------------------------------------------------------------------------
r7886 | reid | 2008-07-22 16:33:21 -0500 (Tue, 22 Jul 2008) | 2 lines

Daemonize routed correctly. Fixed: #429.

------------------------------------------------------------------------
r7874 | reid | 2008-07-21 17:46:30 -0500 (Mon, 21 Jul 2008) | 2 lines

Twiddle transaction handling a little. Fixed: #328, #277.

------------------------------------------------------------------------
r7872 | reid | 2008-07-21 16:20:20 -0500 (Mon, 21 Jul 2008) | 2 lines

Ratings on newly-added blocks are saved properly. Fixed: #427.

------------------------------------------------------------------------
r7864 | reid | 2008-07-21 12:09:31 -0500 (Mon, 21 Jul 2008) | 2 lines

Small wording change. Fixed: #410.

------------------------------------------------------------------------
r7863 | reid | 2008-07-21 12:01:36 -0500 (Mon, 21 Jul 2008) | 2 lines

Add a "closed" flag which makes byways unrouteable. (Fixed: #409)

------------------------------------------------------------------------
r7859 | reid | 2008-07-20 16:21:29 -0500 (Sun, 20 Jul 2008) | 28 lines

Finish merging Andrew's changes.

Merged revisions 7025-7068,7071,7073-7091,7093-7137,7139-7395,7398,7401,7403-7405,7407,7409-7668,7670-7858 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/sheppard

........
  r7670 | sheppard | 2008-07-09 15:55:53 -0500 (Wed, 09 Jul 2008) | 1 line
  
  Disable edit mode when not viewing current revision. (Bug #285)
........
  r7673 | sheppard | 2008-07-09 16:31:50 -0500 (Wed, 09 Jul 2008) | 1 line
  
  Don't allow zoom changes to reactivate edit mode when geodiffing.
........
  r7726 | sheppard | 2008-07-11 15:38:56 -0500 (Fri, 11 Jul 2008) | 1 line
  
  Warn user before discarding dirty features (Fixes #284).
........
  r7742 | sheppard | 2008-07-11 19:19:54 -0500 (Fri, 11 Jul 2008) | 1 line
  
  Added geodiff legend for comparing revisions. (Fixes #300)
........
  r7767 | sheppard | 2008-07-14 12:25:03 -0500 (Mon, 14 Jul 2008) | 1 line
  
  Don't show change note dialog when only ratings are being saved. (Fixes #227)
........


------------------------------------------------------------------------
r7858 | reid | 2008-07-20 15:44:44 -0500 (Sun, 20 Jul 2008) | 32 lines

Merge Andrew's tile management changes.

Merged revisions 7397-7668 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/sheppard

........
  r7397 | sheppard | 2008-07-01 13:41:49 -0500 (Tue, 01 Jul 2008) | 1 line
  
  Added directory for tile managment
........
  r7399 | sheppard | 2008-07-01 13:52:03 -0500 (Tue, 01 Jul 2008) | 1 line
  
  Added various aerial tile management scripts.
........
  r7400 | sheppard | 2008-07-01 13:53:53 -0500 (Tue, 01 Jul 2008) | 1 line
  
  Updated retile.pl to more accurate PerlMagick-based version.
........
  r7402 | sheppard | 2008-07-01 13:55:54 -0500 (Tue, 01 Jul 2008) | 1 line
  
  Added relink.pl to assist in transition to new zoom/x/y.ext directory structure (Bug #408).
........
  r7406 | sheppard | 2008-07-01 15:08:51 -0500 (Tue, 01 Jul 2008) | 1 line
  
  Updated scripts to match new directory structure.
........
  r7408 | sheppard | 2008-07-01 15:58:04 -0500 (Tue, 01 Jul 2008) | 1 line
  
  Updated Tile.as and tilecache_update.py to use new tile directory structure (Bug #408).
........


------------------------------------------------------------------------
r7857 | reid | 2008-07-20 15:31:14 -0500 (Sun, 20 Jul 2008) | 17 lines

"Officially" merge Andrew's zoom/scroll changes, though it looks like they
snuck in via Michael's branch earlier.

Merged revisions 7138-7396 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/sheppard

........
  r7138 | sheppard | 2008-06-19 16:43:15 -0500 (Thu, 19 Jun 2008) | 1 line
  
  Added ctrl+scroll zooming and double-click centering. (Bug #60)
........
  r7396 | sheppard | 2008-07-01 13:41:03 -0500 (Tue, 01 Jul 2008) | 1 line
  
  Merged in from trunk; disabled ctrl+scroll zoom.
........


------------------------------------------------------------------------
r7856 | reid | 2008-07-20 15:14:34 -0500 (Sun, 20 Jul 2008) | 12 lines

Merge Fernando's route UI change, with some tweaks.

Merged revisions 7600-7646,7648-7850 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/torre

........
  r7671 | torre | 2008-07-09 16:13:36 -0500 (Wed, 09 Jul 2008) | 2 lines
  
  Changed the priority menus to sliders in route finding. (Bug #256)
........


------------------------------------------------------------------------
r7849 | reid | 2008-07-18 16:45:30 -0500 (Fri, 18 Jul 2008) | 100 lines

Merge a giant lot of Michael's changes.

Merged revisions 6831,6834-6844,6846,6849-6850,6852-6892,6897-6899,6901,6903-6921,6925-6949,6952-6974,6978-6983,6985,6987-6992,6994-7034,7036-7047,7049-7833 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r7252 | mludwig | 2008-06-26 14:34:29 -0500 (Thu, 26 Jun 2008) | 1 line
  
  Merged in from trunk
........
  r7255 | mludwig | 2008-06-26 14:45:45 -0500 (Thu, 26 Jun 2008) | 1 line
  
  Map updates when recentered by a double-click
........
  r7256 | mludwig | 2008-06-26 15:07:14 -0500 (Thu, 26 Jun 2008) | 1 line
  
  Uninit from sheppard branch
........
  r7277 | mludwig | 2008-06-27 13:40:00 -0500 (Fri, 27 Jun 2008) | 1 line
  
  Merged from trunk, fixed svn props, added more flexible detail panels
........
  r7409 | mludwig | 2008-07-01 16:01:27 -0500 (Tue, 01 Jul 2008) | 1 line
  
  Raw and gory foundation for client watch regions
........
  r7410 | mludwig | 2008-07-01 16:15:51 -0500 (Tue, 01 Jul 2008) | 1 line
  
  Merged in from trunk
........
  r7413 | mludwig | 2008-07-01 16:45:00 -0500 (Tue, 01 Jul 2008) | 1 line
  
  Update watch regions scripts to be more compatible with geofeatures
........
  r7414 | mludwig | 2008-07-01 16:49:16 -0500 (Tue, 01 Jul 2008) | 1 line
  
  Added z attributes to watch_region
........
  r7415 | mludwig | 2008-07-01 16:54:26 -0500 (Tue, 01 Jul 2008) | 1 line
  
  Added notify by email boolean to watch_region
........
  r7427 | mludwig | 2008-07-02 12:28:25 -0500 (Wed, 02 Jul 2008) | 1 line
  
  Base pyserver watch_region handling
........
  r7428 | mludwig | 2008-07-02 12:28:55 -0500 (Wed, 02 Jul 2008) | 1 line
  
  Add watch_region.py
........
  r7429 | mludwig | 2008-07-02 12:38:56 -0500 (Wed, 02 Jul 2008) | 1 line
  
  Merged in from trunk
........
  r7443 | mludwig | 2008-07-02 18:12:10 -0500 (Wed, 02 Jul 2008) | 1 line
  
  Workable watch regions (Fixed Bug #350, Bug #132, Bug #413)
........
  r7727 | mludwig | 2008-07-11 15:48:10 -0500 (Fri, 11 Jul 2008) | 1 line
  
  Improved watch region panel ui (Fixed Bug #420)
........
  r7728 | mludwig | 2008-07-11 16:00:48 -0500 (Fri, 11 Jul 2008) | 1 line
  
  Merged in from the trunk, diff looked okay
........
  r7729 | mludwig | 2008-07-11 16:48:29 -0500 (Fri, 11 Jul 2008) | 1 line
  
  Login popup opens after logging out with private data dirty
........
  r7733 | mludwig | 2008-07-11 17:39:03 -0500 (Fri, 11 Jul 2008) | 1 line
  
  Fixed watch region vertex editing in vector mode
........
  r7734 | mludwig | 2008-07-11 17:49:25 -0500 (Fri, 11 Jul 2008) | 1 line
  
  Watch region look at implemented (Fixed Bug #351)
........
  r7737 | mludwig | 2008-07-11 18:04:17 -0500 (Fri, 11 Jul 2008) | 1 line
  
  Updated new watch region to follow polygon constraint
........
  r7785 | mludwig | 2008-07-15 14:29:06 -0500 (Tue, 15 Jul 2008) | 1 line
  
  Upgraded the edit mode infrastucture (Fixed Bugs #434, #432)
........
  r7786 | mludwig | 2008-07-15 14:42:40 -0500 (Tue, 15 Jul 2008) | 1 line
  
  Watch regions fetched when diffing (Fixed Bug #436)
........
  r7788 | mludwig | 2008-07-15 15:19:18 -0500 (Tue, 15 Jul 2008) | 1 line
  
  Fixed a few holes in the editing framework
........
  r7789 | mludwig | 2008-07-15 15:40:30 -0500 (Tue, 15 Jul 2008) | 1 line
  
  Connectivity not drawn on deleted byways (Fixed Bug #416)
........


------------------------------------------------------------------------
r7831 | reid | 2008-07-17 17:12:36 -0500 (Thu, 17 Jul 2008) | 1 line

remove unneeded trace statements
------------------------------------------------------------------------
r7632 | reid | 2008-07-07 18:37:54 -0500 (Mon, 07 Jul 2008) | 1 line

merge script fix from release branch
------------------------------------------------------------------------
r7629 | reid | 2008-07-07 18:25:08 -0500 (Mon, 07 Jul 2008) | 6 lines

1. Fix crash on pan/zoom with loop byways. (#430).

2. Implement byway merging (#371), which is the last byway editing subfeature,
so closing the master byway editing bug (#174) also.


------------------------------------------------------------------------
r7602 | reid | 2008-07-06 18:27:58 -0500 (Sun, 06 Jul 2008) | 2 lines

Consider unpavedness in bikeability estimates. Fixed: #390.

------------------------------------------------------------------------
r7601 | reid | 2008-07-06 17:55:22 -0500 (Sun, 06 Jul 2008) | 2 lines

Remove unused byway attribute name2. Fixed: #324.

------------------------------------------------------------------------
r7600 | reid | 2008-07-06 17:41:42 -0500 (Sun, 06 Jul 2008) | 12 lines

Merge Fernando's progress bar work with minor changes.

Merged revisions 7432-7599 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/torre

........
  r7521 | torre | 2008-07-03 16:39:41 -0500 (Thu, 03 Jul 2008) | 2 lines
  
  An indeterminate progress bar now shows while finding a route. (Bug #333)
........


------------------------------------------------------------------------
r7550 | reid | 2008-07-04 13:16:10 -0500 (Fri, 04 Jul 2008) | 2 lines

Implement byway splitting. Fixed: #370.

------------------------------------------------------------------------
r7507 | reid | 2008-07-03 12:28:30 -0500 (Thu, 03 Jul 2008) | 2 lines

Fix dumb error which caused endpoint snapping to stop working.

------------------------------------------------------------------------
r7505 | reid | 2008-07-03 12:12:08 -0500 (Thu, 03 Jul 2008) | 2 lines

Draw endpoint vertices differently.

------------------------------------------------------------------------
r7442 | reid | 2008-07-02 18:03:23 -0500 (Wed, 02 Jul 2008) | 2 lines

Implement vertex deletion. Fixes: #369.

------------------------------------------------------------------------
r7440 | reid | 2008-07-02 16:37:20 -0500 (Wed, 02 Jul 2008) | 2 lines

Create a key event listener for the map which filters keystrokes intelligently.

------------------------------------------------------------------------
r7433 | reid | 2008-07-02 15:27:04 -0500 (Wed, 02 Jul 2008) | 17 lines

Merge bugfix from Fernando.

Merged revisions 7006-7079,7081,7083-7379,7381-7431 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/torre

........
  r7006 | reid | 2008-06-12 13:29:45 -0500 (Thu, 12 Jun 2008) | 2 lines
  
  Make a branch for Fernando.
........
  r7378 | torre | 2008-06-30 16:03:42 -0500 (Mon, 30 Jun 2008) | 4 lines
  
  Added error message that appears when to and from address are the same
  or very near. (Bug #240)
........


------------------------------------------------------------------------
r7431 | reid | 2008-07-02 14:58:34 -0500 (Wed, 02 Jul 2008) | 3 lines

Initialized merge tracking via "svnmerge" with revisions "1-7005" from 
file:///project/Grouplens/svn/cyclingproject/branches/torre

------------------------------------------------------------------------
r7430 | reid | 2008-07-02 14:02:21 -0500 (Wed, 02 Jul 2008) | 2 lines

Fix Add Vertex putting the new vertex in the wrong segment sometimes.

------------------------------------------------------------------------
r7418 | reid | 2008-07-01 19:36:04 -0500 (Tue, 01 Jul 2008) | 4 lines

Implement adding vertices. Fixed: #368.

Note: new vertices cannot be endpoints.

------------------------------------------------------------------------
r7395 | reid | 2008-07-01 12:47:18 -0500 (Tue, 01 Jul 2008) | 2 lines

Create widgetry for merging and splitting byways and adding vertices.

------------------------------------------------------------------------
r7384 | reid | 2008-06-30 20:27:35 -0500 (Mon, 30 Jun 2008) | 2 lines

Implement basic byway creation. Fixed: #374.

------------------------------------------------------------------------
r7382 | reid | 2008-06-30 18:17:09 -0500 (Mon, 30 Jun 2008) | 5 lines

Log request and exception if an unhandled exception occurs in the pyserver.

Fixes: #414.


------------------------------------------------------------------------
r7298 | reid | 2008-06-27 20:59:12 -0500 (Fri, 27 Jun 2008) | 5 lines

Server-side changes to deal with endpoint vertex moving.

Finally fixes: #373, #412.


------------------------------------------------------------------------
r7297 | reid | 2008-06-27 19:34:04 -0500 (Fri, 27 Jun 2008) | 2 lines

Client-side endpoint vertex moving seems to be implemented.

------------------------------------------------------------------------
r7275 | reid | 2008-06-27 12:54:31 -0500 (Fri, 27 Jun 2008) | 2 lines

Snap byway endpoints to intersections.

------------------------------------------------------------------------
r7258 | reid | 2008-06-26 17:19:12 -0500 (Thu, 26 Jun 2008) | 5 lines

Partial implementation of byway endpoint vertex moving:
1. Multi-vertex moving.
2. Move other endpoint vertices of selected byways that share a node.
3. Some generalization of bubbling infrastructure.

------------------------------------------------------------------------
r7250 | reid | 2008-06-25 18:21:44 -0500 (Wed, 25 Jun 2008) | 2 lines

Fix slowness on restore.

------------------------------------------------------------------------
r7090 | reid | 2008-06-17 18:42:22 -0500 (Tue, 17 Jun 2008) | 8 lines

1. Make multiple selected byway vertices all move in sync.

2. Make byway endpoint vertices bring along endpoints of other selected byways
that connect to the same node (allowing movement of nodes).

3. Make vertices draw properly after zoom.


------------------------------------------------------------------------
r7075 | reid | 2008-06-16 17:52:44 -0500 (Mon, 16 Jun 2008) | 2 lines

Let sudo handle the user change (#394).

------------------------------------------------------------------------
r7066 | reid | 2008-06-16 14:15:43 -0500 (Mon, 16 Jun 2008) | 1 line

add MapPoint password
------------------------------------------------------------------------
r7054 | reid | 2008-06-15 16:59:02 -0500 (Sun, 15 Jun 2008) | 2 lines

Merge Michael's vertex infrastructure. Fixed: #372.

------------------------------------------------------------------------
r7044 | reid | 2008-06-15 15:31:14 -0500 (Sun, 15 Jun 2008) | 4 lines

Technical docs now on the wiki; see http://cyclopath.org/index.php/Tech:Main.
Fixed: #307.


------------------------------------------------------------------------
r7041 | reid | 2008-06-15 14:58:48 -0500 (Sun, 15 Jun 2008) | 1 line

a few tweaks
------------------------------------------------------------------------
r7036 | reid | 2008-06-13 18:26:53 -0500 (Fri, 13 Jun 2008) | 10 lines

Merged revisions 7035 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r7035 | mludwig | 2008-06-13 17:38:08 -0500 (Fri, 13 Jun 2008) | 1 line
  
  Update direction arrow drawing (Fixed Bug #167, Bug #397)
........


------------------------------------------------------------------------
r7029 | reid | 2008-06-13 14:56:36 -0500 (Fri, 13 Jun 2008) | 16 lines

Merge Andrew's aerial photography work.

Merged revisions 6706-6808,6810-6900,6902-7024 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/sheppard

........
  r6810 | sheppard | 2008-05-22 16:56:09 -0500 (Thu, 22 May 2008) | 1 line
  
  Changed AuthPlugin to require db and user names
........
  r6987 | sheppard | 2008-06-09 17:49:21 -0500 (Mon, 09 Jun 2008) | 1 line
  
  implemented aerial photography (Bug #323)
........


------------------------------------------------------------------------
r7021 | reid | 2008-06-13 13:04:28 -0500 (Fri, 13 Jun 2008) | 14 lines

Merged revisions 6984-6986 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r6984 | mludwig | 2008-06-09 16:58:16 -0500 (Mon, 09 Jun 2008) | 1 line
  
  Update that annotation highlight when new features are loaded
........
  r6986 | mludwig | 2008-06-09 17:31:16 -0500 (Mon, 09 Jun 2008) | 1 line
  
  Better discard behavior (Fixed Bug #392)
........


------------------------------------------------------------------------
r7019 | reid | 2008-06-13 12:53:56 -0500 (Fri, 13 Jun 2008) | 3 lines

1. Rate expressway ramps correctly.
2. A utility script for ratings analysis.

------------------------------------------------------------------------
r7009 | reid | 2008-06-12 18:33:37 -0500 (Thu, 12 Jun 2008) | 2 lines

Implement non-geographic byway editing (#131, #366).

------------------------------------------------------------------------
r6992 | reid | 2008-06-10 14:35:13 -0500 (Tue, 10 Jun 2008) | 4 lines

1. Make route lines translucent again.
2. Non-functional GUI widgets for non-geometric byway editing.


------------------------------------------------------------------------
r6965 | reid | 2008-06-05 14:23:51 -0500 (Thu, 05 Jun 2008) | 32 lines

1. Merge a bunch of Michael's work.

2. Fix a bug in the annotation/annot_bs orphan cleaner where it was
   overzealous in its cleaning (thanks to Michael for help finding the cause).

Merged revisions 6922-6924,6950-6951 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r6922 | mludwig | 2008-06-03 14:29:16 -0500 (Tue, 03 Jun 2008) | 1 line
  
  Upgraded the highlight system (Fixed Bug #362)
........
  r6923 | mludwig | 2008-06-03 14:29:47 -0500 (Tue, 03 Jun 2008) | 1 line
  
  Forgot the key element in last commit
........
  r6924 | mludwig | 2008-06-03 15:56:00 -0500 (Tue, 03 Jun 2008) | 1 line
  
  Improved add/remove block buttons (Fixed Bug #325)
........
  r6950 | mludwig | 2008-06-04 16:05:10 -0500 (Wed, 04 Jun 2008) | 1 line
  
  Clicking a byway_annot entry highlights correctly (Fixed Bug #387)
........
  r6951 | mludwig | 2008-06-04 16:15:36 -0500 (Wed, 04 Jun 2008) | 1 line
  
  Make route transparent, tweak route/highlight alphas (Fixed Bug #388)
........



------------------------------------------------------------------------
r6915 | reid | 2008-06-03 14:07:19 -0500 (Tue, 03 Jun 2008) | 4 lines

Fix byways being selected by New Point tool (#381). This also returns the
dummy point used by the New Point tool, which had snuck away.


------------------------------------------------------------------------
r6905 | reid | 2008-06-02 18:29:05 -0500 (Mon, 02 Jun 2008) | 20 lines

Merge Michael's changes, with a few tweaks for aesthetics.

Merged revisions 6893-6894,6902 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r6893 | mludwig | 2008-06-02 13:07:38 -0500 (Mon, 02 Jun 2008) | 1 line
  
  App no longer crashes when route-finding (Fixed Bug #380)
........
  r6894 | mludwig | 2008-06-02 13:42:44 -0500 (Mon, 02 Jun 2008) | 1 line
  
  Route directions panel sizes correctly, (Fixed Bug #386)
........
  r6902 | mludwig | 2008-06-02 16:03:56 -0500 (Mon, 02 Jun 2008) | 1 line
  
  Make Add Byways button work (Fix Bug #325)
........


------------------------------------------------------------------------
r6904 | reid | 2008-06-02 17:27:11 -0500 (Mon, 02 Jun 2008) | 2 lines

Finally track down mysterious I/O errors (#185).

------------------------------------------------------------------------
r6903 | reid | 2008-06-02 16:56:05 -0500 (Mon, 02 Jun 2008) | 6 lines

1. Make "remember me" tickbox work.
2. Go to previous pan & zoom on app restart if remembering me.

Fixed: #344.


------------------------------------------------------------------------
r6888 | reid | 2008-05-30 18:54:55 -0500 (Fri, 30 May 2008) | 2 lines

Fix junk text in Printer Friendly window.

------------------------------------------------------------------------
r6887 | reid | 2008-05-30 18:44:46 -0500 (Fri, 30 May 2008) | 6 lines

1. Create icons for tool bar buttons, to make the tool bar small enough to
   support coming growth.

2. General deuglification in many areas.


------------------------------------------------------------------------
r6869 | reid | 2008-05-28 16:25:34 -0500 (Wed, 28 May 2008) | 38 lines

Merge Michael's work. Fixes #363 plus a variety of small improvements which
hadn't made their way into the bug tracker.

Merged revisions 6822,6825,6830,6832-6833,6845,6847-6848,6851 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

................
  r6830 | mludwig | 2008-05-23 15:46:06 -0500 (Fri, 23 May 2008) | 1 line
  
  Fixed Bug # 363
................
  r6832 | mludwig | 2008-05-23 17:04:57 -0500 (Fri, 23 May 2008) | 1 line
  
  Fixed major bugs with Pan_Select.as when zooming or panning
................
  r6833 | mludwig | 2008-05-23 17:10:45 -0500 (Fri, 23 May 2008) | 1 line
  
  Re-added the license to a-star code
................
  r6845 | mludwig | 2008-05-27 12:45:34 -0500 (Tue, 27 May 2008) | 1 line
  
  Pan-Select shift selection fixed for windows machines
................
  r6847 | mludwig | 2008-05-27 15:52:08 -0500 (Tue, 27 May 2008) | 1 line
  
  Fixed rating picker with multi byways + byway highlight properly hides
................
  r6848 | mludwig | 2008-05-27 16:10:21 -0500 (Tue, 27 May 2008) | 1 line
  
  Improved Byway_Annotation_Add performance, uses bulk features_add() now
................
  r6851 | mludwig | 2008-05-27 16:49:49 -0500 (Tue, 27 May 2008) | 1 line
  
  Minor bug fixes with (feature delete)|(undo create) leaving visual artifacts
................



------------------------------------------------------------------------
r6867 | reid | 2008-05-28 13:48:35 -0500 (Wed, 28 May 2008) | 2 lines

tilecache_update.py can now update tiles incrementally (#365).

------------------------------------------------------------------------
r6844 | reid | 2008-05-26 18:35:50 -0500 (Mon, 26 May 2008) | 2 lines

Update routed's in-memory network when byways change (#175).

------------------------------------------------------------------------
r6843 | reid | 2008-05-26 16:53:22 -0500 (Mon, 26 May 2008) | 10 lines

1. Build views giving simple access to Annotation geometry.
2. Add geometric summaries to Revision table.

A key subsidiary change is that current versions of versioned objects no
longer have null valid_before_rid; now, valid_before_rid = rid_inf() in these
cases. rid_inf() is greater than any reasonable RID value.

Fixes #364.


------------------------------------------------------------------------
r6825 | reid | 2008-05-23 15:15:39 -0500 (Fri, 23 May 2008) | 4 lines

Update logging infrastructure to reduce HTTP traffic -- of which there is a
lot more now that multiselecting is much faster.


------------------------------------------------------------------------
r6822 | reid | 2008-05-23 12:57:39 -0500 (Fri, 23 May 2008) | 33 lines

Merge a bunch of Michael's work, with some formatting and variable name
changes.

Merged revisions 6777,6780,6804,6807-6808,6813 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r6777 | mludwig | 2008-05-20 13:59:22 -0500 (Tue, 20 May 2008) | 1 line
  
  Unnecessary selection glows are no longer drawn (Fixed Bug #276)
........
  r6780 | mludwig | 2008-05-20 16:29:33 -0500 (Tue, 20 May 2008) | 1 line
  
  Updated the pan-select tool based on experiment results (Fixed #347)
........
  r6804 | mludwig | 2008-05-22 14:27:36 -0500 (Thu, 22 May 2008) | 1 line
  
  Updated pan-select tool even further, tweaked highlights (Fixed Bug #359, #326)
........
  r6807 | mludwig | 2008-05-22 15:47:00 -0500 (Thu, 22 May 2008) | 1 line
  
  Route runtime warnings henceforth shall not be spewed (Fixed Bug #341)
........
  r6808 | mludwig | 2008-05-22 16:02:10 -0500 (Thu, 22 May 2008) | 1 line
  
  Pressing shift now visually responds properly with pan-select tool
........
  r6813 | mludwig | 2008-05-22 17:17:45 -0500 (Thu, 22 May 2008) | 1 line
  
  Removed old log statements, increased pan-select performance (Fixed Bug #360)
........


------------------------------------------------------------------------
r6814 | reid | 2008-05-22 19:35:24 -0500 (Thu, 22 May 2008) | 6 lines

1. Rename "edit" button in byway notes list and generally deuglify things in
   this part of the app (#355).

2. Various miscellaneous tweaks.


------------------------------------------------------------------------
r6803 | reid | 2008-05-22 14:23:49 -0500 (Thu, 22 May 2008) | 2 lines

Don't merge Michaels trunk -> branch revisions.

------------------------------------------------------------------------
r6802 | reid | 2008-05-22 13:51:58 -0500 (Thu, 22 May 2008) | 11 lines

Not merging fix for passe bug.

Blocked revisions 6739 via svnmerge

........
  r6739 | mludwig | 2008-05-13 13:11:58 -0500 (Tue, 13 May 2008) | 1 line
  
  SSL requests made on port + 363 (Fixed Bug #331)
........


------------------------------------------------------------------------
r6795 | reid | 2008-05-21 17:56:36 -0500 (Wed, 21 May 2008) | 2 lines

Usernames now case-insensitive for login (#343).

------------------------------------------------------------------------
r6794 | reid | 2008-05-21 17:45:39 -0500 (Wed, 21 May 2008) | 3 lines

Rewrite authentication to eliminate SSL and all its troubles. Also provide for
reauthenticating if something (e.g. client IP) changes while logged in (#356).

------------------------------------------------------------------------
r6781 | reid | 2008-05-20 18:13:24 -0500 (Tue, 20 May 2008) | 6 lines

1. Add script to produce a snapshot of ratings activity.
2. Add index to byway_rating to make access by last_modified faster.
3. Revamp bikeability computations in route-finder (#339):
   a. Consider the user's own ratings as soon as they're saved.
   b. Use average user rating instead of CBF7 if available.

------------------------------------------------------------------------
r6773 | reid | 2008-05-19 18:00:26 -0500 (Mon, 19 May 2008) | 2 lines

Simple log analysis script.

------------------------------------------------------------------------
r6756 | reid | 2008-05-15 19:13:28 -0500 (Thu, 15 May 2008) | 3 lines

1. Remove useless Print item from context menu.
2. Fix bug where editing text boxes affected the wrong objects (#348).

------------------------------------------------------------------------
r6755 | reid | 2008-05-15 15:26:17 -0500 (Thu, 15 May 2008) | 2 lines

Create a script to simplify copying databases.

------------------------------------------------------------------------
r6735 | reid | 2008-05-12 18:13:53 -0500 (Mon, 12 May 2008) | 3 lines

1. Fix spurious HTTP requests for "/undefined" (#338).
2. Make annot_bs a little less noisy in flashlog.

------------------------------------------------------------------------
r6734 | reid | 2008-05-12 16:47:18 -0500 (Mon, 12 May 2008) | 6 lines

Log when user selects geo-objects and annotations. (#321).

Also leave the service and version arguments out of the WFS URL, since they're
totally ignored and we don't actually provide the WFS service.


------------------------------------------------------------------------
r6729 | reid | 2008-05-12 14:19:49 -0500 (Mon, 12 May 2008) | 4 lines

In the interface, replace "comment" and "annotation" with "note", and
"segment" and "byway" with "block". (Fixes #258.)


------------------------------------------------------------------------
r6723 | reid | 2008-05-09 19:00:32 -0500 (Fri, 09 May 2008) | 10 lines

Merged revisions 6053-6061,6063-6067,6069-6098,6103-6108,6110-6114,6118-6139,6141-6154,6156-6168,6170-6205,6207-6229,6231-6239,6241-6245,6248,6250-6590,6592-6593,6596-6619,6621-6642,6644-6653,6655,6657-6675,6678-6722 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r6721 | mludwig | 2008-05-09 17:46:09 -0500 (Fri, 09 May 2008) | 1 line
  
  Orphaned annot and annot_bs's are cleaned after a save (Fixed Bug #272)
........


------------------------------------------------------------------------
r6722 | reid | 2008-05-09 18:47:37 -0500 (Fri, 09 May 2008) | 2 lines

Script to move byway comments into annotation rows (#278).

------------------------------------------------------------------------
r6720 | reid | 2008-05-09 17:20:47 -0500 (Fri, 09 May 2008) | 2 lines

Force logging in and staying logged in (for alpha testing purposes) (#316).

------------------------------------------------------------------------
r6719 | reid | 2008-05-09 16:54:55 -0500 (Fri, 09 May 2008) | 3 lines

Correctly fetch no annot_bs's or annotations if there were no byways or
annot_bs's, respectively.

------------------------------------------------------------------------
r6714 | reid | 2008-05-08 17:36:07 -0500 (Thu, 08 May 2008) | 4 lines

1. Add legal blurb in save box (bug #317).
2. Restore rating help blurb removed in error in r6688.
3. Remove a couple of references to "Magic Bicycle Map".

------------------------------------------------------------------------
r6706 | reid | 2008-05-08 12:53:26 -0500 (Thu, 08 May 2008) | 9 lines

Merged revisions 6655-6705 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/sheppard

........
  r6698 | sheppard | 2008-05-07 16:15:36 -0500 (Wed, 07 May 2008) | 1 line
  
  removed null pasword check from setPassword
........

------------------------------------------------------------------------
r6690 | reid | 2008-05-06 18:06:26 -0500 (Tue, 06 May 2008) | 2 lines

Keep counterpart pairs together when discarding off-viewport features (#299).

------------------------------------------------------------------------
r6688 | reid | 2008-05-06 15:50:42 -0500 (Tue, 06 May 2008) | 44 lines

Merge from Michael; bugs #273, #274, #279 fixed in trunk.

Merged revisions 6053-6061,6063-6067,6069-6098,6103-6108,6110-6114,6118-6139,6141-6154,6156-6168,6170-6205,6207-6229,6231-6239,6241-6245,6248,6250-6682 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r6591 | mludwig | 2008-04-23 15:09:04 -0500 (Wed, 23 Apr 2008) | 1 line
  
  Merged in from trunk
........
  r6594 | mludwig | 2008-04-23 16:32:31 -0500 (Wed, 23 Apr 2008) | 1 line
  
  Saving geopoints no longer fails incorrectly
........
  r6595 | mludwig | 2008-04-23 16:35:28 -0500 (Wed, 23 Apr 2008) | 1 line
  
  Disabled multiselection for geopoints
........
  r6620 | mludwig | 2008-04-25 18:05:12 -0500 (Fri, 25 Apr 2008) | 1 line
  
  Added diffing support to the geopoint panel
........
  r6643 | mludwig | 2008-04-29 15:13:31 -0500 (Tue, 29 Apr 2008) | 1 line
  
  Major progress in byway/annotation panels (just need annot diffing now)
........
  r6654 | mludwig | 2008-05-01 13:58:06 -0500 (Thu, 01 May 2008) | 1 line
  
  Fixed the UI glitches with the annotation panel (Fixed Bug #274)
........
  r6656 | mludwig | 2008-05-01 15:37:48 -0500 (Thu, 01 May 2008) | 1 line
  
  Completed impl of detail panels (Fixed Bug #274)
........
  r6676 | mludwig | 2008-05-05 16:32:25 -0500 (Mon, 05 May 2008) | 1 line
  
  Robustified annot_bs/annotation fetching (Fixed Bug #279)
........
  r6677 | mludwig | 2008-05-05 16:36:08 -0500 (Mon, 05 May 2008) | 1 line
  
  Removed extraneous log messages
........


------------------------------------------------------------------------
r6682 | reid | 2008-05-06 12:14:57 -0500 (Tue, 06 May 2008) | 8 lines

Blocked revisions 6045 via svnmerge

........
  r6045 | mludwig | 2008-01-31 12:03:45 -0600 (Thu, 31 Jan 2008) | 1 line
  
  Tried to make private status clearer for ratings (Fixed Bug #254)
........

------------------------------------------------------------------------
r6678 | reid | 2008-05-05 17:28:17 -0500 (Mon, 05 May 2008) | 1 line

add two non-academic presentations
------------------------------------------------------------------------
r6675 | reid | 2008-05-05 12:55:35 -0500 (Mon, 05 May 2008) | 1 line

Remove redundant user verification in wfs_Hello.
------------------------------------------------------------------------
r6674 | reid | 2008-05-05 12:53:08 -0500 (Mon, 05 May 2008) | 11 lines

Some minor log tweaking (bug #322):

1. Put the username of the requestor (if logged in) in the Apache access log
   REMOTE_USER slot.

2. Make request processing time (at millisecond resolution) available for
   Apache logging.

3. Record failed logins in Apache log instead of pyserver log.


------------------------------------------------------------------------
r6664 | reid | 2008-05-01 16:33:21 -0500 (Thu, 01 May 2008) | 1 line

Reject logins with null password or too-short password
------------------------------------------------------------------------
r6655 | reid | 2008-05-01 15:18:58 -0500 (Thu, 01 May 2008) | 34 lines

Merged revisions 6394-6654 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/sheppard

........
  r6395 | sheppard | 2008-03-27 17:57:05 -0500 (Thu, 27 Mar 2008) | 3 lines
  
  Removed merge tracking for "svnmerge" for 
  file:///project/Grouplens/subversion-repository/cyclingproject/branches/mludwig
........
  r6396 | sheppard | 2008-03-27 18:17:51 -0500 (Thu, 27 Mar 2008) | 1 line
  
  Merged in from trunk.
........
  r6476 | sheppard | 2008-04-08 14:50:22 -0500 (Tue, 08 Apr 2008) | 1 line
  
  Merged in from trunk.
........
  r6551 | sheppard | 2008-04-18 16:37:22 -0500 (Fri, 18 Apr 2008) | 1 line
  
  Created MediaWiki authentication plugin (Bug #261)
........
  r6602 | sheppard | 2008-04-24 14:33:10 -0500 (Thu, 24 Apr 2008) | 1 line
  
  code reorganization
........
  r6604 | sheppard | 2008-04-24 16:28:05 -0500 (Thu, 24 Apr 2008) | 1 line
  
  Merged from trunk.
........
  r6605 | sheppard | 2008-04-24 16:48:36 -0500 (Thu, 24 Apr 2008) | 1 line
  
  updated cycloauth to use new db functions
........

------------------------------------------------------------------------
r6645 | reid | 2008-04-29 17:47:09 -0500 (Tue, 29 Apr 2008) | 2 lines

Improve labeling of byways in raster mode. (Bug #129)

------------------------------------------------------------------------
r6622 | reid | 2008-04-25 19:02:28 -0500 (Fri, 25 Apr 2008) | 1 line

fun script to count our lines
------------------------------------------------------------------------
r6621 | reid | 2008-04-25 18:15:47 -0500 (Fri, 25 Apr 2008) | 2 lines

Fetch by HTTPS when login credentials are being sent. (Fixed: #113.)

------------------------------------------------------------------------
r6608 | reid | 2008-04-24 18:59:04 -0500 (Thu, 24 Apr 2008) | 2 lines

Implemente client-side auto-logout on idle (part of bug #113).

------------------------------------------------------------------------
r6603 | reid | 2008-04-24 16:04:57 -0500 (Thu, 24 Apr 2008) | 2 lines

Implement password salting and hashing (part of Bug #113).

------------------------------------------------------------------------
r6597 | reid | 2008-04-23 17:26:19 -0500 (Wed, 23 Apr 2008) | 3 lines

Add a note about how to rate bikeability, with a link to help pages.
(Bug #254.)

------------------------------------------------------------------------
r6522 | reid | 2008-04-15 14:04:14 -0500 (Tue, 15 Apr 2008) | 2 lines

Implement basic geodiffing for points.

------------------------------------------------------------------------
r6486 | reid | 2008-04-10 15:27:37 -0500 (Thu, 10 Apr 2008) | 1 line

stats for paper
------------------------------------------------------------------------
r6422 | reid | 2008-04-02 19:08:04 -0500 (Wed, 02 Apr 2008) | 2 lines

Translate a JavaScript diffing library into ActionScript.

------------------------------------------------------------------------
r6414 | reid | 2008-04-02 11:39:39 -0500 (Wed, 02 Apr 2008) | 2 lines

Can now use the map to view an arbitrary revision.

------------------------------------------------------------------------
r6407 | reid | 2008-03-31 18:32:54 -0500 (Mon, 31 Mar 2008) | 10 lines

Geofeatures' layer order is now defined by a Z-order taken from the features
themselves, not an ad-hoc ordering hardcoded in Map_Canvas.

Branches will need to update their databases, either dump-and-reload or run
010-z-order.sql.

If you are on the Cyclingproject team and read this sentence, send me an
e-mail. I want to see who is reading the commit messages.


------------------------------------------------------------------------
r6399 | reid | 2008-03-28 19:14:11 -0500 (Fri, 28 Mar 2008) | 2 lines

History browser loads most recent 50 revisions and displays their metadata.

------------------------------------------------------------------------
r6394 | reid | 2008-03-27 17:33:20 -0500 (Thu, 27 Mar 2008) | 5 lines

From Andrew:
1. Merge Throbber placement fix.
2. Merge new compass rose pan control (bugs #44, #252).
... with a few tweaks.

------------------------------------------------------------------------
r6393 | reid | 2008-03-27 16:50:24 -0500 (Thu, 27 Mar 2008) | 3 lines

Initialized merge tracking via "svnmerge" with revisions "1-6232" from 
file:///project/Grouplens/svn/cyclingproject/branches/sheppard

------------------------------------------------------------------------
r6384 | reid | 2008-03-26 17:32:09 -0500 (Wed, 26 Mar 2008) | 2 lines

Cosmetic tweaks for Flex 3 (bug #103).

------------------------------------------------------------------------
r6379 | reid | 2008-03-26 15:10:32 -0500 (Wed, 26 Mar 2008) | 60 lines

Merge Michael's annotations infrastructure with a few modifications.

Merged revisions 6022-6023,6029,6035-6044,6053-6061,6063-6067,6069-6098,6103-6362 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r6109 | mludwig | 2008-02-08 16:57:15 -0600 (Fri, 08 Feb 2008) | 1 line
  
  Added a layer of abstraction between Feature and Geofeature
........
  r6115 | mludwig | 2008-02-13 15:54:19 -0600 (Wed, 13 Feb 2008) | 1 line
  
  Added the commands for editing annotations
........
  r6116 | mludwig | 2008-02-13 16:01:00 -0600 (Wed, 13 Feb 2008) | 1 line
  
  Made previous commit work with old code, should be merged together with 6115
........
  r6117 | mludwig | 2008-02-13 17:34:59 -0600 (Wed, 13 Feb 2008) | 1 line
  
  First draft of client annotations, untested until server annots are done
........
  r6140 | mludwig | 2008-02-15 17:55:09 -0600 (Fri, 15 Feb 2008) | 1 line
  
  Cleaner add/discard code and new fresh feature id system on client
........
  r6155 | mludwig | 2008-02-20 15:13:07 -0600 (Wed, 20 Feb 2008) | 1 line
  
  Added rough client annotation viewing plus better id handling on pyserver
........
  r6169 | mludwig | 2008-02-21 17:20:55 -0600 (Thu, 21 Feb 2008) | 1 line
  
  Fixed bugs in and nicefied client annotation ui
........
  r6206 | mludwig | 2008-02-26 17:01:54 -0600 (Tue, 26 Feb 2008) | 1 line
  
  Added Annot_BS for client and server and synced client/server feature types
........
  r6230 | mludwig | 2008-02-28 13:51:14 -0600 (Thu, 28 Feb 2008) | 1 line
  
  Fixed some bugs caused by the addition of Annot_BS
........
  r6240 | mludwig | 2008-02-28 17:20:08 -0600 (Thu, 28 Feb 2008) | 1 line
  
  Saving and fetching of annotations works, woohoo!
........
  r6246 | mludwig | 2008-02-29 15:34:18 -0600 (Fri, 29 Feb 2008) | 1 line
  
  A few minor bug fixes with annotation handling on server and client
........
  r6247 | mludwig | 2008-02-29 16:25:12 -0600 (Fri, 29 Feb 2008) | 1 line
  
  Bywyas redrawn when an annotation is deleted
........
  r6249 | mludwig | 2008-02-29 18:27:13 -0600 (Fri, 29 Feb 2008) | 1 line
  
  Added highlighting of byways for selected annotations
........


------------------------------------------------------------------------
r6356 | reid | 2008-03-21 17:14:37 -0500 (Fri, 21 Mar 2008) | 28 lines

1. Merge Michael's multiselection infrastructure.
2. Make Control key work the same as Shift in multiselection.

Merged revisions 6062-6100 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

................
  r6062 | mludwig | 2008-02-01 18:40:24 -0600 (Fri, 01 Feb 2008) | 1 line
  
  Multi-selection infrastructure in place, still need to make the detail panels
................
  r6068 | mludwig | 2008-02-05 16:38:53 -0600 (Tue, 05 Feb 2008) | 1 line
  
  Made the selection ornament prettier
................
  r6099 | mludwig | 2008-02-07 14:51:03 -0600 (Thu, 07 Feb 2008) | 132 lines
  
  Merged revisions 6025-6098 via svnmerge from 
  file:///project/Grouplens/svn/cyclingproject/trunk
  
................
  r6100 | mludwig | 2008-02-07 15:01:22 -0600 (Thu, 07 Feb 2008) | 1 line
  
  Fixed bug where glow filter on selection would dissappear after login
................



------------------------------------------------------------------------
r6353 | reid | 2008-03-21 13:02:00 -0500 (Fri, 21 Mar 2008) | 3 lines

Implement a "grace" area so tiny drags intended to be clicks (we assume) are
interpreted as the latter. Based on Michael's patch for same.

------------------------------------------------------------------------
r6326 | reid | 2008-03-18 18:13:43 -0500 (Tue, 18 Mar 2008) | 17 lines

1. Merge from Michael.
2. Put app at site root (e.g. http:/foo/, not http://foo/main.html).

Merged revisions 6101-6102 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r6101 | mludwig | 2008-02-07 15:20:27 -0600 (Thu, 07 Feb 2008) | 1 line
  
  Confirmed that newest flash player works, updated main.html (Fixed Bug #253)
........
  r6102 | mludwig | 2008-02-07 15:41:35 -0600 (Thu, 07 Feb 2008) | 1 line
  
  Cue sheet no longer has interactive highlights (Fixed Bug #269)
........


------------------------------------------------------------------------
r6325 | reid | 2008-03-18 17:48:08 -0500 (Tue, 18 Mar 2008) | 10 lines

Merged revisions 6052 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r6052 | mludwig | 2008-01-31 15:47:20 -0600 (Thu, 31 Jan 2008) | 1 line
  
  Consolidate dirty handling into Command (Fixed Bug #225)
........


------------------------------------------------------------------------
r6324 | reid | 2008-03-18 17:31:49 -0500 (Tue, 18 Mar 2008) | 1 line

name change
------------------------------------------------------------------------
r6086 | reid | 2008-02-06 17:38:36 -0600 (Wed, 06 Feb 2008) | 13 lines

1. Trim margin in HTML container. (Fixed: #264.)
2. Implement an automated build version tag in the client.

Merged revisions 6051 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r6051 | mludwig | 2008-01-31 15:13:28 -0600 (Thu, 31 Jan 2008) | 1 line
  
  Changed background color of html main page (Fixed Bug #264)
........


------------------------------------------------------------------------
r6082 | reid | 2008-02-06 14:44:30 -0600 (Wed, 06 Feb 2008) | 10 lines

Merged revisions 6050 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r6050 | mludwig | 2008-01-31 14:59:40 -0600 (Thu, 31 Jan 2008) | 1 line
  
  selection restored on undo/redo (Fixed Bugs #219 and #208)
........


------------------------------------------------------------------------
r6081 | reid | 2008-02-06 14:40:32 -0600 (Wed, 06 Feb 2008) | 24 lines

Merge several bugfixes from Michael.

Merged revisions 6046-6049 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r6046 | mludwig | 2008-01-31 14:15:16 -0600 (Thu, 31 Jan 2008) | 1 line
  
  Bike map now retains modified geofeatures (Fixed Bug #210)
........
  r6047 | mludwig | 2008-01-31 14:25:38 -0600 (Thu, 31 Jan 2008) | 1 line
  
  Retains selection on discard (Fixed Bug #209)
........
  r6048 | mludwig | 2008-01-31 14:39:40 -0600 (Thu, 31 Jan 2008) | 1 line
  
  Modified Geofeatures are retained through login/out actions
........
  r6049 | mludwig | 2008-01-31 14:47:35 -0600 (Thu, 31 Jan 2008) | 1 line
  
  Route no longer dissappears when changes are discarded (Fixed Bug #265)
........


------------------------------------------------------------------------
r6080 | reid | 2008-02-06 14:23:21 -0600 (Wed, 06 Feb 2008) | 12 lines

Merge Michael's menubar changes.

Merged revisions 6034 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r6034 | mludwig | 2008-01-25 18:35:43 -0600 (Fri, 25 Jan 2008) | 1 line
  
  Removed menubars, ui overhaul (Fixed Bugs #218, #260, #224)
........


------------------------------------------------------------------------
r6071 | reid | 2008-02-05 17:12:41 -0600 (Tue, 05 Feb 2008) | 24 lines

Merge some bugfixes from Michael.

Merged revisions 6027,6029,6031-6033 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r6027 | mludwig | 2008-01-23 11:33:39 -0600 (Wed, 23 Jan 2008) | 1 line
  
  Panning on road doesn't improperly change side panel (Fixed Bug #250)
........
  r6031 | mludwig | 2008-01-25 16:41:26 -0600 (Fri, 25 Jan 2008) | 1 line
  
  Better invisible mouse catcher made, plus safer dragging (Fixed Bug #243).
........
  r6032 | mludwig | 2008-01-25 16:58:17 -0600 (Fri, 25 Jan 2008) | 1 line
  
  Adjust save changes ok and cancel button labels (Fixed Bug #251)
........
  r6033 | mludwig | 2008-01-25 17:09:54 -0600 (Fri, 25 Jan 2008) | 1 line
  
  Added a confirm dialog for Geofeature deletion (Fixed Bug #257)
........


------------------------------------------------------------------------
r6067 | reid | 2008-02-05 16:36:02 -0600 (Tue, 05 Feb 2008) | 28 lines

Printer friendly cue sheet work from Michael. (Fixed: #244, #262.)

Merged revisions 6024-6026,6028-6030 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r6024 | mludwig | 2008-01-22 11:58:42 -0600 (Tue, 22 Jan 2008) | 1 line
  
  Initial draft of printer friendly cue sheet
........
  r6025 | mludwig | 2008-01-22 12:12:54 -0600 (Tue, 22 Jan 2008) | 1 line
  
  Merge in Reid's tweaks to direction code
........
  r6026 | mludwig | 2008-01-22 12:34:01 -0600 (Tue, 22 Jan 2008) | 1 line
  
  Added Reid's desired cosmetic tweaks for the directions (Fixed Bug #244)
........
  r6028 | mludwig | 2008-01-24 14:31:38 -0600 (Thu, 24 Jan 2008) | 1 line
  
  Improved the direction arrows (Fixed Bug #262)
........
  r6030 | mludwig | 2008-01-24 17:18:07 -0600 (Thu, 24 Jan 2008) | 1 line
  
  Cleaned up direction finding code
........


------------------------------------------------------------------------
r6066 | reid | 2008-02-05 12:44:37 -0600 (Tue, 05 Feb 2008) | 8 lines

Blocked revisions 6045 via svnmerge

........
  r6045 | mludwig | 2008-01-31 12:03:45 -0600 (Thu, 31 Jan 2008) | 1 line
  
  Tried to make private status clearer for ratings (Fixed Bug #254)
........

------------------------------------------------------------------------
r6023 | reid | 2008-01-17 18:18:58 -0600 (Thu, 17 Jan 2008) | 2 lines

Merge Michael's work on turn-by-turn directions (bug #89).

------------------------------------------------------------------------
r5951 | reid | 2007-12-11 15:43:47 -0600 (Tue, 11 Dec 2007) | 2 lines

Make the find routes window a little more user-friendly. (Fixes #234.)

------------------------------------------------------------------------
r5950 | reid | 2007-12-11 15:24:21 -0600 (Tue, 11 Dec 2007) | 1 line

visual tag to clarify which branch you're seeing
------------------------------------------------------------------------
r5926 | reid | 2007-11-30 18:26:02 -0600 (Fri, 30 Nov 2007) | 3 lines

1. Try again on fixing menu-bar related crashes.
2. Make the menu bar a little prettier.

------------------------------------------------------------------------
r5918 | reid | 2007-11-29 15:17:22 -0600 (Thu, 29 Nov 2007) | 2 lines

Try to avoid crashes in menus_refresh().

------------------------------------------------------------------------
r5914 | reid | 2007-11-28 16:24:49 -0600 (Wed, 28 Nov 2007) | 3 lines

Add manual kicking of the menu bar to make it listen to changes. I think this
fixes #237.

------------------------------------------------------------------------
r5913 | reid | 2007-11-28 16:11:06 -0600 (Wed, 28 Nov 2007) | 2 lines

Reorganize menus to standard File/Edit (fixes: #238).

------------------------------------------------------------------------
r5900 | reid | 2007-11-26 16:36:39 -0600 (Mon, 26 Nov 2007) | 4 lines

Change count of unsaved changes to a button that you can click to save.
(Fixed: #241.)


------------------------------------------------------------------------
r5897 | reid | 2007-11-21 17:40:13 -0600 (Wed, 21 Nov 2007) | 1 line

tool_choose() was in a better place before - cursor changes sooner
------------------------------------------------------------------------
r5896 | reid | 2007-11-21 17:38:21 -0600 (Wed, 21 Nov 2007) | 3 lines

Make menu items toggle properly again. (Fixes #233.) Flex menu system is
ridiculous garbage.

------------------------------------------------------------------------
r5895 | reid | 2007-11-21 16:34:50 -0600 (Wed, 21 Nov 2007) | 2 lines

Add byway type to UI (bug #235).

------------------------------------------------------------------------
r5893 | reid | 2007-11-21 14:49:39 -0600 (Wed, 21 Nov 2007) | 4 lines

1. Make the pan buttons operate in the correct direction (#236).
2. Cosmetic tweaks to zoom in/out buttons.


------------------------------------------------------------------------
r5892 | reid | 2007-11-21 13:52:42 -0600 (Wed, 21 Nov 2007) | 26 lines

Merged revisions 5876-5891 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r5880 | mludwig | 2007-11-19 17:49:20 -0600 (Mon, 19 Nov 2007) | 1 line
  
  Merged in from trunk
........
  r5882 | mludwig | 2007-11-19 19:21:49 -0600 (Mon, 19 Nov 2007) | 1 line
  
  Panning no longer inappropriately selects features (Fixed Bug #215)
........
  r5883 | mludwig | 2007-11-19 19:41:46 -0600 (Mon, 19 Nov 2007) | 1 line
  
  Merged in even more stuff from trunk
........
  r5884 | mludwig | 2007-11-19 20:03:51 -0600 (Mon, 19 Nov 2007) | 1 line
  
  Routes persist on the map (Fixed Bug #229)
........
  r5886 | mludwig | 2007-11-20 16:54:17 -0600 (Tue, 20 Nov 2007) | 1 line
  
  Discard changes has a confirmation dialogue (Fixed Bug #222)
........


------------------------------------------------------------------------
r5891 | reid | 2007-11-21 13:48:39 -0600 (Wed, 21 Nov 2007) | 1 line

change display order to put bike trails on top of roads in most cases
------------------------------------------------------------------------
r5881 | reid | 2007-11-19 17:54:38 -0600 (Mon, 19 Nov 2007) | 5 lines

Some visual cleanup in preparation for experiment. (Fixes: #189)

Michael -- you'll need to rebuild your tiles after merging.


------------------------------------------------------------------------
r5878 | reid | 2007-11-19 15:17:39 -0600 (Mon, 19 Nov 2007) | 2 lines

Cosmetic tweaks. (Fixes: #206)

------------------------------------------------------------------------
r5876 | reid | 2007-11-19 14:35:59 -0600 (Mon, 19 Nov 2007) | 16 lines

Merged: #217, #226.

Merged revisions 5863-5875 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r5863 | mludwig | 2007-11-16 19:11:04 -0600 (Fri, 16 Nov 2007) | 1 line
  
  Text_Field_Editable no longer loses focus on record(), removed stale boolean
........
  r5864 | mludwig | 2007-11-16 19:59:50 -0600 (Fri, 16 Nov 2007) | 1 line
  
  Rating_Picker rating is always set (Fixed Bug #217)
........


------------------------------------------------------------------------
r5875 | reid | 2007-11-19 14:29:11 -0600 (Mon, 19 Nov 2007) | 9 lines

Merged revisions 5856,5858-5860,5862 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r5862 | mludwig | 2007-11-16 18:49:33 -0600 (Fri, 16 Nov 2007) | 1 line
  
  Removed Text_Field_Editable.cache (Fixed Bug #223)
........

------------------------------------------------------------------------
r5874 | reid | 2007-11-19 14:18:37 -0600 (Mon, 19 Nov 2007) | 16 lines

Merged to trunk: #213, #221, with no changes (kudos Michael!).

Merged revisions 5857-5861 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r5857 | mludwig | 2007-11-16 17:17:55 -0600 (Fri, 16 Nov 2007) | 1 line
  
  Merged in everything but Map_Key from the trunk
........
  r5861 | mludwig | 2007-11-16 18:37:19 -0600 (Fri, 16 Nov 2007) | 1 line
  
  No longer using old Editor popups for creation (Fixed Bugs #213, #221)
........


------------------------------------------------------------------------
r5856 | reid | 2007-11-16 17:13:46 -0600 (Fri, 16 Nov 2007) | 21 lines

Merge Michael's map key. Further aesthetic tweaks may be required later, but
for now it's pretty good.

Merged revisions 5727-5734,5736,5740-5743,5745-5752,5755-5761,5763-5776,5780-5783,5787-5808,5811-5855 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r5819 | mludwig | 2007-11-12 14:24:33 -0600 (Mon, 12 Nov 2007) | 1 line
  
  Fixed a bug in Byway_Detail_Panel where it'd send a WFS_PutRating request when not logged in
........
  r5831 | mludwig | 2007-11-13 18:18:07 -0600 (Tue, 13 Nov 2007) | 1 line
  
  Map Key implemented, although you may want to tweak how it looks (Fixed Bug #170)
........
  r5854 | mludwig | 2007-11-16 16:25:41 -0600 (Fri, 16 Nov 2007) | 1 line
  
  Added the missing Map_Key.mxml
........


------------------------------------------------------------------------
r5855 | reid | 2007-11-16 16:29:50 -0600 (Fri, 16 Nov 2007) | 2 lines

Aesthetic tweaks in Item Details panel.

------------------------------------------------------------------------
r5853 | reid | 2007-11-16 15:49:55 -0600 (Fri, 16 Nov 2007) | 2 lines

Discard incoming tiles which are for the wrong zoom level. (Fixes: #198.)

------------------------------------------------------------------------
r5840 | reid | 2007-11-15 16:05:39 -0600 (Thu, 15 Nov 2007) | 10 lines

Merged revisions 5810 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r5810 | mludwig | 2007-11-09 19:28:09 -0600 (Fri, 09 Nov 2007) | 1 line
  
  User byway ratings can be entered by keyboard input (Fixes Bug #194)
........


------------------------------------------------------------------------
r5839 | reid | 2007-11-15 15:14:55 -0600 (Thu, 15 Nov 2007) | 3 lines

Very minor code cleanups. This puts to bed: #187 #188 #190 #191 #192 #195.


------------------------------------------------------------------------
r5837 | reid | 2007-11-14 17:45:04 -0600 (Wed, 14 Nov 2007) | 2 lines

Make rating undoable and saved with PutFeature.

------------------------------------------------------------------------
r5834 | reid | 2007-11-14 15:07:00 -0600 (Wed, 14 Nov 2007) | 3 lines

Small robustness improvement to Text_Field_Editable event handling, cosmetic
tweaks.

------------------------------------------------------------------------
r5833 | reid | 2007-11-14 12:29:11 -0600 (Wed, 14 Nov 2007) | 4 lines

1. Change semantics of unsaved changes count: now counts commands, not objects
   with changes.
2. Cosmetic changes to command descriptors.

------------------------------------------------------------------------
r5830 | reid | 2007-11-13 17:40:13 -0600 (Tue, 13 Nov 2007) | 2 lines

Aesthetic changes on Item Details panels.

------------------------------------------------------------------------
r5826 | reid | 2007-11-13 16:41:35 -0600 (Tue, 13 Nov 2007) | 6 lines

Make clicking to deselect work again.

(Michael -- turns out I misunderstood what your mouse_down and mouse_moving
attributes did. This reintroduces your behavior, I think, but in a simpler
way, and it makes this.dragging mean what I had originally meant it to mean.)

------------------------------------------------------------------------
r5824 | reid | 2007-11-13 15:59:27 -0600 (Tue, 13 Nov 2007) | 2 lines

Some menu bar appearance tweaks and logic/interface simplification.

------------------------------------------------------------------------
r5820 | reid | 2007-11-12 15:16:31 -0600 (Mon, 12 Nov 2007) | 69 lines

Merge Michael's UI redesign work -- minimal changes to get it to compile.

Merged revisions 5735-5809 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

................
  r5735 | mludwig | 2007-10-16 15:36:27 -0500 (Tue, 16 Oct 2007) | 157 lines
  
  Merged revisions 1035-5734 via svnmerge from 
  file:///project/Grouplens/svn/cyclingproject/trunk
................
  r5737 | mludwig | 2007-10-16 15:51:43 -0500 (Tue, 16 Oct 2007) | 1 line
  
  Fixed small bug where dummy geopoint wasn't removed properly
................
  r5738 | mludwig | 2007-10-16 17:04:52 -0500 (Tue, 16 Oct 2007) | 1 line
  
  Removed tooltip functionality from client (Fixed Bug #190)
................
  r5739 | mludwig | 2007-10-16 17:18:55 -0500 (Tue, 16 Oct 2007) | 1 line
  
  Moved direction arrows onto the highlights layer
................
  r5744 | mludwig | 2007-10-17 20:06:31 -0500 (Wed, 17 Oct 2007) | 1 line
  
  Replaced Edit accordion with a menu (Fixed Bug #192)
................
  r5753 | mludwig | 2007-10-24 15:29:28 -0500 (Wed, 24 Oct 2007) | 1 line
  
  Changed selection to a command, added empty item details widget
................
  r5754 | mludwig | 2007-10-24 17:21:25 -0500 (Wed, 24 Oct 2007) | 1 line
  
  Non-persistent editable item detail panels added
................
  r5762 | mludwig | 2007-10-26 19:14:33 -0500 (Fri, 26 Oct 2007) | 1 line
  
  Restored original selection functionality.  Select is no longer a command.
................
  r5777 | mludwig | 2007-10-31 18:45:31 -0500 (Wed, 31 Oct 2007) | 1 line
  
  Implementation of editable text fields, must still be tested
................
  r5778 | mludwig | 2007-10-31 19:18:32 -0500 (Wed, 31 Oct 2007) | 1 line
  
  Merged in Reid's mouse handling stuff (r5770, r5771)
................
  r5779 | mludwig | 2007-10-31 21:08:29 -0500 (Wed, 31 Oct 2007) | 1 line
  
  Finished the Item Details panel for the new UI (Fixed Bug #191)
................
  r5784 | mludwig | 2007-11-02 18:38:18 -0500 (Fri, 02 Nov 2007) | 1 line
  
  Undo/Redo stack preserved on login/logout (Fixed Bug #188)
................
  r5785 | mludwig | 2007-11-02 18:43:31 -0500 (Fri, 02 Nov 2007) | 1 line
  
  Discard changes implemented (Fixed Bug #195)
................
  r5786 | mludwig | 2007-11-02 19:16:22 -0500 (Fri, 02 Nov 2007) | 1 line
  
  Undo/Redo menu options change to reflect command (Fixed Bug #193)
................
  r5809 | mludwig | 2007-11-09 17:41:59 -0600 (Fri, 09 Nov 2007) | 1 line
  
  Added a delete button to side panels, and a rating picker for the byway panel.  Plus a minor text tweak for UI
................


------------------------------------------------------------------------
r5771 | reid | 2007-10-31 12:22:15 -0500 (Wed, 31 Oct 2007) | 7 lines

Work around loss of mouse-up events that happen outside the application
window. (Fixed: #197.)

1. Dispatch fake mouse-up event when mouse leaves map.
2. Remove Mouseup_Receiver.as &c., a similar but less general workaround.


------------------------------------------------------------------------
r5770 | reid | 2007-10-31 11:45:42 -0500 (Wed, 31 Oct 2007) | 2 lines

Implement custom cursor for New Point tool. (Fixed: #182.)

------------------------------------------------------------------------
r5765 | reid | 2007-10-29 15:37:29 -0500 (Mon, 29 Oct 2007) | 3 lines

Stop drawing little blue highlight unless connectivity highlighting is
selected. (Fixes: #205.)

------------------------------------------------------------------------
r5764 | reid | 2007-10-29 15:24:38 -0500 (Mon, 29 Oct 2007) | 3 lines

Disable multiselection for now (fixes: #203) and refactor some methods into
superclasses.

------------------------------------------------------------------------
r5763 | reid | 2007-10-29 15:12:23 -0500 (Mon, 29 Oct 2007) | 2 lines

Remove unimplemented options from the Find Route dialog. (Fixed: #200.)

------------------------------------------------------------------------
r5761 | reid | 2007-10-26 17:23:02 -0500 (Fri, 26 Oct 2007) | 2 lines

Make "enter" click the OK button in dialogs. (Fixes: #199)

------------------------------------------------------------------------
r5740 | reid | 2007-10-16 19:09:56 -0500 (Tue, 16 Oct 2007) | 2 lines

Make selection ornament cooler (fixes: #196).

------------------------------------------------------------------------
r5733 | reid | 2007-10-12 17:29:15 -0500 (Fri, 12 Oct 2007) | 1 line

tweak annotation indicator color
------------------------------------------------------------------------
r5729 | reid | 2007-10-11 18:27:08 -0500 (Thu, 11 Oct 2007) | 1 line

another pass at experimental color scheme
------------------------------------------------------------------------
r5728 | reid | 2007-10-11 17:35:05 -0500 (Thu, 11 Oct 2007) | 17 lines

Merge Michael's crash on login and losing track of dirty features (bugs #169,
180).

Merged revisions 1048-5726 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r1050 | mludwig | 2007-10-10 17:21:24 -0500 (Wed, 10 Oct 2007) | 1 line
  
  dirtyset and visible routes are kept on login-out (Fixed Bugs #180, #169)
........
  r1051 | mludwig | 2007-10-10 17:29:07 -0500 (Wed, 10 Oct 2007) | 1 line
  
  Minor change to r1050 to keep usage of Set consistent
........


------------------------------------------------------------------------
r1053 | reid | 2007-10-10 19:53:47 -0500 (Wed, 10 Oct 2007) | 2 lines

Start using pylint. Fixed: #78.

------------------------------------------------------------------------
r1052 | reid | 2007-10-10 19:03:50 -0500 (Wed, 10 Oct 2007) | 1 line

first pass at pylint checking
------------------------------------------------------------------------
r1049 | reid | 2007-10-10 14:49:08 -0500 (Wed, 10 Oct 2007) | 12 lines

Merge Michael's byway comment stuff. Fixed in trunk: #108.

Merged revisions 1037-1042,1044-1047 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r1042 | mludwig | 2007-10-09 17:32:02 -0500 (Tue, 09 Oct 2007) | 1 line
  
  Implemented byway comments (Fixed Bug #108, for now)
........


------------------------------------------------------------------------
r1047 | reid | 2007-10-09 18:10:49 -0500 (Tue, 09 Oct 2007) | 9 lines

Merged revisions 1043 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r1043 | mludwig | 2007-10-09 17:44:14 -0500 (Tue, 09 Oct 2007) | 1 line
  
  Map now resets features on logout (Fixes Bug #181)
........

------------------------------------------------------------------------
r1046 | reid | 2007-10-09 18:10:01 -0500 (Tue, 09 Oct 2007) | 9 lines

Merged revisions 1036 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r1036 | reid | 2007-10-05 16:03:40 -0500 (Fri, 05 Oct 2007) | 1 line
  
  add svnsurrender.py merge helper script
........

------------------------------------------------------------------------
r1045 | reid | 2007-10-09 18:09:14 -0500 (Tue, 09 Oct 2007) | 60 lines

Merged revisions 1024-1035 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

................
  r1024 | reid | 2007-10-03 18:29:18 -0500 (Wed, 03 Oct 2007) | 2 lines
  
  New branch for Michael.
................
  r1025 | reid | 2007-10-03 18:29:52 -0500 (Wed, 03 Oct 2007) | 2 lines
  
  test
................
  r1026 | mludwig | 2007-10-03 18:37:23 -0500 (Wed, 03 Oct 2007) | 3 lines
  
  Initialized merge tracking via "svnmerge" with revisions "1-1025" from 
  file:///project/Grouplens/svn/cyclingproject/trunk
................
  r1027 | mludwig | 2007-10-03 18:49:03 -0500 (Wed, 03 Oct 2007) | 3 lines
  
  Removed merge tracking for "svnmerge" for 
  file:///project/Grouplens/svn/cyclingproject/branches/mludwig2
................
  r1032 | reid | 2007-10-05 15:00:10 -0500 (Fri, 05 Oct 2007) | 1 line
  
  remove erroneous copy
................
  r1033 | reid | 2007-10-05 15:02:34 -0500 (Fri, 05 Oct 2007) | 1 line
  
  test commit -- create conflicting line
................
  r1035 | reid | 2007-10-05 16:01:05 -0500 (Fri, 05 Oct 2007) | 28 lines
  
  Test merge using svnsurrender.
  
  Merged revisions 1026-1034 via svnmerge from 
  file:///project/Grouplens/svn/cyclingproject/trunk
  
  ........
    r1028 | reid | 2007-10-03 19:02:53 -0500 (Wed, 03 Oct 2007) | 2 lines
    
    Import TCBC bike shops. (Fixed: #172.)
  ........
    r1029 | reid | 2007-10-04 17:45:17 -0500 (Thu, 04 Oct 2007) | 2 lines
    
    Add package required to compile lxml.etree.
  ........
    r1030 | reid | 2007-10-04 17:46:30 -0500 (Thu, 04 Oct 2007) | 2 lines
    
    Respect one-way in routing. (Fixed: #162.)
  ........
    r1031 | reid | 2007-10-05 14:24:05 -0500 (Fri, 05 Oct 2007) | 2 lines
    
    Fix Map_Canvas.lookat() (bug #178).
  ........
    r1034 | reid | 2007-10-05 15:02:50 -0500 (Fri, 05 Oct 2007) | 1 line
    
    test commit -- create conflicting line
  ........
................

------------------------------------------------------------------------
r1044 | reid | 2007-10-09 18:03:27 -0500 (Tue, 09 Oct 2007) | 2 lines

another experimental color scheme.

------------------------------------------------------------------------
r1041 | reid | 2007-10-09 14:45:02 -0500 (Tue, 09 Oct 2007) | 2 lines

Add halo around map labels to enhance legibility.

------------------------------------------------------------------------
r1040 | reid | 2007-10-08 17:34:46 -0500 (Mon, 08 Oct 2007) | 2 lines

Prototype a new color scheme.

------------------------------------------------------------------------
r1038 | reid | 2007-10-05 16:05:25 -0500 (Fri, 05 Oct 2007) | 3 lines

Initialized merge tracking via "svnmerge" with revisions "1-1023" from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

------------------------------------------------------------------------
r1037 | reid | 2007-10-05 16:05:02 -0500 (Fri, 05 Oct 2007) | 1 line

clean up branch merge testing stuff
------------------------------------------------------------------------
r1034 | reid | 2007-10-05 15:02:50 -0500 (Fri, 05 Oct 2007) | 1 line

test commit -- create conflicting line
------------------------------------------------------------------------
r1031 | reid | 2007-10-05 14:24:05 -0500 (Fri, 05 Oct 2007) | 2 lines

Fix Map_Canvas.lookat() (bug #178).

------------------------------------------------------------------------
r1030 | reid | 2007-10-04 17:46:30 -0500 (Thu, 04 Oct 2007) | 2 lines

Respect one-way in routing. (Fixed: #162.)

------------------------------------------------------------------------
r1029 | reid | 2007-10-04 17:45:17 -0500 (Thu, 04 Oct 2007) | 2 lines

Add package required to compile lxml.etree.

------------------------------------------------------------------------
r1028 | reid | 2007-10-03 19:02:53 -0500 (Wed, 03 Oct 2007) | 2 lines

Import TCBC bike shops. (Fixed: #172.)

------------------------------------------------------------------------
r1022 | reid | 2007-10-03 14:58:26 -0500 (Wed, 03 Oct 2007) | 1 line

add forgotten import
------------------------------------------------------------------------
r1021 | reid | 2007-10-03 14:58:06 -0500 (Wed, 03 Oct 2007) | 1 line

missed in r1019
------------------------------------------------------------------------
r1020 | reid | 2007-10-02 18:17:07 -0500 (Tue, 02 Oct 2007) | 3 lines

Restore the "smart" XML attribute setting missed by the DOM to ElementTree
conversion.

------------------------------------------------------------------------
r1019 | reid | 2007-10-02 18:01:26 -0500 (Tue, 02 Oct 2007) | 2 lines

Save found routes for analysis. (Fixes bug #159.)

------------------------------------------------------------------------
r1016 | reid | 2007-10-01 19:13:39 -0500 (Mon, 01 Oct 2007) | 4 lines

Replace cElementTree with lxml.etree for a considerable speed boost --
serialization of XML geodata now takes essentially zero time, saving 2 seconds
or more on large WFS requests.

------------------------------------------------------------------------
r1014 | reid | 2007-09-28 18:55:06 -0500 (Fri, 28 Sep 2007) | 2 lines

Implement a decent throbber, at last.

------------------------------------------------------------------------
r1013 | reid | 2007-09-27 18:26:10 -0500 (Thu, 27 Sep 2007) | 12 lines

Merge Michael's XML refactoring with a few tweaks. Fixed in trunk: #147.

Merged revisions 1011-1012 via svnmerge from 
file:///project/Grouplens/subversion-repository/cyclingproject/branches/mludwig2

........
  r1011 | mludwig | 2007-09-26 19:18:51 -0500 (Wed, 26 Sep 2007) | 1 line
  
  Switched everything to use cElementTree (Fixed Bug #147)
........


------------------------------------------------------------------------
r1012 | reid | 2007-09-27 16:23:27 -0500 (Thu, 27 Sep 2007) | 49 lines

Merge Michael's Geofeature deleting and new Geopoint UI improvements.
(Fixed in trunk: #143, 153.)

(The below has been edited to remove reflected revisions.)

Merged revisions 972-984,986-1010 via svnmerge from 
file:///project/Grouplens/subversion-repository/cyclingproject/branches/mludwig2

................
  r972 | mludwig | 2007-09-12 17:27:32 -0500 (Wed, 12 Sep 2007) | 1 line
  
  Preliminary commit for UI removing of geofeatures->untested
................
  r973 | mludwig | 2007-09-12 17:28:35 -0500 (Wed, 12 Sep 2007) | 1 line
  
  Forgot to add a file to the branch for last commit
................
  r974 | mludwig | 2007-09-17 14:16:31 -0500 (Mon, 17 Sep 2007) | 3 lines
  
  Initialized merge tracking via "svnmerge" with revisions "1-956" from 
  file:///project/Grouplens/svn/cyclingproject/trunk
................
  r975 | mludwig | 2007-09-17 14:21:15 -0500 (Mon, 17 Sep 2007) | 3 lines
  
  Removed merge tracking for "svnmerge" for 
  file:///project/Grouplens/svn/cyclingproject/branches/mludwig
................
  r978 | mludwig | 2007-09-17 18:10:26 -0500 (Mon, 17 Sep 2007) | 1 line
  
  Implemented dragging of new geopoints (Fixed Bug # 143)
................
  r983 | mludwig | 2007-09-19 14:55:52 -0500 (Wed, 19 Sep 2007) | 1 line
  
  fixed bug #153
................
  r986 | mludwig | 2007-09-19 16:05:44 -0500 (Wed, 19 Sep 2007) | 1 line
  
  Fixed some too-long lines for comments in prior commit
................
  r1005 | mludwig | 2007-09-25 16:11:12 -0500 (Tue, 25 Sep 2007) | 1 line
  
  Implemented a more elegant approach to geopoint creation
................
  r1006 | mludwig | 2007-09-25 16:18:51 -0500 (Tue, 25 Sep 2007) | 1 line
  
  Fixed user interface so geopoints could be undeleted, too
................


------------------------------------------------------------------------
r1010 | reid | 2007-09-26 17:17:05 -0500 (Wed, 26 Sep 2007) | 3 lines

Add an alert telling the user that routefinding might take a while and giving
the opportunity to cancel.

------------------------------------------------------------------------
r1009 | reid | 2007-09-26 14:22:02 -0500 (Wed, 26 Sep 2007) | 3 lines

Throbber chews lots of CPU time and leaks memory like a faucet (not just a
sieve). Disabling for now.

------------------------------------------------------------------------
r1007 | reid | 2007-09-25 17:31:32 -0500 (Tue, 25 Sep 2007) | 5 lines

routed: precompute less (bug #126), and compute turn angles correctly (#154).

Route-finding is fairly slow again, unfortunately.


------------------------------------------------------------------------
r1001 | reid | 2007-09-21 16:31:58 -0500 (Fri, 21 Sep 2007) | 1 line

performance hack on zoom out from vector to raster
------------------------------------------------------------------------
r999 | reid | 2007-09-21 16:11:53 -0500 (Fri, 21 Sep 2007) | 2 lines

Fix crash on zooming out several levels at once.

------------------------------------------------------------------------
r998 | reid | 2007-09-21 15:45:45 -0500 (Fri, 21 Sep 2007) | 4 lines

Stop representing turns by expanding network nodes into subgraphs (reverts
r545). Reduces memory use from 600M+ to 300M, and one route from St. Paul to
Hopkins now computes in 4 seconds, not >30!

------------------------------------------------------------------------
r996 | reid | 2007-09-20 17:03:48 -0500 (Thu, 20 Sep 2007) | 1 line

re-rate byways to correct for misrated non-expressway on/off ramps
------------------------------------------------------------------------
r995 | reid | 2007-09-20 15:52:21 -0500 (Thu, 20 Sep 2007) | 9 lines

Merged revisions 985 via svnmerge from 
file:///project/Grouplens/subversion-repository/cyclingproject/branches/mludwig2

........
  r985 | mludwig | 2007-09-19 15:46:47 -0500 (Wed, 19 Sep 2007) | 1 line
  
  Added validation to the Find_Route popup (Fixed Bug #130)
........

------------------------------------------------------------------------
r994 | reid | 2007-09-20 15:35:31 -0500 (Thu, 20 Sep 2007) | 16 lines

Merged Michael's tooltip cosmetic fixes with minor changes.

Merged revisions 957-971 via svnmerge from 
file:///project/Grouplens/subversion-repository/cyclingproject/branches/mludwig2

........
  r957 | reid | 2007-09-03 18:19:22 -0500 (Mon, 03 Sep 2007) | 2 lines
  
  Make a new branch for Michael, to solve merging screwup.
........
  r971 | mludwig | 2007-09-11 17:14:06 -0500 (Tue, 11 Sep 2007) | 1 line
  
  Fixed parts 1bc, 2, 3, 4, and 5 of Bug #168
........


------------------------------------------------------------------------
r993 | reid | 2007-09-20 15:20:44 -0500 (Thu, 20 Sep 2007) | 3 lines

Initialized merge tracking via "svnmerge" with revisions "1-956" from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig2

------------------------------------------------------------------------
r991 | reid | 2007-09-20 15:18:57 -0500 (Thu, 20 Sep 2007) | 3 lines

Removed merge tracking for "svnmerge" for 
file:///project/Grouplens/subversion-repository/cyclingproject/branches/mludwig

------------------------------------------------------------------------
r990 | reid | 2007-09-20 11:30:11 -0500 (Thu, 20 Sep 2007) | 8 lines

Connect roads and trails along the river from Boom Island to Lake Street, and
along the Greenway from the river to the Cedar Lake Trail.

(Fixed in trunk: #110.)

Merging will require a database reload and tile rebuild.


------------------------------------------------------------------------
r982 | reid | 2007-09-18 15:14:56 -0500 (Tue, 18 Sep 2007) | 2 lines

Add directions on installing debug Flash Player on Linux. (Fixes bug #138)

------------------------------------------------------------------------
r976 | reid | 2007-09-17 14:34:54 -0500 (Mon, 17 Sep 2007) | 2 lines

UI tweaks based on feedback from Erin.

------------------------------------------------------------------------
r959 | reid | 2007-09-04 19:30:04 -0500 (Tue, 04 Sep 2007) | 2 lines

Implment user byway ratings. (Fixes in trunk: #115)

------------------------------------------------------------------------
r956 | reid | 2007-09-03 18:15:49 -0500 (Mon, 03 Sep 2007) | 2 lines

Style tweaks on tooltip stuff. (Fixed in trunk: #146)

------------------------------------------------------------------------
r955 | reid | 2007-09-03 16:26:39 -0500 (Mon, 03 Sep 2007) | 25 lines

Merge Michael's tooltip stuff, with some changes to make it merge.

--
Merged revisions 905-912,914-916,918-920,922-925,927-929,932-954 via svnmerge from 
file:///project/Grouplens/subversion-repository/cyclingproject/branches/mludwig

........
  r920 | mludwig | 2007-07-27 14:58:47 -0500 (Fri, 27 Jul 2007) | 1 line
  
  Created custom tooltips for Feature (Fixed Bug #146).
........
  r932 | mludwig | 2007-08-22 16:04:52 -0500 (Wed, 22 Aug 2007) | 1 line
  
  Made our custom tooltip framework more flexible
........
  r934 | mludwig | 2007-08-24 15:59:24 -0500 (Fri, 24 Aug 2007) | 1 line
  
  Added a rough draft Byway tooltip, plus some general debugging
........
  r951 | mludwig | 2007-08-30 14:14:30 -0500 (Thu, 30 Aug 2007) | 1 line
  
  Major overhaul of the tooltipping functionality
........


------------------------------------------------------------------------
r954 | reid | 2007-08-31 18:02:48 -0500 (Fri, 31 Aug 2007) | 2 lines

Tweak R-tree stuff a little, mostly for style.

------------------------------------------------------------------------
r953 | reid | 2007-08-31 15:29:09 -0500 (Fri, 31 Aug 2007) | 13 lines

Merge Michael's R-tree stuff, with minimal changes to make it compile.

Merged revisions 926 via svnmerge from 
file:///project/Grouplens/subversion-repository/cyclingproject/branches/mludwig

........
  r926 | mludwig | 2007-08-17 16:43:26 -0500 (Fri, 17 Aug 2007) | 1 line
  
  Implemented an R-Tree and a debug visualizer for it
........



------------------------------------------------------------------------
r950 | reid | 2007-08-30 13:36:55 -0500 (Thu, 30 Aug 2007) | 2 lines

Create data model for annotations.

------------------------------------------------------------------------
r948 | reid | 2007-08-30 12:37:44 -0500 (Thu, 30 Aug 2007) | 4 lines

Removed merge tracking for "svnmerge" for 
file:///project/Grouplens/subversion-repository/cyclingproject/branches/jjoseph


------------------------------------------------------------------------
r947 | reid | 2007-08-29 20:09:35 -0500 (Wed, 29 Aug 2007) | 2 lines

Make objects on passive map layers mouse-inert.

------------------------------------------------------------------------
r946 | reid | 2007-08-29 19:23:48 -0500 (Wed, 29 Aug 2007) | 20 lines

Merge Michael's one-way arrow stuff with some revisions.

Merged revisions 921-925,927-931 via svnmerge from 
file:///project/Grouplens/subversion-repository/cyclingproject/branches/mludwig

........
  r921 | mludwig | 2007-08-01 16:49:18 -0500 (Wed, 01 Aug 2007) | 1 line
  
  Implemented one-way road UI (Fixed Bug #157)
........
  r930 | mludwig | 2007-08-22 15:34:24 -0500 (Wed, 22 Aug 2007) | 1 line
  
  Tweaked one-way arrow drawing code for byways
........
  r931 | mludwig | 2007-08-22 15:35:39 -0500 (Wed, 22 Aug 2007) | 1 line
  
  Forgot to change Byway.as so it didn't always draw an arrow
........


------------------------------------------------------------------------
r938 | reid | 2007-08-28 14:37:24 -0500 (Tue, 28 Aug 2007) | 2 lines

Suppress unnecessary fcsh chatter.

------------------------------------------------------------------------
r933 | reid | 2007-08-23 17:12:13 -0500 (Thu, 23 Aug 2007) | 2 lines

Implement generic bikeability (bug #111).

------------------------------------------------------------------------
r929 | reid | 2007-08-21 15:23:03 -0500 (Tue, 21 Aug 2007) | 2 lines

Import MNDOT cycling road annotations (bug #165).

------------------------------------------------------------------------
r928 | reid | 2007-08-20 15:39:18 -0500 (Mon, 20 Aug 2007) | 1 line

update data model to reflect database changes
------------------------------------------------------------------------
r927 | reid | 2007-08-20 15:38:56 -0500 (Mon, 20 Aug 2007) | 6 lines

Import a big bunch of MNDOT data. (Fixes bugs #83, #116, #117.)

NOTE: The nongeographic MNDOT data ("TIS data") joins poorly with the MNDOT
basemap. I am still communicating with MNDOT on this issue. Therefore, this
import may not be the last word.

------------------------------------------------------------------------
r919 | reid | 2007-07-26 17:10:07 -0500 (Thu, 26 Jul 2007) | 2 lines

Create a wrapper for fcsh to make recompiling faster.

------------------------------------------------------------------------
r918 | reid | 2007-07-26 12:22:37 -0500 (Thu, 26 Jul 2007) | 16 lines

Merge Michael's byway highlights, with some changes.

Merged revisions 905-917 via svnmerge from 
file:///project/Grouplens/subversion-repository/cyclingproject/branches/mludwig

........
  r913 | mludwig | 2007-07-16 10:51:17 -0500 (Mon, 16 Jul 2007) | 1 line
  
  Added byway mouse-over highlights (Bug #160).  \nWorked around a flex bug in Route_Finder_Popup
........
  r917 | mludwig | 2007-07-18 15:13:47 -0500 (Wed, 18 Jul 2007) | 1 line
  
  Integrates Reid's feedback for r913
........


------------------------------------------------------------------------
r916 | reid | 2007-07-17 17:38:31 -0500 (Tue, 17 Jul 2007) | 2 lines

Update for data model tweaks already in database (bug #39).

------------------------------------------------------------------------
r915 | reid | 2007-07-17 15:26:00 -0500 (Tue, 17 Jul 2007) | 4 lines

Bugfix: Editing a Geopoint which was newly created (instead of fetched from
the database) did not work right.


------------------------------------------------------------------------
r914 | reid | 2007-07-17 14:19:50 -0500 (Tue, 17 Jul 2007) | 7 lines

- Script to import MNDOT bikeways (fixes bug #84).
- Show bikeways in UI (vector and raster).

Branches will need to dump and reload the database to see the new
functionality.


------------------------------------------------------------------------
r909 | reid | 2007-07-12 15:13:09 -0500 (Thu, 12 Jul 2007) | 2 lines

Move funding stuff from technical source tree.

------------------------------------------------------------------------
r907 | reid | 2007-07-11 16:07:44 -0500 (Wed, 11 Jul 2007) | 12 lines

Merge from Michael with one minor tweak.

Merged revisions 898,904-906 via svnmerge from 
file:///project/Grouplens/subversion-repository/cyclingproject/branches/mludwig

........
  r904 | mludwig | 2007-07-11 15:45:53 -0500 (Wed, 11 Jul 2007) | 1 line
  
  Made error handling in WFS.as more elegant
........


------------------------------------------------------------------------
r906 | reid | 2007-07-11 16:05:48 -0500 (Wed, 11 Jul 2007) | 3 lines

Block revisions 899-903 from being merged from mludwig to the trunk (they are
revisions repairing his branch and have nothing useful to add to the trunk).

------------------------------------------------------------------------
r905 | reid | 2007-07-11 15:51:52 -0500 (Wed, 11 Jul 2007) | 3 lines

- Make routed use proper XML root tag name.
- Fix bug where second newly created point doesn't appear.

------------------------------------------------------------------------
r898 | reid | 2007-07-10 16:14:32 -0500 (Tue, 10 Jul 2007) | 12 lines

Merge Michael's login validator improvements, with changes.

Merged revisions 889-897 via svnmerge from 
file:///project/Grouplens/subversion-repository/cyclingproject/branches/mludwig

........
  r890 | mludwig | 2007-07-06 16:47:46 -0500 (Fri, 06 Jul 2007) | 1 line
  
  Login_Popup.mxml now uses validators (Fixed Bug #149)
........


------------------------------------------------------------------------
r897 | reid | 2007-07-10 14:11:33 -0500 (Tue, 10 Jul 2007) | 2 lines

Implement editing non-geographic features of Geopoints (fixes #156).

------------------------------------------------------------------------
r896 | reid | 2007-07-10 13:00:12 -0500 (Tue, 10 Jul 2007) | 2 lines

Fix bug which made undo/redo not work for commands.Geopoint_Create.

------------------------------------------------------------------------
r895 | reid | 2007-07-09 17:32:14 -0500 (Mon, 09 Jul 2007) | 2 lines

Implement moving of geopoints (bug #133).

------------------------------------------------------------------------
r894 | reid | 2007-07-09 13:23:55 -0500 (Mon, 09 Jul 2007) | 5 lines

- Use weak references in all event handlers (to plug memory leaks).
- Move some stuff from Feature to Geofeature.
- Now you can select and unselect Geopoints with the mouse.


------------------------------------------------------------------------
r893 | reid | 2007-07-09 12:12:51 -0500 (Mon, 09 Jul 2007) | 1 line

tweak docs
------------------------------------------------------------------------
r892 | reid | 2007-07-06 17:01:14 -0500 (Fri, 06 Jul 2007) | 1 line

swap in a prettier, smoother throbber
------------------------------------------------------------------------
r891 | reid | 2007-07-06 17:00:48 -0500 (Fri, 06 Jul 2007) | 2 lines

Swap in a prettier, smoother throbber.

------------------------------------------------------------------------
r889 | reid | 2007-07-06 15:59:51 -0500 (Fri, 06 Jul 2007) | 33 lines

Merge Michael's work with some changes:

- Resolve conflicts
- Some style tweaks
- One bug fix

Merged revisions 859,861-865,868-876,878-883,885-888 via svnmerge from 
file:///project/Grouplens/subversion-repository/cyclingproject/branches/mludwig

........
  r870 | mludwig | 2007-06-29 20:07:09 -0500 (Fri, 29 Jun 2007) | 1 line
  
  Added a loading throbber and removed the old progress bar (Fixed Bug #49)
........
  r882 | mludwig | 2007-07-03 15:38:05 -0500 (Tue, 03 Jul 2007) | 1 line
  
  Added a map scale bar widget (Fixed Bug #53)
........
  r885 | mludwig | 2007-07-05 11:57:32 -0500 (Thu, 05 Jul 2007) | 1 line
  
  Fixed all the style issues in r882
........
  r886 | mludwig | 2007-07-05 14:37:53 -0500 (Thu, 05 Jul 2007) | 1 line
  
  http 400 error message converted to a more user friendly one, pyserver sql queries are now faster, duplicate features are now discarded by the client (Fixed Bug #128 and Bug #64)
........
  r888 | mludwig | 2007-07-06 14:52:36 -0500 (Fri, 06 Jul 2007) | 1 line
  
  Fixed style issues with regards to r870 and r886
........



------------------------------------------------------------------------
r887 | reid | 2007-07-05 18:49:48 -0500 (Thu, 05 Jul 2007) | 2 lines

Save/fetch point features. Fixes #106.

------------------------------------------------------------------------
r880 | reid | 2007-07-02 17:56:24 -0500 (Mon, 02 Jul 2007) | 17 lines

Merged revisions 860-865,867-869,871-877 via svnmerge from 
file:///project/Grouplens/subversion-repository/cyclingproject/branches/mludwig

........
  r860 | mludwig | 2007-06-26 15:06:25 -0500 (Tue, 26 Jun 2007) | 1 line
  
  Limited response size on wfs_GetFeature requests (Fixed Bug #46)
........
  r867 | mludwig | 2007-06-28 14:01:25 -0500 (Thu, 28 Jun 2007) | 1 line
  
  draw() in Route.as now properly removes old Map_Label's, fixing Bug #134
........
  r877 | mludwig | 2007-07-02 16:00:44 -0500 (Mon, 02 Jul 2007) | 1 line
  
  Fixed style issues with r858, r860, and r867
........

------------------------------------------------------------------------
r879 | reid | 2007-07-02 17:43:41 -0500 (Mon, 02 Jul 2007) | 10 lines

Fix restart and stop options of routedctl: wait for routed to stop before
reporting successful stop (and, in the case of retry, starting the new
process).

This will prevent inadvertently running multiple routed's at once.

Before using 'restart', use 'stop' and make sure the existing routed process
ends.


------------------------------------------------------------------------
r878 | reid | 2007-07-02 17:09:27 -0500 (Mon, 02 Jul 2007) | 1 line

missed commit on john's changes
------------------------------------------------------------------------
r876 | reid | 2007-07-02 15:54:58 -0500 (Mon, 02 Jul 2007) | 23 lines

Merge John's fakedom robustification work, fixing bug #58, with some
modifications.

--
Merged revisions 831,833-847,849-875 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/jjoseph

........
  r831 | reid | 2007-06-13 15:26:02 -0500 (Wed, 13 Jun 2007) | 2 lines
  
  create branch for jjoseph
........
  r861 | jjoseph | 2007-06-26 18:20:52 -0500 (Tue, 26 Jun 2007) | 3 lines
  
  -fixes bug 58
  -xml escaping added to attribute values, and text nodes
........
  r869 | jjoseph | 2007-06-29 18:38:00 -0500 (Fri, 29 Jun 2007) | 2 lines
  
  Incorporated review comments.
........


------------------------------------------------------------------------
r874 | reid | 2007-07-02 12:53:56 -0500 (Mon, 02 Jul 2007) | 2 lines

Make active area of Features include the shadow (if any).

------------------------------------------------------------------------
r873 | reid | 2007-07-02 12:44:41 -0500 (Mon, 02 Jul 2007) | 2 lines

Fix crash on zooming out with geopoints on the map.

------------------------------------------------------------------------
r872 | reid | 2007-06-29 20:34:04 -0500 (Fri, 29 Jun 2007) | 2 lines

Implement basic tooltips for Geopoints.

------------------------------------------------------------------------
r871 | reid | 2007-06-29 20:19:30 -0500 (Fri, 29 Jun 2007) | 2 lines

Implement UI creation of point features.

------------------------------------------------------------------------
r859 | reid | 2007-06-26 14:40:23 -0500 (Tue, 26 Jun 2007) | 9 lines

Merged revisions 857-858 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r858 | mludwig | 2007-06-26 14:34:54 -0500 (Tue, 26 Jun 2007) | 1 line
  
  Turned off automatic gc in routed (fixed Bug # 102)
........

------------------------------------------------------------------------
r857 | reid | 2007-06-26 13:11:01 -0500 (Tue, 26 Jun 2007) | 9 lines

Merged revisions 851-856 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r856 | mludwig | 2007-06-26 12:54:10 -0500 (Tue, 26 Jun 2007) | 1 line
  
  Fixed intermitten exception on entry to vector mode (Bug #95)
........

------------------------------------------------------------------------
r853 | reid | 2007-06-21 17:23:49 -0500 (Thu, 21 Jun 2007) | 7 lines

Replaced water and open space with new dataset from Met Council which has
clearer redistribution terms. (Bug #135.)

Branches will need to reload their databases with a copy of the trunk DB and
regenerate tiles after merging.


------------------------------------------------------------------------
r852 | reid | 2007-06-21 15:32:41 -0500 (Thu, 21 Jun 2007) | 2 lines

Create data model for point features (bug #105).

------------------------------------------------------------------------
r851 | reid | 2007-06-21 12:55:56 -0500 (Thu, 21 Jun 2007) | 17 lines

Merged revisions 823,825,827,829-849 via svnmerge from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

........
  r823 | reid | 2007-06-11 11:08:45 -0500 (Mon, 11 Jun 2007) | 1 line
  
  Create a branch for Michael
........
  r839 | mludwig | 2007-06-14 13:12:06 -0500 (Thu, 14 Jun 2007) | 1 line
  
  Fixed Bug ID 88, route: calculate distance
........
  r849 | mludwig | 2007-06-21 12:44:32 -0500 (Thu, 21 Jun 2007) | 1 line
  
  Attempt at fixing tab issues brought in from Bug #88 commit
........

------------------------------------------------------------------------
r847 | reid | 2007-06-19 18:01:00 -0500 (Tue, 19 Jun 2007) | 1 line

update tech docs to better describe installation
------------------------------------------------------------------------
r846 | reid | 2007-06-19 16:00:43 -0500 (Tue, 19 Jun 2007) | 2 lines

Add infrastructure for editing tools.

------------------------------------------------------------------------
r844 | reid | 2007-06-18 13:00:14 -0500 (Mon, 18 Jun 2007) | 1 line

move creation of DOM object so it exists during fetch()
------------------------------------------------------------------------
r843 | reid | 2007-06-15 18:04:08 -0500 (Fri, 15 Jun 2007) | 5 lines

1. Change logging configuration to keep pyserver and routed log files from
   clobbering each other.
2. Implement basic, low-security login (fixes #112).
3. Really fix request completion reporting (bug #97).

------------------------------------------------------------------------
r842 | reid | 2007-06-14 17:11:46 -0500 (Thu, 14 Jun 2007) | 2 lines

Update tech docs to discuss new branching model.

------------------------------------------------------------------------
r841 | reid | 2007-06-14 16:53:39 -0500 (Thu, 14 Jun 2007) | 1 line

rm leftover SVG code
------------------------------------------------------------------------
r840 | reid | 2007-06-14 16:27:54 -0500 (Thu, 14 Jun 2007) | 7 lines

1. Update to work with mapnik r484.
2. Add BSD license notice.
3. Repair missing feature names (fixes #104).
4. Add option for rebuilding a specific tile.

You must upgrade Mapnik and rebuild the tile cache after merging.

------------------------------------------------------------------------
r838 | reid | 2007-06-14 11:34:50 -0500 (Thu, 14 Jun 2007) | 3 lines

Initialized merge tracking via "svnmerge" with revisions "1-822" from 
file:///project/Grouplens/svn/cyclingproject/branches/mludwig

------------------------------------------------------------------------
r837 | reid | 2007-06-14 11:33:56 -0500 (Thu, 14 Jun 2007) | 3 lines

Initialized merge tracking via "svnmerge" with revisions "1-830" from 
file:///project/Grouplens/svn/cyclingproject/branches/jjoseph

------------------------------------------------------------------------
r836 | reid | 2007-06-14 11:30:08 -0500 (Thu, 14 Jun 2007) | 4 lines

- Tweak interface for WikiSym paper
- Checkpoint Undo/Redo work so it doesn't continue to float uncomitted while
  I work on other things.

------------------------------------------------------------------------
r835 | reid | 2007-06-14 11:28:34 -0500 (Thu, 14 Jun 2007) | 1 line

update roadmap to reflect Wikipedia delays
------------------------------------------------------------------------
r834 | reid | 2007-06-13 16:33:49 -0500 (Wed, 13 Jun 2007) | 1 line

remove spurous exectuable bit
------------------------------------------------------------------------
r833 | reid | 2007-06-13 16:30:22 -0500 (Wed, 13 Jun 2007) | 1 line

remove spurious execute bits
------------------------------------------------------------------------
r827 | reid | 2007-06-12 13:50:38 -0500 (Tue, 12 Jun 2007) | 1 line

change config file format
------------------------------------------------------------------------
r825 | reid | 2007-06-12 13:06:31 -0500 (Tue, 12 Jun 2007) | 1 line

fix typo
------------------------------------------------------------------------
r821 | terveen | 2007-06-11 09:11:25 -0500 (Mon, 11 Jun 2007) | 1 line

Some notes on summer 2007 experiment.
------------------------------------------------------------------------
r809 | reid | 2007-06-08 16:51:55 -0500 (Fri, 08 Jun 2007) | 4 lines

Move scholarly Cyclingproject work out of the software directory in order to
better isolate private subject data.


------------------------------------------------------------------------
r804 | reid | 2007-06-07 15:44:01 -0500 (Thu, 07 Jun 2007) | 7 lines

Check in the presentation given to Kevin Krizek's class in April.

I'm pretty sure this is exactly what I gave, but as I retrieved it from my USB
key and not the laptop, and I remember making some last-minute tweaks, I'm not
100% sure.


------------------------------------------------------------------------
r790 | reid | 2007-05-31 12:23:39 -0500 (Thu, 31 May 2007) | 1 line

tweak in preparation for Michael
------------------------------------------------------------------------
r634 | reid | 2007-05-07 18:29:26 -0500 (Mon, 07 May 2007) | 2 lines

Submitted version.

------------------------------------------------------------------------
r629 | reid | 2007-05-05 23:05:09 -0500 (Sat, 05 May 2007) | 1 line

Integrate Pam, Loren feedback
------------------------------------------------------------------------
r628 | reid | 2007-05-05 14:20:37 -0500 (Sat, 05 May 2007) | 3 lines

Draft 5/4 evening.


------------------------------------------------------------------------
r622 | valent | 2007-05-03 14:15:28 -0500 (Thu, 03 May 2007) | 4 lines

Fixed bug 86, indicate travel direction



------------------------------------------------------------------------
r617 | reid | 2007-05-02 15:13:48 -0500 (Wed, 02 May 2007) | 4 lines

1. Transfer CHI-2007 short paper into WikiSym format.
2. Replace route-finding mockup with screenshot.


------------------------------------------------------------------------
r609 | valent | 2007-04-30 14:39:50 -0500 (Mon, 30 Apr 2007) | 6 lines

Fixed bug 66: Update new developers guide
Fixed bug 81: routed crashes if yahoo geocoder is unavailable
Implemented some suggestions for cleaning up code from
previous release.


------------------------------------------------------------------------
r574 | valent | 2007-04-18 14:23:44 -0500 (Wed, 18 Apr 2007) | 8 lines

Fixed bug 97: routefinding request completion isn't reported

Moved UI.request_completed() call into the data_process function
in WFS.as.  New WFS features don't need to worry about calling
UI.request_completed().



------------------------------------------------------------------------
r545 | valent | 2007-04-04 15:21:36 -0500 (Wed, 04 Apr 2007) | 14 lines

Modified route-finding algorithm to weight intersections.

Routes through intersections can be weighted on whether
it is a left or right turn, or if it passes relatively
straight through the intersection.  

Configuration options were added to CONFIG.template.

The algorithm itself wasn't modified, instead the graph
is modified by expanding intersections.  A node is added
for each edge touching an intersection, weighted edges 
are then added between all of the intersection nodes.


------------------------------------------------------------------------
r512 | reid | 2007-03-26 16:13:38 -0500 (Mon, 26 Mar 2007) | 2 lines

Update according to new Mapnik (r469). Fixes bug #94.

------------------------------------------------------------------------
r478 | reid | 2007-03-09 13:20:45 -0600 (Fri, 09 Mar 2007) | 5 lines


Add water and open space to raster mode. 

Update will require a database reload and a tile cache update.

------------------------------------------------------------------------
r475 | reid | 2007-03-08 16:44:50 -0600 (Thu, 08 Mar 2007) | 7 lines

1. Import basemap polygons (water and open space).
2. Serve and display them in vector mode.
3. Move color configuration into the database.

Updating will require a database reload.


------------------------------------------------------------------------
r472 | valent | 2007-03-07 14:49:10 -0600 (Wed, 07 Mar 2007) | 10 lines

Fixed (bug #80) "Find Route dialog controls should
retain values between popups"

Minor modifications to Route.as were required.

A bug in flex required some changes in Find_Route_Popup.mxml
in order to make sure all controls kept their data
persistant.


------------------------------------------------------------------------
r471 | valent | 2007-03-06 13:33:46 -0600 (Tue, 06 Mar 2007) | 8 lines

Fixed (Bug #74)

When the route panel is open, the active route, if any,
will be display.  When the route panel closes, the active
route disappears.  Showing the active route will pan and
zoom to the route.


------------------------------------------------------------------------
r470 | valent | 2007-03-05 15:08:46 -0600 (Mon, 05 Mar 2007) | 6 lines

Fixed some problems with lookat introduced by projection change.

Added panto function in Map_Canvas to pan the map to specified
canvas coordinates.


------------------------------------------------------------------------
r468 | reid | 2007-02-28 18:02:34 -0600 (Wed, 28 Feb 2007) | 2 lines

Style tweaks on zoomto(); integrate Luke's regex fix in rectangle parsing.

------------------------------------------------------------------------
r467 | valent | 2007-02-28 14:40:26 -0600 (Wed, 28 Feb 2007) | 15 lines

When a new route is found, the client will now pan
and zoom to fit the route in the viewable area.

(Bug #75)

zoomto in the client will clamp the requested zoom
level to the min or max level in the configuration
file.  It returns true if a zoom was performed, 
and false otherwise.

In order to facilitate fixing bug #75, a new function
"lookat" was defined.  lookat takes a DisplayObject
and pans and zooms to look at the object.


------------------------------------------------------------------------
r466 | reid | 2007-02-27 20:43:53 -0600 (Tue, 27 Feb 2007) | 6 lines

Reproject the database into NAD83 UTM Zone 15N. (This is a more natural
projection for the Twin Cities area.) (Bug #68.)

After updating, reloading the database and rebuilding the tile cache will be
required.

------------------------------------------------------------------------
r465 | reid | 2007-02-27 13:44:01 -0600 (Tue, 27 Feb 2007) | 2 lines

Presentation given at Macalester 2/23/2007.

------------------------------------------------------------------------
r464 | reid | 2007-02-22 14:26:27 -0600 (Thu, 22 Feb 2007) | 2 lines

Implement routing priorities.

------------------------------------------------------------------------
r463 | reid | 2007-02-21 12:42:58 -0600 (Wed, 21 Feb 2007) | 2 lines

Read the !@*(#^&@ing directions more carefully... (Fixes bug #76)

------------------------------------------------------------------------
r462 | reid | 2007-02-20 19:15:06 -0600 (Tue, 20 Feb 2007) | 3 lines

Implement route-finding interface in UI. You can now type in two addresses and
get a route between them, albeit a crummy one.

------------------------------------------------------------------------
r461 | reid | 2007-02-19 17:35:31 -0600 (Mon, 19 Feb 2007) | 2 lines

Create GetRoute WFS operation which pushes an XML route out to the browser.

------------------------------------------------------------------------
r460 | reid | 2007-02-19 14:57:51 -0600 (Mon, 19 Feb 2007) | 5 lines

1. XMLize routed output.

2. Make routed a proper daemon and write /etc/init.d script.


------------------------------------------------------------------------
r458 | reid | 2007-02-10 21:26:47 -0600 (Sat, 10 Feb 2007) | 9 lines

1. Daemonize the route-finder, creating the standalone route-finding server
   routed. This is about 50 times faster than the first route-finder without
   any effort at profiling or speed optimization (St. Paul -> Minnetonka now
   takes less than a second).

2. Make logging stop truncating the log file each time the server is started
   up, and move the configuration from g.py to CONFIG.


------------------------------------------------------------------------
r457 | valent | 2007-02-09 17:39:16 -0600 (Fri, 09 Feb 2007) | 6 lines

Changed all double-quoted strings to single-quoted strings, except for strings that have
single quotes within them.
 
Modified tilecache_update.py to write lables no smaller than a minimum specified size.


------------------------------------------------------------------------
r456 | reid | 2007-02-08 19:58:41 -0600 (Thu, 08 Feb 2007) | 6 lines

An apparently working, albeit functionally limited and very slow,
route-finder. (Macalester to the U takes 2.5 seconds, Macalester to Minnetonka
about 30.) While I get a list of nodes, I haven't yet checked to see if the
route is any good.


------------------------------------------------------------------------
r455 | reid | 2007-02-07 17:36:31 -0600 (Wed, 07 Feb 2007) | 2 lines

Import original Norvig code.

------------------------------------------------------------------------
r454 | reid | 2007-02-06 19:39:22 -0600 (Tue, 06 Feb 2007) | 2 lines

Check in Norvig's original code.

------------------------------------------------------------------------
r453 | reid | 2007-01-31 16:27:49 -0600 (Wed, 31 Jan 2007) | 2 lines

Use UNIX socket connections to get to database; add labels to tiles.

------------------------------------------------------------------------
r452 | reid | 2007-01-30 17:17:48 -0600 (Tue, 30 Jan 2007) | 2 lines

Update technical docs.

------------------------------------------------------------------------
r450 | reid | 2007-01-26 19:28:44 -0600 (Fri, 26 Jan 2007) | 3 lines

Tiling works, with the caveat that I haven't been able to get mapnik to rotate
labels properly yet.

------------------------------------------------------------------------
r449 | reid | 2007-01-23 16:17:10 -0600 (Tue, 23 Jan 2007) | 2 lines

Data model for users and ratings.

------------------------------------------------------------------------
r448 | reid | 2007-01-19 14:39:44 -0600 (Fri, 19 Jan 2007) | 2 lines

Center labels better.

------------------------------------------------------------------------
r447 | reid | 2007-01-19 13:30:48 -0600 (Fri, 19 Jan 2007) | 2 lines

Implement basic but reasonable labeling.

------------------------------------------------------------------------
r446 | reid | 2007-01-18 19:31:10 -0600 (Thu, 18 Jan 2007) | 14 lines

Remove panned-out labels on direction of their associated byways, not
independently. This reverts most of revision 444 and fixes bug #62.

 --This line, and those below, will be ignored--

M    flashclient/Conf.as
M    flashclient/Feature.as
M    flashclient/Byway.as
M    flashclient/Map_Layer_Passive.as
D    flashclient/Map_Layer_Base.as
M    flashclient/Map_Canvas.as
M    flashclient/Map_Layer.as
M    flashclient/Map_Label.as

------------------------------------------------------------------------
r445 | reid | 2007-01-18 17:31:25 -0600 (Thu, 18 Jan 2007) | 2 lines

Redraw and filter labels according to zoom level.

------------------------------------------------------------------------
r444 | reid | 2007-01-18 16:12:45 -0600 (Thu, 18 Jan 2007) | 2 lines

Clean up labels properly on pan.

------------------------------------------------------------------------
r443 | reid | 2007-01-17 18:22:40 -0600 (Wed, 17 Jan 2007) | 2 lines

Rotate labels to roughly match byway alignment.

------------------------------------------------------------------------
r442 | reid | 2007-01-17 17:17:32 -0600 (Wed, 17 Jan 2007) | 2 lines

Draw horizontal, embedded-font, properly sized labels centered on each byway.

------------------------------------------------------------------------
r441 | reid | 2007-01-16 19:25:32 -0600 (Tue, 16 Jan 2007) | 2 lines

Change roadmap from Gnumeric to Excel formats.

------------------------------------------------------------------------
r440 | reid | 2007-01-16 18:36:19 -0600 (Tue, 16 Jan 2007) | 2 lines

Move roadmap into spreadsheet.

------------------------------------------------------------------------
r439 | reid | 2007-01-15 19:30:47 -0600 (Mon, 15 Jan 2007) | 4 lines

Revert previous revision (except for Conf.as) due to performance. We will
indeed have to punt to image tiles below zoom level 14, and at levels 14 and
below selectively returning byways according to zoom is not needed.

------------------------------------------------------------------------
r438 | reid | 2007-01-15 19:22:30 -0600 (Mon, 15 Jan 2007) | 2 lines

Serve and draw only byway classes which should be drawn.

------------------------------------------------------------------------
r437 | reid | 2007-01-15 16:41:07 -0600 (Mon, 15 Jan 2007) | 2 lines

Draw byway shadows a la Google Maps.

------------------------------------------------------------------------
r436 | reid | 2007-01-12 16:56:04 -0600 (Fri, 12 Jan 2007) | 2 lines

Make byway draw order look better (bigger on top of smaller).

------------------------------------------------------------------------
r435 | reid | 2007-01-12 15:10:42 -0600 (Fri, 12 Jan 2007) | 2 lines

Write rebutall to Casey review.

------------------------------------------------------------------------
r434 | reid | 2007-01-11 17:19:54 -0600 (Thu, 11 Jan 2007) | 2 lines

Draw byways in different widths and colors.

------------------------------------------------------------------------
r430 | reid | 2007-01-09 17:23:25 -0600 (Tue, 09 Jan 2007) | 2 lines

Mockups for William Casey meeting.

------------------------------------------------------------------------
r429 | reid | 2007-01-07 17:23:59 -0600 (Sun, 07 Jan 2007) | 2 lines

Re-link Conf.as (not sure what happened).

------------------------------------------------------------------------
r428 | reid | 2007-01-07 16:56:34 -0600 (Sun, 07 Jan 2007) | 2 lines

Simplify the XML used to transfer from server to client.

------------------------------------------------------------------------
r426 | reid | 2007-01-04 18:03:57 -0600 (Thu, 04 Jan 2007) | 2 lines

Dump GeoTypes for another 1.5x or so speedup.

------------------------------------------------------------------------
r425 | reid | 2007-01-04 17:27:45 -0600 (Thu, 04 Jan 2007) | 2 lines

Adapt to Ubuntu Apache, tweak server for speed.

------------------------------------------------------------------------
r424 | reid | 2007-01-02 18:54:14 -0600 (Tue, 02 Jan 2007) | 2 lines

Revise executive summary.

------------------------------------------------------------------------
r423 | reid | 2007-01-02 18:13:41 -0600 (Tue, 02 Jan 2007) | 2 lines

Implement panning by dragging.

------------------------------------------------------------------------
r422 | reid | 2007-01-02 13:45:28 -0600 (Tue, 02 Jan 2007) | 2 lines

Tweak UI according to Erin's feedback.

------------------------------------------------------------------------
r421 | reid | 2006-12-29 16:43:57 -0600 (Fri, 29 Dec 2006) | 2 lines

Mock up a good portion of the UI.

------------------------------------------------------------------------
r420 | reid | 2006-12-28 20:22:19 -0600 (Thu, 28 Dec 2006) | 2 lines

Pan/zoom with offscreen fetch works.

------------------------------------------------------------------------
r419 | reid | 2006-12-27 18:02:59 -0600 (Wed, 27 Dec 2006) | 2 lines

Fix progress bar.

------------------------------------------------------------------------
r418 | reid | 2006-12-27 17:57:02 -0600 (Wed, 27 Dec 2006) | 2 lines

Zooming works.

------------------------------------------------------------------------
r417 | reid | 2006-12-23 17:33:20 -0600 (Sat, 23 Dec 2006) | 5 lines

Panning works, yay!

Functionally, this brings us to the point we had reached using SVG, though
there was some additional development beyond this point which didn't yet work.

------------------------------------------------------------------------
r415 | reid | 2006-12-21 20:23:49 -0600 (Thu, 21 Dec 2006) | 2 lines

Make resize events reach the Map_Canvas object. (Bug #43.)

------------------------------------------------------------------------
r414 | reid | 2006-12-21 20:03:58 -0600 (Thu, 21 Dec 2006) | 2 lines

Make clipping of the map work.

------------------------------------------------------------------------
r413 | reid | 2006-12-21 19:15:37 -0600 (Thu, 21 Dec 2006) | 2 lines

Draw fetched byways on the screen.

------------------------------------------------------------------------
r406 | reid | 2006-12-20 19:48:42 -0600 (Wed, 20 Dec 2006) | 2 lines

Client fetches data from server.

------------------------------------------------------------------------
r405 | reid | 2006-12-20 18:22:05 -0600 (Wed, 20 Dec 2006) | 3 lines

Revise proposal according to discussion with Steve Clark this afternoon: trim
down to just a programmer.

------------------------------------------------------------------------
r399 | reid | 2006-12-13 15:04:19 -0600 (Wed, 13 Dec 2006) | 1 line

convert data model from OpenOffice 1.1 to OpenDocument (OOO2) format
------------------------------------------------------------------------
r383 | reid | 2006-11-17 16:39:29 -0600 (Fri, 17 Nov 2006) | 4 lines

Keep byways in map-space, and translate everything on the fly. This doesn't
seem to work, but taking a snapshot is probably useful.


------------------------------------------------------------------------
r382 | reid | 2006-11-15 20:22:02 -0600 (Wed, 15 Nov 2006) | 2 lines

Make the pyserver output GML.

------------------------------------------------------------------------
r381 | reid | 2006-11-14 17:49:21 -0600 (Tue, 14 Nov 2006) | 2 lines

Draw a custom line on the map canvas.

------------------------------------------------------------------------
r380 | reid | 2006-11-07 17:54:00 -0600 (Tue, 07 Nov 2006) | 3 lines

Snapshot SVG client in preparation to investigate its replacement with Flash.
*This code does not currently work.*

------------------------------------------------------------------------
r379 | reid | 2006-11-07 17:52:39 -0600 (Tue, 07 Nov 2006) | 2 lines

Tweak fetch/discard spec.

------------------------------------------------------------------------
r374 | reid | 2006-11-01 17:45:03 -0600 (Wed, 01 Nov 2006) | 3 lines

Panning works again under partial implementation of offscreen fetch/discard of
non-tiled layers.

------------------------------------------------------------------------
r371 | reid | 2006-10-31 15:36:33 -0600 (Tue, 31 Oct 2006) | 3 lines

Nuke MoinMoin. Currently, text wiki features are low on the priority list, and
if/when they rise again, a different choice may be appropriate.

------------------------------------------------------------------------
r370 | reid | 2006-10-31 15:34:36 -0600 (Tue, 31 Oct 2006) | 2 lines

Remove grid (it is obsolete).

------------------------------------------------------------------------
r359 | reid | 2006-10-30 15:55:58 -0600 (Mon, 30 Oct 2006) | 2 lines

Display some roads on the screen, yay!

------------------------------------------------------------------------
r358 | reid | 2006-10-26 20:20:32 -0500 (Thu, 26 Oct 2006) | 2 lines

Start technical documentation manual.

------------------------------------------------------------------------
r357 | reid | 2006-10-26 20:19:56 -0500 (Thu, 26 Oct 2006) | 2 lines

info moved elsewhere (should have been comitted earlier)

------------------------------------------------------------------------
r345 | reid | 2006-10-24 13:40:12 -0500 (Tue, 24 Oct 2006) | 2 lines

Notes for 10/24 TLC Advisory Board meeting.

------------------------------------------------------------------------
r342 | reid | 2006-10-23 17:55:37 -0500 (Mon, 23 Oct 2006) | 1 line

test Id: substitution
------------------------------------------------------------------------
r334 | reid | 2006-10-20 20:26:52 -0500 (Fri, 20 Oct 2006) | 2 lines

Import 131,548 byway segments from MNDOT base map.

------------------------------------------------------------------------
r332 | reid | 2006-10-18 13:20:51 -0500 (Wed, 18 Oct 2006) | 2 lines

clean up survey results

------------------------------------------------------------------------
r303 | reid | 2006-09-29 17:04:49 -0500 (Fri, 29 Sep 2006) | 1 line

submitted version
------------------------------------------------------------------------
r302 | reid | 2006-09-29 13:08:08 -0500 (Fri, 29 Sep 2006) | 1 line

Submittable version pending final proofreading
------------------------------------------------------------------------
r299 | reid | 2006-09-28 12:15:02 -0500 (Thu, 28 Sep 2006) | 1 line

loren's edits
------------------------------------------------------------------------
r298 | reid | 2006-09-27 19:16:41 -0500 (Wed, 27 Sep 2006) | 2 lines

Integrate DanCo and DanFr's feedback.

------------------------------------------------------------------------
r297 | reid | 2006-09-27 13:58:54 -0500 (Wed, 27 Sep 2006) | 1 line

draft for DanFr
------------------------------------------------------------------------
r295 | reid | 2006-09-26 13:33:14 -0500 (Tue, 26 Sep 2006) | 1 line

complete first draft, yay\!
------------------------------------------------------------------------
r294 | reid | 2006-09-24 18:44:53 -0500 (Sun, 24 Sep 2006) | 1 line

draft wiki refs
------------------------------------------------------------------------
r293 | reid | 2006-09-22 18:58:49 -0500 (Fri, 22 Sep 2006) | 1 line

draft approaching completeness
------------------------------------------------------------------------
r288 | reid | 2006-09-20 19:49:00 -0500 (Wed, 20 Sep 2006) | 1 line

first short paper snapshot
------------------------------------------------------------------------
r286 | reid | 2006-09-19 17:38:42 -0500 (Tue, 19 Sep 2006) | 1 line

snapshot long paper
------------------------------------------------------------------------
r285 | reid | 2006-09-19 12:22:09 -0500 (Tue, 19 Sep 2006) | 2 lines

record mailing list info

------------------------------------------------------------------------
r284 | reid | 2006-09-18 18:27:04 -0500 (Mon, 18 Sep 2006) | 4 lines

Template removes copyright notice/space, which conflicts with the spec. I'm
baffled. Re-added.


------------------------------------------------------------------------
r283 | reid | 2006-09-18 18:22:40 -0500 (Mon, 18 Sep 2006) | 1 line

add CHI 2007 template, remove CHI 2006
------------------------------------------------------------------------
r282 | reid | 2006-09-18 14:24:19 -0500 (Mon, 18 Sep 2006) | 1 line

integrate Loren's 9/14 comments, draft 'Propensity to Do'
------------------------------------------------------------------------
r281 | reid | 2006-09-17 20:24:34 -0500 (Sun, 17 Sep 2006) | 1 line

draft RQ2, trust in wiki
------------------------------------------------------------------------
r280 | reid | 2006-09-17 11:01:52 -0500 (Sun, 17 Sep 2006) | 1 line

presented version
------------------------------------------------------------------------
r278 | reid | 2006-09-13 20:22:08 -0500 (Wed, 13 Sep 2006) | 1 line

first draft of presentation
------------------------------------------------------------------------
r277 | reid | 2006-09-12 17:28:50 -0500 (Tue, 12 Sep 2006) | 1 line

draft RQ1: Tasks
------------------------------------------------------------------------
r276 | reid | 2006-09-11 13:05:05 -0500 (Mon, 11 Sep 2006) | 1 line

draft google bicycle and research design sections
------------------------------------------------------------------------
r275 | reid | 2006-09-07 14:03:42 -0500 (Thu, 07 Sep 2006) | 1 line

test
------------------------------------------------------------------------
r274 | reid | 2006-09-07 13:53:31 -0500 (Thu, 07 Sep 2006) | 1 line

test
------------------------------------------------------------------------
r273 | reid | 2006-09-07 11:33:27 -0500 (Thu, 07 Sep 2006) | 1 line

testing
------------------------------------------------------------------------
r272 | reid | 2006-09-07 11:31:41 -0500 (Thu, 07 Sep 2006) | 1 line

testing
------------------------------------------------------------------------
r271 | reid | 2006-09-06 17:37:20 -0500 (Wed, 06 Sep 2006) | 1 line

integrate Loren's comments
------------------------------------------------------------------------
r270 | reid | 2006-09-06 16:04:25 -0500 (Wed, 06 Sep 2006) | 1 line

integrate Loren's comments
------------------------------------------------------------------------
r262 | reid | 2006-08-27 18:06:29 -0500 (Sun, 27 Aug 2006) | 1 line

add PDF version of paper, really
------------------------------------------------------------------------
r261 | reid | 2006-08-27 18:05:53 -0500 (Sun, 27 Aug 2006) | 1 line

add PDF version of paper, really
------------------------------------------------------------------------
r260 | reid | 2006-08-27 18:03:09 -0500 (Sun, 27 Aug 2006) | 1 line

add PDF version of paper
------------------------------------------------------------------------
r259 | reid | 2006-08-27 18:02:19 -0500 (Sun, 27 Aug 2006) | 1 line

integrate Loren's comments
------------------------------------------------------------------------
r250 | reid | 2006-08-24 13:21:01 -0500 (Thu, 24 Aug 2006) | 1 line

first outline
------------------------------------------------------------------------
r249 | reid | 2006-08-23 12:49:43 -0500 (Wed, 23 Aug 2006) | 1 line

tweak spacing
------------------------------------------------------------------------
r248 | reid | 2006-08-23 12:48:59 -0500 (Wed, 23 Aug 2006) | 1 line

Incorporate revisions from TLC budget
------------------------------------------------------------------------
r236 | reid | 2006-08-21 20:04:03 -0500 (Mon, 21 Aug 2006) | 1 line

put in interestingness and truth guesses
------------------------------------------------------------------------
r235 | reid | 2006-08-16 15:56:14 -0500 (Wed, 16 Aug 2006) | 1 line

submitted version
------------------------------------------------------------------------
r234 | reid | 2006-08-16 14:50:32 -0500 (Wed, 16 Aug 2006) | 1 line

rc1
------------------------------------------------------------------------
r233 | reid | 2006-08-15 19:40:41 -0500 (Tue, 15 Aug 2006) | 1 line

categorize
------------------------------------------------------------------------
r232 | reid | 2006-08-15 13:53:40 -0500 (Tue, 15 Aug 2006) | 1 line

first pass
------------------------------------------------------------------------
r231 | reid | 2006-08-15 12:15:49 -0500 (Tue, 15 Aug 2006) | 1 line

final version
------------------------------------------------------------------------
r230 | reid | 2006-08-15 00:46:34 -0500 (Tue, 15 Aug 2006) | 1 line

incorporate loren and doreen's feedback
------------------------------------------------------------------------
r229 | reid | 2006-08-14 12:53:47 -0500 (Mon, 14 Aug 2006) | 1 line

wording improvements
------------------------------------------------------------------------
r228 | reid | 2006-08-11 16:37:54 -0500 (Fri, 11 Aug 2006) | 1 line

draft 1
------------------------------------------------------------------------
r227 | reid | 2006-08-10 18:52:42 -0500 (Thu, 10 Aug 2006) | 1 line

draft for Loren and Doreen
------------------------------------------------------------------------
r226 | reid | 2006-08-10 16:55:10 -0500 (Thu, 10 Aug 2006) | 1 line

reformat notes for easy listening
------------------------------------------------------------------------
r225 | reid | 2006-08-10 12:50:59 -0500 (Thu, 10 Aug 2006) | 1 line

move mislabeled notes
------------------------------------------------------------------------
r224 | reid | 2006-08-09 19:15:45 -0500 (Wed, 09 Aug 2006) | 1 line

relabel one of ben's notes
------------------------------------------------------------------------
r223 | reid | 2006-08-08 16:20:01 -0500 (Tue, 08 Aug 2006) | 1 line

trim a question (when did I stop asking it?
------------------------------------------------------------------------
r222 | reid | 2006-08-08 12:23:52 -0500 (Tue, 08 Aug 2006) | 1 line

enter notes
------------------------------------------------------------------------
r221 | reid | 2006-08-08 12:05:42 -0500 (Tue, 08 Aug 2006) | 1 line

add Ben's notes
------------------------------------------------------------------------
r220 | reid | 2006-08-06 22:25:58 -0500 (Sun, 06 Aug 2006) | 1 line

executive summary for TLC
------------------------------------------------------------------------
r219 | reid | 2006-08-06 22:25:27 -0500 (Sun, 06 Aug 2006) | 1 line

new scrolling works
------------------------------------------------------------------------
r218 | reid | 2006-08-01 14:30:42 -0500 (Tue, 01 Aug 2006) | 1 line

add notes
------------------------------------------------------------------------
r217 | reid | 2006-07-31 22:04:25 -0500 (Mon, 31 Jul 2006) | 1 line

enter notes
------------------------------------------------------------------------
r216 | reid | 2006-07-30 20:31:09 -0500 (Sun, 30 Jul 2006) | 1 line

make resizing work (finally, arrrgh)
------------------------------------------------------------------------
r215 | reid | 2006-07-27 18:16:47 -0500 (Thu, 27 Jul 2006) | 1 line

add notes
------------------------------------------------------------------------
r214 | reid | 2006-07-26 19:08:09 -0500 (Wed, 26 Jul 2006) | 1 line

add notes
------------------------------------------------------------------------
r213 | reid | 2006-07-26 16:20:17 -0500 (Wed, 26 Jul 2006) | 1 line

add 7/23 notes
------------------------------------------------------------------------
r212 | reid | 2006-07-25 19:08:53 -0500 (Tue, 25 Jul 2006) | 1 line

add notes
------------------------------------------------------------------------
r210 | reid | 2006-07-24 16:11:20 -0500 (Mon, 24 Jul 2006) | 1 line

panning works! yay!
------------------------------------------------------------------------
r209 | reid | 2006-07-24 15:14:10 -0500 (Mon, 24 Jul 2006) | 1 line

wrap with if(xpathdebug) a few Log calls that weren't
------------------------------------------------------------------------
r208 | reid | 2006-07-24 15:08:29 -0500 (Mon, 24 Jul 2006) | 1 line

copy ajaxslt into main branch
------------------------------------------------------------------------
r205 | reid | 2006-07-21 15:57:53 -0500 (Fri, 21 Jul 2006) | 1 line

update script
------------------------------------------------------------------------
r204 | reid | 2006-07-21 15:12:45 -0500 (Fri, 21 Jul 2006) | 1 line

add ben's notes
------------------------------------------------------------------------
r203 | reid | 2006-07-20 19:05:52 -0500 (Thu, 20 Jul 2006) | 1 line

today's notes
------------------------------------------------------------------------
r202 | reid | 2006-07-19 14:45:58 -0500 (Wed, 19 Jul 2006) | 1 line

add notes
------------------------------------------------------------------------
r201 | reid | 2006-07-18 13:38:26 -0500 (Tue, 18 Jul 2006) | 1 line

add interview
------------------------------------------------------------------------
r200 | reid | 2006-07-17 21:11:32 -0500 (Mon, 17 Jul 2006) | 1 line

today's interviews
------------------------------------------------------------------------
r198 | reid | 2006-07-16 19:47:23 -0500 (Sun, 16 Jul 2006) | 1 line

fetch a rudimentary tile
------------------------------------------------------------------------
r197 | reid | 2006-07-16 19:39:45 -0500 (Sun, 16 Jul 2006) | 1 line

make nowstr be request time, not import time
------------------------------------------------------------------------
r196 | reid | 2006-07-16 18:42:15 -0500 (Sun, 16 Jul 2006) | 1 line

GetFeature seems to work
------------------------------------------------------------------------
r195 | reid | 2006-07-16 13:01:18 -0500 (Sun, 16 Jul 2006) | 1 line

retrieve from database and create SVG
------------------------------------------------------------------------
r194 | reid | 2006-07-14 13:15:44 -0500 (Fri, 14 Jul 2006) | 1 line

add notes
------------------------------------------------------------------------
r193 | reid | 2006-07-13 17:43:49 -0500 (Thu, 13 Jul 2006) | 1 line

add notes
------------------------------------------------------------------------
r192 | reid | 2006-07-12 13:58:00 -0500 (Wed, 12 Jul 2006) | 1 line

tweak interview script
------------------------------------------------------------------------
r191 | reid | 2006-07-11 14:34:02 -0500 (Tue, 11 Jul 2006) | 1 line

add 7/11 interview 1 notes
------------------------------------------------------------------------
r190 | reid | 2006-07-10 15:53:45 -0500 (Mon, 10 Jul 2006) | 1 line

prep for interview tomorrow
------------------------------------------------------------------------
r189 | reid | 2006-07-07 16:57:43 -0500 (Fri, 07 Jul 2006) | 1 line

talks to database
------------------------------------------------------------------------
r188 | reid | 2006-07-06 20:07:45 -0500 (Thu, 06 Jul 2006) | 1 line

draft interview script
------------------------------------------------------------------------
r187 | reid | 2006-06-29 15:47:48 -0500 (Thu, 29 Jun 2006) | 1 line

add consent for form interviews
------------------------------------------------------------------------
r177 | reid | 2006-06-19 13:23:24 -0500 (Mon, 19 Jun 2006) | 1 line

add Ben Jordan add form
------------------------------------------------------------------------
r176 | reid | 2006-06-16 14:21:19 -0500 (Fri, 16 Jun 2006) | 1 line

add __slots__ timing test
------------------------------------------------------------------------
r175 | reid | 2006-06-15 17:33:29 -0500 (Thu, 15 Jun 2006) | 1 line

survey changes req
------------------------------------------------------------------------
r172 | reid | 2006-06-14 15:37:39 -0500 (Wed, 14 Jun 2006) | 1 line

disable GetCapabilities
------------------------------------------------------------------------
r171 | reid | 2006-06-14 15:35:33 -0500 (Wed, 14 Jun 2006) | 1 line

update to WFS 1.1
------------------------------------------------------------------------
r170 | reid | 2006-06-14 15:00:07 -0500 (Wed, 14 Jun 2006) | 1 line

update error document to WFS 1.1
------------------------------------------------------------------------
r163 | reid | 2006-05-26 17:44:35 -0500 (Fri, 26 May 2006) | 1 line

bludgeon Moin into something I can bear to look at
------------------------------------------------------------------------
r162 | reid | 2006-05-26 16:32:50 -0500 (Fri, 26 May 2006) | 1 line

add system features
------------------------------------------------------------------------
r161 | reid | 2006-05-26 16:18:03 -0500 (Fri, 26 May 2006) | 1 line

add nav scenarios
------------------------------------------------------------------------
r160 | reid | 2006-05-26 16:04:25 -0500 (Fri, 26 May 2006) | 1 line

add email solicitation
------------------------------------------------------------------------
r159 | reid | 2006-05-26 16:00:56 -0500 (Fri, 26 May 2006) | 1 line

correct typo
------------------------------------------------------------------------
r158 | reid | 2006-05-26 15:40:49 -0500 (Fri, 26 May 2006) | 1 line

another draft of IRB forms
------------------------------------------------------------------------
r157 | reid | 2006-05-25 17:39:02 -0500 (Thu, 25 May 2006) | 1 line

move IRB stuff to its own dir
------------------------------------------------------------------------
r156 | reid | 2006-05-25 17:38:01 -0500 (Thu, 25 May 2006) | 1 line

draft 1 of IRB forms
------------------------------------------------------------------------
r155 | reid | 2006-05-24 17:21:41 -0500 (Wed, 24 May 2006) | 1 line

add blank appendices
------------------------------------------------------------------------
r154 | reid | 2006-05-23 18:28:13 -0500 (Tue, 23 May 2006) | 1 line

add blank IRB form
------------------------------------------------------------------------
r152 | reid | 2006-05-21 21:02:44 -0500 (Sun, 21 May 2006) | 1 line

create modern2 theme
------------------------------------------------------------------------
r150 | reid | 2006-05-15 17:15:26 -0500 (Mon, 15 May 2006) | 1 line

bring moin-1.5.3 onto main branch
------------------------------------------------------------------------
r145 | reid | 2006-05-15 15:37:36 -0500 (Mon, 15 May 2006) | 1 line

I can't get my underscores and hyphens straight
------------------------------------------------------------------------
r144 | reid | 2006-05-15 15:32:25 -0500 (Mon, 15 May 2006) | 1 line

add New Media proposal
------------------------------------------------------------------------
r143 | reid | 2006-05-15 14:30:05 -0500 (Mon, 15 May 2006) | 1 line

add in 8115 presentation slides
------------------------------------------------------------------------
r114 | reid | 2006-05-03 17:20:53 -0500 (Wed, 03 May 2006) | 1 line

basic text/map frames interface (bug #3)
------------------------------------------------------------------------
r104 | reid | 2006-04-30 23:57:11 -0500 (Sun, 30 Apr 2006) | 1 line

submit 8115 report
------------------------------------------------------------------------
r103 | reid | 2006-04-28 16:50:35 -0500 (Fri, 28 Apr 2006) | 1 line

create dir and copy in CHI latex stuff
------------------------------------------------------------------------
r96 | reid | 2006-04-27 15:54:17 -0500 (Thu, 27 Apr 2006) | 1 line

remove mapbuilder -- we aren't going to use it after all
------------------------------------------------------------------------
r95 | reid | 2006-04-27 15:52:30 -0500 (Thu, 27 Apr 2006) | 1 line

basic scrolling widgetry works
------------------------------------------------------------------------
r82 | reid | 2006-04-17 19:16:11 -0500 (Mon, 17 Apr 2006) | 1 line

snazzy debug window
------------------------------------------------------------------------
r81 | reid | 2006-04-17 19:16:00 -0500 (Mon, 17 Apr 2006) | 1 line

snazzy debug window
------------------------------------------------------------------------
r80 | reid | 2006-04-17 17:42:21 -0500 (Mon, 17 Apr 2006) | 1 line

split javascript into separate files
------------------------------------------------------------------------
r70 | reid | 2006-04-14 18:16:26 -0500 (Fri, 14 Apr 2006) | 1 line

svg doc with very basic panning
------------------------------------------------------------------------
r68 | reid | 2006-04-13 20:24:06 -0500 (Thu, 13 Apr 2006) | 1 line

successfully serves a validating DescribeFeatureType response
------------------------------------------------------------------------
r67 | reid | 2006-04-02 19:04:11 -0500 (Sun, 02 Apr 2006) | 1 line

a few GetCapabilities tweaks to make Mapbuilder happy
------------------------------------------------------------------------
r66 | reid | 2006-04-02 18:37:42 -0500 (Sun, 02 Apr 2006) | 1 line

point it at the WFS Pyserver
------------------------------------------------------------------------
r65 | reid | 2006-04-02 18:28:27 -0500 (Sun, 02 Apr 2006) | 1 line

half-assed favicon.ico to reduce 404s
------------------------------------------------------------------------
r64 | reid | 2006-04-02 17:31:46 -0500 (Sun, 02 Apr 2006) | 1 line

basic map page that talks to geoserver
------------------------------------------------------------------------
r60 | reid | 2006-03-29 15:49:00 -0600 (Wed, 29 Mar 2006) | 1 line

bring mapbuilder over to trunk
------------------------------------------------------------------------
r57 | reid | 2006-03-29 15:11:34 -0600 (Wed, 29 Mar 2006) | 1 line

hello world apache
------------------------------------------------------------------------
r56 | reid | 2006-03-29 15:05:43 -0600 (Wed, 29 Mar 2006) | 1 line

a reasonable first GetCapabilities, though uDig doesn't like it
------------------------------------------------------------------------
r55 | reid | 2006-03-24 19:43:59 -0600 (Fri, 24 Mar 2006) | 1 line

implement basic KVP decoding
------------------------------------------------------------------------
r54 | reid | 2006-03-24 18:30:32 -0600 (Fri, 24 Mar 2006) | 1 line

seems to give a working WFS error
------------------------------------------------------------------------
r53 | reid | 2006-03-24 17:21:58 -0600 (Fri, 24 Mar 2006) | 1 line

test
------------------------------------------------------------------------
r52 | reid | 2006-03-23 18:45:16 -0600 (Thu, 23 Mar 2006) | 1 line

dump geoserver in favor of writing our own pyserver; bring pyserver to hello-world state
------------------------------------------------------------------------
r51 | reid | 2006-03-21 10:49:01 -0600 (Tue, 21 Mar 2006) | 1 line

change wording
------------------------------------------------------------------------
r50 | reid | 2006-03-19 16:53:49 -0600 (Sun, 19 Mar 2006) | 1 line

revise data model for concurrency control and versioning
------------------------------------------------------------------------
r49 | reid | 2006-03-17 18:29:15 -0600 (Fri, 17 Mar 2006) | 1 line

draft data model
------------------------------------------------------------------------
r48 | reid | 2006-03-17 17:55:46 -0600 (Fri, 17 Mar 2006) | 1 line

create CFCC to route type mapping
------------------------------------------------------------------------
r47 | reid | 2006-03-17 17:39:12 -0600 (Fri, 17 Mar 2006) | 1 line

create route_type table
------------------------------------------------------------------------
r46 | reid | 2006-03-17 16:21:23 -0600 (Fri, 17 Mar 2006) | 1 line

tweak import-shp
------------------------------------------------------------------------
r45 | reid | 2006-03-17 13:54:20 -0600 (Fri, 17 Mar 2006) | 1 line

create shapefile importer
------------------------------------------------------------------------
r44 | reid | 2006-03-16 15:44:50 -0600 (Thu, 16 Mar 2006) | 1 line

bring geoserver-1.3.0a into trunk
------------------------------------------------------------------------
r43 | reid | 2006-03-16 15:44:44 -0600 (Thu, 16 Mar 2006) | 1 line

add trunk
------------------------------------------------------------------------
